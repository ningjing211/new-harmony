let e;function t(e,t,r,n){Object.defineProperty(e,t,{get:r,set:n,enumerable:!0,configurable:!0})}function r(e){return e&&e.__esModule?e.default:e}var n,i,a,s,o=globalThis,l={},h={},u=o.parcelRequireed33;null==u&&((u=function(e){if(e in l)return l[e].exports;if(e in h){var t=h[e];delete h[e];var r={id:e,exports:{}};return l[e]=r,t.call(r.exports,r,r.exports),r.exports}var n=Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}).register=function(e,t){h[e]=t},o.parcelRequireed33=u);var c=u.register;c("ilwiq",function(e,r){let n,i,a;t(e.exports,"MOUSE",()=>s),t(e.exports,"TOUCH",()=>o),t(e.exports,"FrontSide",()=>l),t(e.exports,"DoubleSide",()=>h),t(e.exports,"AdditiveBlending",()=>u),t(e.exports,"RepeatWrapping",()=>c),t(e.exports,"ClampToEdgeWrapping",()=>d),t(e.exports,"MirroredRepeatWrapping",()=>p),t(e.exports,"NearestFilter",()=>f),t(e.exports,"NearestMipmapNearestFilter",()=>m),t(e.exports,"NearestMipmapLinearFilter",()=>g),t(e.exports,"LinearFilter",()=>v),t(e.exports,"LinearMipmapNearestFilter",()=>y),t(e.exports,"LinearMipmapLinearFilter",()=>x),t(e.exports,"RGBFormat",()=>_),t(e.exports,"RGBAFormat",()=>b),t(e.exports,"InterpolateDiscrete",()=>w),t(e.exports,"InterpolateLinear",()=>M),t(e.exports,"TriangleStripDrawMode",()=>S),t(e.exports,"TriangleFanDrawMode",()=>T),t(e.exports,"sRGBEncoding",()=>E),t(e.exports,"RGBADepthPacking",()=>A),t(e.exports,"TangentSpaceNormalMap",()=>L),t(e.exports,"EventDispatcher",()=>P),t(e.exports,"Vector2",()=>O),t(e.exports,"Matrix3",()=>U),t(e.exports,"Vector4",()=>z),t(e.exports,"Quaternion",()=>G),t(e.exports,"Vector3",()=>V),t(e.exports,"Box3",()=>q),t(e.exports,"Sphere",()=>el),t(e.exports,"Matrix4",()=>ev),t(e.exports,"Object3D",()=>eG),t(e.exports,"Material",()=>e5),t(e.exports,"Color",()=>tr),t(e.exports,"MeshBasicMaterial",()=>tn),t(e.exports,"BufferAttribute",()=>ts),t(e.exports,"BufferGeometry",()=>tT),t(e.exports,"Mesh",()=>tV),t(e.exports,"UniformsUtils",()=>tY),t(e.exports,"ShaderMaterial",()=>tZ),t(e.exports,"PerspectiveCamera",()=>tK),t(e.exports,"DataTexture",()=>t1),t(e.exports,"PlaneBufferGeometry",()=>t8),t(e.exports,"ShaderChunk",()=>t7),t(e.exports,"ShaderLib",()=>re),t(e.exports,"MeshDepthMaterial",()=>nC),t(e.exports,"MeshDistanceMaterial",()=>nI),t(e.exports,"Group",()=>nF),t(e.exports,"WebGLRenderer",()=>nG),t(e.exports,"Scene",()=>nj),t(e.exports,"InterleavedBuffer",()=>nq),t(e.exports,"InterleavedBufferAttribute",()=>nY),t(e.exports,"SkinnedMesh",()=>io),t(e.exports,"Bone",()=>il),t(e.exports,"Skeleton",()=>ic),t(e.exports,"LineBasicMaterial",()=>iy),t(e.exports,"Line",()=>iS),t(e.exports,"LineSegments",()=>iA),t(e.exports,"LineLoop",()=>iL),t(e.exports,"PointsMaterial",()=>iR),t(e.exports,"Points",()=>iO),t(e.exports,"CanvasTexture",()=>ik),t(e.exports,"CylinderBufferGeometry",()=>iF),t(e.exports,"MeshStandardMaterial",()=>i7),t(e.exports,"MeshPhysicalMaterial",()=>i9),t(e.exports,"Interpolant",()=>ar),t(e.exports,"NumberKeyframeTrack",()=>ah),t(e.exports,"QuaternionKeyframeTrack",()=>ac),t(e.exports,"VectorKeyframeTrack",()=>ap),t(e.exports,"AnimationClip",()=>af),t(e.exports,"LoadingManager",()=>ag),t(e.exports,"Loader",()=>ay),t(e.exports,"FileLoader",()=>a_),t(e.exports,"TextureLoader",()=>aT),t(e.exports,"SpotLight",()=>a0),t(e.exports,"PointLight",()=>a5),t(e.exports,"OrthographicCamera",()=>a6),t(e.exports,"DirectionalLight",()=>a7),t(e.exports,"AmbientLight",()=>a9),t(e.exports,"LoaderUtils",()=>sr),t(e.exports,"InstancedBufferGeometry",()=>sn),t(e.exports,"InstancedBufferAttribute",()=>si),t(e.exports,"ImageBitmapLoader",()=>sa),t(e.exports,"Clock",()=>sh),t(e.exports,"PropertyBinding",()=>s_),t(e.exports,"Raycaster",()=>sT),t(e.exports,"Spherical",()=>sL),t(e.exports,"MathUtils",()=>D),t(e.exports,"PlaneGeometry",()=>t8);let s={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},o={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},l=0,h=2,u=2,c=1e3,d=1001,p=1002,f=1003,m=1004,g=1005,v=1006,y=1007,x=1008,_=1022,b=1023,w=2300,M=2301,S=1,T=2,E=3001,A=3201,L=0,R="300 es";function P(){}Object.assign(P.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});let r=this._listeners;void 0===r[e]&&(r[e]=[]),-1===r[e].indexOf(t)&&r[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;let r=this._listeners;return void 0!==r[e]&&-1!==r[e].indexOf(t)},removeEventListener:function(e,t){if(void 0===this._listeners)return;let r=this._listeners[e];if(void 0!==r){let e=r.indexOf(t);-1!==e&&r.splice(e,1)}},dispatchEvent:function(e){if(void 0===this._listeners)return;let t=this._listeners[e.type];if(void 0!==t){e.target=this;let r=t.slice(0);for(let t=0,n=r.length;t<n;t++)r[t].call(this,e)}}});let C=[];for(let e=0;e<256;e++)C[e]=(e<16?"0":"")+e.toString(16);let I=1234567,D={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){let e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,r=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(C[255&e]+C[e>>8&255]+C[e>>16&255]+C[e>>24&255]+"-"+C[255&t]+C[t>>8&255]+"-"+C[t>>16&15|64]+C[t>>24&255]+"-"+C[63&r|128]+C[r>>8&255]+"-"+C[r>>16&255]+C[r>>24&255]+C[255&n]+C[n>>8&255]+C[n>>16&255]+C[n>>24&255]).toUpperCase()},clamp:function(e,t,r){return Math.max(t,Math.min(r,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,r,n,i){return n+(e-t)*(i-n)/(r-t)},lerp:function(e,t,r){return(1-r)*e+r*t},damp:function(e,t,r,n){return D.lerp(e,t,1-Math.exp(-r*n))},pingpong:function(e,t=1){return t-Math.abs(D.euclideanModulo(e,2*t)-t)},smoothstep:function(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t))*e*(3-2*e)},smootherstep:function(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){return void 0!==e&&(I=e%2147483647),((I=16807*I%2147483647)-1)/2147483646},degToRad:function(e){return e*D.DEG2RAD},radToDeg:function(e){return e*D.RAD2DEG},isPowerOfTwo:function(e){return(e&e-1)==0&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,t,r,n,i){let a=Math.cos,s=Math.sin,o=a(r/2),l=s(r/2),h=a((t+n)/2),u=s((t+n)/2),c=a((t-n)/2),d=s((t-n)/2),p=a((n-t)/2),f=s((n-t)/2);switch(i){case"XYX":e.set(o*u,l*c,l*d,o*h);break;case"YZY":e.set(l*d,o*u,l*c,o*h);break;case"ZXZ":e.set(l*c,l*d,o*u,o*h);break;case"XZX":e.set(o*u,l*f,l*p,o*h);break;case"YXY":e.set(l*p,o*u,l*f,o*h);break;case"ZYZ":e.set(l*f,l*p,o*u,o*h);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}};class O{constructor(e=0,t=0){this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let t=this.x,r=this.y,n=e.elements;return this.x=n[0]*t+n[3]*r+n[6],this.y=n[1]*t+n[4]*r+n[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t,r){return void 0!==r&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){let r=Math.cos(t),n=Math.sin(t),i=this.x-e.x,a=this.y-e.y;return this.x=i*r-a*n+e.x,this.y=i*n+a*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}}O.prototype.isVector2=!0;class U{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(e,t,r,n,i,a,s,o,l){let h=this.elements;return h[0]=e,h[1]=n,h[2]=s,h[3]=t,h[4]=i,h[5]=o,h[6]=r,h[7]=a,h[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let r=e.elements,n=t.elements,i=this.elements,a=r[0],s=r[3],o=r[6],l=r[1],h=r[4],u=r[7],c=r[2],d=r[5],p=r[8],f=n[0],m=n[3],g=n[6],v=n[1],y=n[4],x=n[7],_=n[2],b=n[5],w=n[8];return i[0]=a*f+s*v+o*_,i[3]=a*m+s*y+o*b,i[6]=a*g+s*x+o*w,i[1]=l*f+h*v+u*_,i[4]=l*m+h*y+u*b,i[7]=l*g+h*x+u*w,i[2]=c*f+d*v+p*_,i[5]=c*m+d*y+p*b,i[8]=c*g+d*x+p*w,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){let e=this.elements,t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],s=e[5],o=e[6],l=e[7],h=e[8];return t*a*h-t*s*l-r*i*h+r*s*o+n*i*l-n*a*o}invert(){let e=this.elements,t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],s=e[5],o=e[6],l=e[7],h=e[8],u=h*a-s*l,c=s*o-h*i,d=l*i-a*o,p=t*u+r*c+n*d;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);let f=1/p;return e[0]=u*f,e[1]=(n*l-h*r)*f,e[2]=(s*r-n*a)*f,e[3]=c*f,e[4]=(h*t-n*o)*f,e[5]=(n*i-s*t)*f,e[6]=d*f,e[7]=(r*o-l*t)*f,e[8]=(a*t-r*i)*f,this}transpose(){let e;let t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,n,i,a,s){let o=Math.cos(i),l=Math.sin(i);return this.set(r*o,r*l,-r*(o*a+l*s)+a+e,-n*l,n*o,-n*(-l*a+o*s)+s+t,0,0,1),this}scale(e,t){let r=this.elements;return r[0]*=e,r[3]*=e,r[6]*=e,r[1]*=t,r[4]*=t,r[7]*=t,this}rotate(e){let t=Math.cos(e),r=Math.sin(e),n=this.elements,i=n[0],a=n[3],s=n[6],o=n[1],l=n[4],h=n[7];return n[0]=t*i+r*o,n[3]=t*a+r*l,n[6]=t*s+r*h,n[1]=-r*i+t*o,n[4]=-r*a+t*l,n[7]=-r*s+t*h,this}translate(e,t){let r=this.elements;return r[0]+=e*r[2],r[3]+=e*r[5],r[6]+=e*r[8],r[1]+=t*r[2],r[4]+=t*r[5],r[7]+=t*r[8],this}equals(e){let t=this.elements,r=e.elements;for(let e=0;e<9;e++)if(t[e]!==r[e])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){let r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}}U.prototype.isMatrix3=!0;let N={getDataURL:function(e){let t;if(/^data:/i.test(e.src)||"undefined"==typeof HTMLCanvasElement)return e.src;if(e instanceof HTMLCanvasElement)t=e;else{void 0===n&&(n=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),n.width=e.width,n.height=e.height;let r=n.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=n}return t.width>2048||t.height>2048?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}},k=0;class F extends P{constructor(e=F.DEFAULT_IMAGE,t=F.DEFAULT_MAPPING,r=d,n=d,i=v,a=x,s=b,o=1009,l=1,h=3e3){super(),Object.defineProperty(this,"id",{value:k++}),this.uuid=D.generateUUID(),this.name="",this.image=e,this.mipmaps=[],this.mapping=t,this.wrapS=r,this.wrapT=n,this.magFilter=i,this.minFilter=a,this.anisotropy=l,this.format=s,this.internalFormat=null,this.type=o,this.offset=new O(0,0),this.repeat=new O(1,1),this.center=new O(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new U,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=h,this.version=0,this.onUpdate=null}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this}toJSON(e){let t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];let r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){let n=this.image;if(void 0===n.uuid&&(n.uuid=D.generateUUID()),!t&&void 0===e.images[n.uuid]){let t;if(Array.isArray(n)){t=[];for(let e=0,r=n.length;e<r;e++)n[e].isDataTexture?t.push(B(n[e].image)):t.push(B(n[e]))}else t=B(n);e.images[n.uuid]={uuid:n.uuid,url:t}}r.image=n.uuid}return t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(300!==this.mapping)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case c:e.x=e.x-Math.floor(e.x);break;case d:e.x=e.x<0?0:1;break;case p:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case c:e.y=e.y-Math.floor(e.y);break;case d:e.y=e.y<0?0:1;break;case p:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&this.version++}}function B(e){return"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?N.getDataURL(e):e.data?{data:Array.prototype.slice.call(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}F.DEFAULT_IMAGE=void 0,F.DEFAULT_MAPPING=300,F.prototype.isTexture=!0;class z{constructor(e=0,t=0,r=0,n=1){this.x=e,this.y=t,this.z=r,this.w=n}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,n){return this.x=e,this.y=t,this.z=r,this.w=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let t=this.x,r=this.y,n=this.z,i=this.w,a=e.elements;return this.x=a[0]*t+a[4]*r+a[8]*n+a[12]*i,this.y=a[1]*t+a[5]*r+a[9]*n+a[13]*i,this.z=a[2]*t+a[6]*r+a[10]*n+a[14]*i,this.w=a[3]*t+a[7]*r+a[11]*n+a[15]*i,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,n,i;let a=e.elements,s=a[0],o=a[4],l=a[8],h=a[1],u=a[5],c=a[9],d=a[2],p=a[6],f=a[10];if(.01>Math.abs(o-h)&&.01>Math.abs(l-d)&&.01>Math.abs(c-p)){if(.1>Math.abs(o+h)&&.1>Math.abs(l+d)&&.1>Math.abs(c+p)&&.1>Math.abs(s+u+f-3))return this.set(1,0,0,0),this;t=Math.PI;let e=(s+1)/2,a=(u+1)/2,m=(f+1)/2,g=(o+h)/4,v=(l+d)/4,y=(c+p)/4;return e>a&&e>m?e<.01?(r=0,n=.707106781,i=.707106781):(n=g/(r=Math.sqrt(e)),i=v/r):a>m?a<.01?(r=.707106781,n=0,i=.707106781):(r=g/(n=Math.sqrt(a)),i=y/n):m<.01?(r=.707106781,n=.707106781,i=0):(r=v/(i=Math.sqrt(m)),n=y/i),this.set(r,n,i,t),this}let m=Math.sqrt((p-c)*(p-c)+(l-d)*(l-d)+(h-o)*(h-o));return .001>Math.abs(m)&&(m=1),this.x=(p-c)/m,this.y=(l-d)/m,this.z=(h-o)/m,this.w=Math.acos((s+u+f-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t,r){return void 0!==r&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}z.prototype.isVector4=!0;class H extends P{constructor(e,t,r){super(),this.width=e,this.height=t,this.depth=1,this.scissor=new z(0,0,e,t),this.scissorTest=!1,this.viewport=new z(0,0,e,t),r=r||{},this.texture=new F(void 0,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),this.texture.image={},this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=1,this.texture.generateMipmaps=void 0!==r.generateMipmaps&&r.generateMipmaps,this.texture.minFilter=void 0!==r.minFilter?r.minFilter:v,this.depthBuffer=void 0===r.depthBuffer||r.depthBuffer,this.stencilBuffer=void 0!==r.stencilBuffer&&r.stencilBuffer,this.depthTexture=void 0!==r.depthTexture?r.depthTexture:null}setTexture(e){e.image={width:this.width,height:this.height,depth:this.depth},this.texture=e}setSize(e,t,r=1){(this.width!==e||this.height!==t||this.depth!==r)&&(this.width=e,this.height=t,this.depth=r,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=r,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}H.prototype.isWebGLRenderTarget=!0,(class extends H{constructor(e,t,r){super(e,t,r),this.samples=4}copy(e){return super.copy.call(this,e),this.samples=e.samples,this}}).prototype.isWebGLMultisampleRenderTarget=!0;class G{constructor(e=0,t=0,r=0,n=1){this._x=e,this._y=t,this._z=r,this._w=n}static slerp(e,t,r,n){return r.copy(e).slerp(t,n)}static slerpFlat(e,t,r,n,i,a,s){let o=r[n+0],l=r[n+1],h=r[n+2],u=r[n+3],c=i[a+0],d=i[a+1],p=i[a+2],f=i[a+3];if(0===s){e[t+0]=o,e[t+1]=l,e[t+2]=h,e[t+3]=u;return}if(1===s){e[t+0]=c,e[t+1]=d,e[t+2]=p,e[t+3]=f;return}if(u!==f||o!==c||l!==d||h!==p){let e=1-s,t=o*c+l*d+h*p+u*f,r=t>=0?1:-1,n=1-t*t;if(n>Number.EPSILON){let i=Math.sqrt(n),a=Math.atan2(i,t*r);e=Math.sin(e*a)/i,s=Math.sin(s*a)/i}let i=s*r;if(o=o*e+c*i,l=l*e+d*i,h=h*e+p*i,u=u*e+f*i,e===1-s){let e=1/Math.sqrt(o*o+l*l+h*h+u*u);o*=e,l*=e,h*=e,u*=e}}e[t]=o,e[t+1]=l,e[t+2]=h,e[t+3]=u}static multiplyQuaternionsFlat(e,t,r,n,i,a){let s=r[n],o=r[n+1],l=r[n+2],h=r[n+3],u=i[a],c=i[a+1],d=i[a+2],p=i[a+3];return e[t]=s*p+h*u+o*d-l*c,e[t+1]=o*p+h*c+l*u-s*d,e[t+2]=l*p+h*d+s*c-o*u,e[t+3]=h*p-s*u-o*c-l*d,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,n){return this._x=e,this._y=t,this._z=r,this._w=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){if(!(e&&e.isEuler))throw Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");let r=e._x,n=e._y,i=e._z,a=e._order,s=Math.cos,o=Math.sin,l=s(r/2),h=s(n/2),u=s(i/2),c=o(r/2),d=o(n/2),p=o(i/2);switch(a){case"XYZ":this._x=c*h*u+l*d*p,this._y=l*d*u-c*h*p,this._z=l*h*p+c*d*u,this._w=l*h*u-c*d*p;break;case"YXZ":this._x=c*h*u+l*d*p,this._y=l*d*u-c*h*p,this._z=l*h*p-c*d*u,this._w=l*h*u+c*d*p;break;case"ZXY":this._x=c*h*u-l*d*p,this._y=l*d*u+c*h*p,this._z=l*h*p+c*d*u,this._w=l*h*u-c*d*p;break;case"ZYX":this._x=c*h*u-l*d*p,this._y=l*d*u+c*h*p,this._z=l*h*p-c*d*u,this._w=l*h*u+c*d*p;break;case"YZX":this._x=c*h*u+l*d*p,this._y=l*d*u+c*h*p,this._z=l*h*p-c*d*u,this._w=l*h*u-c*d*p;break;case"XZY":this._x=c*h*u-l*d*p,this._y=l*d*u-c*h*p,this._z=l*h*p+c*d*u,this._w=l*h*u+c*d*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){let r=t/2,n=Math.sin(r);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){let t=e.elements,r=t[0],n=t[4],i=t[8],a=t[1],s=t[5],o=t[9],l=t[2],h=t[6],u=t[10],c=r+s+u;if(c>0){let e=.5/Math.sqrt(c+1);this._w=.25/e,this._x=(h-o)*e,this._y=(i-l)*e,this._z=(a-n)*e}else if(r>s&&r>u){let e=2*Math.sqrt(1+r-s-u);this._w=(h-o)/e,this._x=.25*e,this._y=(n+a)/e,this._z=(i+l)/e}else if(s>u){let e=2*Math.sqrt(1+s-r-u);this._w=(i-l)/e,this._x=(n+a)/e,this._y=.25*e,this._z=(o+h)/e}else{let e=2*Math.sqrt(1+u-r-s);this._w=(a-n)/e,this._x=(i+l)/e,this._y=(o+h)/e,this._z=.25*e}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<1e-6?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0):(this._x=0,this._y=-e.z,this._z=e.y)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x),this._w=r,this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(D.clamp(this.dot(e),-1,1)))}rotateTowards(e,t){let r=this.angleTo(e);if(0===r)return this;let n=Math.min(1,t/r);return this.slerp(e,n),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){let r=e._x,n=e._y,i=e._z,a=e._w,s=t._x,o=t._y,l=t._z,h=t._w;return this._x=r*h+a*s+n*l-i*o,this._y=n*h+a*o+i*s-r*l,this._z=i*h+a*l+r*o-n*s,this._w=a*h-r*s-n*o-i*l,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);let r=this._x,n=this._y,i=this._z,a=this._w,s=a*e._w+r*e._x+n*e._y+i*e._z;if(s<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,s=-s):this.copy(e),s>=1)return this._w=a,this._x=r,this._y=n,this._z=i,this;let o=1-s*s;if(o<=Number.EPSILON){let e=1-t;return this._w=e*a+t*this._w,this._x=e*r+t*this._x,this._y=e*n+t*this._y,this._z=e*i+t*this._z,this.normalize(),this._onChangeCallback(),this}let l=Math.sqrt(o),h=Math.atan2(l,s),u=Math.sin((1-t)*h)/l,c=Math.sin(t*h)/l;return this._w=a*u+this._w*c,this._x=r*u+this._x*c,this._y=n*u+this._y*c,this._z=i*u+this._z*c,this._onChangeCallback(),this}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}G.prototype.isQuaternion=!0;class V{constructor(e=0,t=0,r=0){this.x=e,this.y=t,this.z=r}set(e,t,r){return void 0===r&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(j.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(j.setFromAxisAngle(e,t))}applyMatrix3(e){let t=this.x,r=this.y,n=this.z,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6]*n,this.y=i[1]*t+i[4]*r+i[7]*n,this.z=i[2]*t+i[5]*r+i[8]*n,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let t=this.x,r=this.y,n=this.z,i=e.elements,a=1/(i[3]*t+i[7]*r+i[11]*n+i[15]);return this.x=(i[0]*t+i[4]*r+i[8]*n+i[12])*a,this.y=(i[1]*t+i[5]*r+i[9]*n+i[13])*a,this.z=(i[2]*t+i[6]*r+i[10]*n+i[14])*a,this}applyQuaternion(e){let t=this.x,r=this.y,n=this.z,i=e.x,a=e.y,s=e.z,o=e.w,l=o*t+a*n-s*r,h=o*r+s*t-i*n,u=o*n+i*r-a*t,c=-i*t-a*r-s*n;return this.x=l*o+-(c*i)+-(h*s)- -(u*a),this.y=h*o+-(c*a)+-(u*i)- -(l*s),this.z=u*o+-(c*s)+-(l*a)- -(h*i),this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let t=this.x,r=this.y,n=this.z,i=e.elements;return this.x=i[0]*t+i[4]*r+i[8]*n,this.y=i[1]*t+i[5]*r+i[9]*n,this.z=i[2]*t+i[6]*r+i[10]*n,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)}crossVectors(e,t){let r=e.x,n=e.y,i=e.z,a=t.x,s=t.y,o=t.z;return this.x=n*o-i*s,this.y=i*a-r*o,this.z=r*s-n*a,this}projectOnVector(e){let t=e.lengthSq();if(0===t)return this.set(0,0,0);let r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return W.copy(this).projectOnVector(e),this.sub(W)}reflect(e){return this.sub(W.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;let r=this.dot(e)/t;return Math.acos(D.clamp(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,r=this.y-e.y,n=this.z-e.z;return t*t+r*r+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){let n=Math.sin(t)*e;return this.x=n*Math.sin(r),this.y=Math.cos(t)*e,this.z=n*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){let t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=n,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t,r){return void 0!==r&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}V.prototype.isVector3=!0;let W=/*@__PURE__*/new V,j=/*@__PURE__*/new G;class q{constructor(e=new V(1/0,1/0,1/0),t=new V(-1/0,-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,r=1/0,n=1/0,i=-1/0,a=-1/0,s=-1/0;for(let o=0,l=e.length;o<l;o+=3){let l=e[o],h=e[o+1],u=e[o+2];l<t&&(t=l),h<r&&(r=h),u<n&&(n=u),l>i&&(i=l),h>a&&(a=h),u>s&&(s=u)}return this.min.set(t,r,n),this.max.set(i,a,s),this}setFromBufferAttribute(e){let t=1/0,r=1/0,n=1/0,i=-1/0,a=-1/0,s=-1/0;for(let o=0,l=e.count;o<l;o++){let l=e.getX(o),h=e.getY(o),u=e.getZ(o);l<t&&(t=l),h<r&&(r=h),u<n&&(n=u),l>i&&(i=l),h>a&&(a=h),u>s&&(s=u)}return this.min.set(t,r,n),this.max.set(i,a,s),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let r=Y.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e){return this.makeEmpty(),this.expandByObject(e)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return void 0===e&&(console.warn("THREE.Box3: .getCenter() target is now required"),e=new V),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return void 0===e&&(console.warn("THREE.Box3: .getSize() target is now required"),e=new V),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e){e.updateWorldMatrix(!1,!1);let t=e.geometry;void 0!==t&&(null===t.boundingBox&&t.computeBoundingBox(),Z.copy(t.boundingBox),Z.applyMatrix4(e.matrixWorld),this.union(Z));let r=e.children;for(let e=0,t=r.length;e<t;e++)this.expandByObject(r[e]);return this}containsPoint(e){return!(e.x<this.min.x)&&!(e.x>this.max.x)&&!(e.y<this.min.y)&&!(e.y>this.max.y)&&!(e.z<this.min.z)&&!(e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return void 0===t&&(console.warn("THREE.Box3: .getParameter() target is now required"),t=new V),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x)&&!(e.min.x>this.max.x)&&!(e.max.y<this.min.y)&&!(e.min.y>this.max.y)&&!(e.max.z<this.min.z)&&!(e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Y),Y.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(er),en.subVectors(this.max,er),J.subVectors(e.a,er),K.subVectors(e.b,er),Q.subVectors(e.c,er),$.subVectors(K,J),ee.subVectors(Q,K),et.subVectors(J,Q);let t=[0,-$.z,$.y,0,-ee.z,ee.y,0,-et.z,et.y,$.z,0,-$.x,ee.z,0,-ee.x,et.z,0,-et.x,-$.y,$.x,0,-ee.y,ee.x,0,-et.y,et.x,0];return!!(es(t,J,K,Q,en)&&es(t=[1,0,0,0,1,0,0,0,1],J,K,Q,en))&&(ei.crossVectors($,ee),es(t=[ei.x,ei.y,ei.z],J,K,Q,en))}clampPoint(e,t){return void 0===t&&(console.warn("THREE.Box3: .clampPoint() target is now required"),t=new V),t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Y.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return void 0===e&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(e.center),e.radius=.5*this.getSize(Y).length(),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(X[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),X[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),X[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),X[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),X[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),X[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),X[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),X[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(X)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}q.prototype.isBox3=!0;let X=[/*@__PURE__*/new V,/*@__PURE__*/new V,/*@__PURE__*/new V,/*@__PURE__*/new V,/*@__PURE__*/new V,/*@__PURE__*/new V,/*@__PURE__*/new V,/*@__PURE__*/new V],Y=/*@__PURE__*/new V,Z=/*@__PURE__*/new q,J=/*@__PURE__*/new V,K=/*@__PURE__*/new V,Q=/*@__PURE__*/new V,$=/*@__PURE__*/new V,ee=/*@__PURE__*/new V,et=/*@__PURE__*/new V,er=/*@__PURE__*/new V,en=/*@__PURE__*/new V,ei=/*@__PURE__*/new V,ea=/*@__PURE__*/new V;function es(e,t,r,n,i){for(let a=0,s=e.length-3;a<=s;a+=3){ea.fromArray(e,a);let s=i.x*Math.abs(ea.x)+i.y*Math.abs(ea.y)+i.z*Math.abs(ea.z),o=t.dot(ea),l=r.dot(ea),h=n.dot(ea);if(Math.max(-Math.max(o,l,h),Math.min(o,l,h))>s)return!1}return!0}let eo=/*@__PURE__*/new q;class el{constructor(e=new V,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){let r=this.center;void 0!==t?r.copy(t):eo.setFromPoints(e).getCenter(r);let n=0;for(let t=0,i=e.length;t<i;t++)n=Math.max(n,r.distanceToSquared(e[t]));return this.radius=Math.sqrt(n),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){let r=this.center.distanceToSquared(e);return void 0===t&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),t=new V),t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return(void 0===e&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),e=new q),this.isEmpty())?e.makeEmpty():(e.set(this.center,this.center),e.expandByScalar(this.radius)),e}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}let eh=/*@__PURE__*/new V,eu=/*@__PURE__*/new V,ec=/*@__PURE__*/new V,ed=/*@__PURE__*/new V,ep=/*@__PURE__*/new V,ef=/*@__PURE__*/new V,em=/*@__PURE__*/new V;class eg{constructor(e=new V,t=new V(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return void 0===t&&(console.warn("THREE.Ray: .at() target is now required"),t=new V),t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,eh)),this}closestPointToPoint(e,t){void 0===t&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),t=new V),t.subVectors(e,this.origin);let r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(r).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let t=eh.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(eh.copy(this.direction).multiplyScalar(t).add(this.origin),eh.distanceToSquared(e))}distanceSqToSegment(e,t,r,n){let i,a,s,o;eu.copy(e).add(t).multiplyScalar(.5),ec.copy(t).sub(e).normalize(),ed.copy(this.origin).sub(eu);let l=.5*e.distanceTo(t),h=-this.direction.dot(ec),u=ed.dot(this.direction),c=-ed.dot(ec),d=ed.lengthSq(),p=Math.abs(1-h*h);if(p>0){if(i=h*c-u,a=h*u-c,o=l*p,i>=0){if(a>=-o){if(a<=o){let e=1/p;i*=e,a*=e,s=i*(i+h*a+2*u)+a*(h*i+a+2*c)+d}else s=-(i=Math.max(0,-(h*(a=l)+u)))*i+a*(a+2*c)+d}else s=-(i=Math.max(0,-(h*(a=-l)+u)))*i+a*(a+2*c)+d}else a<=-o?(a=(i=Math.max(0,-(-h*l+u)))>0?-l:Math.min(Math.max(-l,-c),l),s=-i*i+a*(a+2*c)+d):a<=o?(i=0,s=(a=Math.min(Math.max(-l,-c),l))*(a+2*c)+d):(a=(i=Math.max(0,-(h*l+u)))>0?l:Math.min(Math.max(-l,-c),l),s=-i*i+a*(a+2*c)+d)}else a=h>0?-l:l,s=-(i=Math.max(0,-(h*a+u)))*i+a*(a+2*c)+d;return r&&r.copy(this.direction).multiplyScalar(i).add(this.origin),n&&n.copy(ec).multiplyScalar(a).add(eu),s}intersectSphere(e,t){eh.subVectors(e.center,this.origin);let r=eh.dot(this.direction),n=eh.dot(eh)-r*r,i=e.radius*e.radius;if(n>i)return null;let a=Math.sqrt(i-n),s=r-a,o=r+a;return s<0&&o<0?null:s<0?this.at(o,t):this.at(s,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;let r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){let r=this.distanceToPlane(e);return null===r?null:this.at(r,t)}intersectsPlane(e){let t=e.distanceToPoint(this.origin);return!!(0===t||e.normal.dot(this.direction)*t<0)}intersectBox(e,t){let r,n,i,a,s,o;let l=1/this.direction.x,h=1/this.direction.y,u=1/this.direction.z,c=this.origin;return(l>=0?(r=(e.min.x-c.x)*l,n=(e.max.x-c.x)*l):(r=(e.max.x-c.x)*l,n=(e.min.x-c.x)*l),h>=0?(i=(e.min.y-c.y)*h,a=(e.max.y-c.y)*h):(i=(e.max.y-c.y)*h,a=(e.min.y-c.y)*h),r>a||i>n)?null:((i>r||r!=r)&&(r=i),(a<n||n!=n)&&(n=a),u>=0?(s=(e.min.z-c.z)*u,o=(e.max.z-c.z)*u):(s=(e.max.z-c.z)*u,o=(e.min.z-c.z)*u),r>o||s>n)?null:((s>r||r!=r)&&(r=s),(o<n||n!=n)&&(n=o),n<0)?null:this.at(r>=0?r:n,t)}intersectsBox(e){return null!==this.intersectBox(e,eh)}intersectTriangle(e,t,r,n,i){let a;ep.subVectors(t,e),ef.subVectors(r,e),em.crossVectors(ep,ef);let s=this.direction.dot(em);if(s>0){if(n)return null;a=1}else{if(!(s<0))return null;a=-1,s=-s}ed.subVectors(this.origin,e);let o=a*this.direction.dot(ef.crossVectors(ed,ef));if(o<0)return null;let l=a*this.direction.dot(ep.cross(ed));if(l<0||o+l>s)return null;let h=-a*ed.dot(em);return h<0?null:this.at(h/s,i)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class ev{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(e,t,r,n,i,a,s,o,l,h,u,c,d,p,f,m){let g=this.elements;return g[0]=e,g[4]=t,g[8]=r,g[12]=n,g[1]=i,g[5]=a,g[9]=s,g[13]=o,g[2]=l,g[6]=h,g[10]=u,g[14]=c,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new ev().fromArray(this.elements)}copy(e){let t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){let t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){let t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){let t=this.elements,r=e.elements,n=1/ey.setFromMatrixColumn(e,0).length(),i=1/ey.setFromMatrixColumn(e,1).length(),a=1/ey.setFromMatrixColumn(e,2).length();return t[0]=r[0]*n,t[1]=r[1]*n,t[2]=r[2]*n,t[3]=0,t[4]=r[4]*i,t[5]=r[5]*i,t[6]=r[6]*i,t[7]=0,t[8]=r[8]*a,t[9]=r[9]*a,t[10]=r[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");let t=this.elements,r=e.x,n=e.y,i=e.z,a=Math.cos(r),s=Math.sin(r),o=Math.cos(n),l=Math.sin(n),h=Math.cos(i),u=Math.sin(i);if("XYZ"===e.order){let e=a*h,r=a*u,n=s*h,i=s*u;t[0]=o*h,t[4]=-o*u,t[8]=l,t[1]=r+n*l,t[5]=e-i*l,t[9]=-s*o,t[2]=i-e*l,t[6]=n+r*l,t[10]=a*o}else if("YXZ"===e.order){let e=o*h,r=o*u,n=l*h,i=l*u;t[0]=e+i*s,t[4]=n*s-r,t[8]=a*l,t[1]=a*u,t[5]=a*h,t[9]=-s,t[2]=r*s-n,t[6]=i+e*s,t[10]=a*o}else if("ZXY"===e.order){let e=o*h,r=o*u,n=l*h,i=l*u;t[0]=e-i*s,t[4]=-a*u,t[8]=n+r*s,t[1]=r+n*s,t[5]=a*h,t[9]=i-e*s,t[2]=-a*l,t[6]=s,t[10]=a*o}else if("ZYX"===e.order){let e=a*h,r=a*u,n=s*h,i=s*u;t[0]=o*h,t[4]=n*l-r,t[8]=e*l+i,t[1]=o*u,t[5]=i*l+e,t[9]=r*l-n,t[2]=-l,t[6]=s*o,t[10]=a*o}else if("YZX"===e.order){let e=a*o,r=a*l,n=s*o,i=s*l;t[0]=o*h,t[4]=i-e*u,t[8]=n*u+r,t[1]=u,t[5]=a*h,t[9]=-s*h,t[2]=-l*h,t[6]=r*u+n,t[10]=e-i*u}else if("XZY"===e.order){let e=a*o,r=a*l,n=s*o,i=s*l;t[0]=o*h,t[4]=-u,t[8]=l*h,t[1]=e*u+i,t[5]=a*h,t[9]=r*u-n,t[2]=n*u-r,t[6]=s*h,t[10]=i*u+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(e_,e,eb)}lookAt(e,t,r){let n=this.elements;return eS.subVectors(e,t),0===eS.lengthSq()&&(eS.z=1),eS.normalize(),ew.crossVectors(r,eS),0===ew.lengthSq()&&(1===Math.abs(r.z)?eS.x+=1e-4:eS.z+=1e-4,eS.normalize(),ew.crossVectors(r,eS)),ew.normalize(),eM.crossVectors(eS,ew),n[0]=ew.x,n[4]=eM.x,n[8]=eS.x,n[1]=ew.y,n[5]=eM.y,n[9]=eS.y,n[2]=ew.z,n[6]=eM.z,n[10]=eS.z,this}multiply(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let r=e.elements,n=t.elements,i=this.elements,a=r[0],s=r[4],o=r[8],l=r[12],h=r[1],u=r[5],c=r[9],d=r[13],p=r[2],f=r[6],m=r[10],g=r[14],v=r[3],y=r[7],x=r[11],_=r[15],b=n[0],w=n[4],M=n[8],S=n[12],T=n[1],E=n[5],A=n[9],L=n[13],R=n[2],P=n[6],C=n[10],I=n[14],D=n[3],O=n[7],U=n[11],N=n[15];return i[0]=a*b+s*T+o*R+l*D,i[4]=a*w+s*E+o*P+l*O,i[8]=a*M+s*A+o*C+l*U,i[12]=a*S+s*L+o*I+l*N,i[1]=h*b+u*T+c*R+d*D,i[5]=h*w+u*E+c*P+d*O,i[9]=h*M+u*A+c*C+d*U,i[13]=h*S+u*L+c*I+d*N,i[2]=p*b+f*T+m*R+g*D,i[6]=p*w+f*E+m*P+g*O,i[10]=p*M+f*A+m*C+g*U,i[14]=p*S+f*L+m*I+g*N,i[3]=v*b+y*T+x*R+_*D,i[7]=v*w+y*E+x*P+_*O,i[11]=v*M+y*A+x*C+_*U,i[15]=v*S+y*L+x*I+_*N,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){let e=this.elements,t=e[0],r=e[4],n=e[8],i=e[12],a=e[1],s=e[5],o=e[9],l=e[13],h=e[2],u=e[6],c=e[10],d=e[14],p=e[3];return p*(+i*o*u-n*l*u-i*s*c+r*l*c+n*s*d-r*o*d)+e[7]*(+t*o*d-t*l*c+i*a*c-n*a*d+n*l*h-i*o*h)+e[11]*(+t*l*u-t*s*d-i*a*u+r*a*d+i*s*h-r*l*h)+e[15]*(-n*s*h-t*o*u+t*s*c+n*a*u-r*a*c+r*o*h)}transpose(){let e;let t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(e,t,r){let n=this.elements;return e.isVector3?(n[12]=e.x,n[13]=e.y,n[14]=e.z):(n[12]=e,n[13]=t,n[14]=r),this}invert(){let e=this.elements,t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],s=e[5],o=e[6],l=e[7],h=e[8],u=e[9],c=e[10],d=e[11],p=e[12],f=e[13],m=e[14],g=e[15],v=u*m*l-f*c*l+f*o*d-s*m*d-u*o*g+s*c*g,y=p*c*l-h*m*l-p*o*d+a*m*d+h*o*g-a*c*g,x=h*f*l-p*u*l+p*s*d-a*f*d-h*s*g+a*u*g,_=p*u*o-h*f*o-p*s*c+a*f*c+h*s*m-a*u*m,b=t*v+r*y+n*x+i*_;if(0===b)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let w=1/b;return e[0]=v*w,e[1]=(f*c*i-u*m*i-f*n*d+r*m*d+u*n*g-r*c*g)*w,e[2]=(s*m*i-f*o*i+f*n*l-r*m*l-s*n*g+r*o*g)*w,e[3]=(u*o*i-s*c*i-u*n*l+r*c*l+s*n*d-r*o*d)*w,e[4]=y*w,e[5]=(h*m*i-p*c*i+p*n*d-t*m*d-h*n*g+t*c*g)*w,e[6]=(p*o*i-a*m*i-p*n*l+t*m*l+a*n*g-t*o*g)*w,e[7]=(a*c*i-h*o*i+h*n*l-t*c*l-a*n*d+t*o*d)*w,e[8]=x*w,e[9]=(p*u*i-h*f*i-p*r*d+t*f*d+h*r*g-t*u*g)*w,e[10]=(a*f*i-p*s*i+p*r*l-t*f*l-a*r*g+t*s*g)*w,e[11]=(h*s*i-a*u*i-h*r*l+t*u*l+a*r*d-t*s*d)*w,e[12]=_*w,e[13]=(h*f*n-p*u*n+p*r*c-t*f*c-h*r*m+t*u*m)*w,e[14]=(p*s*n-a*f*n-p*r*o+t*f*o+a*r*m-t*s*m)*w,e[15]=(a*u*n-h*s*n+h*r*o-t*u*o-a*r*c+t*s*c)*w,this}scale(e){let t=this.elements,r=e.x,n=e.y,i=e.z;return t[0]*=r,t[4]*=n,t[8]*=i,t[1]*=r,t[5]*=n,t[9]*=i,t[2]*=r,t[6]*=n,t[10]*=i,t[3]*=r,t[7]*=n,t[11]*=i,this}getMaxScaleOnAxis(){let e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,r){return this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){let t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){let r=Math.cos(t),n=Math.sin(t),i=1-r,a=e.x,s=e.y,o=e.z,l=i*a,h=i*s;return this.set(l*a+r,l*s-n*o,l*o+n*s,0,l*s+n*o,h*s+r,h*o-n*a,0,l*o-n*s,h*o+n*a,i*o*o+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r){return this.set(1,t,r,0,e,1,r,0,e,t,1,0,0,0,0,1),this}compose(e,t,r){let n=this.elements,i=t._x,a=t._y,s=t._z,o=t._w,l=i+i,h=a+a,u=s+s,c=i*l,d=i*h,p=i*u,f=a*h,m=a*u,g=s*u,v=o*l,y=o*h,x=o*u,_=r.x,b=r.y,w=r.z;return n[0]=(1-(f+g))*_,n[1]=(d+x)*_,n[2]=(p-y)*_,n[3]=0,n[4]=(d-x)*b,n[5]=(1-(c+g))*b,n[6]=(m+v)*b,n[7]=0,n[8]=(p+y)*w,n[9]=(m-v)*w,n[10]=(1-(c+f))*w,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,this}decompose(e,t,r){let n=this.elements,i=ey.set(n[0],n[1],n[2]).length(),a=ey.set(n[4],n[5],n[6]).length(),s=ey.set(n[8],n[9],n[10]).length();0>this.determinant()&&(i=-i),e.x=n[12],e.y=n[13],e.z=n[14],ex.copy(this);let o=1/i,l=1/a,h=1/s;return ex.elements[0]*=o,ex.elements[1]*=o,ex.elements[2]*=o,ex.elements[4]*=l,ex.elements[5]*=l,ex.elements[6]*=l,ex.elements[8]*=h,ex.elements[9]*=h,ex.elements[10]*=h,t.setFromRotationMatrix(ex),r.x=i,r.y=a,r.z=s,this}makePerspective(e,t,r,n,i,a){void 0===a&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");let s=this.elements;return s[0]=2*i/(t-e),s[4]=0,s[8]=(t+e)/(t-e),s[12]=0,s[1]=0,s[5]=2*i/(r-n),s[9]=(r+n)/(r-n),s[13]=0,s[2]=0,s[6]=0,s[10]=-(a+i)/(a-i),s[14]=-2*a*i/(a-i),s[3]=0,s[7]=0,s[11]=-1,s[15]=0,this}makeOrthographic(e,t,r,n,i,a){let s=this.elements,o=1/(t-e),l=1/(r-n),h=1/(a-i);return s[0]=2*o,s[4]=0,s[8]=0,s[12]=-((t+e)*o),s[1]=0,s[5]=2*l,s[9]=0,s[13]=-((r+n)*l),s[2]=0,s[6]=0,s[10]=-2*h,s[14]=-((a+i)*h),s[3]=0,s[7]=0,s[11]=0,s[15]=1,this}equals(e){let t=this.elements,r=e.elements;for(let e=0;e<16;e++)if(t[e]!==r[e])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){let r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}ev.prototype.isMatrix4=!0;let ey=/*@__PURE__*/new V,ex=/*@__PURE__*/new ev,e_=/*@__PURE__*/new V(0,0,0),eb=/*@__PURE__*/new V(1,1,1),ew=/*@__PURE__*/new V,eM=/*@__PURE__*/new V,eS=/*@__PURE__*/new V,eT=/*@__PURE__*/new ev,eE=/*@__PURE__*/new G;class eA{constructor(e=0,t=0,r=0,n=eA.DefaultOrder){this._x=e,this._y=t,this._z=r,this._order=n}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,n){return this._x=e,this._y=t,this._z=r,this._order=n||this._order,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t,r){let n=D.clamp,i=e.elements,a=i[0],s=i[4],o=i[8],l=i[1],h=i[5],u=i[9],c=i[2],d=i[6],p=i[10];switch(t=t||this._order){case"XYZ":this._y=Math.asin(n(o,-1,1)),.9999999>Math.abs(o)?(this._x=Math.atan2(-u,p),this._z=Math.atan2(-s,a)):(this._x=Math.atan2(d,h),this._z=0);break;case"YXZ":this._x=Math.asin(-n(u,-1,1)),.9999999>Math.abs(u)?(this._y=Math.atan2(o,p),this._z=Math.atan2(l,h)):(this._y=Math.atan2(-c,a),this._z=0);break;case"ZXY":this._x=Math.asin(n(d,-1,1)),.9999999>Math.abs(d)?(this._y=Math.atan2(-c,p),this._z=Math.atan2(-s,h)):(this._y=0,this._z=Math.atan2(l,a));break;case"ZYX":this._y=Math.asin(-n(c,-1,1)),.9999999>Math.abs(c)?(this._x=Math.atan2(d,p),this._z=Math.atan2(l,a)):(this._x=0,this._z=Math.atan2(-s,h));break;case"YZX":this._z=Math.asin(n(l,-1,1)),.9999999>Math.abs(l)?(this._x=Math.atan2(-u,h),this._y=Math.atan2(-c,a)):(this._x=0,this._y=Math.atan2(o,p));break;case"XZY":this._z=Math.asin(-n(s,-1,1)),.9999999>Math.abs(s)?(this._x=Math.atan2(d,h),this._y=Math.atan2(o,a)):(this._x=Math.atan2(-u,p),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!1!==r&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return eT.makeRotationFromQuaternion(e),this.setFromRotationMatrix(eT,t,r)}setFromVector3(e,t){return this.set(e.x,e.y,e.z,t||this._order)}reorder(e){return eE.setFromEuler(this),this.setFromQuaternion(eE,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}toVector3(e){return e?e.set(this._x,this._y,this._z):new V(this._x,this._y,this._z)}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}eA.prototype.isEuler=!0,eA.DefaultOrder="XYZ",eA.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class eL{constructor(){this.mask=1}set(e){this.mask=1<<e|0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!=0}}let eR=0,eP=new V,eC=new G,eI=new ev,eD=new V,eO=new V,eU=new V,eN=new G,ek=new V(1,0,0),eF=new V(0,1,0),eB=new V(0,0,1),ez={type:"added"},eH={type:"removed"};function eG(){Object.defineProperty(this,"id",{value:eR++}),this.uuid=D.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=eG.DefaultUp.clone();let e=new V,t=new eA,r=new G,n=new V(1,1,1);t._onChange(function(){r.setFromEuler(t,!1)}),r._onChange(function(){t.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new ev},normalMatrix:{value:new U}}),this.matrix=new ev,this.matrixWorld=new ev,this.matrixAutoUpdate=eG.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new eL,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}eG.DefaultUp=new V(0,1,0),eG.DefaultMatrixAutoUpdate=!0,eG.prototype=Object.assign(Object.create(P.prototype),{constructor:eG,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(e,t){return eC.setFromAxisAngle(e,t),this.quaternion.multiply(eC),this},rotateOnWorldAxis:function(e,t){return eC.setFromAxisAngle(e,t),this.quaternion.premultiply(eC),this},rotateX:function(e){return this.rotateOnAxis(ek,e)},rotateY:function(e){return this.rotateOnAxis(eF,e)},rotateZ:function(e){return this.rotateOnAxis(eB,e)},translateOnAxis:function(e,t){return eP.copy(e).applyQuaternion(this.quaternion),this.position.add(eP.multiplyScalar(t)),this},translateX:function(e){return this.translateOnAxis(ek,e)},translateY:function(e){return this.translateOnAxis(eF,e)},translateZ:function(e){return this.translateOnAxis(eB,e)},localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(e){return e.applyMatrix4(eI.copy(this.matrixWorld).invert())},lookAt:function(e,t,r){e.isVector3?eD.copy(e):eD.set(e,t,r);let n=this.parent;this.updateWorldMatrix(!0,!1),eO.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?eI.lookAt(eO,eD,this.up):eI.lookAt(eD,eO,this.up),this.quaternion.setFromRotationMatrix(eI),n&&(eI.extractRotation(n.matrixWorld),eC.setFromRotationMatrix(eI),this.quaternion.premultiply(eC.invert()))},add:function(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this?console.error("THREE.Object3D.add: object can't be added as a child of itself.",e):e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(ez)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this},remove:function(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}let t=this.children.indexOf(e);return -1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(eH)),this},clear:function(){for(let e=0;e<this.children.length;e++){let t=this.children[e];t.parent=null,t.dispatchEvent(eH)}return this.children.length=0,this},attach:function(e){return this.updateWorldMatrix(!0,!1),eI.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),eI.multiply(e.parent.matrixWorld)),e.applyMatrix4(eI),this.add(e),e.updateWorldMatrix(!1,!0),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(let r=0,n=this.children.length;r<n;r++){let n=this.children[r].getObjectByProperty(e,t);if(void 0!==n)return n}},getWorldPosition:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new V),this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),e=new G),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(eO,e,eU),e},getWorldScale:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),e=new V),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(eO,eN,e),e},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new V),this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()},raycast:function(){},traverse:function(e){e(this);let t=this.children;for(let r=0,n=t.length;r<n;r++)t[r].traverse(e)},traverseVisible:function(e){if(!1===this.visible)return;e(this);let t=this.children;for(let r=0,n=t.length;r<n;r++)t[r].traverseVisible(e)},traverseAncestors:function(e){let t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);let t=this.children;for(let r=0,n=t.length;r<n;r++)t[r].updateMatrixWorld(e)},updateWorldMatrix:function(e,t){let r=this.parent;if(!0===e&&null!==r&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t){let e=this.children;for(let t=0,r=e.length;t<r;t++)e[t].updateWorldMatrix(!1,!0)}},toJSON:function(e){let t=void 0===e||"string"==typeof e,r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});let n={};function i(t,r){return void 0===t[r.uuid]&&(t[r.uuid]=r.toJSON(e)),r.uuid}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),!0===this.castShadow&&(n.castShadow=!0),!0===this.receiveShadow&&(n.receiveShadow=!0),!1===this.visible&&(n.visible=!1),!1===this.frustumCulled&&(n.frustumCulled=!1),0!==this.renderOrder&&(n.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(n.matrixAutoUpdate=!1),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){n.geometry=i(e.geometries,this.geometry);let t=this.geometry.parameters;if(void 0!==t&&void 0!==t.shapes){let r=t.shapes;if(Array.isArray(r))for(let t=0,n=r.length;t<n;t++){let n=r[t];i(e.shapes,n)}else i(e.shapes,r)}}if(this.isSkinnedMesh&&(n.bindMode=this.bindMode,n.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(i(e.skeletons,this.skeleton),n.skeleton=this.skeleton.uuid)),void 0!==this.material){if(Array.isArray(this.material)){let t=[];for(let r=0,n=this.material.length;r<n;r++)t.push(i(e.materials,this.material[r]));n.material=t}else n.material=i(e.materials,this.material)}if(this.children.length>0){n.children=[];for(let t=0;t<this.children.length;t++)n.children.push(this.children[t].toJSON(e).object)}if(this.animations.length>0){n.animations=[];for(let t=0;t<this.animations.length;t++){let r=this.animations[t];n.animations.push(i(e.animations,r))}}if(t){let t=a(e.geometries),n=a(e.materials),i=a(e.textures),s=a(e.images),o=a(e.shapes),l=a(e.skeletons),h=a(e.animations);t.length>0&&(r.geometries=t),n.length>0&&(r.materials=n),i.length>0&&(r.textures=i),s.length>0&&(r.images=s),o.length>0&&(r.shapes=o),l.length>0&&(r.skeletons=l),h.length>0&&(r.animations=h)}return r.object=n,r;function a(e){let t=[];for(let r in e){let n=e[r];delete n.metadata,t.push(n)}return t}},clone:function(e){return new this.constructor().copy(this,e)},copy:function(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let t=0;t<e.children.length;t++){let r=e.children[t];this.add(r.clone())}return this}});let eV=/*@__PURE__*/new V,eW=/*@__PURE__*/new V,ej=/*@__PURE__*/new U;class eq{constructor(e=new V(1,0,0),t=0){this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,n){return this.normal.set(e,t,r),this.constant=n,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){let n=eV.subVectors(r,t).cross(eW.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(n,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return void 0===t&&(console.warn("THREE.Plane: .projectPoint() target is now required"),t=new V),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){void 0===t&&(console.warn("THREE.Plane: .intersectLine() target is now required"),t=new V);let r=e.delta(eV),n=this.normal.dot(r);if(0===n)return 0===this.distanceToPoint(e.start)?t.copy(e.start):void 0;let i=-(e.start.dot(this.normal)+this.constant)/n;if(!(i<0)&&!(i>1))return t.copy(r).multiplyScalar(i).add(e.start)}intersectsLine(e){let t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return void 0===e&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),e=new V),e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){let r=t||ej.getNormalMatrix(e),n=this.coplanarPoint(eV).applyMatrix4(e),i=this.normal.applyMatrix3(r).normalize();return this.constant=-n.dot(i),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}eq.prototype.isPlane=!0;let eX=/*@__PURE__*/new V,eY=/*@__PURE__*/new V,eZ=/*@__PURE__*/new V,eJ=/*@__PURE__*/new V,eK=/*@__PURE__*/new V,eQ=/*@__PURE__*/new V,e$=/*@__PURE__*/new V,e0=/*@__PURE__*/new V,e1=/*@__PURE__*/new V,e2=/*@__PURE__*/new V;class e3{constructor(e=new V,t=new V,r=new V){this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,n){void 0===n&&(console.warn("THREE.Triangle: .getNormal() target is now required"),n=new V),n.subVectors(r,t),eX.subVectors(e,t),n.cross(eX);let i=n.lengthSq();return i>0?n.multiplyScalar(1/Math.sqrt(i)):n.set(0,0,0)}static getBarycoord(e,t,r,n,i){eX.subVectors(n,t),eY.subVectors(r,t),eZ.subVectors(e,t);let a=eX.dot(eX),s=eX.dot(eY),o=eX.dot(eZ),l=eY.dot(eY),h=eY.dot(eZ),u=a*l-s*s;if(void 0===i&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),i=new V),0===u)return i.set(-2,-1,-1);let c=1/u,d=(l*o-s*h)*c,p=(a*h-s*o)*c;return i.set(1-d-p,p,d)}static containsPoint(e,t,r,n){return this.getBarycoord(e,t,r,n,eJ),eJ.x>=0&&eJ.y>=0&&eJ.x+eJ.y<=1}static getUV(e,t,r,n,i,a,s,o){return this.getBarycoord(e,t,r,n,eJ),o.set(0,0),o.addScaledVector(i,eJ.x),o.addScaledVector(a,eJ.y),o.addScaledVector(s,eJ.z),o}static isFrontFacing(e,t,r,n){return eX.subVectors(r,t),eY.subVectors(e,t),0>eX.cross(eY).dot(n)}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,n){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[n]),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return eX.subVectors(this.c,this.b),eY.subVectors(this.a,this.b),.5*eX.cross(eY).length()}getMidpoint(e){return void 0===e&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),e=new V),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return e3.getNormal(this.a,this.b,this.c,e)}getPlane(e){return void 0===e&&(console.warn("THREE.Triangle: .getPlane() target is now required"),e=new eq),e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return e3.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,r,n,i){return e3.getUV(e,this.a,this.b,this.c,t,r,n,i)}containsPoint(e){return e3.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return e3.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){let r,n;void 0===t&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),t=new V);let i=this.a,a=this.b,s=this.c;eK.subVectors(a,i),eQ.subVectors(s,i),e0.subVectors(e,i);let o=eK.dot(e0),l=eQ.dot(e0);if(o<=0&&l<=0)return t.copy(i);e1.subVectors(e,a);let h=eK.dot(e1),u=eQ.dot(e1);if(h>=0&&u<=h)return t.copy(a);let c=o*u-h*l;if(c<=0&&o>=0&&h<=0)return r=o/(o-h),t.copy(i).addScaledVector(eK,r);e2.subVectors(e,s);let d=eK.dot(e2),p=eQ.dot(e2);if(p>=0&&d<=p)return t.copy(s);let f=d*l-o*p;if(f<=0&&l>=0&&p<=0)return n=l/(l-p),t.copy(i).addScaledVector(eQ,n);let m=h*p-d*u;if(m<=0&&u-h>=0&&d-p>=0)return e$.subVectors(s,a),n=(u-h)/(u-h+(d-p)),t.copy(a).addScaledVector(e$,n);let g=1/(m+f+c);return r=f*g,n=c*g,t.copy(i).addScaledVector(eK,r).addScaledVector(eQ,n)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let e4=0;function e5(){Object.defineProperty(this,"id",{value:e4++}),this.uuid=D.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=l,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}e5.prototype=Object.assign(Object.create(P.prototype),{constructor:e5,isMaterial:!0,onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(e){if(void 0!==e)for(let t in e){let r=e[t];if(void 0===r){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}if("shading"===t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===r;continue}let n=this[t];if(void 0===n){console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.");continue}n&&n.isColor?n.set(r):n&&n.isVector3&&r&&r.isVector3?n.copy(r):this[t]=r}},toJSON:function(e){let t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});let r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function n(e){let t=[];for(let r in e){let n=e[r];delete n.metadata,t.push(n)}return t}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),void 0!==this.roughness&&(r.roughness=this.roughness),void 0!==this.metalness&&(r.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(r.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),void 0!==this.shininess&&(r.shininess=this.shininess),void 0!==this.clearcoat&&(r.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,r.reflectivity=this.reflectivity,r.refractionRatio=this.refractionRatio,void 0!==this.combine&&(r.combine=this.combine),void 0!==this.envMapIntensity&&(r.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(r.size=this.size),void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(r.blending=this.blending),this.side!==l&&(r.side=this.side),this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),!0===this.transparent&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,r.stencilWrite=this.stencilWrite,r.stencilWriteMask=this.stencilWriteMask,r.stencilFunc=this.stencilFunc,r.stencilRef=this.stencilRef,r.stencilFuncMask=this.stencilFuncMask,r.stencilFail=this.stencilFail,r.stencilZFail=this.stencilZFail,r.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(r.rotation=this.rotation),!0===this.polygonOffset&&(r.polygonOffset=!0),0!==this.polygonOffsetFactor&&(r.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(r.linewidth=this.linewidth),void 0!==this.dashSize&&(r.dashSize=this.dashSize),void 0!==this.gapSize&&(r.gapSize=this.gapSize),void 0!==this.scale&&(r.scale=this.scale),!0===this.dithering&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(r.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(r.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(r.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(r.morphTargets=!0),!0===this.morphNormals&&(r.morphNormals=!0),!0===this.skinning&&(r.skinning=!0),!0===this.flatShading&&(r.flatShading=this.flatShading),!1===this.visible&&(r.visible=!1),!1===this.toneMapped&&(r.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),t){let t=n(e.textures),i=n(e.images);t.length>0&&(r.textures=t),i.length>0&&(r.images=i)}return r},clone:function(){return new this.constructor().copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let t=e.clippingPlanes,r=null;if(null!==t){let e=t.length;r=Array(e);for(let n=0;n!==e;++n)r[n]=t[n].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(e5.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}});let e6={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},e8={h:0,s:0,l:0},e7={h:0,s:0,l:0};function e9(e,t,r){return(r<0&&(r+=1),r>1&&(r-=1),r<1/6)?e+(t-e)*6*r:r<.5?t:r<2/3?e+(t-e)*6*(2/3-r):e}function te(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function tt(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}class tr{constructor(e,t,r){if(void 0===t&&void 0===r)return this.set(e);return this.setRGB(e,t,r)}set(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this}setRGB(e,t,r){return this.r=e,this.g=t,this.b=r,this}setHSL(e,t,r){if(e=D.euclideanModulo(e,1),t=D.clamp(t,0,1),r=D.clamp(r,0,1),0===t)this.r=this.g=this.b=r;else{let n=r<=.5?r*(1+t):r+t-r*t,i=2*r-n;this.r=e9(i,n,e+1/3),this.g=e9(i,n,e),this.b=e9(i,n,e-1/3)}return this}setStyle(e){let t;function r(t){void 0!==t&&1>parseFloat(t)&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}if(t=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let e;let n=t[1],i=t[2];switch(n){case"rgb":case"rgba":if(e=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(i))return this.r=Math.min(255,parseInt(e[1],10))/255,this.g=Math.min(255,parseInt(e[2],10))/255,this.b=Math.min(255,parseInt(e[3],10))/255,r(e[4]),this;if(e=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(i))return this.r=Math.min(100,parseInt(e[1],10))/100,this.g=Math.min(100,parseInt(e[2],10))/100,this.b=Math.min(100,parseInt(e[3],10))/100,r(e[4]),this;break;case"hsl":case"hsla":if(e=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(i)){let t=parseFloat(e[1])/360,n=parseInt(e[2],10)/100,i=parseInt(e[3],10)/100;return r(e[4]),this.setHSL(t,n,i)}}}else if(t=/^\#([A-Fa-f\d]+)$/.exec(e)){let e=t[1],r=e.length;if(3===r)return this.r=parseInt(e.charAt(0)+e.charAt(0),16)/255,this.g=parseInt(e.charAt(1)+e.charAt(1),16)/255,this.b=parseInt(e.charAt(2)+e.charAt(2),16)/255,this;if(6===r)return this.r=parseInt(e.charAt(0)+e.charAt(1),16)/255,this.g=parseInt(e.charAt(2)+e.charAt(3),16)/255,this.b=parseInt(e.charAt(4)+e.charAt(5),16)/255,this}return e&&e.length>0?this.setColorName(e):this}setColorName(e){let t=e6[e];return void 0!==t?this.setHex(t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copyGammaToLinear(e,t=2){return this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this}copyLinearToGamma(e,t=2){let r=t>0?1/t:1;return this.r=Math.pow(e.r,r),this.g=Math.pow(e.g,r),this.b=Math.pow(e.b,r),this}convertGammaToLinear(e){return this.copyGammaToLinear(this,e),this}convertLinearToGamma(e){return this.copyLinearToGamma(this,e),this}copySRGBToLinear(e){return this.r=te(e.r),this.g=te(e.g),this.b=te(e.b),this}copyLinearToSRGB(e){return this.r=tt(e.r),this.g=tt(e.g),this.b=tt(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(e){let t,r;void 0===e&&(console.warn("THREE.Color: .getHSL() target is now required"),e={h:0,s:0,l:0});let n=this.r,i=this.g,a=this.b,s=Math.max(n,i,a),o=Math.min(n,i,a),l=(o+s)/2;if(o===s)t=0,r=0;else{let e=s-o;switch(r=l<=.5?e/(s+o):e/(2-s-o),s){case n:t=(i-a)/e+(i<a?6:0);break;case i:t=(a-n)/e+2;break;case a:t=(n-i)/e+4}t/=6}return e.h=t,e.s=r,e.l=l,e}getStyle(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}offsetHSL(e,t,r){return this.getHSL(e8),e8.h+=e,e8.s+=t,e8.l+=r,this.setHSL(e8.h,e8.s,e8.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(e8),e.getHSL(e7);let r=D.lerp(e8.h,e7.h,t),n=D.lerp(e8.s,e7.s,t),i=D.lerp(e8.l,e7.l,t);return this.setHSL(r,n,i),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),!0===e.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}tr.NAMES=e6,tr.prototype.isColor=!0,tr.prototype.r=1,tr.prototype.g=1,tr.prototype.b=1;class tn extends e5{constructor(e){super(),this.type="MeshBasicMaterial",this.color=new tr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this}}tn.prototype.isMeshBasicMaterial=!0;let ti=new V,ta=new O;function ts(e,t,r){if(Array.isArray(e))throw TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===r,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}function to(e,t,r){ts.call(this,new Int8Array(e),t,r)}function tl(e,t,r){ts.call(this,new Uint8Array(e),t,r)}function th(e,t,r){ts.call(this,new Uint8ClampedArray(e),t,r)}function tu(e,t,r){ts.call(this,new Int16Array(e),t,r)}function tc(e,t,r){ts.call(this,new Uint16Array(e),t,r)}function td(e,t,r){ts.call(this,new Int32Array(e),t,r)}function tp(e,t,r){ts.call(this,new Uint32Array(e),t,r)}function tf(e,t,r){ts.call(this,new Uint16Array(e),t,r)}function tm(e,t,r){ts.call(this,new Float32Array(e),t,r)}function tg(e,t,r){ts.call(this,new Float64Array(e),t,r)}function tv(e){if(0===e.length)return-1/0;let t=e[0];for(let r=1,n=e.length;r<n;++r)e[r]>t&&(t=e[r]);return t}Object.defineProperty(ts.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(ts.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this},copyAt:function(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let n=0,i=this.itemSize;n<i;n++)this.array[e+n]=t.array[r+n];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){let t=this.array,r=0;for(let n=0,i=e.length;n<i;n++){let i=e[n];void 0===i&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),i=new tr),t[r++]=i.r,t[r++]=i.g,t[r++]=i.b}return this},copyVector2sArray:function(e){let t=this.array,r=0;for(let n=0,i=e.length;n<i;n++){let i=e[n];void 0===i&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",n),i=new O),t[r++]=i.x,t[r++]=i.y}return this},copyVector3sArray:function(e){let t=this.array,r=0;for(let n=0,i=e.length;n<i;n++){let i=e[n];void 0===i&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),i=new V),t[r++]=i.x,t[r++]=i.y,t[r++]=i.z}return this},copyVector4sArray:function(e){let t=this.array,r=0;for(let n=0,i=e.length;n<i;n++){let i=e[n];void 0===i&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),i=new z),t[r++]=i.x,t[r++]=i.y,t[r++]=i.z,t[r++]=i.w}return this},applyMatrix3:function(e){if(2===this.itemSize)for(let t=0,r=this.count;t<r;t++)ta.fromBufferAttribute(this,t),ta.applyMatrix3(e),this.setXY(t,ta.x,ta.y);else if(3===this.itemSize)for(let t=0,r=this.count;t<r;t++)ti.fromBufferAttribute(this,t),ti.applyMatrix3(e),this.setXYZ(t,ti.x,ti.y,ti.z);return this},applyMatrix4:function(e){for(let t=0,r=this.count;t<r;t++)ti.x=this.getX(t),ti.y=this.getY(t),ti.z=this.getZ(t),ti.applyMatrix4(e),this.setXYZ(t,ti.x,ti.y,ti.z);return this},applyNormalMatrix:function(e){for(let t=0,r=this.count;t<r;t++)ti.x=this.getX(t),ti.y=this.getY(t),ti.z=this.getZ(t),ti.applyNormalMatrix(e),this.setXYZ(t,ti.x,ti.y,ti.z);return this},transformDirection:function(e){for(let t=0,r=this.count;t<r;t++)ti.x=this.getX(t),ti.y=this.getY(t),ti.z=this.getZ(t),ti.transformDirection(e),this.setXYZ(t,ti.x,ti.y,ti.z);return this},set:function(e,t=0){return this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this},setXYZ:function(e,t,r,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=n,this},setXYZW:function(e,t,r,n,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=n,this.array[e+3]=i,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),to.prototype=Object.create(ts.prototype),to.prototype.constructor=to,tl.prototype=Object.create(ts.prototype),tl.prototype.constructor=tl,th.prototype=Object.create(ts.prototype),th.prototype.constructor=th,tu.prototype=Object.create(ts.prototype),tu.prototype.constructor=tu,tc.prototype=Object.create(ts.prototype),tc.prototype.constructor=tc,td.prototype=Object.create(ts.prototype),td.prototype.constructor=td,tp.prototype=Object.create(ts.prototype),tp.prototype.constructor=tp,tf.prototype=Object.create(ts.prototype),tf.prototype.constructor=tf,tf.prototype.isFloat16BufferAttribute=!0,tm.prototype=Object.create(ts.prototype),tm.prototype.constructor=tm,tg.prototype=Object.create(ts.prototype),tg.prototype.constructor=tg,Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;let ty=0,tx=new ev,t_=new eG,tb=new V,tw=new q,tM=new q,tS=new V;function tT(){Object.defineProperty(this,"id",{value:ty++}),this.uuid=D.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}tT.prototype=Object.assign(Object.create(P.prototype),{constructor:tT,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){return Array.isArray(e)?this.index=new(tv(e)>65535?tp:tc)(e,1):this.index=e,this},getAttribute:function(e){return this.attributes[e]},setAttribute:function(e,t){return this.attributes[e]=t,this},deleteAttribute:function(e){return delete this.attributes[e],this},hasAttribute:function(e){return void 0!==this.attributes[e]},addGroup:function(e,t,r=0){this.groups.push({start:e,count:t,materialIndex:r})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix4:function(e){let t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);let r=this.attributes.normal;if(void 0!==r){let t=new U().getNormalMatrix(e);r.applyNormalMatrix(t),r.needsUpdate=!0}let n=this.attributes.tangent;return void 0!==n&&(n.transformDirection(e),n.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(e){return tx.makeRotationX(e),this.applyMatrix4(tx),this},rotateY:function(e){return tx.makeRotationY(e),this.applyMatrix4(tx),this},rotateZ:function(e){return tx.makeRotationZ(e),this.applyMatrix4(tx),this},translate:function(e,t,r){return tx.makeTranslation(e,t,r),this.applyMatrix4(tx),this},scale:function(e,t,r){return tx.makeScale(e,t,r),this.applyMatrix4(tx),this},lookAt:function(e){return t_.lookAt(e),t_.updateMatrix(),this.applyMatrix4(t_.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(tb).negate(),this.translate(tb.x,tb.y,tb.z),this},setFromPoints:function(e){let t=[];for(let r=0,n=e.length;r<n;r++){let n=e[r];t.push(n.x,n.y,n.z||0)}return this.setAttribute("position",new tm(t,3)),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new q);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new V(-1/0,-1/0,-1/0),new V(1/0,1/0,1/0));return}if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let e=0,r=t.length;e<r;e++){let r=t[e];tw.setFromBufferAttribute(r),this.morphTargetsRelative?(tS.addVectors(this.boundingBox.min,tw.min),this.boundingBox.expandByPoint(tS),tS.addVectors(this.boundingBox.max,tw.max),this.boundingBox.expandByPoint(tS)):(this.boundingBox.expandByPoint(tw.min),this.boundingBox.expandByPoint(tw.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new el);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new V,1/0);return}if(e){let r=this.boundingSphere.center;if(tw.setFromBufferAttribute(e),t)for(let e=0,r=t.length;e<r;e++){let r=t[e];tM.setFromBufferAttribute(r),this.morphTargetsRelative?(tS.addVectors(tw.min,tM.min),tw.expandByPoint(tS),tS.addVectors(tw.max,tM.max),tw.expandByPoint(tS)):(tw.expandByPoint(tM.min),tw.expandByPoint(tM.max))}tw.getCenter(r);let n=0;for(let t=0,i=e.count;t<i;t++)tS.fromBufferAttribute(e,t),n=Math.max(n,r.distanceToSquared(tS));if(t)for(let i=0,a=t.length;i<a;i++){let a=t[i],s=this.morphTargetsRelative;for(let t=0,i=a.count;t<i;t++)tS.fromBufferAttribute(a,t),s&&(tb.fromBufferAttribute(e,t),tS.add(tb)),n=Math.max(n,r.distanceToSquared(tS))}this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeTangents:function(){let e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let r=e.array,n=t.position.array,i=t.normal.array,a=t.uv.array,s=n.length/3;void 0===t.tangent&&this.setAttribute("tangent",new ts(new Float32Array(4*s),4));let o=t.tangent.array,l=[],h=[];for(let e=0;e<s;e++)l[e]=new V,h[e]=new V;let u=new V,c=new V,d=new V,p=new O,f=new O,m=new O,g=new V,v=new V,y=this.groups;0===y.length&&(y=[{start:0,count:r.length}]);for(let e=0,t=y.length;e<t;++e){let t=y[e],i=t.start,s=t.count;for(let e=i,t=i+s;e<t;e+=3)!function(e,t,r){u.fromArray(n,3*e),c.fromArray(n,3*t),d.fromArray(n,3*r),p.fromArray(a,2*e),f.fromArray(a,2*t),m.fromArray(a,2*r),c.sub(u),d.sub(u),f.sub(p),m.sub(p);let i=1/(f.x*m.y-m.x*f.y);isFinite(i)&&(g.copy(c).multiplyScalar(m.y).addScaledVector(d,-f.y).multiplyScalar(i),v.copy(d).multiplyScalar(f.x).addScaledVector(c,-m.x).multiplyScalar(i),l[e].add(g),l[t].add(g),l[r].add(g),h[e].add(v),h[t].add(v),h[r].add(v))}(r[e+0],r[e+1],r[e+2])}let x=new V,_=new V,b=new V,w=new V;function M(e){b.fromArray(i,3*e),w.copy(b);let t=l[e];x.copy(t),x.sub(b.multiplyScalar(b.dot(t))).normalize(),_.crossVectors(w,t);let r=_.dot(h[e]);o[4*e]=x.x,o[4*e+1]=x.y,o[4*e+2]=x.z,o[4*e+3]=r<0?-1:1}for(let e=0,t=y.length;e<t;++e){let t=y[e],n=t.start,i=t.count;for(let e=n,t=n+i;e<t;e+=3)M(r[e+0]),M(r[e+1]),M(r[e+2])}},computeVertexNormals:function(){let e=this.index,t=this.getAttribute("position");if(void 0!==t){let r=this.getAttribute("normal");if(void 0===r)r=new ts(new Float32Array(3*t.count),3),this.setAttribute("normal",r);else for(let e=0,t=r.count;e<t;e++)r.setXYZ(e,0,0,0);let n=new V,i=new V,a=new V,s=new V,o=new V,l=new V,h=new V,u=new V;if(e)for(let c=0,d=e.count;c<d;c+=3){let d=e.getX(c+0),p=e.getX(c+1),f=e.getX(c+2);n.fromBufferAttribute(t,d),i.fromBufferAttribute(t,p),a.fromBufferAttribute(t,f),h.subVectors(a,i),u.subVectors(n,i),h.cross(u),s.fromBufferAttribute(r,d),o.fromBufferAttribute(r,p),l.fromBufferAttribute(r,f),s.add(h),o.add(h),l.add(h),r.setXYZ(d,s.x,s.y,s.z),r.setXYZ(p,o.x,o.y,o.z),r.setXYZ(f,l.x,l.y,l.z)}else for(let e=0,s=t.count;e<s;e+=3)n.fromBufferAttribute(t,e+0),i.fromBufferAttribute(t,e+1),a.fromBufferAttribute(t,e+2),h.subVectors(a,i),u.subVectors(n,i),h.cross(u),r.setXYZ(e+0,h.x,h.y,h.z),r.setXYZ(e+1,h.x,h.y,h.z),r.setXYZ(e+2,h.x,h.y,h.z);this.normalizeNormals(),r.needsUpdate=!0}},merge:function(e,t){if(!(e&&e.isBufferGeometry)){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);return}void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));let r=this.attributes;for(let n in r){if(void 0===e.attributes[n])continue;let i=r[n].array,a=e.attributes[n],s=a.array,o=a.itemSize*t,l=Math.min(s.length,i.length-o);for(let e=0,t=o;e<l;e++,t++)i[t]=s[e]}return this},normalizeNormals:function(){let e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)tS.fromBufferAttribute(e,t),tS.normalize(),e.setXYZ(t,tS.x,tS.y,tS.z)},toNonIndexed:function(){function e(e,t){let r=e.array,n=e.itemSize,i=e.normalized,a=new r.constructor(t.length*n),s=0,o=0;for(let e=0,i=t.length;e<i;e++){s=t[e]*n;for(let e=0;e<n;e++)a[o++]=r[s++]}return new ts(a,n,i)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let t=new tT,r=this.index.array,n=this.attributes;for(let i in n){let a=e(n[i],r);t.setAttribute(i,a)}let i=this.morphAttributes;for(let n in i){let a=[],s=i[n];for(let t=0,n=s.length;t<n;t++){let n=e(s[t],r);a.push(n)}t.morphAttributes[n]=a}t.morphTargetsRelative=this.morphTargetsRelative;let a=this.groups;for(let e=0,r=a.length;e<r;e++){let r=a[e];t.addGroup(r.start,r.count,r.materialIndex)}return t},toJSON:function(){let e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){let t=this.parameters;for(let r in t)void 0!==t[r]&&(e[r]=t[r]);return e}e.data={attributes:{}};let t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});let r=this.attributes;for(let t in r){let n=r[t],i=n.toJSON(e.data);""!==n.name&&(i.name=n.name),e.data.attributes[t]=i}let n={},i=!1;for(let t in this.morphAttributes){let r=this.morphAttributes[t],a=[];for(let t=0,n=r.length;t<n;t++){let n=r[t],i=n.toJSON(e.data);""!==n.name&&(i.name=n.name),a.push(i)}a.length>0&&(n[t]=a,i=!0)}i&&(e.data.morphAttributes=n,e.data.morphTargetsRelative=this.morphTargetsRelative);let a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));let s=this.boundingSphere;return null!==s&&(e.data.boundingSphere={center:s.center.toArray(),radius:s.radius}),e},clone:function(){return new tT().copy(this)},copy:function(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let t={};this.name=e.name;let r=e.index;null!==r&&this.setIndex(r.clone(t));let n=e.attributes;for(let e in n){let r=n[e];this.setAttribute(e,r.clone(t))}let i=e.morphAttributes;for(let e in i){let r=[],n=i[e];for(let e=0,i=n.length;e<i;e++)r.push(n[e].clone(t));this.morphAttributes[e]=r}this.morphTargetsRelative=e.morphTargetsRelative;let a=e.groups;for(let e=0,t=a.length;e<t;e++){let t=a[e];this.addGroup(t.start,t.count,t.materialIndex)}let s=e.boundingBox;null!==s&&(this.boundingBox=s.clone());let o=e.boundingSphere;return null!==o&&(this.boundingSphere=o.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});let tE=new ev,tA=new eg,tL=new el,tR=new V,tP=new V,tC=new V,tI=new V,tD=new V,tO=new V,tU=new V,tN=new V,tk=new V,tF=new O,tB=new O,tz=new O,tH=new V,tG=new V;function tV(e=new tT,t=new tn){eG.call(this),this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}function tW(e,t,r,n,i,a,s,o,l,u,c,d){tR.fromBufferAttribute(i,u),tP.fromBufferAttribute(i,c),tC.fromBufferAttribute(i,d);let p=e.morphTargetInfluences;if(t.morphTargets&&a&&p){tU.set(0,0,0),tN.set(0,0,0),tk.set(0,0,0);for(let e=0,t=a.length;e<t;e++){let t=p[e],r=a[e];0!==t&&(tI.fromBufferAttribute(r,u),tD.fromBufferAttribute(r,c),tO.fromBufferAttribute(r,d),s?(tU.addScaledVector(tI,t),tN.addScaledVector(tD,t),tk.addScaledVector(tO,t)):(tU.addScaledVector(tI.sub(tR),t),tN.addScaledVector(tD.sub(tP),t),tk.addScaledVector(tO.sub(tC),t)))}tR.add(tU),tP.add(tN),tC.add(tk)}e.isSkinnedMesh&&t.skinning&&(e.boneTransform(u,tR),e.boneTransform(c,tP),e.boneTransform(d,tC));let f=function(e,t,r,n,i,a,s,o){if(null===(1===t.side?n.intersectTriangle(s,a,i,!0,o):n.intersectTriangle(i,a,s,t.side!==h,o)))return null;tG.copy(o),tG.applyMatrix4(e.matrixWorld);let l=r.ray.origin.distanceTo(tG);return l<r.near||l>r.far?null:{distance:l,point:tG.clone(),object:e}}(e,t,r,n,tR,tP,tC,tH);if(f){o&&(tF.fromBufferAttribute(o,u),tB.fromBufferAttribute(o,c),tz.fromBufferAttribute(o,d),f.uv=e3.getUV(tH,tR,tP,tC,tF,tB,tz,new O)),l&&(tF.fromBufferAttribute(l,u),tB.fromBufferAttribute(l,c),tz.fromBufferAttribute(l,d),f.uv2=e3.getUV(tH,tR,tP,tC,tF,tB,tz,new O));let e={a:u,b:c,c:d,normal:new V,materialIndex:0};e3.getNormal(tR,tP,tC,e.normal),f.face=e}return f}tV.prototype=Object.assign(Object.create(eG.prototype),{constructor:tV,isMesh:!0,copy:function(e){return eG.prototype.copy.call(this,e),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this},updateMorphTargets:function(){let e=this.geometry;if(e.isBufferGeometry){let t=e.morphAttributes,r=Object.keys(t);if(r.length>0){let e=t[r[0]];if(void 0!==e){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,r=e.length;t<r;t++){let r=e[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[r]=t}}}}else{let t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(e,t){let r;let n=this.geometry,i=this.material,a=this.matrixWorld;if(void 0!==i&&(null===n.boundingSphere&&n.computeBoundingSphere(),tL.copy(n.boundingSphere),tL.applyMatrix4(a),!1!==e.ray.intersectsSphere(tL))){if(tE.copy(a).invert(),tA.copy(e.ray).applyMatrix4(tE),null!==n.boundingBox&&!1===tA.intersectsBox(n.boundingBox))return;if(n.isBufferGeometry){let a=n.index,s=n.attributes.position,o=n.morphAttributes.position,l=n.morphTargetsRelative,h=n.attributes.uv,u=n.attributes.uv2,c=n.groups,d=n.drawRange;if(null!==a){if(Array.isArray(i))for(let n=0,p=c.length;n<p;n++){let p=c[n],f=i[p.materialIndex],m=Math.max(p.start,d.start),g=Math.min(p.start+p.count,d.start+d.count);for(let n=m;n<g;n+=3)(r=tW(this,f,e,tA,s,o,l,h,u,a.getX(n),a.getX(n+1),a.getX(n+2)))&&(r.faceIndex=Math.floor(n/3),r.face.materialIndex=p.materialIndex,t.push(r))}else{let n=Math.max(0,d.start),c=Math.min(a.count,d.start+d.count);for(let d=n;d<c;d+=3)(r=tW(this,i,e,tA,s,o,l,h,u,a.getX(d),a.getX(d+1),a.getX(d+2)))&&(r.faceIndex=Math.floor(d/3),t.push(r))}}else if(void 0!==s){if(Array.isArray(i))for(let n=0,a=c.length;n<a;n++){let a=c[n],p=i[a.materialIndex],f=Math.max(a.start,d.start),m=Math.min(a.start+a.count,d.start+d.count);for(let n=f;n<m;n+=3)(r=tW(this,p,e,tA,s,o,l,h,u,n,n+1,n+2))&&(r.faceIndex=Math.floor(n/3),r.face.materialIndex=a.materialIndex,t.push(r))}else{let n=Math.max(0,d.start),a=Math.min(s.count,d.start+d.count);for(let c=n;c<a;c+=3)(r=tW(this,i,e,tA,s,o,l,h,u,c,c+1,c+2))&&(r.faceIndex=Math.floor(c/3),t.push(r))}}}else n.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}});class tj extends tT{constructor(e=1,t=1,r=1,n=1,i=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:n,heightSegments:i,depthSegments:a};let s=this;n=Math.floor(n),i=Math.floor(i);let o=[],l=[],h=[],u=[],c=0,d=0;function p(e,t,r,n,i,a,p,f,m,g,v){let y=a/m,x=p/g,_=a/2,b=p/2,w=f/2,M=m+1,S=g+1,T=0,E=0,A=new V;for(let a=0;a<S;a++){let s=a*x-b;for(let o=0;o<M;o++){let c=o*y-_;A[e]=c*n,A[t]=s*i,A[r]=w,l.push(A.x,A.y,A.z),A[e]=0,A[t]=0,A[r]=f>0?1:-1,h.push(A.x,A.y,A.z),u.push(o/m),u.push(1-a/g),T+=1}}for(let e=0;e<g;e++)for(let t=0;t<m;t++){let r=c+t+M*e,n=c+t+M*(e+1),i=c+(t+1)+M*(e+1),a=c+(t+1)+M*e;o.push(r,n,a),o.push(n,i,a),E+=6}s.addGroup(d,E,v),d+=E,c+=T}p("z","y","x",-1,-1,r,t,e,a=Math.floor(a),i,0),p("z","y","x",1,-1,r,t,-e,a,i,1),p("x","z","y",1,1,e,r,t,n,a,2),p("x","z","y",1,-1,e,r,-t,n,a,3),p("x","y","z",1,-1,e,t,r,n,i,4),p("x","y","z",-1,-1,e,t,-r,n,i,5),this.setIndex(o),this.setAttribute("position",new tm(l,3)),this.setAttribute("normal",new tm(h,3)),this.setAttribute("uv",new tm(u,2))}}function tq(e){let t={};for(let r in e)for(let n in t[r]={},e[r]){let i=e[r][n];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?t[r][n]=i.clone():Array.isArray(i)?t[r][n]=i.slice():t[r][n]=i}return t}function tX(e){let t={};for(let r=0;r<e.length;r++){let n=tq(e[r]);for(let e in n)t[e]=n[e]}return t}let tY={clone:tq,merge:tX};function tZ(e){e5.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function tJ(){eG.call(this),this.type="Camera",this.matrixWorldInverse=new ev,this.projectionMatrix=new ev,this.projectionMatrixInverse=new ev}function tK(e=50,t=1,r=.1,n=2e3){tJ.call(this),this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=n,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}tZ.prototype=Object.create(e5.prototype),tZ.prototype.constructor=tZ,tZ.prototype.isShaderMaterial=!0,tZ.prototype.copy=function(e){return e5.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=tq(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this},tZ.prototype.toJSON=function(e){let t=e5.prototype.toJSON.call(this,e);for(let r in t.glslVersion=this.glslVersion,t.uniforms={},this.uniforms){let n=this.uniforms[r].value;n&&n.isTexture?t.uniforms[r]={type:"t",value:n.toJSON(e).uuid}:n&&n.isColor?t.uniforms[r]={type:"c",value:n.getHex()}:n&&n.isVector2?t.uniforms[r]={type:"v2",value:n.toArray()}:n&&n.isVector3?t.uniforms[r]={type:"v3",value:n.toArray()}:n&&n.isVector4?t.uniforms[r]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?t.uniforms[r]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?t.uniforms[r]={type:"m4",value:n.toArray()}:t.uniforms[r]={value:n}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;let r={};for(let e in this.extensions)!0===this.extensions[e]&&(r[e]=!0);return Object.keys(r).length>0&&(t.extensions=r),t},tJ.prototype=Object.assign(Object.create(eG.prototype),{constructor:tJ,isCamera:!0,copy:function(e,t){return eG.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new V),this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()},updateMatrixWorld:function(e){eG.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()},updateWorldMatrix:function(e,t){eG.prototype.updateWorldMatrix.call(this,e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()},clone:function(){return new this.constructor().copy(this)}}),tK.prototype=Object.assign(Object.create(tJ.prototype),{constructor:tK,isPerspectiveCamera:!0,copy:function(e,t){return tJ.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){let t=.5*this.getFilmHeight()/e;this.fov=2*D.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){let e=Math.tan(.5*D.DEG2RAD*this.fov);return .5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*D.RAD2DEG*Math.atan(Math.tan(.5*D.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,r,n,i,a){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=n,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){let e=this.near,t=e*Math.tan(.5*D.DEG2RAD*this.fov)/this.zoom,r=2*t,n=this.aspect*r,i=-.5*n,a=this.view;if(null!==this.view&&this.view.enabled){let e=a.fullWidth,s=a.fullHeight;i+=a.offsetX*n/e,t-=a.offsetY*r/s,n*=a.width/e,r*=a.height/s}let s=this.filmOffset;0!==s&&(i+=e*s/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+n,t,t-r,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()},toJSON:function(e){let t=eG.prototype.toJSON.call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}});class tQ extends eG{constructor(e,t,r){if(super(),this.type="CubeCamera",!0!==r.isWebGLCubeRenderTarget){console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");return}this.renderTarget=r;let n=new tK(90,1,e,t);n.layers=this.layers,n.up.set(0,-1,0),n.lookAt(new V(1,0,0)),this.add(n);let i=new tK(90,1,e,t);i.layers=this.layers,i.up.set(0,-1,0),i.lookAt(new V(-1,0,0)),this.add(i);let a=new tK(90,1,e,t);a.layers=this.layers,a.up.set(0,0,1),a.lookAt(new V(0,1,0)),this.add(a);let s=new tK(90,1,e,t);s.layers=this.layers,s.up.set(0,0,-1),s.lookAt(new V(0,-1,0)),this.add(s);let o=new tK(90,1,e,t);o.layers=this.layers,o.up.set(0,-1,0),o.lookAt(new V(0,0,1)),this.add(o);let l=new tK(90,1,e,t);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new V(0,0,-1)),this.add(l)}update(e,t){null===this.parent&&this.updateMatrixWorld();let r=this.renderTarget,[n,i,a,s,o,l]=this.children,h=e.xr.enabled,u=e.getRenderTarget();e.xr.enabled=!1;let c=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0),e.render(t,n),e.setRenderTarget(r,1),e.render(t,i),e.setRenderTarget(r,2),e.render(t,a),e.setRenderTarget(r,3),e.render(t,s),e.setRenderTarget(r,4),e.render(t,o),r.texture.generateMipmaps=c,e.setRenderTarget(r,5),e.render(t,l),e.setRenderTarget(u),e.xr.enabled=h}}class t$ extends F{constructor(e,t,r,n,i,a,s,o,l,h){super(e=void 0!==e?e:[],t=void 0!==t?t:301,r,n,i,a,s=void 0!==s?s:_,o,l,h),this._needsFlipEnvMap=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}t$.prototype.isCubeTexture=!0;class t0 extends H{constructor(e,t,r){Number.isInteger(t)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),t=r),super(e,e,t),t=t||{},this.texture=new t$(void 0,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:v,this.texture._needsFlipEnvMap=!1}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.format=b,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;let r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},n=new tj(5,5,5),i=new tZ({name:"CubemapFromEquirect",uniforms:tq(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:1,blending:0});i.uniforms.tEquirect.value=t;let a=new tV(n,i),s=t.minFilter;return t.minFilter===x&&(t.minFilter=v),new tQ(1,10,this).update(e,a),t.minFilter=s,a.geometry.dispose(),a.material.dispose(),this}clear(e,t,r,n){let i=e.getRenderTarget();for(let i=0;i<6;i++)e.setRenderTarget(this,i),e.clear(t,r,n);e.setRenderTarget(i)}}t0.prototype.isWebGLCubeRenderTarget=!0;class t1 extends F{constructor(e,t,r,n,i,a,s,o,l,h,u,c){super(null,a,s,o,l,h,n,i,u,c),this.image={data:e||null,width:t||1,height:r||1},this.magFilter=void 0!==l?l:f,this.minFilter=void 0!==h?h:f,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}t1.prototype.isDataTexture=!0;let t2=/*@__PURE__*/new el,t3=/*@__PURE__*/new V;class t4{constructor(e=new eq,t=new eq,r=new eq,n=new eq,i=new eq,a=new eq){this.planes=[e,t,r,n,i,a]}set(e,t,r,n,i,a){let s=this.planes;return s[0].copy(e),s[1].copy(t),s[2].copy(r),s[3].copy(n),s[4].copy(i),s[5].copy(a),this}copy(e){let t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e){let t=this.planes,r=e.elements,n=r[0],i=r[1],a=r[2],s=r[3],o=r[4],l=r[5],h=r[6],u=r[7],c=r[8],d=r[9],p=r[10],f=r[11],m=r[12],g=r[13],v=r[14],y=r[15];return t[0].setComponents(s-n,u-o,f-c,y-m).normalize(),t[1].setComponents(s+n,u+o,f+c,y+m).normalize(),t[2].setComponents(s+i,u+l,f+d,y+g).normalize(),t[3].setComponents(s-i,u-l,f-d,y-g).normalize(),t[4].setComponents(s-a,u-h,f-p,y-v).normalize(),t[5].setComponents(s+a,u+h,f+p,y+v).normalize(),this}intersectsObject(e){let t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),t2.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(t2)}intersectsSprite(e){return t2.center.set(0,0,0),t2.radius=.7071067811865476,t2.applyMatrix4(e.matrixWorld),this.intersectsSphere(t2)}intersectsSphere(e){let t=this.planes,r=e.center,n=-e.radius;for(let e=0;e<6;e++)if(t[e].distanceToPoint(r)<n)return!1;return!0}intersectsBox(e){let t=this.planes;for(let r=0;r<6;r++){let n=t[r];if(t3.x=n.normal.x>0?e.max.x:e.min.x,t3.y=n.normal.y>0?e.max.y:e.min.y,t3.z=n.normal.z>0?e.max.z:e.min.z,0>n.distanceToPoint(t3))return!1}return!0}containsPoint(e){let t=this.planes;for(let r=0;r<6;r++)if(0>t[r].distanceToPoint(e))return!1;return!0}clone(){return new this.constructor().copy(this)}}function t5(){let e=null,t=!1,r=null,n=null;function i(t,a){r(t,a),n=e.requestAnimationFrame(i)}return{start:function(){!0!==t&&null!==r&&(n=e.requestAnimationFrame(i),t=!0)},stop:function(){e.cancelAnimationFrame(n),t=!1},setAnimationLoop:function(e){r=e},setContext:function(t){e=t}}}function t6(e,t){let r=t.isWebGL2,n=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),n.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);let r=n.get(t);r&&(e.deleteBuffer(r.buffer),n.delete(t))},update:function(t,i){if(t.isGLBufferAttribute){let e=n.get(t);(!e||e.version<t.version)&&n.set(t,{buffer:t.buffer,type:t.type,bytesPerElement:t.elementSize,version:t.version});return}t.isInterleavedBufferAttribute&&(t=t.data);let a=n.get(t);void 0===a?n.set(t,function(t,n){let i=t.array,a=t.usage,s=e.createBuffer();e.bindBuffer(n,s),e.bufferData(n,i,a),t.onUploadCallback();let o=5126;return i instanceof Float32Array?o=5126:i instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):i instanceof Uint16Array?t.isFloat16BufferAttribute?r?o=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):o=5123:i instanceof Int16Array?o=5122:i instanceof Uint32Array?o=5125:i instanceof Int32Array?o=5124:i instanceof Int8Array?o=5120:i instanceof Uint8Array&&(o=5121),{buffer:s,type:o,bytesPerElement:i.BYTES_PER_ELEMENT,version:t.version}}(t,i)):a.version<t.version&&(function(t,n,i){let a=n.array,s=n.updateRange;e.bindBuffer(i,t),-1===s.count?e.bufferSubData(i,0,a):(r?e.bufferSubData(i,s.offset*a.BYTES_PER_ELEMENT,a,s.offset,s.count):e.bufferSubData(i,s.offset*a.BYTES_PER_ELEMENT,a.subarray(s.offset,s.offset+s.count)),s.count=-1)}(a.buffer,t,i),a.version=t.version)}}}class t8 extends tT{constructor(e=1,t=1,r=1,n=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:n};let i=e/2,a=t/2,s=Math.floor(r),o=Math.floor(n),l=s+1,h=o+1,u=e/s,c=t/o,d=[],p=[],f=[],m=[];for(let e=0;e<h;e++){let t=e*c-a;for(let r=0;r<l;r++){let n=r*u-i;p.push(n,-t,0),f.push(0,0,1),m.push(r/s),m.push(1-e/o)}}for(let e=0;e<o;e++)for(let t=0;t<s;t++){let r=t+l*e,n=t+l*(e+1),i=t+1+l*(e+1),a=t+1+l*e;d.push(r,n,a),d.push(n,i,a)}this.setIndex(d),this.setAttribute("position",new tm(p,3)),this.setAttribute("normal",new tm(f,3)),this.setAttribute("uv",new tm(m,2))}}let t7={alphamap_fragment:"#ifdef USE_ALPHAMAP\n	diffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n	uniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n	if ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n	reflectedLight.indirectDiffuse *= ambientOcclusion;\n	#if defined( USE_ENVMAP ) && defined( STANDARD )\n		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n	#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n	uniform sampler2D aoMap;\n	uniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n	vec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n	vec4 r = roughness * c0 + c1;\n	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n	return vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n	if( cutoffDistance > 0.0 ) {\n		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n	}\n	return distanceFalloff;\n#else\n	if( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n		return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n	}\n	return 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n	return RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n	float fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n	return ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n	float fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n	vec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n	return Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n	float a2 = pow2( alpha );\n	float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n	float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n	return 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n	float a2 = pow2( alpha );\n	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n	return 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n	float a2 = pow2( alpha );\n	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n	return RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n	float alpha = pow2( roughness );\n	vec3 halfDir = normalize( incidentLight.direction + viewDir );\n	float dotNL = saturate( dot( normal, incidentLight.direction ) );\n	float dotNV = saturate( dot( normal, viewDir ) );\n	float dotNH = saturate( dot( normal, halfDir ) );\n	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n	vec3 F = F_Schlick( specularColor, dotLH );\n	float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n	float D = D_GGX( alpha, dotNH );\n	return F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n	const float LUT_SIZE = 64.0;\n	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n	const float LUT_BIAS = 0.5 / LUT_SIZE;\n	float dotNV = saturate( dot( N, V ) );\n	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n	uv = uv * LUT_SCALE + LUT_BIAS;\n	return uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n	float l = length( f );\n	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n	float x = dot( v1, v2 );\n	float y = abs( x );\n	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n	float b = 3.4175940 + ( 4.1616724 + y ) * y;\n	float v = a / b;\n	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n	return cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n	vec3 lightNormal = cross( v1, v2 );\n	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n	vec3 T1, T2;\n	T1 = normalize( V - N * dot( V, N ) );\n	T2 = - cross( N, T1 );\n	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n	vec3 coords[ 4 ];\n	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n	coords[ 0 ] = normalize( coords[ 0 ] );\n	coords[ 1 ] = normalize( coords[ 1 ] );\n	coords[ 2 ] = normalize( coords[ 2 ] );\n	coords[ 3 ] = normalize( coords[ 3 ] );\n	vec3 vectorFormFactor = vec3( 0.0 );\n	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n	return vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n	float dotNV = saturate( dot( normal, viewDir ) );\n	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n	return specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n	vec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n	vec3 FssEss = F * brdf.x + brdf.y;\n	float Ess = brdf.x + brdf.y;\n	float Ems = 1.0 - Ess;\n	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n	singleScatter += FssEss;\n	multiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n	return 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n	float dotNH = saturate( dot( geometry.normal, halfDir ) );\n	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n	vec3 F = F_Schlick( specularColor, dotLH );\n	float G = G_BlinnPhong_Implicit( );\n	float D = D_BlinnPhong( shininess, dotNH );\n	return F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n	return ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n	return sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n	float invAlpha = 1.0 / roughness;\n	float cos2h = NoH * NoH;\n	float sin2h = max(1.0 - cos2h, 0.0078125);	return (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n	return saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n	vec3 N = geometry.normal;\n	vec3 V = geometry.viewDir;\n	vec3 H = normalize( V + L );\n	float dotNH = saturate( dot( N, H ) );\n	return specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n	uniform sampler2D bumpMap;\n	uniform float bumpScale;\n	vec2 dHdxy_fwd() {\n		vec2 dSTdx = dFdx( vUv );\n		vec2 dSTdy = dFdy( vUv );\n		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n		return vec2( dBx, dBy );\n	}\n	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n		vec3 vN = surf_norm;\n		vec3 R1 = cross( vSigmaY, vN );\n		vec3 R2 = cross( vN, vSigmaX );\n		float fDet = dot( vSigmaX, R1 ) * faceDirection;\n		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n		return normalize( abs( fDet ) * surf_norm - vGrad );\n	}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n	vec4 plane;\n	#pragma unroll_loop_start\n	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n		plane = clippingPlanes[ i ];\n		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n	}\n	#pragma unroll_loop_end\n	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n		bool clipped = true;\n		#pragma unroll_loop_start\n		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n			plane = clippingPlanes[ i ];\n			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n		}\n		#pragma unroll_loop_end\n		if ( clipped ) discard;\n	#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n	varying vec3 vClipPosition;\n	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n	varying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n	vClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n	diffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n	varying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n	varying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n	vColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n	vColor.xyz *= color.xyz;\n#endif\n#ifdef USE_INSTANCING_COLOR\n	vColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n	const highp float a = 12.9898, b = 78.233, c = 43758.5453;\n	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n	return fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n	float precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n	float max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n	float precisionSafeLength( vec3 v ) {\n		float maxComponent = max3( abs( v ) );\n		return length( v / maxComponent ) * maxComponent;\n	}\n#endif\nstruct IncidentLight {\n	vec3 color;\n	vec3 direction;\n	bool visible;\n};\nstruct ReflectedLight {\n	vec3 directDiffuse;\n	vec3 directSpecular;\n	vec3 indirectDiffuse;\n	vec3 indirectSpecular;\n};\nstruct GeometricContext {\n	vec3 position;\n	vec3 normal;\n	vec3 viewDir;\n#ifdef CLEARCOAT\n	vec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n	float distance = dot( planeNormal, point - pointOnPlane );\n	return - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n	return sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n	mat3 tmp;\n	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n	return tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n	return dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n	return m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n	return vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n	#define cubeUV_maxMipLevel 8.0\n	#define cubeUV_minMipLevel 4.0\n	#define cubeUV_maxTileSize 256.0\n	#define cubeUV_minTileSize 16.0\n	float getFace( vec3 direction ) {\n		vec3 absDirection = abs( direction );\n		float face = - 1.0;\n		if ( absDirection.x > absDirection.z ) {\n			if ( absDirection.x > absDirection.y )\n				face = direction.x > 0.0 ? 0.0 : 3.0;\n			else\n				face = direction.y > 0.0 ? 1.0 : 4.0;\n		} else {\n			if ( absDirection.z > absDirection.y )\n				face = direction.z > 0.0 ? 2.0 : 5.0;\n			else\n				face = direction.y > 0.0 ? 1.0 : 4.0;\n		}\n		return face;\n	}\n	vec2 getUV( vec3 direction, float face ) {\n		vec2 uv;\n		if ( face == 0.0 ) {\n			uv = vec2( direction.z, direction.y ) / abs( direction.x );\n		} else if ( face == 1.0 ) {\n			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n		} else if ( face == 2.0 ) {\n			uv = vec2( - direction.x, direction.y ) / abs( direction.z );\n		} else if ( face == 3.0 ) {\n			uv = vec2( - direction.z, direction.y ) / abs( direction.x );\n		} else if ( face == 4.0 ) {\n			uv = vec2( - direction.x, direction.z ) / abs( direction.y );\n		} else {\n			uv = vec2( direction.x, direction.y ) / abs( direction.z );\n		}\n		return 0.5 * ( uv + 1.0 );\n	}\n	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n		float face = getFace( direction );\n		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n		mipInt = max( mipInt, cubeUV_minMipLevel );\n		float faceSize = exp2( mipInt );\n		float texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n		vec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );\n		vec2 f = fract( uv );\n		uv += 0.5 - f;\n		if ( face > 2.0 ) {\n			uv.y += faceSize;\n			face -= 3.0;\n		}\n		uv.x += face * faceSize;\n		if ( mipInt < cubeUV_maxMipLevel ) {\n			uv.y += 2.0 * cubeUV_maxTileSize;\n		}\n		uv.y += filterInt * 2.0 * cubeUV_minTileSize;\n		uv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n		uv *= texelSize;\n		vec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n		uv.x += texelSize;\n		vec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n		uv.y += texelSize;\n		vec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n		uv.x -= texelSize;\n		vec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n		vec3 tm = mix( tl, tr, f.x );\n		vec3 bm = mix( bl, br, f.x );\n		return mix( tm, bm, f.y );\n	}\n	#define r0 1.0\n	#define v0 0.339\n	#define m0 - 2.0\n	#define r1 0.8\n	#define v1 0.276\n	#define m1 - 1.0\n	#define r4 0.4\n	#define v4 0.046\n	#define m4 2.0\n	#define r5 0.305\n	#define v5 0.016\n	#define m5 3.0\n	#define r6 0.21\n	#define v6 0.0038\n	#define m6 4.0\n	float roughnessToMip( float roughness ) {\n		float mip = 0.0;\n		if ( roughness >= r1 ) {\n			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n		} else if ( roughness >= r4 ) {\n			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n		} else if ( roughness >= r5 ) {\n			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n		} else if ( roughness >= r6 ) {\n			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n		} else {\n			mip = - 2.0 * log2( 1.16 * roughness );		}\n		return mip;\n	}\n	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n		float mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n		float mipF = fract( mip );\n		float mipInt = floor( mip );\n		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n		if ( mipF == 0.0 ) {\n			return vec4( color0, 1.0 );\n		} else {\n			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n			return vec4( mix( color0, color1, mipF ), 1.0 );\n		}\n	}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n	mat3 m = mat3( instanceMatrix );\n	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n	transformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n	transformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n	#ifdef FLIP_SIDED\n		transformedTangent = - transformedTangent;\n	#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n	uniform sampler2D displacementMap;\n	uniform float displacementScale;\n	uniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n	vec4 emissiveColor = texture2D( emissiveMap, vUv );\n	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n	totalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n	uniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n	return value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n	return vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n	return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n	float maxComponent = max( max( value.r, value.g ), value.b );\n	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n	return vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n	float maxRGB = max( value.r, max( value.g, value.b ) );\n	float M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n	M = ceil( M * 255.0 ) / 255.0;\n	return vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n	float maxRGB = max( value.r, max( value.g, value.b ) );\n	float D = max( maxRange / maxRGB, 1.0 );\n	D = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value ) {\n	vec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n	Xp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n	vec4 vResult;\n	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n	vResult.w = fract( Le );\n	vResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n	return vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n	float Le = value.z * 255.0 + value.w;\n	vec3 Xp_Y_XYZp;\n	Xp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n	vec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n	return vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n	#ifdef ENV_WORLDPOS\n		vec3 cameraToFrag;\n		if ( isOrthographic ) {\n			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n		} else {\n			cameraToFrag = normalize( vWorldPosition - cameraPosition );\n		}\n		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n		#ifdef ENVMAP_MODE_REFLECTION\n			vec3 reflectVec = reflect( cameraToFrag, worldNormal );\n		#else\n			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n		#endif\n	#else\n		vec3 reflectVec = vReflect;\n	#endif\n	#ifdef ENVMAP_TYPE_CUBE\n		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n	#elif defined( ENVMAP_TYPE_CUBE_UV )\n		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n	#else\n		vec4 envColor = vec4( 0.0 );\n	#endif\n	#ifndef ENVMAP_TYPE_CUBE_UV\n		envColor = envMapTexelToLinear( envColor );\n	#endif\n	#ifdef ENVMAP_BLENDING_MULTIPLY\n		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n	#elif defined( ENVMAP_BLENDING_MIX )\n		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n	#elif defined( ENVMAP_BLENDING_ADD )\n		outgoingLight += envColor.xyz * specularStrength * reflectivity;\n	#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n	uniform float envMapIntensity;\n	uniform float flipEnvMap;\n	uniform int maxMipLevel;\n	#ifdef ENVMAP_TYPE_CUBE\n		uniform samplerCube envMap;\n	#else\n		uniform sampler2D envMap;\n	#endif\n	\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n	uniform float reflectivity;\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n		#define ENV_WORLDPOS\n	#endif\n	#ifdef ENV_WORLDPOS\n		varying vec3 vWorldPosition;\n		uniform float refractionRatio;\n	#else\n		varying vec3 vReflect;\n	#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n		#define ENV_WORLDPOS\n	#endif\n	#ifdef ENV_WORLDPOS\n		\n		varying vec3 vWorldPosition;\n	#else\n		varying vec3 vReflect;\n		uniform float refractionRatio;\n	#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n	#ifdef ENVMAP_MODE_REFRACTION\n		uniform float refractionRatio;\n	#endif\n	vec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n		vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n		#ifdef ENVMAP_TYPE_CUBE\n			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n			#ifdef TEXTURE_LOD_EXT\n				vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n			#else\n				vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n			#endif\n			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n		#elif defined( ENVMAP_TYPE_CUBE_UV )\n			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n		#else\n			vec4 envMapColor = vec4( 0.0 );\n		#endif\n		return PI * envMapColor.rgb * envMapIntensity;\n	}\n	float getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n		float maxMIPLevelScalar = float( maxMIPLevel );\n		float sigma = PI * roughness * roughness / ( 1.0 + roughness );\n		float desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n		return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n	}\n	vec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n		#ifdef ENVMAP_MODE_REFLECTION\n			vec3 reflectVec = reflect( -viewDir, normal );\n			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n		#else\n			vec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n		#endif\n		reflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n		float specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n		#ifdef ENVMAP_TYPE_CUBE\n			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n			#ifdef TEXTURE_LOD_EXT\n				vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n			#else\n				vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n			#endif\n			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n		#elif defined( ENVMAP_TYPE_CUBE_UV )\n			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n		#endif\n		return envMapColor.rgb * envMapIntensity;\n	}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n	#ifdef ENV_WORLDPOS\n		vWorldPosition = worldPosition.xyz;\n	#else\n		vec3 cameraToVertex;\n		if ( isOrthographic ) {\n			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n		} else {\n			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n		}\n		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n		#ifdef ENVMAP_MODE_REFLECTION\n			vReflect = reflect( cameraToVertex, worldNormal );\n		#else\n			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n		#endif\n	#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n	fogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n	varying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n	#ifdef FOG_EXP2\n		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n	#else\n		float fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n	#endif\n	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n	uniform vec3 fogColor;\n	varying float fogDepth;\n	#ifdef FOG_EXP2\n		uniform float fogDensity;\n	#else\n		uniform float fogNear;\n		uniform float fogFar;\n	#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n	uniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n	float dotNL = dot( normal, lightDirection );\n	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n	#ifdef USE_GRADIENTMAP\n		return texture2D( gradientMap, coord ).rgb;\n	#else\n		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n	#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n	vec4 lightMapTexel= texture2D( lightMap, vUv2 );\n	reflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n	uniform sampler2D lightMap;\n	uniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n	vLightBack = vec3( 0.0 );\n	vIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\n#ifdef DOUBLE_SIDED\n	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\n#endif\n#if NUM_POINT_LIGHTS > 0\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n		getPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n		dotNL = dot( geometry.normal, directLight.direction );\n		directLightColor_Diffuse = PI * directLight.color;\n		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n		#ifdef DOUBLE_SIDED\n			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n		#endif\n	}\n	#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n		getSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n		dotNL = dot( geometry.normal, directLight.direction );\n		directLightColor_Diffuse = PI * directLight.color;\n		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n		#ifdef DOUBLE_SIDED\n			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n		#endif\n	}\n	#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n		getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n		dotNL = dot( geometry.normal, directLight.direction );\n		directLightColor_Diffuse = PI * directLight.color;\n		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n		#ifdef DOUBLE_SIDED\n			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n		#endif\n	}\n	#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n		#ifdef DOUBLE_SIDED\n			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n		#endif\n	}\n	#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n	float x = normal.x, y = normal.y, z = normal.z;\n	vec3 result = shCoefficients[ 0 ] * 0.886227;\n	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n	return result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n	vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n	return irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n	vec3 irradiance = ambientLightColor;\n	#ifndef PHYSICALLY_CORRECT_LIGHTS\n		irradiance *= PI;\n	#endif\n	return irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n	struct DirectionalLight {\n		vec3 direction;\n		vec3 color;\n	};\n	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n	void getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n		directLight.color = directionalLight.color;\n		directLight.direction = directionalLight.direction;\n		directLight.visible = true;\n	}\n#endif\n#if NUM_POINT_LIGHTS > 0\n	struct PointLight {\n		vec3 position;\n		vec3 color;\n		float distance;\n		float decay;\n	};\n	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n	void getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n		vec3 lVector = pointLight.position - geometry.position;\n		directLight.direction = normalize( lVector );\n		float lightDistance = length( lVector );\n		directLight.color = pointLight.color;\n		directLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n		directLight.visible = ( directLight.color != vec3( 0.0 ) );\n	}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n	struct SpotLight {\n		vec3 position;\n		vec3 direction;\n		vec3 color;\n		float distance;\n		float decay;\n		float coneCos;\n		float penumbraCos;\n	};\n	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n	void getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n		vec3 lVector = spotLight.position - geometry.position;\n		directLight.direction = normalize( lVector );\n		float lightDistance = length( lVector );\n		float angleCos = dot( directLight.direction, spotLight.direction );\n		if ( angleCos > spotLight.coneCos ) {\n			float spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n			directLight.color = spotLight.color;\n			directLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n			directLight.visible = true;\n		} else {\n			directLight.color = vec3( 0.0 );\n			directLight.visible = false;\n		}\n	}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n	struct RectAreaLight {\n		vec3 color;\n		vec3 position;\n		vec3 halfWidth;\n		vec3 halfHeight;\n	};\n	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;\n	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n	struct HemisphereLight {\n		vec3 direction;\n		vec3 skyColor;\n		vec3 groundColor;\n	};\n	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n		float dotNL = dot( geometry.normal, hemiLight.direction );\n		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n		#ifndef PHYSICALLY_CORRECT_LIGHTS\n			irradiance *= PI;\n		#endif\n		return irradiance;\n	}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n	vec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n	#ifndef PHYSICALLY_CORRECT_LIGHTS\n		irradiance *= PI;\n	#endif\n	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct				RE_Direct_Toon\n#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )	(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n	vec3 diffuseColor;\n	vec3 specularColor;\n	float specularShininess;\n	float specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n	vec3 irradiance = dotNL * directLight.color;\n	#ifndef PHYSICALLY_CORRECT_LIGHTS\n		irradiance *= PI;\n	#endif\n	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct				RE_Direct_BlinnPhong\n#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )	(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n	material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n	material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n	material.clearcoat = clearcoat;\n	material.clearcoatRoughness = clearcoatRoughness;\n	#ifdef USE_CLEARCOATMAP\n		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n	#endif\n	#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n	#endif\n	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n	material.clearcoatRoughness += geometryRoughness;\n	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n	material.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n	vec3 diffuseColor;\n	float specularRoughness;\n	vec3 specularColor;\n#ifdef CLEARCOAT\n	float clearcoat;\n	float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n	vec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n	return DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n		vec3 normal = geometry.normal;\n		vec3 viewDir = geometry.viewDir;\n		vec3 position = geometry.position;\n		vec3 lightPos = rectAreaLight.position;\n		vec3 halfWidth = rectAreaLight.halfWidth;\n		vec3 halfHeight = rectAreaLight.halfHeight;\n		vec3 lightColor = rectAreaLight.color;\n		float roughness = material.specularRoughness;\n		vec3 rectCoords[ 4 ];\n		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n		vec2 uv = LTC_Uv( normal, viewDir, roughness );\n		vec4 t1 = texture2D( ltc_1, uv );\n		vec4 t2 = texture2D( ltc_2, uv );\n		mat3 mInv = mat3(\n			vec3( t1.x, 0, t1.y ),\n			vec3(    0, 1,    0 ),\n			vec3( t1.z, 0, t1.w )\n		);\n		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n	}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n	vec3 irradiance = dotNL * directLight.color;\n	#ifndef PHYSICALLY_CORRECT_LIGHTS\n		irradiance *= PI;\n	#endif\n	#ifdef CLEARCOAT\n		float ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n		vec3 ccIrradiance = ccDotNL * directLight.color;\n		#ifndef PHYSICALLY_CORRECT_LIGHTS\n			ccIrradiance *= PI;\n		#endif\n		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n		reflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n	#else\n		float clearcoatDHR = 0.0;\n	#endif\n	#ifdef USE_SHEEN\n		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n			material.specularRoughness,\n			directLight.direction,\n			geometry,\n			material.sheenColor\n		);\n	#else\n		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n	#endif\n	reflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n	#ifdef CLEARCOAT\n		float ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n		reflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n		float ccDotNL = ccDotNV;\n		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n	#else\n		float clearcoatDHR = 0.0;\n	#endif\n	float clearcoatInv = 1.0 - clearcoatDHR;\n	vec3 singleScattering = vec3( 0.0 );\n	vec3 multiScattering = vec3( 0.0 );\n	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n	BRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n	reflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct				RE_Direct_Physical\n#define RE_Direct_RectArea		RE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular		RE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n	geometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n	PointLight pointLight;\n	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n	PointLightShadow pointLightShadow;\n	#endif\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n		pointLight = pointLights[ i ];\n		getPointDirectLightIrradiance( pointLight, geometry, directLight );\n		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n		pointLightShadow = pointLightShadows[ i ];\n		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n		#endif\n		RE_Direct( directLight, geometry, material, reflectedLight );\n	}\n	#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n	SpotLight spotLight;\n	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n	SpotLightShadow spotLightShadow;\n	#endif\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n		spotLight = spotLights[ i ];\n		getSpotDirectLightIrradiance( spotLight, geometry, directLight );\n		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n		spotLightShadow = spotLightShadows[ i ];\n		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n		#endif\n		RE_Direct( directLight, geometry, material, reflectedLight );\n	}\n	#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n	DirectionalLight directionalLight;\n	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n	DirectionalLightShadow directionalLightShadow;\n	#endif\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n		directionalLight = directionalLights[ i ];\n		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n		directionalLightShadow = directionalLightShadows[ i ];\n		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n		#endif\n		RE_Direct( directLight, geometry, material, reflectedLight );\n	}\n	#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n	RectAreaLight rectAreaLight;\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n		rectAreaLight = rectAreaLights[ i ];\n		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n	}\n	#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n	vec3 iblIrradiance = vec3( 0.0 );\n	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n	irradiance += getLightProbeIrradiance( lightProbe, geometry );\n	#if ( NUM_HEMI_LIGHTS > 0 )\n		#pragma unroll_loop_start\n		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n		}\n		#pragma unroll_loop_end\n	#endif\n#endif\n#if defined( RE_IndirectSpecular )\n	vec3 radiance = vec3( 0.0 );\n	vec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n	#ifdef USE_LIGHTMAP\n		vec4 lightMapTexel= texture2D( lightMap, vUv2 );\n		vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n		#ifndef PHYSICALLY_CORRECT_LIGHTS\n			lightMapIrradiance *= PI;\n		#endif\n		irradiance += lightMapIrradiance;\n	#endif\n	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n		iblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n	#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n	radiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n	#ifdef CLEARCOAT\n		clearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n	#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n	uniform float logDepthBufFC;\n	varying float vFragDepth;\n	varying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n	#ifdef USE_LOGDEPTHBUF_EXT\n		varying float vFragDepth;\n		varying float vIsPerspective;\n	#else\n		uniform float logDepthBufFC;\n	#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n	#ifdef USE_LOGDEPTHBUF_EXT\n		vFragDepth = 1.0 + gl_Position.w;\n		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n	#else\n		if ( isPerspectiveMatrix( projectionMatrix ) ) {\n			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n			gl_Position.z *= gl_Position.w;\n		}\n	#endif\n#endif",map_fragment:"#ifdef USE_MAP\n	vec4 texelColor = texture2D( map, vUv );\n	texelColor = mapTexelToLinear( texelColor );\n	diffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n	uniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n	vec4 mapTexel = texture2D( map, uv );\n	diffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n	diffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n	uniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n	uniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n	uniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n	vec4 texelMetalness = texture2D( metalnessMap, vUv );\n	metalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n	uniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n	objectNormal *= morphTargetBaseInfluence;\n	objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n	objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n	objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n	objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n	uniform float morphTargetBaseInfluence;\n	#ifndef USE_MORPHNORMALS\n		uniform float morphTargetInfluences[ 8 ];\n	#else\n		uniform float morphTargetInfluences[ 4 ];\n	#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n	transformed *= morphTargetBaseInfluence;\n	transformed += morphTarget0 * morphTargetInfluences[ 0 ];\n	transformed += morphTarget1 * morphTargetInfluences[ 1 ];\n	transformed += morphTarget2 * morphTargetInfluences[ 2 ];\n	transformed += morphTarget3 * morphTargetInfluences[ 3 ];\n	#ifndef USE_MORPHNORMALS\n		transformed += morphTarget4 * morphTargetInfluences[ 4 ];\n		transformed += morphTarget5 * morphTargetInfluences[ 5 ];\n		transformed += morphTarget6 * morphTargetInfluences[ 6 ];\n		transformed += morphTarget7 * morphTargetInfluences[ 7 ];\n	#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n	vec3 normal = normalize( cross( fdx, fdy ) );\n#else\n	vec3 normal = normalize( vNormal );\n	#ifdef DOUBLE_SIDED\n		normal = normal * faceDirection;\n	#endif\n	#ifdef USE_TANGENT\n		vec3 tangent = normalize( vTangent );\n		vec3 bitangent = normalize( vBitangent );\n		#ifdef DOUBLE_SIDED\n			tangent = tangent * faceDirection;\n			bitangent = bitangent * faceDirection;\n		#endif\n		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n			mat3 vTBN = mat3( tangent, bitangent, normal );\n		#endif\n	#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n	#ifdef FLIP_SIDED\n		normal = - normal;\n	#endif\n	#ifdef DOUBLE_SIDED\n		normal = normal * faceDirection;\n	#endif\n	normal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n	mapN.xy *= normalScale;\n	#ifdef USE_TANGENT\n		normal = normalize( vTBN * mapN );\n	#else\n		normal = perturbNormal2Arb( -vViewPosition, normal, mapN, faceDirection );\n	#endif\n#elif defined( USE_BUMPMAP )\n	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n	uniform sampler2D normalMap;\n	uniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n	uniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n		vec2 st0 = dFdx( vUv.st );\n		vec2 st1 = dFdy( vUv.st );\n		vec3 N = surf_norm;\n		vec3 q1perp = cross( q1, N );\n		vec3 q0perp = cross( N, q0 );\n		vec3 T = q1perp * st0.x + q0perp * st1.x;\n		vec3 B = q1perp * st0.y + q0perp * st1.y;\n		float det = max( dot( T, T ), dot( B, B ) );\n		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n	}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n	vec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n	clearcoatMapN.xy *= clearcoatNormalScale;\n	#ifdef USE_TANGENT\n		clearcoatNormal = normalize( vTBN * clearcoatMapN );\n	#else\n		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n	#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n	uniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n	uniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n	uniform sampler2D clearcoatNormalMap;\n	uniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n	return normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n	return 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n	vec4 r = vec4( fract( v * PackFactors ), v );\n	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n	return dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n	return ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n	return linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n	return (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n	return ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n	gl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n	mvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n	gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n	vec3 dithering( vec3 color ) {\n		float grid_position = rand( gl_FragCoord.xy );\n		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n		return color + dither_shift_RGB;\n	}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n	vec4 texelRoughness = texture2D( roughnessMap, vUv );\n	roughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n	uniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n	#if NUM_DIR_LIGHT_SHADOWS > 0\n		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n		struct DirectionalLightShadow {\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n		};\n		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n	#endif\n	#if NUM_SPOT_LIGHT_SHADOWS > 0\n		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n		struct SpotLightShadow {\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n		};\n		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n	#endif\n	#if NUM_POINT_LIGHT_SHADOWS > 0\n		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n		struct PointLightShadow {\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n			float shadowCameraNear;\n			float shadowCameraFar;\n		};\n		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n	#endif\n	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n	}\n	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n		return unpackRGBATo2Half( texture2D( shadow, uv ) );\n	}\n	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n		float occlusion = 1.0;\n		vec2 distribution = texture2DDistribution( shadow, uv );\n		float hard_shadow = step( compare , distribution.x );\n		if (hard_shadow != 1.0 ) {\n			float distance = compare - distribution.x ;\n			float variance = max( 0.00000, distribution.y * distribution.y );\n			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n		}\n		return occlusion;\n	}\n	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n		float shadow = 1.0;\n		shadowCoord.xyz /= shadowCoord.w;\n		shadowCoord.z += shadowBias;\n		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n		bool inFrustum = all( inFrustumVec );\n		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n		bool frustumTest = all( frustumTestVec );\n		if ( frustumTest ) {\n		#if defined( SHADOWMAP_TYPE_PCF )\n			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n			float dx0 = - texelSize.x * shadowRadius;\n			float dy0 = - texelSize.y * shadowRadius;\n			float dx1 = + texelSize.x * shadowRadius;\n			float dy1 = + texelSize.y * shadowRadius;\n			float dx2 = dx0 / 2.0;\n			float dy2 = dy0 / 2.0;\n			float dx3 = dx1 / 2.0;\n			float dy3 = dy1 / 2.0;\n			shadow = (\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n			) * ( 1.0 / 17.0 );\n		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n			float dx = texelSize.x;\n			float dy = texelSize.y;\n			vec2 uv = shadowCoord.xy;\n			vec2 f = fract( uv * shadowMapSize + 0.5 );\n			uv -= f * texelSize;\n			shadow = (\n				texture2DCompare( shadowMap, uv, shadowCoord.z ) +\n				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n					 f.x ) +\n				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n					 f.x ) +\n				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n					 f.y ) +\n				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n					 f.y ) +\n				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n						  f.x ),\n					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n						  f.x ),\n					 f.y )\n			) * ( 1.0 / 9.0 );\n		#elif defined( SHADOWMAP_TYPE_VSM )\n			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n		#else\n			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n		#endif\n		}\n		return shadow;\n	}\n	vec2 cubeToUV( vec3 v, float texelSizeY ) {\n		vec3 absV = abs( v );\n		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n		absV *= scaleToCube;\n		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n		vec2 planar = v.xy;\n		float almostATexel = 1.5 * texelSizeY;\n		float almostOne = 1.0 - almostATexel;\n		if ( absV.z >= almostOne ) {\n			if ( v.z > 0.0 )\n				planar.x = 4.0 - v.x;\n		} else if ( absV.x >= almostOne ) {\n			float signX = sign( v.x );\n			planar.x = v.z * signX + 2.0 * signX;\n		} else if ( absV.y >= almostOne ) {\n			float signY = sign( v.y );\n			planar.x = v.x + 2.0 * signY + 2.0;\n			planar.y = v.z * signY - 2.0;\n		}\n		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n	}\n	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n		vec3 lightToPosition = shadowCoord.xyz;\n		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;\n		vec3 bd3D = normalize( lightToPosition );\n		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n			return (\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n			) * ( 1.0 / 9.0 );\n		#else\n			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n		#endif\n	}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n	#if NUM_DIR_LIGHT_SHADOWS > 0\n		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n		struct DirectionalLightShadow {\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n		};\n		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n	#endif\n	#if NUM_SPOT_LIGHT_SHADOWS > 0\n		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n		struct SpotLightShadow {\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n		};\n		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n	#endif\n	#if NUM_POINT_LIGHT_SHADOWS > 0\n		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n		struct PointLightShadow {\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n			float shadowCameraNear;\n			float shadowCameraFar;\n		};\n		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n	#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n		vec4 shadowWorldPosition;\n	#endif\n	#if NUM_DIR_LIGHT_SHADOWS > 0\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n	}\n	#pragma unroll_loop_end\n	#endif\n	#if NUM_SPOT_LIGHT_SHADOWS > 0\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n	}\n	#pragma unroll_loop_end\n	#endif\n	#if NUM_POINT_LIGHT_SHADOWS > 0\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n	}\n	#pragma unroll_loop_end\n	#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n	float shadow = 1.0;\n	#ifdef USE_SHADOWMAP\n	#if NUM_DIR_LIGHT_SHADOWS > 0\n	DirectionalLightShadow directionalLight;\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n		directionalLight = directionalLightShadows[ i ];\n		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n	}\n	#pragma unroll_loop_end\n	#endif\n	#if NUM_SPOT_LIGHT_SHADOWS > 0\n	SpotLightShadow spotLight;\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n		spotLight = spotLightShadows[ i ];\n		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n	}\n	#pragma unroll_loop_end\n	#endif\n	#if NUM_POINT_LIGHT_SHADOWS > 0\n	PointLightShadow pointLight;\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n		pointLight = pointLightShadows[ i ];\n		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n	}\n	#pragma unroll_loop_end\n	#endif\n	#endif\n	return shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n	mat4 boneMatX = getBoneMatrix( skinIndex.x );\n	mat4 boneMatY = getBoneMatrix( skinIndex.y );\n	mat4 boneMatZ = getBoneMatrix( skinIndex.z );\n	mat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n	uniform mat4 bindMatrix;\n	uniform mat4 bindMatrixInverse;\n	#ifdef BONE_TEXTURE\n		uniform highp sampler2D boneTexture;\n		uniform int boneTextureSize;\n		mat4 getBoneMatrix( const in float i ) {\n			float j = i * 4.0;\n			float x = mod( j, float( boneTextureSize ) );\n			float y = floor( j / float( boneTextureSize ) );\n			float dx = 1.0 / float( boneTextureSize );\n			float dy = 1.0 / float( boneTextureSize );\n			y = dy * ( y + 0.5 );\n			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n			mat4 bone = mat4( v1, v2, v3, v4 );\n			return bone;\n		}\n	#else\n		uniform mat4 boneMatrices[ MAX_BONES ];\n		mat4 getBoneMatrix( const in float i ) {\n			mat4 bone = boneMatrices[ int(i) ];\n			return bone;\n		}\n	#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n	vec4 skinned = vec4( 0.0 );\n	skinned += boneMatX * skinVertex * skinWeight.x;\n	skinned += boneMatY * skinVertex * skinWeight.y;\n	skinned += boneMatZ * skinVertex * skinWeight.z;\n	skinned += boneMatW * skinVertex * skinWeight.w;\n	transformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n	mat4 skinMatrix = mat4( 0.0 );\n	skinMatrix += skinWeight.x * boneMatX;\n	skinMatrix += skinWeight.y * boneMatY;\n	skinMatrix += skinWeight.z * boneMatZ;\n	skinMatrix += skinWeight.w * boneMatW;\n	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n	#ifdef USE_TANGENT\n		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n	#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n	vec4 texelSpecular = texture2D( specularMap, vUv );\n	specularStrength = texelSpecular.r;\n#else\n	specularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n	uniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n	return toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n	color *= toneMappingExposure;\n	return saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n	color *= toneMappingExposure;\n	color = max( vec3( 0.0 ), color - 0.004 );\n	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n	return a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n	const mat3 ACESInputMat = mat3(\n		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),\n		vec3( 0.04823, 0.01566, 0.83777 )\n	);\n	const mat3 ACESOutputMat = mat3(\n		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),\n		vec3( -0.07367, -0.00605,  1.07602 )\n	);\n	color *= toneMappingExposure / 0.6;\n	color = ACESInputMat * color;\n	color = RRTAndODTFit( color );\n	color = ACESOutputMat * color;\n	return saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmissionmap_fragment:"#ifdef USE_TRANSMISSIONMAP\n	totalTransmission *= texture2D( transmissionMap, vUv ).r;\n#endif",transmissionmap_pars_fragment:"#ifdef USE_TRANSMISSIONMAP\n	uniform sampler2D transmissionMap;\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n	varying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n	#ifdef UVS_VERTEX_ONLY\n		vec2 vUv;\n	#else\n		varying vec2 vUv;\n	#endif\n	uniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n	varying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n	attribute vec2 uv2;\n	varying vec2 vUv2;\n	uniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n	vec4 worldPosition = vec4( transformed, 1.0 );\n	#ifdef USE_INSTANCING\n		worldPosition = instanceMatrix * worldPosition;\n	#endif\n	worldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n	vec4 texColor = texture2D( t2D, vUv );\n	gl_FragColor = mapTexelToLinear( texColor );\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n	gl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n	vec3 vReflect = vWorldDirection;\n	#include <envmap_fragment>\n	gl_FragColor = envColor;\n	gl_FragColor.a *= opacity;\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n	vWorldDirection = transformDirection( position, modelMatrix );\n	#include <begin_vertex>\n	#include <project_vertex>\n	gl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n	uniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( 1.0 );\n	#if DEPTH_PACKING == 3200\n		diffuseColor.a = opacity;\n	#endif\n	#include <map_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <logdepthbuf_fragment>\n	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n	#if DEPTH_PACKING == 3200\n		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n	#elif DEPTH_PACKING == 3201\n		gl_FragColor = packDepthToRGBA( fragCoordZ );\n	#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n	#include <uv_vertex>\n	#include <skinbase_vertex>\n	#ifdef USE_DISPLACEMENTMAP\n		#include <beginnormal_vertex>\n		#include <morphnormal_vertex>\n		#include <skinnormal_vertex>\n	#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( 1.0 );\n	#include <map_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	float dist = length( vWorldPosition - referencePosition );\n	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n	dist = saturate( dist );\n	gl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <skinbase_vertex>\n	#ifdef USE_DISPLACEMENTMAP\n		#include <beginnormal_vertex>\n		#include <morphnormal_vertex>\n		#include <skinnormal_vertex>\n	#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <worldpos_vertex>\n	#include <clipping_planes_vertex>\n	vWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n	vec3 direction = normalize( vWorldDirection );\n	vec2 sampleUV = equirectUv( direction );\n	vec4 texColor = texture2D( tEquirect, sampleUV );\n	gl_FragColor = mapTexelToLinear( texColor );\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n	vWorldDirection = transformDirection( position, modelMatrix );\n	#include <begin_vertex>\n	#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	if ( mod( vLineDistance, totalSize ) > dashSize ) {\n		discard;\n	}\n	vec3 outgoingLight = vec3( 0.0 );\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <logdepthbuf_fragment>\n	#include <color_fragment>\n	outgoingLight = diffuseColor.rgb;\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	vLineDistance = scale * lineDistance;\n	#include <color_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <specularmap_fragment>\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	#ifdef USE_LIGHTMAP\n	\n		vec4 lightMapTexel= texture2D( lightMap, vUv2 );\n		reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n	#else\n		reflectedLight.indirectDiffuse += vec3( 1.0 );\n	#endif\n	#include <aomap_fragment>\n	reflectedLight.indirectDiffuse *= diffuseColor.rgb;\n	vec3 outgoingLight = reflectedLight.indirectDiffuse;\n	#include <envmap_fragment>\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <uv2_vertex>\n	#include <color_vertex>\n	#include <skinbase_vertex>\n	#ifdef USE_ENVMAP\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <worldpos_vertex>\n	#include <clipping_planes_vertex>\n	#include <envmap_vertex>\n	#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n	varying vec3 vLightBack;\n	varying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <specularmap_fragment>\n	#include <emissivemap_fragment>\n	#ifdef DOUBLE_SIDED\n		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n	#else\n		reflectedLight.indirectDiffuse += vIndirectFront;\n	#endif\n	#include <lightmap_fragment>\n	reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n	#ifdef DOUBLE_SIDED\n		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n	#else\n		reflectedLight.directDiffuse = vLightFront;\n	#endif\n	reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n	#include <aomap_fragment>\n	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n	#include <envmap_fragment>\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n	varying vec3 vLightBack;\n	varying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <uv2_vertex>\n	#include <color_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <worldpos_vertex>\n	#include <envmap_vertex>\n	#include <lights_lambert_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	vec3 viewDir = normalize( vViewPosition );\n	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n	vec3 y = cross( viewDir, x );\n	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n	#ifdef USE_MATCAP\n		vec4 matcapColor = texture2D( matcap, uv );\n		matcapColor = matcapTexelToLinear( matcapColor );\n	#else\n		vec4 matcapColor = vec4( 1.0 );\n	#endif\n	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#ifndef FLAT_SHADED\n		vNormal = normalize( transformedNormal );\n	#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <fog_vertex>\n	vViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	#include <emissivemap_fragment>\n	#include <lights_toon_fragment>\n	#include <lights_fragment_begin>\n	#include <lights_fragment_maps>\n	#include <lights_fragment_end>\n	#include <aomap_fragment>\n	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <uv2_vertex>\n	#include <color_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n	vNormal = normalize( transformedNormal );\n#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vViewPosition = - mvPosition.xyz;\n	#include <worldpos_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <specularmap_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	#include <emissivemap_fragment>\n	#include <lights_phong_fragment>\n	#include <lights_fragment_begin>\n	#include <lights_fragment_maps>\n	#include <lights_fragment_end>\n	#include <aomap_fragment>\n	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n	#include <envmap_fragment>\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <uv2_vertex>\n	#include <color_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n	vNormal = normalize( transformedNormal );\n#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vViewPosition = - mvPosition.xyz;\n	#include <worldpos_vertex>\n	#include <envmap_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n	#define REFLECTIVITY\n	#define CLEARCOAT\n	#define TRANSMISSION\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSMISSION\n	uniform float transmission;\n#endif\n#ifdef REFLECTIVITY\n	uniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n	uniform float clearcoat;\n	uniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n	uniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n	#ifdef USE_TANGENT\n		varying vec3 vTangent;\n		varying vec3 vBitangent;\n	#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <transmissionmap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#ifdef TRANSMISSION\n		float totalTransmission = transmission;\n	#endif\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <roughnessmap_fragment>\n	#include <metalnessmap_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	#include <clearcoat_normal_fragment_begin>\n	#include <clearcoat_normal_fragment_maps>\n	#include <emissivemap_fragment>\n	#include <transmissionmap_fragment>\n	#include <lights_physical_fragment>\n	#include <lights_fragment_begin>\n	#include <lights_fragment_maps>\n	#include <lights_fragment_end>\n	#include <aomap_fragment>\n	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n	#ifdef TRANSMISSION\n		diffuseColor.a *= mix( saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) ), 1.0, metalness );\n	#endif\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n	#ifdef USE_TANGENT\n		varying vec3 vTangent;\n		varying vec3 vBitangent;\n	#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <uv2_vertex>\n	#include <color_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n	vNormal = normalize( transformedNormal );\n	#ifdef USE_TANGENT\n		vTangent = normalize( transformedTangent );\n		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n	#endif\n#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vViewPosition = - mvPosition.xyz;\n	#include <worldpos_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n	varying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n	#ifdef USE_TANGENT\n		varying vec3 vTangent;\n		varying vec3 vBitangent;\n	#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	#include <logdepthbuf_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n	varying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n	#ifdef USE_TANGENT\n		varying vec3 vTangent;\n		varying vec3 vBitangent;\n	#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n	vNormal = normalize( transformedNormal );\n	#ifdef USE_TANGENT\n		vTangent = normalize( transformedTangent );\n		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n	#endif\n#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n	vViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec3 outgoingLight = vec3( 0.0 );\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <logdepthbuf_fragment>\n	#include <map_particle_fragment>\n	#include <color_fragment>\n	#include <alphatest_fragment>\n	outgoingLight = diffuseColor.rgb;\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <color_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <project_vertex>\n	gl_PointSize = size;\n	#ifdef USE_SIZEATTENUATION\n		bool isPerspective = isPerspectiveMatrix( projectionMatrix );\n		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n	#endif\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <worldpos_vertex>\n	#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n	#include <begin_vertex>\n	#include <project_vertex>\n	#include <worldpos_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec3 outgoingLight = vec3( 0.0 );\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	outgoingLight = diffuseColor.rgb;\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n	vec2 scale;\n	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n	#ifndef USE_SIZEATTENUATION\n		bool isPerspective = isPerspectiveMatrix( projectionMatrix );\n		if ( isPerspective ) scale *= - mvPosition.z;\n	#endif\n	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n	vec2 rotatedPosition;\n	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n	mvPosition.xy += rotatedPosition;\n	gl_Position = projectionMatrix * mvPosition;\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <fog_vertex>\n}"},t9={common:{diffuse:{value:new tr(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new U},uv2Transform:{value:new U},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new O(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new tr(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new tr(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new U}},sprite:{diffuse:{value:new tr(15658734)},opacity:{value:1},center:{value:new O(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new U}}},re={basic:{uniforms:tX([t9.common,t9.specularmap,t9.envmap,t9.aomap,t9.lightmap,t9.fog]),vertexShader:t7.meshbasic_vert,fragmentShader:t7.meshbasic_frag},lambert:{uniforms:tX([t9.common,t9.specularmap,t9.envmap,t9.aomap,t9.lightmap,t9.emissivemap,t9.fog,t9.lights,{emissive:{value:new tr(0)}}]),vertexShader:t7.meshlambert_vert,fragmentShader:t7.meshlambert_frag},phong:{uniforms:tX([t9.common,t9.specularmap,t9.envmap,t9.aomap,t9.lightmap,t9.emissivemap,t9.bumpmap,t9.normalmap,t9.displacementmap,t9.fog,t9.lights,{emissive:{value:new tr(0)},specular:{value:new tr(1118481)},shininess:{value:30}}]),vertexShader:t7.meshphong_vert,fragmentShader:t7.meshphong_frag},standard:{uniforms:tX([t9.common,t9.envmap,t9.aomap,t9.lightmap,t9.emissivemap,t9.bumpmap,t9.normalmap,t9.displacementmap,t9.roughnessmap,t9.metalnessmap,t9.fog,t9.lights,{emissive:{value:new tr(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:t7.meshphysical_vert,fragmentShader:t7.meshphysical_frag},toon:{uniforms:tX([t9.common,t9.aomap,t9.lightmap,t9.emissivemap,t9.bumpmap,t9.normalmap,t9.displacementmap,t9.gradientmap,t9.fog,t9.lights,{emissive:{value:new tr(0)}}]),vertexShader:t7.meshtoon_vert,fragmentShader:t7.meshtoon_frag},matcap:{uniforms:tX([t9.common,t9.bumpmap,t9.normalmap,t9.displacementmap,t9.fog,{matcap:{value:null}}]),vertexShader:t7.meshmatcap_vert,fragmentShader:t7.meshmatcap_frag},points:{uniforms:tX([t9.points,t9.fog]),vertexShader:t7.points_vert,fragmentShader:t7.points_frag},dashed:{uniforms:tX([t9.common,t9.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:t7.linedashed_vert,fragmentShader:t7.linedashed_frag},depth:{uniforms:tX([t9.common,t9.displacementmap]),vertexShader:t7.depth_vert,fragmentShader:t7.depth_frag},normal:{uniforms:tX([t9.common,t9.bumpmap,t9.normalmap,t9.displacementmap,{opacity:{value:1}}]),vertexShader:t7.normal_vert,fragmentShader:t7.normal_frag},sprite:{uniforms:tX([t9.sprite,t9.fog]),vertexShader:t7.sprite_vert,fragmentShader:t7.sprite_frag},background:{uniforms:{uvTransform:{value:new U},t2D:{value:null}},vertexShader:t7.background_vert,fragmentShader:t7.background_frag},cube:{uniforms:tX([t9.envmap,{opacity:{value:1}}]),vertexShader:t7.cube_vert,fragmentShader:t7.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:t7.equirect_vert,fragmentShader:t7.equirect_frag},distanceRGBA:{uniforms:tX([t9.common,t9.displacementmap,{referencePosition:{value:new V},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:t7.distanceRGBA_vert,fragmentShader:t7.distanceRGBA_frag},shadow:{uniforms:tX([t9.lights,t9.fog,{color:{value:new tr(0)},opacity:{value:1}}]),vertexShader:t7.shadow_vert,fragmentShader:t7.shadow_frag}};function rt(e,t,r,n,i){let a,s;let o=new tr(0),h=0,u=null,c=0,d=null;function p(e,t){r.buffers.color.setClear(e.r,e.g,e.b,t,i)}return{getClearColor:function(){return o},setClearColor:function(e,t=1){o.set(e),p(o,h=t)},getClearAlpha:function(){return h},setClearAlpha:function(e){p(o,h=e)},render:function(r,i,f,m){let g=!0===i.isScene?i.background:null;g&&g.isTexture&&(g=t.get(g));let v=e.xr,y=v.getSession&&v.getSession();y&&"additive"===y.environmentBlendMode&&(g=null),null===g?p(o,h):g&&g.isColor&&(p(g,1),m=!0),(e.autoClear||m)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),g&&(g.isCubeTexture||g.isWebGLCubeRenderTarget||306===g.mapping)?(void 0===s&&((s=new tV(new tj(1,1,1),new tZ({name:"BackgroundCubeMaterial",uniforms:tq(re.cube.uniforms),vertexShader:re.cube.vertexShader,fragmentShader:re.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),s.geometry.deleteAttribute("uv"),s.onBeforeRender=function(e,t,r){this.matrixWorld.copyPosition(r.matrixWorld)},Object.defineProperty(s.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(s)),g.isWebGLCubeRenderTarget&&(g=g.texture),s.material.uniforms.envMap.value=g,s.material.uniforms.flipEnvMap.value=g.isCubeTexture&&g._needsFlipEnvMap?-1:1,(u!==g||c!==g.version||d!==e.toneMapping)&&(s.material.needsUpdate=!0,u=g,c=g.version,d=e.toneMapping),r.unshift(s,s.geometry,s.material,0,0,null)):g&&g.isTexture&&(void 0===a&&((a=new tV(new t8(2,2),new tZ({name:"BackgroundMaterial",uniforms:tq(re.background.uniforms),vertexShader:re.background.vertexShader,fragmentShader:re.background.fragmentShader,side:l,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(a.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(a)),a.material.uniforms.t2D.value=g,!0===g.matrixAutoUpdate&&g.updateMatrix(),a.material.uniforms.uvTransform.value.copy(g.matrix),(u!==g||c!==g.version||d!==e.toneMapping)&&(a.material.needsUpdate=!0,u=g,c=g.version,d=e.toneMapping),r.unshift(a,a.geometry,a.material,0,0,null))}}}function rr(e,t,r,n){let i=e.getParameter(34921),a=n.isWebGL2?null:t.get("OES_vertex_array_object"),s=n.isWebGL2||null!==a,o={},l=d(null),h=l;function u(t){return n.isWebGL2?e.bindVertexArray(t):a.bindVertexArrayOES(t)}function c(t){return n.isWebGL2?e.deleteVertexArray(t):a.deleteVertexArrayOES(t)}function d(e){let t=[],r=[],n=[];for(let e=0;e<i;e++)t[e]=0,r[e]=0,n[e]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:r,attributeDivisors:n,object:e,attributes:{},index:null}}function p(){let e=h.newAttributes;for(let t=0,r=e.length;t<r;t++)e[t]=0}function f(e){m(e,0)}function m(r,i){let a=h.newAttributes,s=h.enabledAttributes,o=h.attributeDivisors;a[r]=1,0===s[r]&&(e.enableVertexAttribArray(r),s[r]=1),o[r]!==i&&((n.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](r,i),o[r]=i)}function g(){let t=h.newAttributes,r=h.enabledAttributes;for(let n=0,i=r.length;n<i;n++)r[n]!==t[n]&&(e.disableVertexAttribArray(n),r[n]=0)}function v(t,r,i,a,s,o){!0===n.isWebGL2&&(5124===i||5125===i)?e.vertexAttribIPointer(t,r,i,s,o):e.vertexAttribPointer(t,r,i,a,s,o)}function y(){x(),h!==l&&u((h=l).object)}function x(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function(i,l,c,y,x){let _=!1;if(s){let t=function(t,r,i){let s=!0===i.wireframe,l=o[t.id];void 0===l&&(l={},o[t.id]=l);let h=l[r.id];void 0===h&&(h={},l[r.id]=h);let u=h[s];return void 0===u&&(u=d(n.isWebGL2?e.createVertexArray():a.createVertexArrayOES()),h[s]=u),u}(y,c,l);h!==t&&u((h=t).object),(_=function(e,t){let r=h.attributes,n=e.attributes,i=0;for(let e in n){let t=r[e],a=n[e];if(void 0===t||t.attribute!==a||t.data!==a.data)return!0;i++}return h.attributesNum!==i||h.index!==t}(y,x))&&function(e,t){let r={},n=e.attributes,i=0;for(let e in n){let t=n[e],a={};a.attribute=t,t.data&&(a.data=t.data),r[e]=a,i++}h.attributes=r,h.attributesNum=i,h.index=t}(y,x)}else{let e=!0===l.wireframe;(h.geometry!==y.id||h.program!==c.id||h.wireframe!==e)&&(h.geometry=y.id,h.program=c.id,h.wireframe=e,_=!0)}!0===i.isInstancedMesh&&(_=!0),null!==x&&r.update(x,34963),_&&(function(i,a,s,o){if(!1===n.isWebGL2&&(i.isInstancedMesh||o.isInstancedBufferGeometry)&&null===t.get("ANGLE_instanced_arrays"))return;p();let l=o.attributes,h=s.getAttributes(),u=a.defaultAttributeValues;for(let t in h){let n=h[t];if(n>=0){let a=l[t];if(void 0!==a){let t=a.normalized,i=a.itemSize,s=r.get(a);if(void 0===s)continue;let l=s.buffer,h=s.type,u=s.bytesPerElement;if(a.isInterleavedBufferAttribute){let r=a.data,s=r.stride,c=a.offset;r&&r.isInstancedInterleavedBuffer?(m(n,r.meshPerAttribute),void 0===o._maxInstanceCount&&(o._maxInstanceCount=r.meshPerAttribute*r.count)):f(n),e.bindBuffer(34962,l),v(n,i,h,t,s*u,c*u)}else a.isInstancedBufferAttribute?(m(n,a.meshPerAttribute),void 0===o._maxInstanceCount&&(o._maxInstanceCount=a.meshPerAttribute*a.count)):f(n),e.bindBuffer(34962,l),v(n,i,h,t,0,0)}else if("instanceMatrix"===t){let t=r.get(i.instanceMatrix);if(void 0===t)continue;let a=t.buffer,s=t.type;m(n+0,1),m(n+1,1),m(n+2,1),m(n+3,1),e.bindBuffer(34962,a),e.vertexAttribPointer(n+0,4,s,!1,64,0),e.vertexAttribPointer(n+1,4,s,!1,64,16),e.vertexAttribPointer(n+2,4,s,!1,64,32),e.vertexAttribPointer(n+3,4,s,!1,64,48)}else if("instanceColor"===t){let t=r.get(i.instanceColor);if(void 0===t)continue;let a=t.buffer,s=t.type;m(n,1),e.bindBuffer(34962,a),e.vertexAttribPointer(n,3,s,!1,12,0)}else if(void 0!==u){let r=u[t];if(void 0!==r)switch(r.length){case 2:e.vertexAttrib2fv(n,r);break;case 3:e.vertexAttrib3fv(n,r);break;case 4:e.vertexAttrib4fv(n,r);break;default:e.vertexAttrib1fv(n,r)}}}}g()}(i,l,c,y),null!==x&&e.bindBuffer(34963,r.get(x).buffer))},reset:y,resetDefaultState:x,dispose:function(){for(let e in y(),o){let t=o[e];for(let e in t){let r=t[e];for(let e in r)c(r[e].object),delete r[e];delete t[e]}delete o[e]}},releaseStatesOfGeometry:function(e){if(void 0===o[e.id])return;let t=o[e.id];for(let e in t){let r=t[e];for(let e in r)c(r[e].object),delete r[e];delete t[e]}delete o[e.id]},releaseStatesOfProgram:function(e){for(let t in o){let r=o[t];if(void 0===r[e.id])continue;let n=r[e.id];for(let e in n)c(n[e].object),delete n[e];delete r[e.id]}},initAttributes:p,enableAttribute:f,disableUnusedAttributes:g}}function rn(e,t,r,n){let i;let a=n.isWebGL2;this.setMode=function(e){i=e},this.render=function(t,n){e.drawArrays(i,t,n),r.update(n,i,1)},this.renderInstances=function(n,s,o){let l,h;if(0!==o){if(a)l=e,h="drawArraysInstanced";else if(l=t.get("ANGLE_instanced_arrays"),h="drawArraysInstancedANGLE",null===l){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}l[h](i,n,s,o),r.update(s,i,o)}}}function ri(e,t,r){let n;function i(t){if("highp"===t){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}let a="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&e instanceof WebGL2ComputeRenderingContext,s=void 0!==r.precision?r.precision:"highp",o=i(s);o!==s&&(console.warn("THREE.WebGLRenderer:",s,"not supported, using",o,"instead."),s=o);let l=!0===r.logarithmicDepthBuffer,h=e.getParameter(34930),u=e.getParameter(35660),c=e.getParameter(3379),d=e.getParameter(34076),p=e.getParameter(34921),f=e.getParameter(36347),m=e.getParameter(36348),g=e.getParameter(36349),v=u>0,y=a||t.has("OES_texture_float"),x=a?e.getParameter(36183):0;return{isWebGL2:a,getMaxAnisotropy:function(){if(void 0!==n)return n;if(!0===t.has("EXT_texture_filter_anisotropic")){let r=t.get("EXT_texture_filter_anisotropic");n=e.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n},getMaxPrecision:i,precision:s,logarithmicDepthBuffer:l,maxTextures:h,maxVertexTextures:u,maxTextureSize:c,maxCubemapSize:d,maxAttributes:p,maxVertexUniforms:f,maxVaryings:m,maxFragmentUniforms:g,vertexTextures:v,floatFragmentTextures:y,floatVertexTextures:v&&y,maxSamples:x}}function ra(e){let t=this,r=null,n=0,i=!1,a=!1,s=new eq,o=new U,l={value:null,needsUpdate:!1};function h(){l.value!==r&&(l.value=r,l.needsUpdate=n>0),t.numPlanes=n,t.numIntersection=0}function u(e,r,n,i){let a=null!==e?e.length:0,h=null;if(0!==a){if(h=l.value,!0!==i||null===h){let t=n+4*a,i=r.matrixWorldInverse;o.getNormalMatrix(i),(null===h||h.length<t)&&(h=new Float32Array(t));for(let t=0,r=n;t!==a;++t,r+=4)s.copy(e[t]).applyMatrix4(i,o),s.normal.toArray(h,r),h[r+3]=s.constant}l.value=h,l.needsUpdate=!0}return t.numPlanes=a,t.numIntersection=0,h}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t,a){let s=0!==e.length||t||0!==n||i;return i=t,r=u(e,a,0),n=e.length,s},this.beginShadows=function(){a=!0,u(null)},this.endShadows=function(){a=!1,h()},this.setState=function(t,s,o){let c=t.clippingPlanes,d=t.clipIntersection,p=t.clipShadows,f=e.get(t);if(i&&null!==c&&0!==c.length&&(!a||p)){let e=a?0:n,t=4*e,i=f.clippingState||null;l.value=i,i=u(c,s,t,o);for(let e=0;e!==t;++e)i[e]=r[e];f.clippingState=i,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=e}else a?u(null):h()}}function rs(e){let t=new WeakMap;function r(e,t){return 303===t?e.mapping=301:304===t&&(e.mapping=302),e}function n(e){let r=e.target;r.removeEventListener("dispose",n);let i=t.get(r);void 0!==i&&(t.delete(r),i.dispose())}return{get:function(i){if(i&&i.isTexture){let a=i.mapping;if(303===a||304===a){if(t.has(i))return r(t.get(i).texture,i.mapping);{let a=i.image;if(!a||!(a.height>0))return null;{let s=e.getRenderTarget(),o=new t0(a.height/2);return o.fromEquirectangularTexture(e,i),t.set(i,o),e.setRenderTarget(s),i.addEventListener("dispose",n),r(o.texture,i.mapping)}}}}return i},dispose:function(){t=new WeakMap}}}function ro(e){let t={};function r(r){let n;if(void 0!==t[r])return t[r];switch(r){case"WEBGL_depth_texture":n=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=e.getExtension(r)}return t[r]=n,n}return{has:function(e){return null!==r(e)},init:function(e){e.isWebGL2?r("EXT_color_buffer_float"):(r("WEBGL_depth_texture"),r("OES_texture_float"),r("OES_texture_half_float"),r("OES_texture_half_float_linear"),r("OES_standard_derivatives"),r("OES_element_index_uint"),r("OES_vertex_array_object"),r("ANGLE_instanced_arrays")),r("OES_texture_float_linear"),r("EXT_color_buffer_half_float")},get:function(e){let t=r(e);return null===t&&console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function rl(e,t,r,n){let i={},a=new WeakMap;function s(e){let o=e.target;for(let e in null!==o.index&&t.remove(o.index),o.attributes)t.remove(o.attributes[e]);o.removeEventListener("dispose",s),delete i[o.id];let l=a.get(o);l&&(t.remove(l),a.delete(o)),n.releaseStatesOfGeometry(o),!0===o.isInstancedBufferGeometry&&delete o._maxInstanceCount,r.memory.geometries--}function o(e){let r=[],n=e.index,i=e.attributes.position,s=0;if(null!==n){let e=n.array;s=n.version;for(let t=0,n=e.length;t<n;t+=3){let n=e[t+0],i=e[t+1],a=e[t+2];r.push(n,i,i,a,a,n)}}else{let e=i.array;s=i.version;for(let t=0,n=e.length/3-1;t<n;t+=3){let e=t+0,n=t+1,i=t+2;r.push(e,n,n,i,i,e)}}let o=new(tv(r)>65535?tp:tc)(r,1);o.version=s;let l=a.get(e);l&&t.remove(l),a.set(e,o)}return{get:function(e,t){return!0===i[t.id]||(t.addEventListener("dispose",s),i[t.id]=!0,r.memory.geometries++),t},update:function(e){let r=e.attributes;for(let e in r)t.update(r[e],34962);let n=e.morphAttributes;for(let e in n){let r=n[e];for(let e=0,n=r.length;e<n;e++)t.update(r[e],34962)}},getWireframeAttribute:function(e){let t=a.get(e);if(t){let r=e.index;null!==r&&t.version<r.version&&o(e)}else o(e);return a.get(e)}}}function rh(e,t,r,n){let i,a,s;let o=n.isWebGL2;this.setMode=function(e){i=e},this.setIndex=function(e){a=e.type,s=e.bytesPerElement},this.render=function(t,n){e.drawElements(i,n,a,t*s),r.update(n,i,1)},this.renderInstances=function(n,l,h){let u,c;if(0!==h){if(o)u=e,c="drawElementsInstanced";else if(u=t.get("ANGLE_instanced_arrays"),c="drawElementsInstancedANGLE",null===u){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}u[c](i,l,a,n*s,h),r.update(l,i,h)}}}function ru(e){let t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(e,r,n){switch(t.calls++,r){case 4:t.triangles+=e/3*n;break;case 1:t.lines+=e/2*n;break;case 3:t.lines+=n*(e-1);break;case 2:t.lines+=n*e;break;case 0:t.points+=n*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",r)}}}}function rc(e,t){return e[0]-t[0]}function rd(e,t){return Math.abs(t[1])-Math.abs(e[1])}function rp(e){let t={},r=new Float32Array(8),n=[];for(let e=0;e<8;e++)n[e]=[e,0];return{update:function(i,a,s,o){let l=i.morphTargetInfluences,h=void 0===l?0:l.length,u=t[a.id];if(void 0===u){u=[];for(let e=0;e<h;e++)u[e]=[e,0];t[a.id]=u}for(let e=0;e<h;e++){let t=u[e];t[0]=e,t[1]=l[e]}u.sort(rd);for(let e=0;e<8;e++)e<h&&u[e][1]?(n[e][0]=u[e][0],n[e][1]=u[e][1]):(n[e][0]=Number.MAX_SAFE_INTEGER,n[e][1]=0);n.sort(rc);let c=s.morphTargets&&a.morphAttributes.position,d=s.morphNormals&&a.morphAttributes.normal,p=0;for(let e=0;e<8;e++){let t=n[e],i=t[0],s=t[1];i!==Number.MAX_SAFE_INTEGER&&s?(c&&a.getAttribute("morphTarget"+e)!==c[i]&&a.setAttribute("morphTarget"+e,c[i]),d&&a.getAttribute("morphNormal"+e)!==d[i]&&a.setAttribute("morphNormal"+e,d[i]),r[e]=s,p+=s):(c&&!0===a.hasAttribute("morphTarget"+e)&&a.deleteAttribute("morphTarget"+e),d&&!0===a.hasAttribute("morphNormal"+e)&&a.deleteAttribute("morphNormal"+e),r[e]=0)}let f=a.morphTargetsRelative?1:1-p;o.getUniforms().setValue(e,"morphTargetBaseInfluence",f),o.getUniforms().setValue(e,"morphTargetInfluences",r)}}}function rf(e,t,r,n){let i=new WeakMap;function a(e){let t=e.target;t.removeEventListener("dispose",a),r.remove(t.instanceMatrix),null!==t.instanceColor&&r.remove(t.instanceColor)}return{update:function(e){let s=n.render.frame,o=e.geometry,l=t.get(e,o);return i.get(l)!==s&&(t.update(l),i.set(l,s)),e.isInstancedMesh&&(!1===e.hasEventListener("dispose",a)&&e.addEventListener("dispose",a),r.update(e.instanceMatrix,34962),null!==e.instanceColor&&r.update(e.instanceColor,34962)),l},dispose:function(){i=new WeakMap}}}re.physical={uniforms:tX([re.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new O(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new tr(0)},transmission:{value:0},transmissionMap:{value:null}}]),vertexShader:t7.meshphysical_vert,fragmentShader:t7.meshphysical_frag};class rm extends F{constructor(e=null,t=1,r=1,n=1){super(null),this.image={data:e,width:t,height:r,depth:n},this.magFilter=f,this.minFilter=f,this.wrapR=d,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}}rm.prototype.isDataTexture2DArray=!0;class rg extends F{constructor(e=null,t=1,r=1,n=1){super(null),this.image={data:e,width:t,height:r,depth:n},this.magFilter=f,this.minFilter=f,this.wrapR=d,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}}rg.prototype.isDataTexture3D=!0;let rv=new F,ry=new rm,rx=new rg,r_=new t$,rb=[],rw=[],rM=new Float32Array(16),rS=new Float32Array(9),rT=new Float32Array(4);function rE(e,t,r){let n=e[0];if(n<=0||n>0)return e;let i=t*r,a=rb[i];if(void 0===a&&(a=new Float32Array(i),rb[i]=a),0!==t){n.toArray(a,0);for(let n=1,i=0;n!==t;++n)i+=r,e[n].toArray(a,i)}return a}function rA(e,t){if(e.length!==t.length)return!1;for(let r=0,n=e.length;r<n;r++)if(e[r]!==t[r])return!1;return!0}function rL(e,t){for(let r=0,n=t.length;r<n;r++)e[r]=t[r]}function rR(e,t){let r=rw[t];void 0===r&&(r=new Int32Array(t),rw[t]=r);for(let n=0;n!==t;++n)r[n]=e.allocateTextureUnit();return r}function rP(e,t){let r=this.cache;r[0]!==t&&(e.uniform1f(this.addr,t),r[0]=t)}function rC(e,t){let r=this.cache;if(void 0!==t.x)(r[0]!==t.x||r[1]!==t.y)&&(e.uniform2f(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(rA(r,t))return;e.uniform2fv(this.addr,t),rL(r,t)}}function rI(e,t){let r=this.cache;if(void 0!==t.x)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z)&&(e.uniform3f(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else if(void 0!==t.r)(r[0]!==t.r||r[1]!==t.g||r[2]!==t.b)&&(e.uniform3f(this.addr,t.r,t.g,t.b),r[0]=t.r,r[1]=t.g,r[2]=t.b);else{if(rA(r,t))return;e.uniform3fv(this.addr,t),rL(r,t)}}function rD(e,t){let r=this.cache;if(void 0!==t.x)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w)&&(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(rA(r,t))return;e.uniform4fv(this.addr,t),rL(r,t)}}function rO(e,t){let r=this.cache,n=t.elements;if(void 0===n){if(rA(r,t))return;e.uniformMatrix2fv(this.addr,!1,t),rL(r,t)}else{if(rA(r,n))return;rT.set(n),e.uniformMatrix2fv(this.addr,!1,rT),rL(r,n)}}function rU(e,t){let r=this.cache,n=t.elements;if(void 0===n){if(rA(r,t))return;e.uniformMatrix3fv(this.addr,!1,t),rL(r,t)}else{if(rA(r,n))return;rS.set(n),e.uniformMatrix3fv(this.addr,!1,rS),rL(r,n)}}function rN(e,t){let r=this.cache,n=t.elements;if(void 0===n){if(rA(r,t))return;e.uniformMatrix4fv(this.addr,!1,t),rL(r,t)}else{if(rA(r,n))return;rM.set(n),e.uniformMatrix4fv(this.addr,!1,rM),rL(r,n)}}function rk(e,t,r){let n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(e.uniform1i(this.addr,i),n[0]=i),r.safeSetTexture2D(t||rv,i)}function rF(e,t,r){let n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(e.uniform1i(this.addr,i),n[0]=i),r.setTexture2DArray(t||ry,i)}function rB(e,t,r){let n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(e.uniform1i(this.addr,i),n[0]=i),r.setTexture3D(t||rx,i)}function rz(e,t,r){let n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(e.uniform1i(this.addr,i),n[0]=i),r.safeSetTextureCube(t||r_,i)}function rH(e,t){let r=this.cache;r[0]!==t&&(e.uniform1i(this.addr,t),r[0]=t)}function rG(e,t){let r=this.cache;rA(r,t)||(e.uniform2iv(this.addr,t),rL(r,t))}function rV(e,t){let r=this.cache;rA(r,t)||(e.uniform3iv(this.addr,t),rL(r,t))}function rW(e,t){let r=this.cache;rA(r,t)||(e.uniform4iv(this.addr,t),rL(r,t))}function rj(e,t){let r=this.cache;r[0]!==t&&(e.uniform1ui(this.addr,t),r[0]=t)}function rq(e,t){e.uniform1fv(this.addr,t)}function rX(e,t){e.uniform1iv(this.addr,t)}function rY(e,t){e.uniform2iv(this.addr,t)}function rZ(e,t){e.uniform3iv(this.addr,t)}function rJ(e,t){e.uniform4iv(this.addr,t)}function rK(e,t){let r=rE(t,this.size,2);e.uniform2fv(this.addr,r)}function rQ(e,t){let r=rE(t,this.size,3);e.uniform3fv(this.addr,r)}function r$(e,t){let r=rE(t,this.size,4);e.uniform4fv(this.addr,r)}function r0(e,t){let r=rE(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,r)}function r1(e,t){let r=rE(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,r)}function r2(e,t){let r=rE(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,r)}function r3(e,t,r){let n=t.length,i=rR(r,n);e.uniform1iv(this.addr,i);for(let e=0;e!==n;++e)r.safeSetTexture2D(t[e]||rv,i[e])}function r4(e,t,r){let n=t.length,i=rR(r,n);e.uniform1iv(this.addr,i);for(let e=0;e!==n;++e)r.safeSetTextureCube(t[e]||r_,i[e])}function r5(e,t,r){this.id=e,this.addr=r,this.cache=[],this.setValue=function(e){switch(e){case 5126:return rP;case 35664:return rC;case 35665:return rI;case 35666:return rD;case 35674:return rO;case 35675:return rU;case 35676:return rN;case 5124:case 35670:return rH;case 35667:case 35671:return rG;case 35668:case 35672:return rV;case 35669:case 35673:return rW;case 5125:return rj;case 35678:case 36198:case 36298:case 36306:case 35682:return rk;case 35679:case 36299:case 36307:return rB;case 35680:case 36300:case 36308:case 36293:return rz;case 36289:case 36303:case 36311:case 36292:return rF}}(t.type)}function r6(e,t,r){this.id=e,this.addr=r,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return rq;case 35664:return rK;case 35665:return rQ;case 35666:return r$;case 35674:return r0;case 35675:return r1;case 35676:return r2;case 5124:case 35670:return rX;case 35667:case 35671:return rY;case 35668:case 35672:return rZ;case 35669:case 35673:return rJ;case 35678:case 36198:case 36298:case 36306:case 35682:return r3;case 35680:case 36300:case 36308:case 36293:return r4}}(t.type)}function r8(e){this.id=e,this.seq=[],this.map={}}r6.prototype.updateCache=function(e){let t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),rL(t,e)},r8.prototype.setValue=function(e,t,r){let n=this.seq;for(let i=0,a=n.length;i!==a;++i){let a=n[i];a.setValue(e,t[a.id],r)}};let r7=/(\w+)(\])?(\[|\.)?/g;function r9(e,t){e.seq.push(t),e.map[t.id]=t}function ne(e,t){this.seq=[],this.map={};let r=e.getProgramParameter(t,35718);for(let n=0;n<r;++n){let r=e.getActiveUniform(t,n),i=e.getUniformLocation(t,r.name);!function(e,t,r){let n=e.name,i=n.length;for(r7.lastIndex=0;;){let a=r7.exec(n),s=r7.lastIndex,o=a[1],l="]"===a[2],h=a[3];if(l&&(o|=0),void 0===h||"["===h&&s+2===i){r9(r,void 0===h?new r5(o,e,t):new r6(o,e,t));break}{let e=r.map[o];void 0===e&&r9(r,e=new r8(o)),r=e}}}(r,i,this)}}function nt(e,t,r){let n=e.createShader(t);return e.shaderSource(n,r),e.compileShader(n),n}ne.prototype.setValue=function(e,t,r,n){let i=this.map[t];void 0!==i&&i.setValue(e,r,n)},ne.prototype.setOptional=function(e,t,r){let n=t[r];void 0!==n&&this.setValue(e,r,n)},ne.upload=function(e,t,r,n){for(let i=0,a=t.length;i!==a;++i){let a=t[i],s=r[a.id];!1!==s.needsUpdate&&a.setValue(e,s.value,n)}},ne.seqWithValue=function(e,t){let r=[];for(let n=0,i=e.length;n!==i;++n){let i=e[n];i.id in t&&r.push(i)}return r};let nr=0;function nn(e){switch(e){case 3e3:return["Linear","( value )"];case E:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case 3003:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}function ni(e,t,r){let n=e.getShaderParameter(t,35713),i=e.getShaderInfoLog(t).trim();return n&&""===i?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+r+"\n"+i+function(e){let t=e.split("\n");for(let e=0;e<t.length;e++)t[e]=e+1+": "+t[e];return t.join("\n")}(e.getShaderSource(t))}function na(e,t){let r=nn(t);return"vec4 "+e+"( vec4 value ) { return "+r[0]+"ToLinear"+r[1]+"; }"}function ns(e){return""!==e}function no(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function nl(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}let nh=/^[ \t]*#include +<([\w\d./]+)>/gm;function nu(e){return e.replace(nh,nc)}function nc(e,t){let r=t7[t];if(void 0===r)throw Error("Can not resolve #include <"+t+">");return nu(r)}let nd=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,np=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function nf(e){return e.replace(np,ng).replace(nd,nm)}function nm(e,t,r,n){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),ng(e,t,r,n)}function ng(e,t,r,n){let i="";for(let e=parseInt(t);e<parseInt(r);e++)i+=n.replace(/\[\s*i\s*\]/g,"[ "+e+" ]").replace(/UNROLLED_LOOP_INDEX/g,e);return i}function nv(e){let t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function ny(e,t,r,n){let i,a,s,o,l;let h=e.getContext(),u=r.defines,c=r.vertexShader,d=r.fragmentShader,p=(l="SHADOWMAP_TYPE_BASIC",1===r.shadowMapType?l="SHADOWMAP_TYPE_PCF":2===r.shadowMapType?l="SHADOWMAP_TYPE_PCF_SOFT":3===r.shadowMapType&&(l="SHADOWMAP_TYPE_VSM"),l),f=function(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case 301:case 302:t="ENVMAP_TYPE_CUBE";break;case 306:case 307:t="ENVMAP_TYPE_CUBE_UV"}return t}(r),m=function(e){let t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case 302:case 307:t="ENVMAP_MODE_REFRACTION"}return t}(r),g=function(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case 0:t="ENVMAP_BLENDING_MULTIPLY";break;case 1:t="ENVMAP_BLENDING_MIX";break;case 2:t="ENVMAP_BLENDING_ADD"}return t}(r),v=e.gammaFactor>0?e.gammaFactor:1,y=r.isWebGL2?"":[r.extensionDerivatives||r.envMapCubeUV||r.bumpMap||r.tangentSpaceNormalMap||r.clearcoatNormalMap||r.flatShading||"physical"===r.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(r.extensionFragDepth||r.logarithmicDepthBuffer)&&r.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",r.extensionDrawBuffers&&r.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(r.extensionShaderTextureLOD||r.envMap)&&r.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(ns).join("\n"),x=function(e){let t=[];for(let r in e){let n=e[r];!1!==n&&t.push("#define "+r+" "+n)}return t.join("\n")}(u),_=h.createProgram(),b=r.glslVersion?"#version "+r.glslVersion+"\n":"";r.isRawShaderMaterial?((i=[x].filter(ns).join("\n")).length>0&&(i+="\n"),(a=[y,x].filter(ns).join("\n")).length>0&&(a+="\n")):(i=[nv(r),"#define SHADER_NAME "+r.shaderName,x,r.instancing?"#define USE_INSTANCING":"",r.instancingColor?"#define USE_INSTANCING_COLOR":"",r.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+v,"#define MAX_BONES "+r.maxBones,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+m:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.displacementMap&&r.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors?"#define USE_COLOR":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.flatShading?"#define FLAT_SHADED":"",r.skinning?"#define USE_SKINNING":"",r.useVertexTexture?"#define BONE_TEXTURE":"",r.morphTargets?"#define USE_MORPHTARGETS":"",r.morphNormals&&!1===r.flatShading?"#define USE_MORPHNORMALS":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+p:"",r.sizeAttenuation?"#define USE_SIZEATTENUATION":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#ifdef USE_COLOR","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif","\n"].filter(ns).join("\n"),a=[y,nv(r),"#define SHADER_NAME "+r.shaderName,x,r.alphaTest?"#define ALPHATEST "+r.alphaTest+(r.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+v,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.matcap?"#define USE_MATCAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+f:"",r.envMap?"#define "+m:"",r.envMap?"#define "+g:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.sheen?"#define USE_SHEEN":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors||r.instancingColor?"#define USE_COLOR":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.gradientMap?"#define USE_GRADIENTMAP":"",r.flatShading?"#define FLAT_SHADED":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+p:"",r.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",r.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(r.extensionShaderTextureLOD||r.envMap)&&r.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==r.toneMapping?"#define TONE_MAPPING":"",0!==r.toneMapping?t7.tonemapping_pars_fragment:"",0!==r.toneMapping?function(e,t){let r;switch(t){case 1:r="Linear";break;case 2:r="Reinhard";break;case 3:r="OptimizedCineon";break;case 4:r="ACESFilmic";break;case 5:r="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),r="Linear"}return"vec3 "+e+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}("toneMapping",r.toneMapping):"",r.dithering?"#define DITHERING":"",t7.encodings_pars_fragment,r.map?na("mapTexelToLinear",r.mapEncoding):"",r.matcap?na("matcapTexelToLinear",r.matcapEncoding):"",r.envMap?na("envMapTexelToLinear",r.envMapEncoding):"",r.emissiveMap?na("emissiveMapTexelToLinear",r.emissiveMapEncoding):"",r.lightMap?na("lightMapTexelToLinear",r.lightMapEncoding):"",function(e,t){let r=nn(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+r[0]+r[1]+"; }"}("linearToOutputTexel",r.outputEncoding),r.depthPacking?"#define DEPTH_PACKING "+r.depthPacking:"","\n"].filter(ns).join("\n")),c=nl(c=no(c=nu(c),r),r),d=nl(d=no(d=nu(d),r),r),c=nf(c),d=nf(d),r.isWebGL2&&!0!==r.isRawShaderMaterial&&(b="#version 300 es\n",i="#define attribute in\n#define varying out\n#define texture2D texture\n"+i,a=["#define varying in",r.glslVersion===R?"":"out highp vec4 pc_fragColor;",r.glslVersion===R?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+a);let w=b+i+c,M=b+a+d,S=nt(h,35633,w),T=nt(h,35632,M);if(h.attachShader(_,S),h.attachShader(_,T),void 0!==r.index0AttributeName?h.bindAttribLocation(_,0,r.index0AttributeName):!0===r.morphTargets&&h.bindAttribLocation(_,0,"position"),h.linkProgram(_),e.debug.checkShaderErrors){let e=h.getProgramInfoLog(_).trim(),t=h.getShaderInfoLog(S).trim(),r=h.getShaderInfoLog(T).trim(),n=!0,s=!0;if(!1===h.getProgramParameter(_,35714)){n=!1;let t=ni(h,S,"vertex"),r=ni(h,T,"fragment");console.error("THREE.WebGLProgram: shader error: ",h.getError(),"35715",h.getProgramParameter(_,35715),"gl.getProgramInfoLog",e,t,r)}else""!==e?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",e):(""===t||""===r)&&(s=!1);s&&(this.diagnostics={runnable:n,programLog:e,vertexShader:{log:t,prefix:i},fragmentShader:{log:r,prefix:a}})}return h.deleteShader(S),h.deleteShader(T),this.getUniforms=function(){return void 0===s&&(s=new ne(h,_)),s},this.getAttributes=function(){return void 0===o&&(o=function(e,t){let r={},n=e.getProgramParameter(t,35721);for(let i=0;i<n;i++){let n=e.getActiveAttrib(t,i).name;r[n]=e.getAttribLocation(t,n)}return r}(h,_)),o},this.destroy=function(){n.releaseStatesOfProgram(this),h.deleteProgram(_),this.program=void 0},this.name=r.shaderName,this.id=nr++,this.cacheKey=t,this.usedTimes=1,this.program=_,this.vertexShader=S,this.fragmentShader=T,this}function nx(e,t,r,n,i,a){let s=[],o=n.isWebGL2,l=n.logarithmicDepthBuffer,u=n.floatVertexTextures,c=n.maxVertexUniforms,d=n.vertexTextures,p=n.precision,f={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},m=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmissionMap"];function g(e){let t;return e&&e.isTexture?t=e.encoding:e&&e.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),t=e.texture.encoding):t=3e3,t}return{getParameters:function(i,s,m,v,y){let x,_;let b=v.fog,w=i.isMeshStandardMaterial?v.environment:null,M=t.get(i.envMap||w),S=f[i.type],T=y.isSkinnedMesh?function(e){let t=e.skeleton.bones;if(u)return 1024;{let e=Math.min(Math.floor((c-20)/4),t.length);return e<t.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+t.length+" bones. This GPU supports "+e+"."),0):e}}(y):0;if(null!==i.precision&&(p=n.getMaxPrecision(i.precision))!==i.precision&&console.warn("THREE.WebGLProgram.getParameters:",i.precision,"not supported, using",p,"instead."),S){let e=re[S];x=e.vertexShader,_=e.fragmentShader}else x=i.vertexShader,_=i.fragmentShader;let E=e.getRenderTarget();return{isWebGL2:o,shaderID:S,shaderName:i.type,vertexShader:x,fragmentShader:_,defines:i.defines,isRawShaderMaterial:!0===i.isRawShaderMaterial,glslVersion:i.glslVersion,precision:p,instancing:!0===y.isInstancedMesh,instancingColor:!0===y.isInstancedMesh&&null!==y.instanceColor,supportsVertexTextures:d,outputEncoding:null!==E?g(E.texture):e.outputEncoding,map:!!i.map,mapEncoding:g(i.map),matcap:!!i.matcap,matcapEncoding:g(i.matcap),envMap:!!M,envMapMode:M&&M.mapping,envMapEncoding:g(M),envMapCubeUV:!!M&&(306===M.mapping||307===M.mapping),lightMap:!!i.lightMap,lightMapEncoding:g(i.lightMap),aoMap:!!i.aoMap,emissiveMap:!!i.emissiveMap,emissiveMapEncoding:g(i.emissiveMap),bumpMap:!!i.bumpMap,normalMap:!!i.normalMap,objectSpaceNormalMap:1===i.normalMapType,tangentSpaceNormalMap:i.normalMapType===L,clearcoatMap:!!i.clearcoatMap,clearcoatRoughnessMap:!!i.clearcoatRoughnessMap,clearcoatNormalMap:!!i.clearcoatNormalMap,displacementMap:!!i.displacementMap,roughnessMap:!!i.roughnessMap,metalnessMap:!!i.metalnessMap,specularMap:!!i.specularMap,alphaMap:!!i.alphaMap,gradientMap:!!i.gradientMap,sheen:!!i.sheen,transmissionMap:!!i.transmissionMap,combine:i.combine,vertexTangents:i.normalMap&&i.vertexTangents,vertexColors:i.vertexColors,vertexUvs:!!i.map||!!i.bumpMap||!!i.normalMap||!!i.specularMap||!!i.alphaMap||!!i.emissiveMap||!!i.roughnessMap||!!i.metalnessMap||!!i.clearcoatMap||!!i.clearcoatRoughnessMap||!!i.clearcoatNormalMap||!!i.displacementMap||!!i.transmissionMap,uvsVertexOnly:!(i.map||i.bumpMap||i.normalMap||i.specularMap||i.alphaMap||i.emissiveMap||i.roughnessMap||i.metalnessMap||i.clearcoatNormalMap||i.transmissionMap)&&!!i.displacementMap,fog:!!b,useFog:i.fog,fogExp2:b&&b.isFogExp2,flatShading:!!i.flatShading,sizeAttenuation:i.sizeAttenuation,logarithmicDepthBuffer:l,skinning:i.skinning&&T>0,maxBones:T,useVertexTexture:u,morphTargets:i.morphTargets,morphNormals:i.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:s.directional.length,numPointLights:s.point.length,numSpotLights:s.spot.length,numRectAreaLights:s.rectArea.length,numHemiLights:s.hemi.length,numDirLightShadows:s.directionalShadowMap.length,numPointLightShadows:s.pointShadowMap.length,numSpotLightShadows:s.spotShadowMap.length,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:i.dithering,shadowMapEnabled:e.shadowMap.enabled&&m.length>0,shadowMapType:e.shadowMap.type,toneMapping:i.toneMapped?e.toneMapping:0,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:i.premultipliedAlpha,alphaTest:i.alphaTest,doubleSided:i.side===h,flipSided:1===i.side,depthPacking:void 0!==i.depthPacking&&i.depthPacking,index0AttributeName:i.index0AttributeName,extensionDerivatives:i.extensions&&i.extensions.derivatives,extensionFragDepth:i.extensions&&i.extensions.fragDepth,extensionDrawBuffers:i.extensions&&i.extensions.drawBuffers,extensionShaderTextureLOD:i.extensions&&i.extensions.shaderTextureLOD,rendererExtensionFragDepth:o||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:o||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:o||r.has("EXT_shader_texture_lod"),customProgramCacheKey:i.customProgramCacheKey()}},getProgramCacheKey:function(t){let r=[];if(t.shaderID?r.push(t.shaderID):(r.push(t.fragmentShader),r.push(t.vertexShader)),void 0!==t.defines)for(let e in t.defines)r.push(e),r.push(t.defines[e]);if(!1===t.isRawShaderMaterial){for(let e=0;e<m.length;e++)r.push(t[m[e]]);r.push(e.outputEncoding),r.push(e.gammaFactor)}return r.push(t.customProgramCacheKey),r.join()},getUniforms:function(e){let t;let r=f[e.type];if(r){let e=re[r];t=tY.clone(e.uniforms)}else t=e.uniforms;return t},acquireProgram:function(t,r){let n;for(let e=0,t=s.length;e<t;e++){let t=s[e];if(t.cacheKey===r){n=t,++n.usedTimes;break}}return void 0===n&&(n=new ny(e,r,t,i),s.push(n)),n},releaseProgram:function(e){if(0==--e.usedTimes){let t=s.indexOf(e);s[t]=s[s.length-1],s.pop(),e.destroy()}},programs:s}}function n_(){let e=new WeakMap;return{get:function(t){let r=e.get(t);return void 0===r&&(r={},e.set(t,r)),r},remove:function(t){e.delete(t)},update:function(t,r,n){e.get(t)[r]=n},dispose:function(){e=new WeakMap}}}function nb(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function nw(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function nM(e){let t=[],r=0,n=[],i=[],a={id:-1};function s(n,i,s,o,l,h){let u=t[r],c=e.get(s);return void 0===u?(u={id:n.id,object:n,geometry:i,material:s,program:c.program||a,groupOrder:o,renderOrder:n.renderOrder,z:l,group:h},t[r]=u):(u.id=n.id,u.object=n,u.geometry=i,u.material=s,u.program=c.program||a,u.groupOrder=o,u.renderOrder=n.renderOrder,u.z=l,u.group=h),r++,u}return{opaque:n,transparent:i,init:function(){r=0,n.length=0,i.length=0},push:function(e,t,r,a,o,l){let h=s(e,t,r,a,o,l);(!0===r.transparent?i:n).push(h)},unshift:function(e,t,r,a,o,l){let h=s(e,t,r,a,o,l);(!0===r.transparent?i:n).unshift(h)},finish:function(){for(let e=r,n=t.length;e<n;e++){let r=t[e];if(null===r.id)break;r.id=null,r.object=null,r.geometry=null,r.material=null,r.program=null,r.group=null}},sort:function(e,t){n.length>1&&n.sort(e||nb),i.length>1&&i.sort(t||nw)}}}function nS(e){let t=new WeakMap;return{get:function(r,n){let i;return!1===t.has(r)?(i=new nM(e),t.set(r,[i])):n>=t.get(r).length?(i=new nM(e),t.get(r).push(i)):i=t.get(r)[n],i},dispose:function(){t=new WeakMap}}}function nT(){let e={};return{get:function(t){let r;if(void 0!==e[t.id])return e[t.id];switch(t.type){case"DirectionalLight":r={direction:new V,color:new tr};break;case"SpotLight":r={position:new V,direction:new V,color:new tr,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":r={position:new V,color:new tr,distance:0,decay:0};break;case"HemisphereLight":r={direction:new V,skyColor:new tr,groundColor:new tr};break;case"RectAreaLight":r={color:new tr,position:new V,halfWidth:new V,halfHeight:new V}}return e[t.id]=r,r}}}let nE=0;function nA(e,t){return(t.castShadow?1:0)-(e.castShadow?1:0)}function nL(e,t){let r=new nT,n=function(){let e={};return{get:function(t){let r;if(void 0!==e[t.id])return e[t.id];switch(t.type){case"DirectionalLight":case"SpotLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new O};break;case"PointLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new O,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=r,r}}}(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let e=0;e<9;e++)i.probe.push(new V);let a=new V,s=new ev,o=new ev;return{setup:function(a){let s=0,o=0,l=0;for(let e=0;e<9;e++)i.probe[e].set(0,0,0);let h=0,u=0,c=0,d=0,p=0,f=0,m=0,g=0;a.sort(nA);for(let e=0,t=a.length;e<t;e++){let t=a[e],v=t.color,y=t.intensity,x=t.distance,_=t.shadow&&t.shadow.map?t.shadow.map.texture:null;if(t.isAmbientLight)s+=v.r*y,o+=v.g*y,l+=v.b*y;else if(t.isLightProbe)for(let e=0;e<9;e++)i.probe[e].addScaledVector(t.sh.coefficients[e],y);else if(t.isDirectionalLight){let e=r.get(t);if(e.color.copy(t.color).multiplyScalar(t.intensity),t.castShadow){let e=t.shadow,r=n.get(t);r.shadowBias=e.bias,r.shadowNormalBias=e.normalBias,r.shadowRadius=e.radius,r.shadowMapSize=e.mapSize,i.directionalShadow[h]=r,i.directionalShadowMap[h]=_,i.directionalShadowMatrix[h]=t.shadow.matrix,f++}i.directional[h]=e,h++}else if(t.isSpotLight){let e=r.get(t);if(e.position.setFromMatrixPosition(t.matrixWorld),e.color.copy(v).multiplyScalar(y),e.distance=x,e.coneCos=Math.cos(t.angle),e.penumbraCos=Math.cos(t.angle*(1-t.penumbra)),e.decay=t.decay,t.castShadow){let e=t.shadow,r=n.get(t);r.shadowBias=e.bias,r.shadowNormalBias=e.normalBias,r.shadowRadius=e.radius,r.shadowMapSize=e.mapSize,i.spotShadow[c]=r,i.spotShadowMap[c]=_,i.spotShadowMatrix[c]=t.shadow.matrix,g++}i.spot[c]=e,c++}else if(t.isRectAreaLight){let e=r.get(t);e.color.copy(v).multiplyScalar(y),e.halfWidth.set(.5*t.width,0,0),e.halfHeight.set(0,.5*t.height,0),i.rectArea[d]=e,d++}else if(t.isPointLight){let e=r.get(t);if(e.color.copy(t.color).multiplyScalar(t.intensity),e.distance=t.distance,e.decay=t.decay,t.castShadow){let e=t.shadow,r=n.get(t);r.shadowBias=e.bias,r.shadowNormalBias=e.normalBias,r.shadowRadius=e.radius,r.shadowMapSize=e.mapSize,r.shadowCameraNear=e.camera.near,r.shadowCameraFar=e.camera.far,i.pointShadow[u]=r,i.pointShadowMap[u]=_,i.pointShadowMatrix[u]=t.shadow.matrix,m++}i.point[u]=e,u++}else if(t.isHemisphereLight){let e=r.get(t);e.skyColor.copy(t.color).multiplyScalar(y),e.groundColor.copy(t.groundColor).multiplyScalar(y),i.hemi[p]=e,p++}}d>0&&(t.isWebGL2?(i.rectAreaLTC1=t9.LTC_FLOAT_1,i.rectAreaLTC2=t9.LTC_FLOAT_2):!0===e.has("OES_texture_float_linear")?(i.rectAreaLTC1=t9.LTC_FLOAT_1,i.rectAreaLTC2=t9.LTC_FLOAT_2):!0===e.has("OES_texture_half_float_linear")?(i.rectAreaLTC1=t9.LTC_HALF_1,i.rectAreaLTC2=t9.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),i.ambient[0]=s,i.ambient[1]=o,i.ambient[2]=l;let v=i.hash;(v.directionalLength!==h||v.pointLength!==u||v.spotLength!==c||v.rectAreaLength!==d||v.hemiLength!==p||v.numDirectionalShadows!==f||v.numPointShadows!==m||v.numSpotShadows!==g)&&(i.directional.length=h,i.spot.length=c,i.rectArea.length=d,i.point.length=u,i.hemi.length=p,i.directionalShadow.length=f,i.directionalShadowMap.length=f,i.pointShadow.length=m,i.pointShadowMap.length=m,i.spotShadow.length=g,i.spotShadowMap.length=g,i.directionalShadowMatrix.length=f,i.pointShadowMatrix.length=m,i.spotShadowMatrix.length=g,v.directionalLength=h,v.pointLength=u,v.spotLength=c,v.rectAreaLength=d,v.hemiLength=p,v.numDirectionalShadows=f,v.numPointShadows=m,v.numSpotShadows=g,i.version=nE++)},setupView:function(e,t){let r=0,n=0,l=0,h=0,u=0,c=t.matrixWorldInverse;for(let t=0,d=e.length;t<d;t++){let d=e[t];if(d.isDirectionalLight){let e=i.directional[r];e.direction.setFromMatrixPosition(d.matrixWorld),a.setFromMatrixPosition(d.target.matrixWorld),e.direction.sub(a),e.direction.transformDirection(c),r++}else if(d.isSpotLight){let e=i.spot[l];e.position.setFromMatrixPosition(d.matrixWorld),e.position.applyMatrix4(c),e.direction.setFromMatrixPosition(d.matrixWorld),a.setFromMatrixPosition(d.target.matrixWorld),e.direction.sub(a),e.direction.transformDirection(c),l++}else if(d.isRectAreaLight){let e=i.rectArea[h];e.position.setFromMatrixPosition(d.matrixWorld),e.position.applyMatrix4(c),o.identity(),s.copy(d.matrixWorld),s.premultiply(c),o.extractRotation(s),e.halfWidth.set(.5*d.width,0,0),e.halfHeight.set(0,.5*d.height,0),e.halfWidth.applyMatrix4(o),e.halfHeight.applyMatrix4(o),h++}else if(d.isPointLight){let e=i.point[n];e.position.setFromMatrixPosition(d.matrixWorld),e.position.applyMatrix4(c),n++}else if(d.isHemisphereLight){let e=i.hemi[u];e.direction.setFromMatrixPosition(d.matrixWorld),e.direction.transformDirection(c),e.direction.normalize(),u++}}},state:i}}function nR(e,t){let r=new nL(e,t),n=[],i=[];return{init:function(){n.length=0,i.length=0},state:{lightsArray:n,shadowsArray:i,lights:r},setupLights:function(){r.setup(n)},setupLightsView:function(e){r.setupView(n,e)},pushLight:function(e){n.push(e)},pushShadow:function(e){i.push(e)}}}function nP(e,t){let r=new WeakMap;return{get:function(n,i=0){let a;return!1===r.has(n)?(a=new nR(e,t),r.set(n,[a])):i>=r.get(n).length?(a=new nR(e,t),r.get(n).push(a)):a=r.get(n)[i],a},dispose:function(){r=new WeakMap}}}class nC extends e5{constructor(e){super(),this.type="MeshDepthMaterial",this.depthPacking=3200,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}nC.prototype.isMeshDepthMaterial=!0;class nI extends e5{constructor(e){super(),this.type="MeshDistanceMaterial",this.referencePosition=new V,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function nD(e,t,r){let n=new t4,i=new O,a=new O,s=new z,o=[],u=[],c={},d={0:1,1:l,2:h},p=new tZ({defines:{SAMPLE_RATE:.25,HALF_SAMPLE_RATE:.125},uniforms:{shadow_pass:{value:null},resolution:{value:new O},radius:{value:4}},vertexShader:"void main() {\n	gl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n	float mean = 0.0;\n	float squared_mean = 0.0;\n	float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );\n	for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n		#ifdef HORIZONTAL_PASS\n			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n			mean += distribution.x;\n			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n		#else\n			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );\n			mean += depth;\n			squared_mean += depth * depth;\n		#endif\n	}\n	mean = mean * HALF_SAMPLE_RATE;\n	squared_mean = squared_mean * HALF_SAMPLE_RATE;\n	float std_dev = sqrt( squared_mean - mean * mean );\n	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),m=p.clone();m.defines.HORIZONTAL_PASS=1;let g=new tT;g.setAttribute("position",new ts(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let y=new tV(g,p),x=this;function _(e,t,r){let n=e<<0|t<<1|r<<2,i=o[n];return void 0===i&&(i=new nC({depthPacking:A,morphTargets:e,skinning:t}),o[n]=i),i}function w(e,t,r){let n=e<<0|t<<1|r<<2,i=u[n];return void 0===i&&(i=new nI({morphTargets:e,skinning:t}),u[n]=i),i}function M(t,r,n,i,a,s,o){let l=null,h=_,u=t.customDepthMaterial;if(!0===i.isPointLight&&(h=w,u=t.customDistanceMaterial),void 0===u){let e=!1;!0===n.morphTargets&&(e=r.morphAttributes&&r.morphAttributes.position&&r.morphAttributes.position.length>0);let i=!1;!0===t.isSkinnedMesh&&(!0===n.skinning?i=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",t)),l=h(e,i,!0===t.isInstancedMesh)}else l=u;if(e.localClippingEnabled&&!0===n.clipShadows&&0!==n.clippingPlanes.length){let e=l.uuid,t=n.uuid,r=c[e];void 0===r&&(r={},c[e]=r);let i=r[t];void 0===i&&(i=l.clone(),r[t]=i),l=i}return l.visible=n.visible,l.wireframe=n.wireframe,3===o?l.side=null!==n.shadowSide?n.shadowSide:n.side:l.side=null!==n.shadowSide?n.shadowSide:d[n.side],l.clipShadows=n.clipShadows,l.clippingPlanes=n.clippingPlanes,l.clipIntersection=n.clipIntersection,l.wireframeLinewidth=n.wireframeLinewidth,l.linewidth=n.linewidth,!0===i.isPointLight&&!0===l.isMeshDistanceMaterial&&(l.referencePosition.setFromMatrixPosition(i.matrixWorld),l.nearDistance=a,l.farDistance=s),l}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(o,l,h){if(!1===x.enabled||!1===x.autoUpdate&&!1===x.needsUpdate||0===o.length)return;let u=e.getRenderTarget(),c=e.getActiveCubeFace(),d=e.getActiveMipmapLevel(),g=e.state;g.setBlending(0),g.buffers.color.setClear(1,1,1,1),g.buffers.depth.setTest(!0),g.setScissorTest(!1);for(let u=0,c=o.length;u<c;u++){let c=o[u],d=c.shadow;if(void 0===d){console.warn("THREE.WebGLShadowMap:",c,"has no shadow.");continue}if(!1===d.autoUpdate&&!1===d.needsUpdate)continue;i.copy(d.mapSize);let x=d.getFrameExtents();if(i.multiply(x),a.copy(d.mapSize),(i.x>r||i.y>r)&&(i.x>r&&(a.x=Math.floor(r/x.x),i.x=a.x*x.x,d.mapSize.x=a.x),i.y>r&&(a.y=Math.floor(r/x.y),i.y=a.y*x.y,d.mapSize.y=a.y)),null===d.map&&!d.isPointLightShadow&&3===this.type){let e={minFilter:v,magFilter:v,format:b};d.map=new H(i.x,i.y,e),d.map.texture.name=c.name+".shadowMap",d.mapPass=new H(i.x,i.y,e),d.camera.updateProjectionMatrix()}if(null===d.map){let e={minFilter:f,magFilter:f,format:b};d.map=new H(i.x,i.y,e),d.map.texture.name=c.name+".shadowMap",d.camera.updateProjectionMatrix()}e.setRenderTarget(d.map),e.clear();let _=d.getViewportCount();for(let r=0;r<_;r++){let i=d.getViewport(r);s.set(a.x*i.x,a.y*i.y,a.x*i.z,a.y*i.w),g.viewport(s),d.updateMatrices(c,r),n=d.getFrustum(),function r(i,a,s,o,l){if(!1===i.visible)return;if(i.layers.test(a.layers)&&(i.isMesh||i.isLine||i.isPoints)&&(i.castShadow||i.receiveShadow&&3===l)&&(!i.frustumCulled||n.intersectsObject(i))){i.modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,i.matrixWorld);let r=t.update(i),n=i.material;if(Array.isArray(n)){let t=r.groups;for(let a=0,h=t.length;a<h;a++){let h=t[a],u=n[h.materialIndex];if(u&&u.visible){let t=M(i,r,u,o,s.near,s.far,l);e.renderBufferDirect(s,null,r,t,i,h)}}}else if(n.visible){let t=M(i,r,n,o,s.near,s.far,l);e.renderBufferDirect(s,null,r,t,i,null)}}let h=i.children;for(let e=0,t=h.length;e<t;e++)r(h[e],a,s,o,l)}(l,h,d.camera,c,this.type)}d.isPointLightShadow||3!==this.type||function(r,n){let i=t.update(y);p.uniforms.shadow_pass.value=r.map.texture,p.uniforms.resolution.value=r.mapSize,p.uniforms.radius.value=r.radius,e.setRenderTarget(r.mapPass),e.clear(),e.renderBufferDirect(n,null,i,p,y,null),m.uniforms.shadow_pass.value=r.mapPass.texture,m.uniforms.resolution.value=r.mapSize,m.uniforms.radius.value=r.radius,e.setRenderTarget(r.map),e.clear(),e.renderBufferDirect(n,null,i,m,y,null)}(d,h),d.needsUpdate=!1}x.needsUpdate=!1,e.setRenderTarget(u,c,d)}}function nO(e,t,r){let n=r.isWebGL2,i=new function(){let t=!1,r=new z,n=null,i=new z(0,0,0,0);return{setMask:function(r){n===r||t||(e.colorMask(r,r,r,r),n=r)},setLocked:function(e){t=e},setClear:function(t,n,a,s,o){!0===o&&(t*=s,n*=s,a*=s),r.set(t,n,a,s),!1===i.equals(r)&&(e.clearColor(t,n,a,s),i.copy(r))},reset:function(){t=!1,n=null,i.set(-1,0,0,0)}}},a=new function(){let t=!1,r=null,n=null,i=null;return{setTest:function(e){e?O(2929):U(2929)},setMask:function(n){r===n||t||(e.depthMask(n),r=n)},setFunc:function(t){if(n!==t){if(t)switch(t){case 0:e.depthFunc(512);break;case 1:e.depthFunc(519);break;case 2:e.depthFunc(513);break;case 3:default:e.depthFunc(515);break;case 4:e.depthFunc(514);break;case 5:e.depthFunc(518);break;case 6:e.depthFunc(516);break;case 7:e.depthFunc(517)}else e.depthFunc(515);n=t}},setLocked:function(e){t=e},setClear:function(t){i!==t&&(e.clearDepth(t),i=t)},reset:function(){t=!1,r=null,n=null,i=null}}},s=new function(){let t=!1,r=null,n=null,i=null,a=null,s=null,o=null,l=null,h=null;return{setTest:function(e){t||(e?O(2960):U(2960))},setMask:function(n){r===n||t||(e.stencilMask(n),r=n)},setFunc:function(t,r,s){(n!==t||i!==r||a!==s)&&(e.stencilFunc(t,r,s),n=t,i=r,a=s)},setOp:function(t,r,n){(s!==t||o!==r||l!==n)&&(e.stencilOp(t,r,n),s=t,o=r,l=n)},setLocked:function(e){t=e},setClear:function(t){h!==t&&(e.clearStencil(t),h=t)},reset:function(){t=!1,r=null,n=null,i=null,a=null,s=null,o=null,l=null,h=null}}},o={},l=null,c=!1,d=null,p=null,f=null,m=null,g=null,v=null,y=null,x=!1,_=null,b=null,w=null,M=null,S=null,T=e.getParameter(35661),E=!1,A=e.getParameter(7938);-1!==A.indexOf("WebGL")?E=parseFloat(/^WebGL (\d)/.exec(A)[1])>=1:-1!==A.indexOf("OpenGL ES")&&(E=parseFloat(/^OpenGL ES (\d)/.exec(A)[1])>=2);let L=null,R={},P=new z,C=new z;function I(t,r,n){let i=new Uint8Array(4),a=e.createTexture();e.bindTexture(t,a),e.texParameteri(t,10241,9728),e.texParameteri(t,10240,9728);for(let t=0;t<n;t++)e.texImage2D(r+t,0,6408,1,1,0,6408,5121,i);return a}let D={};function O(t){!0!==o[t]&&(e.enable(t),o[t]=!0)}function U(t){!1!==o[t]&&(e.disable(t),o[t]=!1)}D[3553]=I(3553,3553,1),D[34067]=I(34067,34069,6),i.setClear(0,0,0,1),a.setClear(1),s.setClear(0),O(2929),a.setFunc(3),B(!1),H(1),O(2884),F(0);let N={100:32774,101:32778,102:32779};if(n)N[103]=32775,N[104]=32776;else{let e=t.get("EXT_blend_minmax");null!==e&&(N[103]=e.MIN_EXT,N[104]=e.MAX_EXT)}let k={200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773};function F(t,r,n,i,a,s,o,l){if(0===t){!0===c&&(U(3042),c=!1);return}if(!1===c&&(O(3042),c=!0),5!==t){if(t!==d||l!==x){if((100!==p||100!==g)&&(e.blendEquation(32774),p=100,g=100),l)switch(t){case 1:e.blendFuncSeparate(1,771,1,771);break;case u:e.blendFunc(1,1);break;case 3:e.blendFuncSeparate(0,0,769,771);break;case 4:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case 1:e.blendFuncSeparate(770,771,1,771);break;case u:e.blendFunc(770,1);break;case 3:e.blendFunc(0,769);break;case 4:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}f=null,m=null,v=null,y=null,d=t,x=l}return}a=a||r,s=s||n,o=o||i,(r!==p||a!==g)&&(e.blendEquationSeparate(N[r],N[a]),p=r,g=a),(n!==f||i!==m||s!==v||o!==y)&&(e.blendFuncSeparate(k[n],k[i],k[s],k[o]),f=n,m=i,v=s,y=o),d=t,x=null}function B(t){_!==t&&(t?e.frontFace(2304):e.frontFace(2305),_=t)}function H(t){0!==t?(O(2884),t!==b&&(1===t?e.cullFace(1029):2===t?e.cullFace(1028):e.cullFace(1032))):U(2884),b=t}function G(t,r,n){t?(O(32823),(M!==r||S!==n)&&(e.polygonOffset(r,n),M=r,S=n)):U(32823)}function V(t){void 0===t&&(t=33984+T-1),L!==t&&(e.activeTexture(t),L=t)}return{buffers:{color:i,depth:a,stencil:s},enable:O,disable:U,useProgram:function(t){return l!==t&&(e.useProgram(t),l=t,!0)},setBlending:F,setMaterial:function(e,t){e.side===h?U(2884):O(2884);let r=1===e.side;t&&(r=!r),B(r),1===e.blending&&!1===e.transparent?F(0):F(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),a.setFunc(e.depthFunc),a.setTest(e.depthTest),a.setMask(e.depthWrite),i.setMask(e.colorWrite);let n=e.stencilWrite;s.setTest(n),n&&(s.setMask(e.stencilWriteMask),s.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),s.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),G(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)},setFlipSided:B,setCullFace:H,setLineWidth:function(t){t!==w&&(E&&e.lineWidth(t),w=t)},setPolygonOffset:G,setScissorTest:function(e){e?O(3089):U(3089)},activeTexture:V,bindTexture:function(t,r){null===L&&V();let n=R[L];void 0===n&&(n={type:void 0,texture:void 0},R[L]=n),(n.type!==t||n.texture!==r)&&(e.bindTexture(t,r||D[t]),n.type=t,n.texture=r)},unbindTexture:function(){let t=R[L];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(t){!1===P.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),P.copy(t))},viewport:function(t){!1===C.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),C.copy(t))},reset:function(){e.disable(3042),e.disable(2884),e.disable(2929),e.disable(32823),e.disable(3089),e.disable(2960),e.blendEquation(32774),e.blendFunc(1,0),e.blendFuncSeparate(1,0,1,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(513),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(519,0,4294967295),e.stencilOp(7680,7680,7680),e.clearStencil(0),e.cullFace(1029),e.frontFace(2305),e.polygonOffset(0,0),e.activeTexture(33984),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),o={},L=null,R={},l=null,c=!1,d=null,p=null,f=null,m=null,g=null,v=null,y=null,x=!1,_=null,b=null,w=null,M=null,S=null,i.reset(),a.reset(),s.reset()}}}function nU(e,t,r,n,i,a,s){let o;let l=i.isWebGL2,h=i.maxTextures,u=i.maxCubemapSize,w=i.maxTextureSize,M=i.maxSamples,S=new WeakMap,T=!1;try{T="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(e){}function E(e,t){return T?new OffscreenCanvas(e,t):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function A(e,t,r,n){let i=1;if((e.width>n||e.height>n)&&(i=n/Math.max(e.width,e.height)),i<1||!0===t){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){let n=t?D.floorPowerOfTwo:Math.floor,a=n(i*e.width),s=n(i*e.height);void 0===o&&(o=E(a,s));let l=r?E(a,s):o;return l.width=a,l.height=s,l.getContext("2d").drawImage(e,0,0,a,s),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+a+"x"+s+")."),l}"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+").")}return e}function L(e){return D.isPowerOfTwo(e.width)&&D.isPowerOfTwo(e.height)}function R(e,t){return e.generateMipmaps&&t&&e.minFilter!==f&&e.minFilter!==v}function P(t,r,i,a){e.generateMipmap(t),n.get(r).__maxMipLevel=Math.log2(Math.max(i,a))}function C(r,n,i){if(!1===l)return n;if(null!==r){if(void 0!==e[r])return e[r];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+r+"'")}let a=n;return 6403===n&&(5126===i&&(a=33326),5131===i&&(a=33325),5121===i&&(a=33321)),6407===n&&(5126===i&&(a=34837),5131===i&&(a=34843),5121===i&&(a=32849)),6408===n&&(5126===i&&(a=34836),5131===i&&(a=34842),5121===i&&(a=32856)),(33325===a||33326===a||34842===a||34836===a)&&t.get("EXT_color_buffer_float"),a}function I(e){return e===f||e===m||e===g?9728:9729}function O(t){let r=t.target;r.removeEventListener("dispose",O),function(t){let r=n.get(t);void 0!==r.__webglInit&&(e.deleteTexture(r.__webglTexture),n.remove(t))}(r),r.isVideoTexture&&S.delete(r),s.memory.textures--}function U(t){let r=t.target;r.removeEventListener("dispose",U),function(t){let r=t.texture,i=n.get(t),a=n.get(r);if(t){if(void 0!==a.__webglTexture&&e.deleteTexture(a.__webglTexture),t.depthTexture&&t.depthTexture.dispose(),t.isWebGLCubeRenderTarget)for(let t=0;t<6;t++)e.deleteFramebuffer(i.__webglFramebuffer[t]),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer[t]);else e.deleteFramebuffer(i.__webglFramebuffer),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer),i.__webglMultisampledFramebuffer&&e.deleteFramebuffer(i.__webglMultisampledFramebuffer),i.__webglColorRenderbuffer&&e.deleteRenderbuffer(i.__webglColorRenderbuffer),i.__webglDepthRenderbuffer&&e.deleteRenderbuffer(i.__webglDepthRenderbuffer);n.remove(r),n.remove(t)}}(r),s.memory.textures--}let N=0;function k(e,t){let i=n.get(e);if(e.isVideoTexture&&function(e){let t=s.render.frame;S.get(e)!==t&&(S.set(e,t),e.update())}(e),e.version>0&&i.__version!==e.version){let r=e.image;if(void 0===r)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if(!1===r.complete)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{V(i,e,t);return}}r.activeTexture(33984+t),r.bindTexture(3553,i.__webglTexture)}function F(t,i){let s=n.get(t);if(t.version>0&&s.__version!==t.version){(function(t,n,i){let s;if(6!==n.image.length)return;G(t,n),r.activeTexture(33984+i),r.bindTexture(34067,t.__webglTexture),e.pixelStorei(37440,n.flipY),e.pixelStorei(37441,n.premultiplyAlpha),e.pixelStorei(3317,n.unpackAlignment),e.pixelStorei(37443,0);let o=n&&(n.isCompressedTexture||n.image[0].isCompressedTexture),h=n.image[0]&&n.image[0].isDataTexture,c=[];for(let e=0;e<6;e++)o||h?c[e]=h?n.image[e].image:n.image[e]:c[e]=A(n.image[e],!1,!0,u);let d=c[0],p=L(d)||l,f=a.convert(n.format),m=a.convert(n.type),g=C(n.internalFormat,f,m);if(H(34067,n,p),o){for(let e=0;e<6;e++){s=c[e].mipmaps;for(let t=0;t<s.length;t++){let i=s[t];n.format!==b&&n.format!==_?null!==f?r.compressedTexImage2D(34069+e,t,g,i.width,i.height,0,i.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):r.texImage2D(34069+e,t,g,i.width,i.height,0,f,m,i.data)}}t.__maxMipLevel=s.length-1}else{s=n.mipmaps;for(let e=0;e<6;e++)if(h){r.texImage2D(34069+e,0,g,c[e].width,c[e].height,0,f,m,c[e].data);for(let t=0;t<s.length;t++){let n=s[t].image[e].image;r.texImage2D(34069+e,t+1,g,n.width,n.height,0,f,m,n.data)}}else{r.texImage2D(34069+e,0,g,f,m,c[e]);for(let t=0;t<s.length;t++){let n=s[t];r.texImage2D(34069+e,t+1,g,f,m,n.image[e])}}t.__maxMipLevel=s.length}R(n,p)&&P(34067,n,d.width,d.height),t.__version=n.version,n.onUpdate&&n.onUpdate(n)})(s,t,i);return}r.activeTexture(33984+i),r.bindTexture(34067,s.__webglTexture)}let B={[c]:10497,[d]:33071,[p]:33648},z={[f]:9728,[m]:9984,[g]:9986,[v]:9729,[y]:9985,[x]:9987};function H(r,a,s){if(s?(e.texParameteri(r,10242,B[a.wrapS]),e.texParameteri(r,10243,B[a.wrapT]),(32879===r||35866===r)&&e.texParameteri(r,32882,B[a.wrapR]),e.texParameteri(r,10240,z[a.magFilter]),e.texParameteri(r,10241,z[a.minFilter])):(e.texParameteri(r,10242,33071),e.texParameteri(r,10243,33071),(32879===r||35866===r)&&e.texParameteri(r,32882,33071),(a.wrapS!==d||a.wrapT!==d)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(r,10240,I(a.magFilter)),e.texParameteri(r,10241,I(a.minFilter)),a.minFilter!==f&&a.minFilter!==v&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===t.has("EXT_texture_filter_anisotropic")){let s=t.get("EXT_texture_filter_anisotropic");(1015!==a.type||!1!==t.has("OES_texture_float_linear"))&&(!1!==l||1016!==a.type||!1!==t.has("OES_texture_half_float_linear"))&&(a.anisotropy>1||n.get(a).__currentAnisotropy)&&(e.texParameterf(r,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,i.getMaxAnisotropy())),n.get(a).__currentAnisotropy=a.anisotropy)}}function G(t,r){void 0===t.__webglInit&&(t.__webglInit=!0,r.addEventListener("dispose",O),t.__webglTexture=e.createTexture(),s.memory.textures++)}function V(t,n,i){let s,o=3553;n.isDataTexture2DArray&&(o=35866),n.isDataTexture3D&&(o=32879),G(t,n),r.activeTexture(33984+i),r.bindTexture(o,t.__webglTexture),e.pixelStorei(37440,n.flipY),e.pixelStorei(37441,n.premultiplyAlpha),e.pixelStorei(3317,n.unpackAlignment),e.pixelStorei(37443,0);let h=!l&&(n.wrapS!==d||n.wrapT!==d||n.minFilter!==f&&n.minFilter!==v)&&!1===L(n.image),u=A(n.image,h,!1,w),c=L(u)||l,p=a.convert(n.format),m=a.convert(n.type),g=C(n.internalFormat,p,m);H(o,n,c);let y=n.mipmaps;if(n.isDepthTexture)g=6402,l?g=1015===n.type?36012:1014===n.type?33190:1020===n.type?35056:33189:1015===n.type&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),1026===n.format&&6402===g&&1012!==n.type&&1014!==n.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),n.type=1012,m=a.convert(n.type)),1027===n.format&&6402===g&&(g=34041,1020!==n.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),n.type=1020,m=a.convert(n.type))),r.texImage2D(3553,0,g,u.width,u.height,0,p,m,null);else if(n.isDataTexture){if(y.length>0&&c){for(let e=0,t=y.length;e<t;e++)s=y[e],r.texImage2D(3553,e,g,s.width,s.height,0,p,m,s.data);n.generateMipmaps=!1,t.__maxMipLevel=y.length-1}else r.texImage2D(3553,0,g,u.width,u.height,0,p,m,u.data),t.__maxMipLevel=0}else if(n.isCompressedTexture){for(let e=0,t=y.length;e<t;e++)s=y[e],n.format!==b&&n.format!==_?null!==p?r.compressedTexImage2D(3553,e,g,s.width,s.height,0,s.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):r.texImage2D(3553,e,g,s.width,s.height,0,p,m,s.data);t.__maxMipLevel=y.length-1}else if(n.isDataTexture2DArray)r.texImage3D(35866,0,g,u.width,u.height,u.depth,0,p,m,u.data),t.__maxMipLevel=0;else if(n.isDataTexture3D)r.texImage3D(32879,0,g,u.width,u.height,u.depth,0,p,m,u.data),t.__maxMipLevel=0;else if(y.length>0&&c){for(let e=0,t=y.length;e<t;e++)s=y[e],r.texImage2D(3553,e,g,p,m,s);n.generateMipmaps=!1,t.__maxMipLevel=y.length-1}else r.texImage2D(3553,0,g,p,m,u),t.__maxMipLevel=0;R(n,c)&&P(o,n,u.width,u.height),t.__version=n.version,n.onUpdate&&n.onUpdate(n)}function W(t,i,s,o){let l=i.texture,h=a.convert(l.format),u=a.convert(l.type),c=C(l.internalFormat,h,u);32879===o||35866===o?r.texImage3D(o,0,c,i.width,i.height,i.depth,0,h,u,null):r.texImage2D(o,0,c,i.width,i.height,0,h,u,null),e.bindFramebuffer(36160,t),e.framebufferTexture2D(36160,s,o,n.get(l).__webglTexture,0),e.bindFramebuffer(36160,null)}function j(t,r,n){if(e.bindRenderbuffer(36161,t),r.depthBuffer&&!r.stencilBuffer){let i=33189;if(n){let t=r.depthTexture;t&&t.isDepthTexture&&(1015===t.type?i=36012:1014===t.type&&(i=33190));let n=q(r);e.renderbufferStorageMultisample(36161,n,i,r.width,r.height)}else e.renderbufferStorage(36161,i,r.width,r.height);e.framebufferRenderbuffer(36160,36096,36161,t)}else if(r.depthBuffer&&r.stencilBuffer){if(n){let t=q(r);e.renderbufferStorageMultisample(36161,t,35056,r.width,r.height)}else e.renderbufferStorage(36161,34041,r.width,r.height);e.framebufferRenderbuffer(36160,33306,36161,t)}else{let t=r.texture,i=a.convert(t.format),s=a.convert(t.type),o=C(t.internalFormat,i,s);if(n){let t=q(r);e.renderbufferStorageMultisample(36161,t,o,r.width,r.height)}else e.renderbufferStorage(36161,o,r.width,r.height)}e.bindRenderbuffer(36161,null)}function q(e){return l&&e.isWebGLMultisampleRenderTarget?Math.min(M,e.samples):0}let X=!1,Y=!1;this.allocateTextureUnit=function(){let e=N;return e>=h&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+h),N+=1,e},this.resetTextureUnits=function(){N=0},this.setTexture2D=k,this.setTexture2DArray=function(e,t){let i=n.get(e);if(e.version>0&&i.__version!==e.version){V(i,e,t);return}r.activeTexture(33984+t),r.bindTexture(35866,i.__webglTexture)},this.setTexture3D=function(e,t){let i=n.get(e);if(e.version>0&&i.__version!==e.version){V(i,e,t);return}r.activeTexture(33984+t),r.bindTexture(32879,i.__webglTexture)},this.setTextureCube=F,this.setupRenderTarget=function(t){let i=t.texture,o=n.get(t),h=n.get(i);t.addEventListener("dispose",U),h.__webglTexture=e.createTexture(),s.memory.textures++;let u=!0===t.isWebGLCubeRenderTarget,c=!0===t.isWebGLMultisampleRenderTarget,d=i.isDataTexture3D||i.isDataTexture2DArray,p=L(t)||l;if(l&&i.format===_&&(1015===i.type||1016===i.type)&&(i.format=b,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),u){o.__webglFramebuffer=[];for(let t=0;t<6;t++)o.__webglFramebuffer[t]=e.createFramebuffer()}else if(o.__webglFramebuffer=e.createFramebuffer(),c){if(l){o.__webglMultisampledFramebuffer=e.createFramebuffer(),o.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,o.__webglColorRenderbuffer);let r=a.convert(i.format),n=a.convert(i.type),s=C(i.internalFormat,r,n),l=q(t);e.renderbufferStorageMultisample(36161,l,s,t.width,t.height),e.bindFramebuffer(36160,o.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064,36161,o.__webglColorRenderbuffer),e.bindRenderbuffer(36161,null),t.depthBuffer&&(o.__webglDepthRenderbuffer=e.createRenderbuffer(),j(o.__webglDepthRenderbuffer,t,!0)),e.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")}if(u){r.bindTexture(34067,h.__webglTexture),H(34067,i,p);for(let e=0;e<6;e++)W(o.__webglFramebuffer[e],t,36064,34069+e);R(i,p)&&P(34067,i,t.width,t.height),r.bindTexture(34067,null)}else{let e=3553;d&&(l?e=i.isDataTexture3D?32879:35866:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),r.bindTexture(e,h.__webglTexture),H(e,i,p),W(o.__webglFramebuffer,t,36064,e),R(i,p)&&P(3553,i,t.width,t.height),r.bindTexture(3553,null)}t.depthBuffer&&function(t){let r=n.get(t),i=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture){if(i)throw Error("target.depthTexture not supported in Cube render targets");!function(t,r){if(r&&r.isWebGLCubeRenderTarget)throw Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(36160,t),!(r.depthTexture&&r.depthTexture.isDepthTexture))throw Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");n.get(r.depthTexture).__webglTexture&&r.depthTexture.image.width===r.width&&r.depthTexture.image.height===r.height||(r.depthTexture.image.width=r.width,r.depthTexture.image.height=r.height,r.depthTexture.needsUpdate=!0),k(r.depthTexture,0);let i=n.get(r.depthTexture).__webglTexture;if(1026===r.depthTexture.format)e.framebufferTexture2D(36160,36096,3553,i,0);else if(1027===r.depthTexture.format)e.framebufferTexture2D(36160,33306,3553,i,0);else throw Error("Unknown depthTexture format")}(r.__webglFramebuffer,t)}else if(i){r.__webglDepthbuffer=[];for(let n=0;n<6;n++)e.bindFramebuffer(36160,r.__webglFramebuffer[n]),r.__webglDepthbuffer[n]=e.createRenderbuffer(),j(r.__webglDepthbuffer[n],t,!1)}else e.bindFramebuffer(36160,r.__webglFramebuffer),r.__webglDepthbuffer=e.createRenderbuffer(),j(r.__webglDepthbuffer,t,!1);e.bindFramebuffer(36160,null)}(t)},this.updateRenderTargetMipmap=function(e){let t=e.texture;if(R(t,L(e)||l)){let i=e.isWebGLCubeRenderTarget?34067:3553,a=n.get(t).__webglTexture;r.bindTexture(i,a),P(i,t,e.width,e.height),r.bindTexture(i,null)}},this.updateMultisampleRenderTarget=function(t){if(t.isWebGLMultisampleRenderTarget){if(l){let r=n.get(t);e.bindFramebuffer(36008,r.__webglMultisampledFramebuffer),e.bindFramebuffer(36009,r.__webglFramebuffer);let i=t.width,a=t.height,s=16384;t.depthBuffer&&(s|=256),t.stencilBuffer&&(s|=1024),e.blitFramebuffer(0,0,i,a,0,0,i,a,s,9728),e.bindFramebuffer(36160,r.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")}},this.safeSetTexture2D=function(e,t){e&&e.isWebGLRenderTarget&&(!1===X&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),X=!0),e=e.texture),k(e,t)},this.safeSetTextureCube=function(e,t){e&&e.isWebGLCubeRenderTarget&&(!1===Y&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),Y=!0),e=e.texture),F(e,t)}}function nN(e,t,r){let n=r.isWebGL2;return{convert:function(e){let r;if(1009===e)return 5121;if(1017===e)return 32819;if(1018===e)return 32820;if(1019===e)return 33635;if(1010===e)return 5120;if(1011===e)return 5122;if(1012===e)return 5123;if(1013===e)return 5124;if(1014===e)return 5125;if(1015===e)return 5126;if(1016===e)return n?5131:null!==(r=t.get("OES_texture_half_float"))?r.HALF_FLOAT_OES:null;if(1021===e)return 6406;if(e===_)return 6407;if(e===b)return 6408;if(1024===e)return 6409;if(1025===e)return 6410;if(1026===e)return 6402;if(1027===e)return 34041;if(1028===e)return 6403;if(1029===e)return 36244;if(1030===e)return 33319;if(1031===e)return 33320;if(1032===e)return 36248;if(1033===e)return 36249;if(33776===e||33777===e||33778===e||33779===e){if(null===(r=t.get("WEBGL_compressed_texture_s3tc")))return null;if(33776===e)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===e)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===e)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===e)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===e||35841===e||35842===e||35843===e){if(null===(r=t.get("WEBGL_compressed_texture_pvrtc")))return null;if(35840===e)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===e)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===e)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===e)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===e)return null!==(r=t.get("WEBGL_compressed_texture_etc1"))?r.COMPRESSED_RGB_ETC1_WEBGL:null;if((37492===e||37496===e)&&null!==(r=t.get("WEBGL_compressed_texture_etc"))){if(37492===e)return r.COMPRESSED_RGB8_ETC2;if(37496===e)return r.COMPRESSED_RGBA8_ETC2_EAC}return 37808===e||37809===e||37810===e||37811===e||37812===e||37813===e||37814===e||37815===e||37816===e||37817===e||37818===e||37819===e||37820===e||37821===e||37840===e||37841===e||37842===e||37843===e||37844===e||37845===e||37846===e||37847===e||37848===e||37849===e||37850===e||37851===e||37852===e||37853===e?null!==(r=t.get("WEBGL_compressed_texture_astc"))?e:null:36492===e?null!==(r=t.get("EXT_texture_compression_bptc"))?e:null:1020===e?n?34042:null!==(r=t.get("WEBGL_depth_texture"))?r.UNSIGNED_INT_24_8_WEBGL:null:void 0}}}function nk(e=[]){tK.call(this),this.cameras=e}nI.prototype.isMeshDistanceMaterial=!0,nk.prototype=Object.assign(Object.create(tK.prototype),{constructor:nk,isArrayCamera:!0});class nF extends eG{constructor(){super(),this.type="Group"}}function nB(){this._targetRay=null,this._grip=null,this._hand=null}function nz(e,t){let r=this,n=null,i=1,a=null,s="local-floor",o=null,l=[],h=new Map,u=new tK;u.layers.enable(1),u.viewport=new z;let c=new tK;c.layers.enable(2),c.viewport=new z;let d=[u,c],p=new nk;p.layers.enable(1),p.layers.enable(2);let f=null,m=null;function g(e){let t=h.get(e.inputSource);t&&t.dispatchEvent({type:e.type,data:e.inputSource})}function v(){h.forEach(function(e,t){e.disconnect(t)}),h.clear(),f=null,m=null,e.setFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),M.stop(),r.isPresenting=!1,r.dispatchEvent({type:"sessionend"})}function y(e){let t=n.inputSources;for(let e=0;e<l.length;e++)h.set(t[e],l[e]);for(let t=0;t<e.removed.length;t++){let r=e.removed[t],n=h.get(r);n&&(n.dispatchEvent({type:"disconnected",data:r}),h.delete(r))}for(let t=0;t<e.added.length;t++){let r=e.added[t],n=h.get(r);n&&n.dispatchEvent({type:"connected",data:r})}}this.enabled=!1,this.isPresenting=!1,this.getController=function(e){let t=l[e];return void 0===t&&(t=new nB,l[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t=l[e];return void 0===t&&(t=new nB,l[e]=t),t.getGripSpace()},this.getHand=function(e){let t=l[e];return void 0===t&&(t=new nB,l[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){i=e,!0===r.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){s=e,!0===r.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return a},this.getSession=function(){return n},this.setSession=async function(e){if(null!==(n=e)){n.addEventListener("select",g),n.addEventListener("selectstart",g),n.addEventListener("selectend",g),n.addEventListener("squeeze",g),n.addEventListener("squeezestart",g),n.addEventListener("squeezeend",g),n.addEventListener("end",v),n.addEventListener("inputsourceschange",y);let e=t.getContextAttributes();!0!==e.xrCompatible&&await t.makeXRCompatible();let o={antialias:e.antialias,alpha:e.alpha,depth:e.depth,stencil:e.stencil,framebufferScaleFactor:i},l=new XRWebGLLayer(n,t,o);n.updateRenderState({baseLayer:l}),a=await n.requestReferenceSpace(s),M.setContext(n),M.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}};let x=new V,_=new V;function b(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.getCamera=function(e){p.near=c.near=u.near=e.near,p.far=c.far=u.far=e.far,(f!==p.near||m!==p.far)&&(n.updateRenderState({depthNear:p.near,depthFar:p.far}),f=p.near,m=p.far);let t=e.parent,r=p.cameras;b(p,t);for(let e=0;e<r.length;e++)b(r[e],t);e.matrixWorld.copy(p.matrixWorld),e.matrix.copy(p.matrix),e.matrix.decompose(e.position,e.quaternion,e.scale);let i=e.children;for(let e=0,t=i.length;e<t;e++)i[e].updateMatrixWorld(!0);return 2===r.length?function(e,t,r){x.setFromMatrixPosition(t.matrixWorld),_.setFromMatrixPosition(r.matrixWorld);let n=x.distanceTo(_),i=t.projectionMatrix.elements,a=r.projectionMatrix.elements,s=i[14]/(i[10]-1),o=i[14]/(i[10]+1),l=(i[9]+1)/i[5],h=(i[9]-1)/i[5],u=(i[8]-1)/i[0],c=(a[8]+1)/a[0],d=n/(-u+c),p=-(d*u);t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(p),e.translateZ(d),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert();let f=s+d,m=o+d;e.projectionMatrix.makePerspective(s*u-p,s*c+(n-p),l*o/m*f,h*o/m*f,f,m)}(p,u,c):p.projectionMatrix.copy(u.projectionMatrix),p};let w=null,M=new t5;M.setAnimationLoop(function(t,r){if(null!==(o=r.getViewerPose(a))){let t=o.views,r=n.renderState.baseLayer;e.setFramebuffer(r.framebuffer);let i=!1;t.length!==p.cameras.length&&(p.cameras.length=0,i=!0);for(let e=0;e<t.length;e++){let n=t[e],a=r.getViewport(n),s=d[e];s.matrix.fromArray(n.transform.matrix),s.projectionMatrix.fromArray(n.projectionMatrix),s.viewport.set(a.x,a.y,a.width,a.height),0===e&&p.matrix.copy(s.matrix),!0===i&&p.cameras.push(s)}}let i=n.inputSources;for(let e=0;e<l.length;e++){let t=l[e],n=i[e];t.update(n,r,a)}w&&w(t,r)}),this.setAnimationLoop=function(e){w=e},this.dispose=function(){}}function nH(e){function t(t,r){let n,i;t.opacity.value=r.opacity,r.color&&t.diffuse.value.copy(r.color),r.emissive&&t.emissive.value.copy(r.emissive).multiplyScalar(r.emissiveIntensity),r.map&&(t.map.value=r.map),r.alphaMap&&(t.alphaMap.value=r.alphaMap),r.specularMap&&(t.specularMap.value=r.specularMap);let a=e.get(r).envMap;if(a){t.envMap.value=a,t.flipEnvMap.value=a.isCubeTexture&&a._needsFlipEnvMap?-1:1,t.reflectivity.value=r.reflectivity,t.refractionRatio.value=r.refractionRatio;let n=e.get(a).__maxMipLevel;void 0!==n&&(t.maxMipLevel.value=n)}r.lightMap&&(t.lightMap.value=r.lightMap,t.lightMapIntensity.value=r.lightMapIntensity),r.aoMap&&(t.aoMap.value=r.aoMap,t.aoMapIntensity.value=r.aoMapIntensity),r.map?n=r.map:r.specularMap?n=r.specularMap:r.displacementMap?n=r.displacementMap:r.normalMap?n=r.normalMap:r.bumpMap?n=r.bumpMap:r.roughnessMap?n=r.roughnessMap:r.metalnessMap?n=r.metalnessMap:r.alphaMap?n=r.alphaMap:r.emissiveMap?n=r.emissiveMap:r.clearcoatMap?n=r.clearcoatMap:r.clearcoatNormalMap?n=r.clearcoatNormalMap:r.clearcoatRoughnessMap&&(n=r.clearcoatRoughnessMap),void 0!==n&&(n.isWebGLRenderTarget&&(n=n.texture),!0===n.matrixAutoUpdate&&n.updateMatrix(),t.uvTransform.value.copy(n.matrix)),r.aoMap?i=r.aoMap:r.lightMap&&(i=r.lightMap),void 0!==i&&(i.isWebGLRenderTarget&&(i=i.texture),!0===i.matrixAutoUpdate&&i.updateMatrix(),t.uv2Transform.value.copy(i.matrix))}function r(t,r){t.roughness.value=r.roughness,t.metalness.value=r.metalness,r.roughnessMap&&(t.roughnessMap.value=r.roughnessMap),r.metalnessMap&&(t.metalnessMap.value=r.metalnessMap),r.emissiveMap&&(t.emissiveMap.value=r.emissiveMap),r.bumpMap&&(t.bumpMap.value=r.bumpMap,t.bumpScale.value=r.bumpScale,1===r.side&&(t.bumpScale.value*=-1)),r.normalMap&&(t.normalMap.value=r.normalMap,t.normalScale.value.copy(r.normalScale),1===r.side&&t.normalScale.value.negate()),r.displacementMap&&(t.displacementMap.value=r.displacementMap,t.displacementScale.value=r.displacementScale,t.displacementBias.value=r.displacementBias),e.get(r).envMap&&(t.envMapIntensity.value=r.envMapIntensity)}return{refreshFogUniforms:function(e,t){e.fogColor.value.copy(t.color),t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)},refreshMaterialUniforms:function(e,n,i,a){let s,o;n.isMeshBasicMaterial?t(e,n):n.isMeshLambertMaterial?(t(e,n),n.emissiveMap&&(e.emissiveMap.value=n.emissiveMap)):n.isMeshToonMaterial?(t(e,n),n.gradientMap&&(e.gradientMap.value=n.gradientMap),n.emissiveMap&&(e.emissiveMap.value=n.emissiveMap),n.bumpMap&&(e.bumpMap.value=n.bumpMap,e.bumpScale.value=n.bumpScale,1===n.side&&(e.bumpScale.value*=-1)),n.normalMap&&(e.normalMap.value=n.normalMap,e.normalScale.value.copy(n.normalScale),1===n.side&&e.normalScale.value.negate()),n.displacementMap&&(e.displacementMap.value=n.displacementMap,e.displacementScale.value=n.displacementScale,e.displacementBias.value=n.displacementBias)):n.isMeshPhongMaterial?(t(e,n),e.specular.value.copy(n.specular),e.shininess.value=Math.max(n.shininess,1e-4),n.emissiveMap&&(e.emissiveMap.value=n.emissiveMap),n.bumpMap&&(e.bumpMap.value=n.bumpMap,e.bumpScale.value=n.bumpScale,1===n.side&&(e.bumpScale.value*=-1)),n.normalMap&&(e.normalMap.value=n.normalMap,e.normalScale.value.copy(n.normalScale),1===n.side&&e.normalScale.value.negate()),n.displacementMap&&(e.displacementMap.value=n.displacementMap,e.displacementScale.value=n.displacementScale,e.displacementBias.value=n.displacementBias)):n.isMeshStandardMaterial?(t(e,n),n.isMeshPhysicalMaterial?(r(e,n),e.reflectivity.value=n.reflectivity,e.clearcoat.value=n.clearcoat,e.clearcoatRoughness.value=n.clearcoatRoughness,n.sheen&&e.sheen.value.copy(n.sheen),n.clearcoatMap&&(e.clearcoatMap.value=n.clearcoatMap),n.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=n.clearcoatRoughnessMap),n.clearcoatNormalMap&&(e.clearcoatNormalScale.value.copy(n.clearcoatNormalScale),e.clearcoatNormalMap.value=n.clearcoatNormalMap,1===n.side&&e.clearcoatNormalScale.value.negate()),e.transmission.value=n.transmission,n.transmissionMap&&(e.transmissionMap.value=n.transmissionMap)):r(e,n)):n.isMeshMatcapMaterial?(t(e,n),n.matcap&&(e.matcap.value=n.matcap),n.bumpMap&&(e.bumpMap.value=n.bumpMap,e.bumpScale.value=n.bumpScale,1===n.side&&(e.bumpScale.value*=-1)),n.normalMap&&(e.normalMap.value=n.normalMap,e.normalScale.value.copy(n.normalScale),1===n.side&&e.normalScale.value.negate()),n.displacementMap&&(e.displacementMap.value=n.displacementMap,e.displacementScale.value=n.displacementScale,e.displacementBias.value=n.displacementBias)):n.isMeshDepthMaterial?(t(e,n),n.displacementMap&&(e.displacementMap.value=n.displacementMap,e.displacementScale.value=n.displacementScale,e.displacementBias.value=n.displacementBias)):n.isMeshDistanceMaterial?(t(e,n),n.displacementMap&&(e.displacementMap.value=n.displacementMap,e.displacementScale.value=n.displacementScale,e.displacementBias.value=n.displacementBias),e.referencePosition.value.copy(n.referencePosition),e.nearDistance.value=n.nearDistance,e.farDistance.value=n.farDistance):n.isMeshNormalMaterial?(t(e,n),n.bumpMap&&(e.bumpMap.value=n.bumpMap,e.bumpScale.value=n.bumpScale,1===n.side&&(e.bumpScale.value*=-1)),n.normalMap&&(e.normalMap.value=n.normalMap,e.normalScale.value.copy(n.normalScale),1===n.side&&e.normalScale.value.negate()),n.displacementMap&&(e.displacementMap.value=n.displacementMap,e.displacementScale.value=n.displacementScale,e.displacementBias.value=n.displacementBias)):n.isLineBasicMaterial?(e.diffuse.value.copy(n.color),e.opacity.value=n.opacity,n.isLineDashedMaterial&&(e.dashSize.value=n.dashSize,e.totalSize.value=n.dashSize+n.gapSize,e.scale.value=n.scale)):n.isPointsMaterial?(e.diffuse.value.copy(n.color),e.opacity.value=n.opacity,e.size.value=n.size*i,e.scale.value=.5*a,n.map&&(e.map.value=n.map),n.alphaMap&&(e.alphaMap.value=n.alphaMap),n.map?s=n.map:n.alphaMap&&(s=n.alphaMap),void 0!==s&&(!0===s.matrixAutoUpdate&&s.updateMatrix(),e.uvTransform.value.copy(s.matrix))):n.isSpriteMaterial?(e.diffuse.value.copy(n.color),e.opacity.value=n.opacity,e.rotation.value=n.rotation,n.map&&(e.map.value=n.map),n.alphaMap&&(e.alphaMap.value=n.alphaMap),n.map?o=n.map:n.alphaMap&&(o=n.alphaMap),void 0!==o&&(!0===o.matrixAutoUpdate&&o.updateMatrix(),e.uvTransform.value.copy(o.matrix))):n.isShadowMaterial?(e.color.value.copy(n.color),e.opacity.value=n.opacity):n.isShaderMaterial&&(n.uniformsNeedUpdate=!1)}}}function nG(e){let t,r,n,i,a,s,o,l,h,u,c,d,p,f,m,g,v,y,x,_,w;let M=void 0!==(e=e||{}).canvas?e.canvas:function(){let e=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return e.style.display="block",e}(),S=void 0!==e.context?e.context:null,T=void 0!==e.alpha&&e.alpha,E=void 0===e.depth||e.depth,A=void 0===e.stencil||e.stencil,L=void 0!==e.antialias&&e.antialias,R=void 0===e.premultipliedAlpha||e.premultipliedAlpha,P=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,C=void 0!==e.powerPreference?e.powerPreference:"default",I=void 0!==e.failIfMajorPerformanceCaveat&&e.failIfMajorPerformanceCaveat,U=null,N=null,k=[],F=[];this.domElement=M,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=3e3,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4;let B=this,H=!1,G=null,W=0,j=0,q=null,X=null,Y=-1,Z=null,J=new z,K=new z,Q=null,$=M.width,ee=M.height,et=1,er=null,en=null,ei=new z(0,0,$,ee),ea=new z(0,0,$,ee),es=!1,eo=new t4,el=!1,eh=!1,eu=new ev,ec=new V,ed={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function ep(){return null===q?et:1}let ef=S;function em(e,t){for(let r=0;r<e.length;r++){let n=e[r],i=M.getContext(n,t);if(null!==i)return i}return null}try{if(M.addEventListener("webglcontextlost",e_,!1),M.addEventListener("webglcontextrestored",eb,!1),null===ef){let e=["webgl2","webgl","experimental-webgl"];if(!0===B.isWebGL1Renderer&&e.shift(),ef=em(e,{alpha:T,depth:E,stencil:A,antialias:L,premultipliedAlpha:R,preserveDrawingBuffer:P,powerPreference:C,failIfMajorPerformanceCaveat:I}),null===ef){if(em(e))throw Error("Error creating WebGL context with your selected attributes.");throw Error("Error creating WebGL context.")}}void 0===ef.getShaderPrecisionFormat&&(ef.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){throw console.error("THREE.WebGLRenderer: "+e.message),e}function eg(){t=new ro(ef),r=new ri(ef,t,e),t.init(r),_=new nN(ef,t,r),(n=new nO(ef,t,r)).scissor(K.copy(ea).multiplyScalar(et).floor()),n.viewport(J.copy(ei).multiplyScalar(et).floor()),i=new ru(ef),a=new n_,s=new nU(ef,t,n,a,r,_,i),o=new rs(B),l=new t6(ef,r),w=new rr(ef,t,l,r),h=new rl(ef,l,i,w),u=new rf(ef,h,l,i),v=new rp(ef),m=new ra(a),c=new nx(B,o,t,r,w,m),d=new nH(a),p=new nS(a),f=new nP(t,r),g=new rt(B,o,n,u,R),y=new rn(ef,t,i,r),x=new rh(ef,t,i,r),i.programs=c.programs,B.capabilities=r,B.extensions=t,B.properties=a,B.renderLists=p,B.state=n,B.info=i}eg();let ey=new nz(B,ef);this.xr=ey;let ex=new nD(B,u,r.maxTextureSize);function e_(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),H=!0}function eb(){console.log("THREE.WebGLRenderer: Context Restored."),H=!1,eg()}function ew(e){let t=e.target;t.removeEventListener("dispose",ew),eM(t),a.remove(t)}function eM(e){let t=a.get(e).program;void 0!==t&&c.releaseProgram(t)}this.shadowMap=ex,this.getContext=function(){return ef},this.getContextAttributes=function(){return ef.getContextAttributes()},this.forceContextLoss=function(){let e=t.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){let e=t.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return et},this.setPixelRatio=function(e){void 0!==e&&(et=e,this.setSize($,ee,!1))},this.getSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),e=new O),e.set($,ee)},this.setSize=function(e,t,r){if(ey.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}$=e,ee=t,M.width=Math.floor(e*et),M.height=Math.floor(t*et),!1!==r&&(M.style.width=e+"px",M.style.height=t+"px"),this.setViewport(0,0,e,t)},this.getDrawingBufferSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),e=new O),e.set($*et,ee*et).floor()},this.setDrawingBufferSize=function(e,t,r){$=e,ee=t,et=r,M.width=Math.floor(e*r),M.height=Math.floor(t*r),this.setViewport(0,0,e,t)},this.getCurrentViewport=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),e=new z),e.copy(J)},this.getViewport=function(e){return e.copy(ei)},this.setViewport=function(e,t,r,i){e.isVector4?ei.set(e.x,e.y,e.z,e.w):ei.set(e,t,r,i),n.viewport(J.copy(ei).multiplyScalar(et).floor())},this.getScissor=function(e){return e.copy(ea)},this.setScissor=function(e,t,r,i){e.isVector4?ea.set(e.x,e.y,e.z,e.w):ea.set(e,t,r,i),n.scissor(K.copy(ea).multiplyScalar(et).floor())},this.getScissorTest=function(){return es},this.setScissorTest=function(e){n.setScissorTest(es=e)},this.setOpaqueSort=function(e){er=e},this.setTransparentSort=function(e){en=e},this.getClearColor=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getClearColor() now requires a Color as an argument"),e=new tr),e.copy(g.getClearColor())},this.setClearColor=function(){g.setClearColor.apply(g,arguments)},this.getClearAlpha=function(){return g.getClearAlpha()},this.setClearAlpha=function(){g.setClearAlpha.apply(g,arguments)},this.clear=function(e,t,r){let n=0;(void 0===e||e)&&(n|=16384),(void 0===t||t)&&(n|=256),(void 0===r||r)&&(n|=1024),ef.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){M.removeEventListener("webglcontextlost",e_,!1),M.removeEventListener("webglcontextrestored",eb,!1),p.dispose(),f.dispose(),a.dispose(),o.dispose(),u.dispose(),w.dispose(),ey.dispose(),eT.stop()},this.renderBufferImmediate=function(e,t){w.initAttributes();let r=a.get(e);e.hasPositions&&!r.position&&(r.position=ef.createBuffer()),e.hasNormals&&!r.normal&&(r.normal=ef.createBuffer()),e.hasUvs&&!r.uv&&(r.uv=ef.createBuffer()),e.hasColors&&!r.color&&(r.color=ef.createBuffer());let n=t.getAttributes();e.hasPositions&&(ef.bindBuffer(34962,r.position),ef.bufferData(34962,e.positionArray,35048),w.enableAttribute(n.position),ef.vertexAttribPointer(n.position,3,5126,!1,0,0)),e.hasNormals&&(ef.bindBuffer(34962,r.normal),ef.bufferData(34962,e.normalArray,35048),w.enableAttribute(n.normal),ef.vertexAttribPointer(n.normal,3,5126,!1,0,0)),e.hasUvs&&(ef.bindBuffer(34962,r.uv),ef.bufferData(34962,e.uvArray,35048),w.enableAttribute(n.uv),ef.vertexAttribPointer(n.uv,2,5126,!1,0,0)),e.hasColors&&(ef.bindBuffer(34962,r.color),ef.bufferData(34962,e.colorArray,35048),w.enableAttribute(n.color),ef.vertexAttribPointer(n.color,3,5126,!1,0,0)),w.disableUnusedAttributes(),ef.drawArrays(4,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,r,i,a,s){let o;null===t&&(t=ed);let u=a.isMesh&&0>a.matrixWorld.determinant(),c=eR(e,t,i,a);n.setMaterial(i,u);let d=r.index,p=r.attributes.position;if(null===d){if(void 0===p||0===p.count)return}else if(0===d.count)return;let f=1;!0===i.wireframe&&(d=h.getWireframeAttribute(r),f=2),(i.morphTargets||i.morphNormals)&&v.update(a,r,i,c),w.setup(a,i,c,r,d);let m=y;null!==d&&(o=l.get(d),(m=x).setIndex(o));let g=null!==d?d.count:p.count,_=r.drawRange.start*f,b=r.drawRange.count*f,M=null!==s?s.start*f:0,S=null!==s?s.count*f:1/0,T=Math.max(_,M),E=Math.max(0,Math.min(g,_+b,M+S)-1-T+1);if(0!==E){if(a.isMesh)!0===i.wireframe?(n.setLineWidth(i.wireframeLinewidth*ep()),m.setMode(1)):m.setMode(4);else if(a.isLine){let e=i.linewidth;void 0===e&&(e=1),n.setLineWidth(e*ep()),a.isLineSegments?m.setMode(1):a.isLineLoop?m.setMode(2):m.setMode(3)}else a.isPoints?m.setMode(0):a.isSprite&&m.setMode(4);if(a.isInstancedMesh)m.renderInstances(T,E,a.count);else if(r.isInstancedBufferGeometry){let e=Math.min(r.instanceCount,r._maxInstanceCount);m.renderInstances(T,E,e)}else m.render(T,E)}},this.compile=function(e,t){(N=f.get(e)).init(),e.traverseVisible(function(e){e.isLight&&e.layers.test(t.layers)&&(N.pushLight(e),e.castShadow&&N.pushShadow(e))}),N.setupLights();let r=new WeakMap;e.traverse(function(t){let n=t.material;if(n){if(Array.isArray(n))for(let i=0;i<n.length;i++){let a=n[i];!1===r.has(a)&&(eL(a,e,t),r.set(a))}else!1===r.has(n)&&(eL(n,e,t),r.set(n))}})};let eS=null,eT=new t5;function eE(e,t,r){let i=!0===t.isScene?t.overrideMaterial:null;for(let a=0,s=e.length;a<s;a++){let s=e[a],o=s.object,l=s.geometry,h=null===i?s.material:i,u=s.group;if(r.isArrayCamera){let e=r.cameras;for(let r=0,i=e.length;r<i;r++){let i=e[r];o.layers.test(i.layers)&&(n.viewport(J.copy(i.viewport)),N.setupLightsView(i),eA(o,t,i,l,h,u))}}else eA(o,t,r,l,h,u)}}function eA(e,t,r,i,a,s){if(e.onBeforeRender(B,t,r,i,a,s),e.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),e.isImmediateRenderObject){let i=eR(r,t,a,e);n.setMaterial(a),w.reset(),function(e,t){e.render(function(e){B.renderBufferImmediate(e,t)})}(e,i)}else B.renderBufferDirect(r,t,i,a,e,s);e.onAfterRender(B,t,r,i,a,s)}function eL(e,t,r){!0!==t.isScene&&(t=ed);let n=a.get(e),i=N.state.lights,s=N.state.shadowsArray,l=i.state.version,h=c.getParameters(e,i.state,s,t,r),u=c.getProgramCacheKey(h),d=n.program,p=!0;if(n.environment=e.isMeshStandardMaterial?t.environment:null,n.fog=t.fog,n.envMap=o.get(e.envMap||n.environment),void 0===d)e.addEventListener("dispose",ew);else if(d.cacheKey!==u)eM(e);else if(n.lightsStateVersion!==l)p=!1;else{if(void 0!==h.shaderID)return;p=!1}p&&(h.uniforms=c.getUniforms(e),e.onBeforeCompile(h,B),d=c.acquireProgram(h,u),n.program=d,n.uniforms=h.uniforms,n.outputEncoding=h.outputEncoding);let f=n.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(n.numClippingPlanes=m.numPlanes,n.numIntersection=m.numIntersection,f.clippingPlanes=m.uniform),n.needsLights=e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights,n.lightsStateVersion=l,n.needsLights&&(f.ambientLightColor.value=i.state.ambient,f.lightProbe.value=i.state.probe,f.directionalLights.value=i.state.directional,f.directionalLightShadows.value=i.state.directionalShadow,f.spotLights.value=i.state.spot,f.spotLightShadows.value=i.state.spotShadow,f.rectAreaLights.value=i.state.rectArea,f.ltc_1.value=i.state.rectAreaLTC1,f.ltc_2.value=i.state.rectAreaLTC2,f.pointLights.value=i.state.point,f.pointLightShadows.value=i.state.pointShadow,f.hemisphereLights.value=i.state.hemi,f.directionalShadowMap.value=i.state.directionalShadowMap,f.directionalShadowMatrix.value=i.state.directionalShadowMatrix,f.spotShadowMap.value=i.state.spotShadowMap,f.spotShadowMatrix.value=i.state.spotShadowMatrix,f.pointShadowMap.value=i.state.pointShadowMap,f.pointShadowMatrix.value=i.state.pointShadowMatrix);let g=n.program.getUniforms(),v=ne.seqWithValue(g.seq,f);n.uniformsList=v}function eR(e,t,i,l){var h;!0!==t.isScene&&(t=ed),s.resetTextureUnits();let u=t.fog,c=i.isMeshStandardMaterial?t.environment:null,p=null===q?B.outputEncoding:q.texture.encoding,f=o.get(i.envMap||c),g=a.get(i),v=N.state.lights;if(!0===el&&(!0===eh||e!==Z)){let t=e===Z&&i.id===Y;m.setState(i,e,t)}i.version===g.__version?i.fog&&g.fog!==u?eL(i,t,l):g.environment!==c?eL(i,t,l):g.needsLights&&g.lightsStateVersion!==v.state.version?eL(i,t,l):void 0!==g.numClippingPlanes&&(g.numClippingPlanes!==m.numPlanes||g.numIntersection!==m.numIntersection)?eL(i,t,l):g.outputEncoding!==p?eL(i,t,l):g.envMap!==f&&eL(i,t,l):(eL(i,t,l),g.__version=i.version);let y=!1,x=!1,_=!1,w=g.program,M=w.getUniforms(),S=g.uniforms;if(n.useProgram(w.program)&&(y=!0,x=!0,_=!0),i.id!==Y&&(Y=i.id,x=!0),y||Z!==e){if(M.setValue(ef,"projectionMatrix",e.projectionMatrix),r.logarithmicDepthBuffer&&M.setValue(ef,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),Z!==e&&(Z=e,x=!0,_=!0),i.isShaderMaterial||i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshStandardMaterial||i.envMap){let t=M.map.cameraPosition;void 0!==t&&t.setValue(ef,ec.setFromMatrixPosition(e.matrixWorld))}(i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial)&&M.setValue(ef,"isOrthographic",!0===e.isOrthographicCamera),(i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial||i.isShadowMaterial||i.skinning)&&M.setValue(ef,"viewMatrix",e.matrixWorldInverse)}if(i.skinning){M.setOptional(ef,l,"bindMatrix"),M.setOptional(ef,l,"bindMatrixInverse");let e=l.skeleton;if(e){let t=e.bones;if(r.floatVertexTextures){if(null===e.boneTexture){let r=Math.sqrt(4*t.length),n=new Float32Array((r=Math.max(r=D.ceilPowerOfTwo(r),4))*r*4);n.set(e.boneMatrices);let i=new t1(n,r,r,b,1015);e.boneMatrices=n,e.boneTexture=i,e.boneTextureSize=r}M.setValue(ef,"boneTexture",e.boneTexture,s),M.setValue(ef,"boneTextureSize",e.boneTextureSize)}else M.setOptional(ef,e,"boneMatrices")}}return(x||g.receiveShadow!==l.receiveShadow)&&(g.receiveShadow=l.receiveShadow,M.setValue(ef,"receiveShadow",l.receiveShadow)),x&&(M.setValue(ef,"toneMappingExposure",B.toneMappingExposure),g.needsLights&&(h=_,S.ambientLightColor.needsUpdate=h,S.lightProbe.needsUpdate=h,S.directionalLights.needsUpdate=h,S.directionalLightShadows.needsUpdate=h,S.pointLights.needsUpdate=h,S.pointLightShadows.needsUpdate=h,S.spotLights.needsUpdate=h,S.spotLightShadows.needsUpdate=h,S.rectAreaLights.needsUpdate=h,S.hemisphereLights.needsUpdate=h),u&&i.fog&&d.refreshFogUniforms(S,u),d.refreshMaterialUniforms(S,i,et,ee),ne.upload(ef,g.uniformsList,S,s)),i.isShaderMaterial&&!0===i.uniformsNeedUpdate&&(ne.upload(ef,g.uniformsList,S,s),i.uniformsNeedUpdate=!1),i.isSpriteMaterial&&M.setValue(ef,"center",l.center),M.setValue(ef,"modelViewMatrix",l.modelViewMatrix),M.setValue(ef,"normalMatrix",l.normalMatrix),M.setValue(ef,"modelMatrix",l.matrixWorld),w}eT.setAnimationLoop(function(e){!ey.isPresenting&&eS&&eS(e)}),"undefined"!=typeof window&&eT.setContext(window),this.setAnimationLoop=function(e){eS=e,ey.setAnimationLoop(e),null===e?eT.stop():eT.start()},this.render=function(e,t){let r,a;if(void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),r=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),a=arguments[3]),void 0!==t&&!0!==t.isCamera){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(!0===H)return;w.resetDefaultState(),Y=-1,Z=null,!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),!0===ey.enabled&&!0===ey.isPresenting&&(t=ey.getCamera(t)),!0===e.isScene&&e.onBeforeRender(B,e,t,r||q),(N=f.get(e,F.length)).init(),F.push(N),eu.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),eo.setFromProjectionMatrix(eu),eh=this.localClippingEnabled,el=m.init(this.clippingPlanes,eh,t),(U=p.get(e,k.length)).init(),k.push(U),function e(t,r,n,a){if(!1===t.visible)return;if(t.layers.test(r.layers)){if(t.isGroup)n=t.renderOrder;else if(t.isLOD)!0===t.autoUpdate&&t.update(r);else if(t.isLight)N.pushLight(t),t.castShadow&&N.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||eo.intersectsSprite(t)){a&&ec.setFromMatrixPosition(t.matrixWorld).applyMatrix4(eu);let e=u.update(t),r=t.material;r.visible&&U.push(t,e,r,n,ec.z,null)}}else if(t.isImmediateRenderObject)a&&ec.setFromMatrixPosition(t.matrixWorld).applyMatrix4(eu),U.push(t,null,t.material,n,ec.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.frame!==i.render.frame&&(t.skeleton.update(),t.skeleton.frame=i.render.frame),!t.frustumCulled||eo.intersectsObject(t))){a&&ec.setFromMatrixPosition(t.matrixWorld).applyMatrix4(eu);let e=u.update(t),r=t.material;if(Array.isArray(r)){let i=e.groups;for(let a=0,s=i.length;a<s;a++){let s=i[a],o=r[s.materialIndex];o&&o.visible&&U.push(t,e,o,n,ec.z,s)}}else r.visible&&U.push(t,e,r,n,ec.z,null)}}let s=t.children;for(let t=0,i=s.length;t<i;t++)e(s[t],r,n,a)}(e,t,0,B.sortObjects),U.finish(),!0===B.sortObjects&&U.sort(er,en),!0===el&&m.beginShadows();let o=N.state.shadowsArray;ex.render(o,e,t),N.setupLights(),N.setupLightsView(t),!0===el&&m.endShadows(),!0===this.info.autoReset&&this.info.reset(),void 0!==r&&this.setRenderTarget(r),g.render(U,e,t,a);let l=U.opaque,h=U.transparent;l.length>0&&eE(l,e,t),h.length>0&&eE(h,e,t),!0===e.isScene&&e.onAfterRender(B,e,t),null!==q&&(s.updateRenderTargetMipmap(q),s.updateMultisampleRenderTarget(q)),n.buffers.depth.setTest(!0),n.buffers.depth.setMask(!0),n.buffers.color.setMask(!0),n.setPolygonOffset(!1),F.pop(),N=F.length>0?F[F.length-1]:null,k.pop(),U=k.length>0?k[k.length-1]:null},this.setFramebuffer=function(e){G!==e&&null===q&&ef.bindFramebuffer(36160,e),G=e},this.getActiveCubeFace=function(){return W},this.getActiveMipmapLevel=function(){return j},this.getRenderTarget=function(){return q},this.setRenderTarget=function(e,t=0,r=0){q=e,W=t,j=r,e&&void 0===a.get(e).__webglFramebuffer&&s.setupRenderTarget(e);let i=G,o=!1,l=!1;if(e){let r=e.texture;(r.isDataTexture3D||r.isDataTexture2DArray)&&(l=!0);let n=a.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(i=n[t],o=!0):i=e.isWebGLMultisampleRenderTarget?a.get(e).__webglMultisampledFramebuffer:n,J.copy(e.viewport),K.copy(e.scissor),Q=e.scissorTest}else J.copy(ei).multiplyScalar(et).floor(),K.copy(ea).multiplyScalar(et).floor(),Q=es;if(X!==i&&(ef.bindFramebuffer(36160,i),X=i),n.viewport(J),n.scissor(K),n.setScissorTest(Q),o){let n=a.get(e.texture);ef.framebufferTexture2D(36160,36064,34069+t,n.__webglTexture,r)}else if(l){let n=a.get(e.texture);ef.framebufferTextureLayer(36160,36064,n.__webglTexture,r||0,t||0)}},this.readRenderTargetPixels=function(e,n,i,s,o,l,h){if(!(e&&e.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let u=a.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==h&&(u=u[h]),u){let a=!1;u!==X&&(ef.bindFramebuffer(36160,u),a=!0);try{let a=e.texture,h=a.format,u=a.type;if(h!==b&&_.convert(h)!==ef.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}let c=1016===u&&(t.has("EXT_color_buffer_half_float")||r.isWebGL2&&t.has("EXT_color_buffer_float"));if(1009!==u&&_.convert(u)!==ef.getParameter(35738)&&!(1015===u&&(r.isWebGL2||t.has("OES_texture_float")||t.has("WEBGL_color_buffer_float")))&&!c){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}36053===ef.checkFramebufferStatus(36160)?n>=0&&n<=e.width-s&&i>=0&&i<=e.height-o&&ef.readPixels(n,i,s,o,_.convert(h),_.convert(u),l):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{a&&ef.bindFramebuffer(36160,X)}}},this.copyFramebufferToTexture=function(e,t,r=0){let i=Math.pow(2,-r),a=Math.floor(t.image.width*i),o=Math.floor(t.image.height*i),l=_.convert(t.format);s.setTexture2D(t,0),ef.copyTexImage2D(3553,r,l,e.x,e.y,a,o,0),n.unbindTexture()},this.copyTextureToTexture=function(e,t,r,i=0){let a=t.image.width,o=t.image.height,l=_.convert(r.format),h=_.convert(r.type);s.setTexture2D(r,0),ef.pixelStorei(37440,r.flipY),ef.pixelStorei(37441,r.premultiplyAlpha),ef.pixelStorei(3317,r.unpackAlignment),t.isDataTexture?ef.texSubImage2D(3553,i,e.x,e.y,a,o,l,h,t.image.data):t.isCompressedTexture?ef.compressedTexSubImage2D(3553,i,e.x,e.y,t.mipmaps[0].width,t.mipmaps[0].height,l,t.mipmaps[0].data):ef.texSubImage2D(3553,i,e.x,e.y,l,h,t.image),0===i&&r.generateMipmaps&&ef.generateMipmap(3553),n.unbindTexture()},this.copyTextureToTexture3D=function(e,t,r,i,a=0){let o;if(B.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}let{width:l,height:h,data:u}=r.image,c=_.convert(i.format),d=_.convert(i.type);if(i.isDataTexture3D)s.setTexture3D(i,0),o=32879;else if(i.isDataTexture2DArray)s.setTexture2DArray(i,0),o=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}ef.pixelStorei(37440,i.flipY),ef.pixelStorei(37441,i.premultiplyAlpha),ef.pixelStorei(3317,i.unpackAlignment);let p=ef.getParameter(3314),f=ef.getParameter(32878),m=ef.getParameter(3316),g=ef.getParameter(3315),v=ef.getParameter(32877);ef.pixelStorei(3314,l),ef.pixelStorei(32878,h),ef.pixelStorei(3316,e.min.x),ef.pixelStorei(3315,e.min.y),ef.pixelStorei(32877,e.min.z),ef.texSubImage3D(o,a,t.x,t.y,t.z,e.max.x-e.min.x+1,e.max.y-e.min.y+1,e.max.z-e.min.z+1,c,d,u),ef.pixelStorei(3314,p),ef.pixelStorei(32878,f),ef.pixelStorei(3316,m),ef.pixelStorei(3315,g),ef.pixelStorei(32877,v),0===a&&i.generateMipmaps&&ef.generateMipmap(o),n.unbindTexture()},this.initTexture=function(e){s.setTexture2D(e,0),n.unbindTexture()},this.resetState=function(){n.reset(),w.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}nF.prototype.isGroup=!0,Object.assign(nB.prototype,{constructor:nB,getHandSpace:function(){return null===this._hand&&(this._hand=new nF,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand},getTargetRaySpace:function(){return null===this._targetRay&&(this._targetRay=new nF,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return null===this._grip&&(this._grip=new nF,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this},disconnect:function(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this},update:function(e,t,r){let n=null,i=null,a=null,s=this._targetRay,o=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(l&&e.hand){for(let n of(a=!0,e.hand.values())){let e=t.getJointPose(n,r);if(void 0===l.joints[n.jointName]){let e=new nF;e.matrixAutoUpdate=!1,e.visible=!1,l.joints[n.jointName]=e,l.add(e)}let i=l.joints[n.jointName];null!==e&&(i.matrix.fromArray(e.transform.matrix),i.matrix.decompose(i.position,i.rotation,i.scale),i.jointRadius=e.radius),i.visible=null!==e}let n=l.joints["index-finger-tip"],i=l.joints["thumb-tip"],s=n.position.distanceTo(i.position);l.inputState.pinching&&s>.025?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&s<=.015&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==s&&null!==(n=t.getPose(e.targetRaySpace,r))&&(s.matrix.fromArray(n.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale)),null!==o&&e.gripSpace&&null!==(i=t.getPose(e.gripSpace,r))&&(o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale))}return null!==s&&(s.visible=null!==n),null!==o&&(o.visible=null!==i),null!==l&&(l.visible=null!==a),this}}),Object.assign(nz.prototype,P.prototype),(class extends nG{}).prototype.isWebGL1Renderer=!0;class nV{constructor(e,t){this.name="",this.color=new tr(e),this.density=void 0!==t?t:25e-5}clone(){return new nV(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}nV.prototype.isFogExp2=!0;class nW{constructor(e,t,r){this.name="",this.color=new tr(e),this.near=void 0!==t?t:1,this.far=void 0!==r?r:1e3}clone(){return new nW(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}nW.prototype.isFog=!0;class nj extends eG{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){let t=super.toJSON(e);return null!==this.background&&(t.object.background=this.background.toJSON(e)),null!==this.environment&&(t.object.environment=this.environment.toJSON(e)),null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}function nq(e,t){this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=D.generateUUID()}nj.prototype.isScene=!0,Object.defineProperty(nq.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(nq.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this},copyAt:function(e,t,r){e*=this.stride,r*=t.stride;for(let n=0,i=this.stride;n<i;n++)this.array[e+n]=t.array[r+n];return this},set:function(e,t=0){return this.array.set(e,t),this},clone:function(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=D.generateUUID()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let t=new nq(new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),this.stride);return t.setUsage(this.usage),t},onUpload:function(e){return this.onUploadCallback=e,this},toJSON:function(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=D.generateUUID()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}});let nX=new V;function nY(e,t,r,n){this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=!0===n}Object.defineProperties(nY.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}},needsUpdate:{set:function(e){this.data.needsUpdate=e}}}),Object.assign(nY.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(e){for(let t=0,r=this.data.count;t<r;t++)nX.x=this.getX(t),nX.y=this.getY(t),nX.z=this.getZ(t),nX.applyMatrix4(e),this.setXYZ(t,nX.x,nX.y,nX.z);return this},setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this},setXYZ:function(e,t,r,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=n,this},setXYZW:function(e,t,r,n,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=n,this.data.array[e+3]=i,this},clone:function(e){if(void 0!==e)return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new nY(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized);{console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");let e=[];for(let t=0;t<this.count;t++){let r=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[r+t])}return new ts(new this.array.constructor(e),this.itemSize,this.normalized)}},toJSON:function(e){if(void 0!==e)return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized};{console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");let e=[];for(let t=0;t<this.count;t++){let r=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[r+t])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}}});class nZ extends e5{constructor(e){super(),this.type="SpriteMaterial",this.color=new tr(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this}}nZ.prototype.isSpriteMaterial=!0;let nJ=/*@__PURE__*/new V,nK=/*@__PURE__*/new V,nQ=/*@__PURE__*/new V,n$=/*@__PURE__*/new O,n0=/*@__PURE__*/new O,n1=/*@__PURE__*/new ev,n2=/*@__PURE__*/new V,n3=/*@__PURE__*/new V,n4=/*@__PURE__*/new V,n5=/*@__PURE__*/new O,n6=/*@__PURE__*/new O,n8=/*@__PURE__*/new O;function n7(e,t,r,n,i,a){n$.subVectors(e,r).addScalar(.5).multiply(n),void 0!==i?(n0.x=a*n$.x-i*n$.y,n0.y=i*n$.x+a*n$.y):n0.copy(n$),e.copy(t),e.x+=n0.x,e.y+=n0.y,e.applyMatrix4(n1)}(class extends eG{constructor(e){if(super(),this.type="Sprite",void 0===i){i=new tT;let e=new nq(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);i.setIndex([0,1,2,0,2,3]),i.setAttribute("position",new nY(e,3,0,!1)),i.setAttribute("uv",new nY(e,2,3,!1))}this.geometry=i,this.material=void 0!==e?e:new nZ,this.center=new O(.5,.5)}raycast(e,t){let r,n;null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),nK.setFromMatrixScale(this.matrixWorld),n1.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),nQ.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&nK.multiplyScalar(-nQ.z);let i=this.material.rotation;0!==i&&(n=Math.cos(i),r=Math.sin(i));let a=this.center;n7(n2.set(-.5,-.5,0),nQ,a,nK,r,n),n7(n3.set(.5,-.5,0),nQ,a,nK,r,n),n7(n4.set(.5,.5,0),nQ,a,nK,r,n),n5.set(0,0),n6.set(1,0),n8.set(1,1);let s=e.ray.intersectTriangle(n2,n3,n4,!1,nJ);if(null===s&&(n7(n3.set(-.5,.5,0),nQ,a,nK,r,n),n6.set(0,1),null===(s=e.ray.intersectTriangle(n2,n4,n3,!1,nJ))))return;let o=e.ray.origin.distanceTo(nJ);o<e.near||o>e.far||t.push({distance:o,point:nJ.clone(),uv:e3.getUV(nJ,n2,n3,n4,n5,n6,n8,new O),face:null,object:this})}copy(e){return super.copy(e),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}).prototype.isSprite=!0;let n9=/*@__PURE__*/new V,ie=/*@__PURE__*/new V,it=new V,ir=new z,ii=new z,ia=new V,is=new ev;function io(e,t){tV.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new ev,this.bindMatrixInverse=new ev}function il(){eG.call(this),this.type="Bone"}io.prototype=Object.assign(Object.create(tV.prototype),{constructor:io,isSkinnedMesh:!0,copy:function(e){return tV.prototype.copy.call(this,e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this},bind:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){let e=new z,t=this.geometry.attributes.skinWeight;for(let r=0,n=t.count;r<n;r++){e.x=t.getX(r),e.y=t.getY(r),e.z=t.getZ(r),e.w=t.getW(r);let n=1/e.manhattanLength();n!==1/0?e.multiplyScalar(n):e.set(1,0,0,0),t.setXYZW(r,e.x,e.y,e.z,e.w)}},updateMatrixWorld:function(e){tV.prototype.updateMatrixWorld.call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},boneTransform:function(e,t){let r=this.skeleton,n=this.geometry;ir.fromBufferAttribute(n.attributes.skinIndex,e),ii.fromBufferAttribute(n.attributes.skinWeight,e),it.fromBufferAttribute(n.attributes.position,e).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let e=0;e<4;e++){let n=ii.getComponent(e);if(0!==n){let i=ir.getComponent(e);is.multiplyMatrices(r.bones[i].matrixWorld,r.boneInverses[i]),t.addScaledVector(ia.copy(it).applyMatrix4(is),n)}}return t.applyMatrix4(this.bindMatrixInverse)}}),il.prototype=Object.assign(Object.create(eG.prototype),{constructor:il,isBone:!0});let ih=/*@__PURE__*/new ev,iu=/*@__PURE__*/new ev;class ic{constructor(e=[],t=[]){this.uuid=D.generateUUID(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){let e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let e=0,t=this.bones.length;e<t;e++)this.boneInverses.push(new ev)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){let t=new ev;this.bones[e]&&t.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(t)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){let t=this.bones[e];t&&t.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){let t=this.bones[e];t&&(t.parent&&t.parent.isBone?(t.matrix.copy(t.parent.matrixWorld).invert(),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))}}update(){let e=this.bones,t=this.boneInverses,r=this.boneMatrices,n=this.boneTexture;for(let n=0,i=e.length;n<i;n++){let i=e[n]?e[n].matrixWorld:iu;ih.multiplyMatrices(i,t[n]),ih.toArray(r,16*n)}null!==n&&(n.needsUpdate=!0)}clone(){return new ic(this.bones,this.boneInverses)}getBoneByName(e){for(let t=0,r=this.bones.length;t<r;t++){let r=this.bones[t];if(r.name===e)return r}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let r=0,n=e.bones.length;r<n;r++){let n=e.bones[r],i=t[n];void 0===i&&(console.warn("THREE.Skeleton: No bone found with UUID:",n),i=new il),this.bones.push(i),this.boneInverses.push(new ev().fromArray(e.boneInverses[r]))}return this.init(),this}toJSON(){let e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;let t=this.bones,r=this.boneInverses;for(let n=0,i=t.length;n<i;n++){let i=t[n];e.bones.push(i.uuid);let a=r[n];e.boneInverses.push(a.toArray())}return e}}let id=new ev,ip=new ev,im=[],ig=new tV;function iv(e,t,r){tV.call(this,e,t),this.instanceMatrix=new ts(new Float32Array(16*r),16),this.instanceColor=null,this.count=r,this.frustumCulled=!1}iv.prototype=Object.assign(Object.create(tV.prototype),{constructor:iv,isInstancedMesh:!0,copy:function(e){return tV.prototype.copy.call(this,e),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this},getColorAt:function(e,t){t.fromArray(this.instanceColor.array,3*e)},getMatrixAt:function(e,t){t.fromArray(this.instanceMatrix.array,16*e)},raycast:function(e,t){let r=this.matrixWorld,n=this.count;if(ig.geometry=this.geometry,ig.material=this.material,void 0!==ig.material)for(let i=0;i<n;i++){this.getMatrixAt(i,id),ip.multiplyMatrices(r,id),ig.matrixWorld=ip,ig.raycast(e,im);for(let e=0,r=im.length;e<r;e++){let r=im[e];r.instanceId=i,r.object=this,t.push(r)}im.length=0}},setColorAt:function(e,t){null===this.instanceColor&&(this.instanceColor=new ts(new Float32Array(3*this.count),3)),t.toArray(this.instanceColor.array,3*e)},setMatrixAt:function(e,t){t.toArray(this.instanceMatrix.array,16*e)},updateMorphTargets:function(){},dispose:function(){this.dispatchEvent({type:"dispose"})}});class iy extends e5{constructor(e){super(),this.type="LineBasicMaterial",this.color=new tr(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.morphTargets=e.morphTargets,this}}iy.prototype.isLineBasicMaterial=!0;let ix=new V,i_=new V,ib=new ev,iw=new eg,iM=new el;function iS(e=new tT,t=new iy){eG.call(this),this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}iS.prototype=Object.assign(Object.create(eG.prototype),{constructor:iS,isLine:!0,copy:function(e){return eG.prototype.copy.call(this,e),this.material=e.material,this.geometry=e.geometry,this},computeLineDistances:function(){let e=this.geometry;if(e.isBufferGeometry){if(null===e.index){let t=e.attributes.position,r=[0];for(let e=1,n=t.count;e<n;e++)ix.fromBufferAttribute(t,e-1),i_.fromBufferAttribute(t,e),r[e]=r[e-1],r[e]+=ix.distanceTo(i_);e.setAttribute("lineDistance",new tm(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.")}else e.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this},raycast:function(e,t){let r=this.geometry,n=this.matrixWorld,i=e.params.Line.threshold;if(null===r.boundingSphere&&r.computeBoundingSphere(),iM.copy(r.boundingSphere),iM.applyMatrix4(n),iM.radius+=i,!1===e.ray.intersectsSphere(iM))return;ib.copy(n).invert(),iw.copy(e.ray).applyMatrix4(ib);let a=i/((this.scale.x+this.scale.y+this.scale.z)/3),s=a*a,o=new V,l=new V,h=new V,u=new V,c=this.isLineSegments?2:1;if(r.isBufferGeometry){let n=r.index,i=r.attributes.position;if(null!==n){let r=n.array;for(let n=0,a=r.length-1;n<a;n+=c){let a=r[n],c=r[n+1];if(o.fromBufferAttribute(i,a),l.fromBufferAttribute(i,c),iw.distanceSqToSegment(o,l,u,h)>s)continue;u.applyMatrix4(this.matrixWorld);let d=e.ray.origin.distanceTo(u);d<e.near||d>e.far||t.push({distance:d,point:h.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}else for(let r=0,n=i.count-1;r<n;r+=c){if(o.fromBufferAttribute(i,r),l.fromBufferAttribute(i,r+1),iw.distanceSqToSegment(o,l,u,h)>s)continue;u.applyMatrix4(this.matrixWorld);let n=e.ray.origin.distanceTo(u);n<e.near||n>e.far||t.push({distance:n,point:h.clone().applyMatrix4(this.matrixWorld),index:r,face:null,faceIndex:null,object:this})}}else r.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")},updateMorphTargets:function(){let e=this.geometry;if(e.isBufferGeometry){let t=e.morphAttributes,r=Object.keys(t);if(r.length>0){let e=t[r[0]];if(void 0!==e){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,r=e.length;t<r;t++){let r=e[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[r]=t}}}}else{let t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});let iT=new V,iE=new V;function iA(e,t){iS.call(this,e,t),this.type="LineSegments"}iA.prototype=Object.assign(Object.create(iS.prototype),{constructor:iA,isLineSegments:!0,computeLineDistances:function(){let e=this.geometry;if(e.isBufferGeometry){if(null===e.index){let t=e.attributes.position,r=[];for(let e=0,n=t.count;e<n;e+=2)iT.fromBufferAttribute(t,e),iE.fromBufferAttribute(t,e+1),r[e]=0===e?0:r[e-1],r[e+1]=r[e]+iT.distanceTo(iE);e.setAttribute("lineDistance",new tm(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.")}else e.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}});class iL extends iS{constructor(e,t){super(e,t),this.type="LineLoop"}}iL.prototype.isLineLoop=!0;class iR extends e5{constructor(e){super(),this.type="PointsMaterial",this.color=new tr(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this}}iR.prototype.isPointsMaterial=!0;let iP=new ev,iC=new eg,iI=new el,iD=new V;function iO(e=new tT,t=new iR){eG.call(this),this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}function iU(e,t,r,n,i,a,s){let o=iC.distanceSqToPoint(e);if(o<r){let r=new V;iC.closestPointToPoint(e,r),r.applyMatrix4(n);let l=i.ray.origin.distanceTo(r);if(l<i.near||l>i.far)return;a.push({distance:l,distanceToRay:Math.sqrt(o),point:r,index:t,face:null,object:s})}}iO.prototype=Object.assign(Object.create(eG.prototype),{constructor:iO,isPoints:!0,copy:function(e){return eG.prototype.copy.call(this,e),this.material=e.material,this.geometry=e.geometry,this},raycast:function(e,t){let r=this.geometry,n=this.matrixWorld,i=e.params.Points.threshold;if(null===r.boundingSphere&&r.computeBoundingSphere(),iI.copy(r.boundingSphere),iI.applyMatrix4(n),iI.radius+=i,!1===e.ray.intersectsSphere(iI))return;iP.copy(n).invert(),iC.copy(e.ray).applyMatrix4(iP);let a=i/((this.scale.x+this.scale.y+this.scale.z)/3),s=a*a;if(r.isBufferGeometry){let i=r.index,a=r.attributes.position;if(null!==i){let r=i.array;for(let i=0,o=r.length;i<o;i++){let o=r[i];iD.fromBufferAttribute(a,o),iU(iD,o,s,n,e,t,this)}}else for(let r=0,i=a.count;r<i;r++)iD.fromBufferAttribute(a,r),iU(iD,r,s,n,e,t,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")},updateMorphTargets:function(){let e=this.geometry;if(e.isBufferGeometry){let t=e.morphAttributes,r=Object.keys(t);if(r.length>0){let e=t[r[0]];if(void 0!==e){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,r=e.length;t<r;t++){let r=e[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[r]=t}}}}else{let t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}),(class extends F{constructor(e,t,r,n,i,a,s,o,l){super(e,t,r,n,i,a,s,o,l),this.format=void 0!==s?s:_,this.minFilter=void 0!==a?a:v,this.magFilter=void 0!==i?i:v,this.generateMipmaps=!1;let h=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(function t(){h.needsUpdate=!0,e.requestVideoFrameCallback(t)})}clone(){return new this.constructor(this.image).copy(this)}update(){let e=this.image;!1=="requestVideoFrameCallback"in e&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}).prototype.isVideoTexture=!0;class iN extends F{constructor(e,t,r,n,i,a,s,o,l,h,u,c){super(null,a,s,o,l,h,n,i,u,c),this.image={width:t,height:r},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}iN.prototype.isCompressedTexture=!0;class ik extends F{constructor(e,t,r,n,i,a,s,o,l){super(e,t,r,n,i,a,s,o,l),this.needsUpdate=!0}}ik.prototype.isCanvasTexture=!0,(class extends F{constructor(e,t,r,n,i,a,s,o,l,h){if(1026!==(h=void 0!==h?h:1026)&&1027!==h)throw Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===r&&1026===h&&(r=1012),void 0===r&&1027===h&&(r=1020),super(null,n,i,a,s,o,h,r,l),this.image={width:e,height:t},this.magFilter=void 0!==s?s:f,this.minFilter=void 0!==o?o:f,this.flipY=!1,this.generateMipmaps=!1}}).prototype.isDepthTexture=!0;class iF extends tT{constructor(e=1,t=1,r=1,n=8,i=1,a=!1,s=0,o=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:n,heightSegments:i,openEnded:a,thetaStart:s,thetaLength:o};let l=this;n=Math.floor(n),i=Math.floor(i);let h=[],u=[],c=[],d=[],p=0,f=[],m=r/2,g=0;function v(r){let i=p,a=new O,f=new V,v=0,y=!0===r?e:t,x=!0===r?1:-1;for(let e=1;e<=n;e++)u.push(0,m*x,0),c.push(0,x,0),d.push(.5,.5),p++;let _=p;for(let e=0;e<=n;e++){let t=e/n*o+s,r=Math.cos(t),i=Math.sin(t);f.x=y*i,f.y=m*x,f.z=y*r,u.push(f.x,f.y,f.z),c.push(0,x,0),a.x=.5*r+.5,a.y=.5*i*x+.5,d.push(a.x,a.y),p++}for(let e=0;e<n;e++){let t=i+e,n=_+e;!0===r?h.push(n,n+1,t):h.push(n+1,n,t),v+=3}l.addGroup(g,v,!0===r?1:2),g+=v}(function(){let a=new V,v=new V,y=0,x=(t-e)/r;for(let l=0;l<=i;l++){let h=[],g=l/i,y=g*(t-e)+e;for(let e=0;e<=n;e++){let t=e/n,i=t*o+s,l=Math.sin(i),f=Math.cos(i);v.x=y*l,v.y=-g*r+m,v.z=y*f,u.push(v.x,v.y,v.z),a.set(l,x,f).normalize(),c.push(a.x,a.y,a.z),d.push(t,1-g),h.push(p++)}f.push(h)}for(let e=0;e<n;e++)for(let t=0;t<i;t++){let r=f[t][e],n=f[t+1][e],i=f[t+1][e+1],a=f[t][e+1];h.push(r,n,a),h.push(n,i,a),y+=6}l.addGroup(g,y,0),g+=y})(),!1===a&&(e>0&&v(!0),t>0&&v(!1)),this.setIndex(h),this.setAttribute("position",new tm(u,3)),this.setAttribute("normal",new tm(c,3)),this.setAttribute("uv",new tm(d,2))}}new V,new V,new V,new e3;let iB=function(e,t,r){let n,i,a,s,o,l,h;r=r||2;let u=t&&t.length,c=u?t[0]*r:e.length,d=iz(e,0,c,r,!0),p=[];if(!d||d.next===d.prev)return p;if(u&&(d=function(e,t,r,n){let i,a,s,o,l;let h=[];for(i=0,a=t.length;i<a;i++)s=t[i]*n,o=i<a-1?t[i+1]*n:e.length,(l=iz(e,s,o,n,!1))===l.next&&(l.steiner=!0),h.push(function(e){let t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e)return r}(l));for(h.sort(iG),i=0;i<h.length;i++)(function(e,t){if(t=function(e,t){let r=t,n=e.x,i=e.y,a=-1/0,s;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){let e=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(e<=n&&e>a){if(a=e,e===n){if(i===r.y)return r;if(i===r.next.y)return r.next}s=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t)if(!s)return null;if(n===a)return s;let o=s,l=s.x,h=s.y,u=1/0,c;r=s;do{var d,p;n>=r.x&&r.x>=l&&n!==r.x&&iW(i<h?n:a,i,l,h,i<h?a:n,i,r.x,r.y)&&(c=Math.abs(i-r.y)/(n-r.x),iJ(r,e)&&(c<u||c===u&&(r.x>s.x||r.x===s.x&&(d=s,p=r,0>ij(d.prev,d,p.prev)&&0>ij(p.next,d,d.next))))&&(s=r,u=c)),r=r.next}while(r!==o)return s}(e,t)){let r=iK(t,e);iH(t,t.next),iH(r,r.next)}})(h[i],r),r=iH(r,r.next);return r}(e,t,d,r)),e.length>80*r){n=a=e[0],i=s=e[1];for(let t=r;t<c;t+=r)o=e[t],l=e[t+1],o<n&&(n=o),l<i&&(i=l),o>a&&(a=o),l>s&&(s=l);h=0!==(h=Math.max(a-n,s-i))?1/h:0}return function e(t,r,n,i,a,s,o){if(!t)return;!o&&s&&function(e,t,r,n){let i=e;do null===i.z&&(i.z=iV(i.x,i.y,t,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==e)i.prevZ.nextZ=null,i.prevZ=null,function(e){let t,r,n,i,a,s,o,l,h=1;do{for(r=e,e=null,a=null,s=0;r;){for(s++,n=r,o=0,t=0;t<h&&(o++,n=n.nextZ);t++);for(l=h;o>0||l>0&&n;)0!==o&&(0===l||!n||r.z<=n.z)?(i=r,r=r.nextZ,o--):(i=n,n=n.nextZ,l--),a?a.nextZ=i:e=i,i.prevZ=a,a=i;r=n}a.nextZ=null,h*=2}while(s>1)}(i)}(t,i,a,s);let l=t,h,u;for(;t.prev!==t.next;){if(h=t.prev,u=t.next,s?function(e,t,r,n){let i=e.prev,a=e.next;if(ij(i,e,a)>=0)return!1;let s=i.x<e.x?i.x<a.x?i.x:a.x:e.x<a.x?e.x:a.x,o=i.y<e.y?i.y<a.y?i.y:a.y:e.y<a.y?e.y:a.y,l=i.x>e.x?i.x>a.x?i.x:a.x:e.x>a.x?e.x:a.x,h=i.y>e.y?i.y>a.y?i.y:a.y:e.y>a.y?e.y:a.y,u=iV(s,o,t,r,n),c=iV(l,h,t,r,n),d=e.prevZ,p=e.nextZ;for(;d&&d.z>=u&&p&&p.z<=c;){if(d!==e.prev&&d!==e.next&&iW(i.x,i.y,e.x,e.y,a.x,a.y,d.x,d.y)&&ij(d.prev,d,d.next)>=0||(d=d.prevZ,p!==e.prev&&p!==e.next&&iW(i.x,i.y,e.x,e.y,a.x,a.y,p.x,p.y)&&ij(p.prev,p,p.next)>=0))return!1;p=p.nextZ}for(;d&&d.z>=u;){if(d!==e.prev&&d!==e.next&&iW(i.x,i.y,e.x,e.y,a.x,a.y,d.x,d.y)&&ij(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;p&&p.z<=c;){if(p!==e.prev&&p!==e.next&&iW(i.x,i.y,e.x,e.y,a.x,a.y,p.x,p.y)&&ij(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}(t,i,a,s):function(e){let t=e.prev,r=e.next;if(ij(t,e,r)>=0)return!1;let n=e.next.next;for(;n!==e.prev;){if(iW(t.x,t.y,e.x,e.y,r.x,r.y,n.x,n.y)&&ij(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}(t)){r.push(h.i/n),r.push(t.i/n),r.push(u.i/n),i$(t),t=u.next,l=u.next;continue}if((t=u)===l){o?1===o?e(t=function(e,t,r){let n=e;do{let i=n.prev,a=n.next.next;!iq(i,a)&&iX(i,n,n.next,a)&&iJ(i,a)&&iJ(a,i)&&(t.push(i.i/r),t.push(n.i/r),t.push(a.i/r),i$(n),i$(n.next),n=e=a),n=n.next}while(n!==e)return iH(n)}(iH(t),r,n),r,n,i,a,s,2):2===o&&function(t,r,n,i,a,s){let o=t;do{let t=o.next.next;for(;t!==o.prev;){var l,h;if(o.i!==t.i&&(l=o,h=t,l.next.i!==h.i&&l.prev.i!==h.i&&!function(e,t){let r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&iX(r,r.next,e,t))return!0;r=r.next}while(r!==e)return!1}(l,h)&&(iJ(l,h)&&iJ(h,l)&&function(e,t){let r=e,n=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do r.y>a!=r.next.y>a&&r.next.y!==r.y&&i<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next;while(r!==e)return n}(l,h)&&(ij(l.prev,l,h.prev)||ij(l,h.prev,h))||iq(l,h)&&ij(l.prev,l,l.next)>0&&ij(h.prev,h,h.next)>0))){let l=iK(o,t);o=iH(o,o.next),l=iH(l,l.next),e(o,r,n,i,a,s),e(l,r,n,i,a,s);return}t=t.next}o=o.next}while(o!==t)}(t,r,n,i,a,s):e(iH(t),r,n,i,a,s,1);break}}}(d,p,r,n,i,h),p};function iz(e,t,r,n,i){let a,s;if(i===function(e,t,r,n){let i=0;for(let a=t,s=r-n;a<r;a+=n)i+=(e[s]-e[a])*(e[a+1]+e[s+1]),s=a;return i}(e,t,r,n)>0)for(a=t;a<r;a+=n)s=iQ(a,e[a],e[a+1],s);else for(a=r-n;a>=t;a-=n)s=iQ(a,e[a],e[a+1],s);return s&&iq(s,s.next)&&(i$(s),s=s.next),s}function iH(e,t){if(!e)return e;t||(t=e);let r=e,n;do if(n=!1,!r.steiner&&(iq(r,r.next)||0===ij(r.prev,r,r.next))){if(i$(r),(r=t=r.prev)===r.next)break;n=!0}else r=r.next;while(n||r!==t)return t}function iG(e,t){return e.x-t.x}function iV(e,t,r,n,i){return(e=((e=((e=((e=((e=32767*(e-r)*i)|e<<8)&16711935)|e<<4)&252645135)|e<<2)&858993459)|e<<1)&1431655765)|(t=((t=((t=((t=((t=32767*(t-n)*i)|t<<8)&16711935)|t<<4)&252645135)|t<<2)&858993459)|t<<1)&1431655765)<<1}function iW(e,t,r,n,i,a,s,o){return(i-s)*(t-o)-(e-s)*(a-o)>=0&&(e-s)*(n-o)-(r-s)*(t-o)>=0&&(r-s)*(a-o)-(i-s)*(n-o)>=0}function ij(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function iq(e,t){return e.x===t.x&&e.y===t.y}function iX(e,t,r,n){let i=iZ(ij(e,t,r)),a=iZ(ij(e,t,n)),s=iZ(ij(r,n,e)),o=iZ(ij(r,n,t));return!!(i!==a&&s!==o||0===i&&iY(e,r,t)||0===a&&iY(e,n,t)||0===s&&iY(r,e,n)||0===o&&iY(r,t,n))}function iY(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function iZ(e){return e>0?1:e<0?-1:0}function iJ(e,t){return 0>ij(e.prev,e,e.next)?ij(e,t,e.next)>=0&&ij(e,e.prev,t)>=0:0>ij(e,t,e.prev)||0>ij(e,e.next,t)}function iK(e,t){let r=new i0(e.i,e.x,e.y),n=new i0(t.i,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,a.next=n,n.prev=a,n}function iQ(e,t,r,n){let i=new i0(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function i$(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function i0(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}let i1={area:function(e){let t=e.length,r=0;for(let n=t-1,i=0;i<t;n=i++)r+=e[n].x*e[i].y-e[i].x*e[n].y;return .5*r},isClockWise:function(e){return 0>i1.area(e)},triangulateShape:function(e,t){let r=[],n=[],i=[];i2(e),i3(r,e);let a=e.length;t.forEach(i2);for(let e=0;e<t.length;e++)n.push(a),a+=t[e].length,i3(r,t[e]);let s=iB(r,n);for(let e=0;e<s.length;e+=3)i.push(s.slice(e,e+3));return i}};function i2(e){let t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function i3(e,t){for(let r=0;r<t.length;r++)e.push(t[r].x),e.push(t[r].y)}class i4 extends tT{constructor(e,t){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];let r=this,n=[],i=[];for(let a=0,s=e.length;a<s;a++)(function(e){let a,s,o,l;let h=[],u=void 0!==t.curveSegments?t.curveSegments:12,c=void 0!==t.steps?t.steps:1,d=void 0!==t.depth?t.depth:100,p=void 0===t.bevelEnabled||t.bevelEnabled,f=void 0!==t.bevelThickness?t.bevelThickness:6,m=void 0!==t.bevelSize?t.bevelSize:f-2,g=void 0!==t.bevelOffset?t.bevelOffset:0,v=void 0!==t.bevelSegments?t.bevelSegments:3,y=t.extrudePath,x=void 0!==t.UVGenerator?t.UVGenerator:i5;void 0!==t.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),d=t.amount);let _,b=!1;y&&(_=y.getSpacedPoints(c),b=!0,p=!1,a=y.computeFrenetFrames(c,!1),s=new V,o=new V,l=new V),p||(v=0,f=0,m=0,g=0);let w=e.extractPoints(u),M=w.shape,S=w.holes;if(!i1.isClockWise(M)){M=M.reverse();for(let e=0,t=S.length;e<t;e++){let t=S[e];i1.isClockWise(t)&&(S[e]=t.reverse())}}let T=i1.triangulateShape(M,S),E=M;for(let e=0,t=S.length;e<t;e++){let t=S[e];M=M.concat(t)}function A(e,t,r){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(r).add(e)}let L=M.length,R=T.length;function P(e,t,r){let n,i,a;let s=e.x-t.x,o=e.y-t.y,l=r.x-e.x,h=r.y-e.y,u=s*s+o*o;if(Math.abs(s*h-o*l)>Number.EPSILON){let c=Math.sqrt(u),d=Math.sqrt(l*l+h*h),p=t.x-o/c,f=t.y+s/c,m=((r.x-h/d-p)*h-(r.y+l/d-f)*l)/(s*h-o*l),g=(n=p+s*m-e.x)*n+(i=f+o*m-e.y)*i;if(g<=2)return new O(n,i);a=Math.sqrt(g/2)}else{let e=!1;s>Number.EPSILON?l>Number.EPSILON&&(e=!0):s<-Number.EPSILON?l<-Number.EPSILON&&(e=!0):Math.sign(o)===Math.sign(h)&&(e=!0),e?(n=-o,i=s,a=Math.sqrt(u)):(n=s,i=o,a=Math.sqrt(u/2))}return new O(n/a,i/a)}let C=[];for(let e=0,t=E.length,r=t-1,n=e+1;e<t;e++,r++,n++)r===t&&(r=0),n===t&&(n=0),C[e]=P(E[e],E[r],E[n]);let I=[],D,U=C.concat();for(let e=0,t=S.length;e<t;e++){let t=S[e];D=[];for(let e=0,r=t.length,n=r-1,i=e+1;e<r;e++,n++,i++)n===r&&(n=0),i===r&&(i=0),D[e]=P(t[e],t[n],t[i]);I.push(D),U=U.concat(D)}for(let e=0;e<v;e++){let t=e/v,r=f*Math.cos(t*Math.PI/2),n=m*Math.sin(t*Math.PI/2)+g;for(let e=0,t=E.length;e<t;e++){let t=A(E[e],C[e],n);F(t.x,t.y,-r)}for(let e=0,t=S.length;e<t;e++){let t=S[e];D=I[e];for(let e=0,i=t.length;e<i;e++){let i=A(t[e],D[e],n);F(i.x,i.y,-r)}}}let N=m+g;for(let e=0;e<L;e++){let t=p?A(M[e],U[e],N):M[e];b?(o.copy(a.normals[0]).multiplyScalar(t.x),s.copy(a.binormals[0]).multiplyScalar(t.y),l.copy(_[0]).add(o).add(s),F(l.x,l.y,l.z)):F(t.x,t.y,0)}for(let e=1;e<=c;e++)for(let t=0;t<L;t++){let r=p?A(M[t],U[t],N):M[t];b?(o.copy(a.normals[e]).multiplyScalar(r.x),s.copy(a.binormals[e]).multiplyScalar(r.y),l.copy(_[e]).add(o).add(s),F(l.x,l.y,l.z)):F(r.x,r.y,d/c*e)}for(let e=v-1;e>=0;e--){let t=e/v,r=f*Math.cos(t*Math.PI/2),n=m*Math.sin(t*Math.PI/2)+g;for(let e=0,t=E.length;e<t;e++){let t=A(E[e],C[e],n);F(t.x,t.y,d+r)}for(let e=0,t=S.length;e<t;e++){let t=S[e];D=I[e];for(let e=0,i=t.length;e<i;e++){let i=A(t[e],D[e],n);b?F(i.x,i.y+_[c-1].y,_[c-1].x+r):F(i.x,i.y,d+r)}}}function k(e,t){let i=e.length;for(;--i>=0;){let a=i,s=i-1;s<0&&(s=e.length-1);for(let e=0,i=c+2*v;e<i;e++){let i=L*e,o=L*(e+1);(function(e,t,i,a){z(e),z(t),z(a),z(t),z(i),z(a);let s=n.length/3,o=x.generateSideWallUV(r,n,s-6,s-3,s-2,s-1);H(o[0]),H(o[1]),H(o[3]),H(o[1]),H(o[2]),H(o[3])})(t+a+i,t+s+i,t+s+o,t+a+o)}}}function F(e,t,r){h.push(e),h.push(t),h.push(r)}function B(e,t,i){z(e),z(t),z(i);let a=n.length/3,s=x.generateTopUV(r,n,a-3,a-2,a-1);H(s[0]),H(s[1]),H(s[2])}function z(e){n.push(h[3*e+0]),n.push(h[3*e+1]),n.push(h[3*e+2])}function H(e){i.push(e.x),i.push(e.y)}(function(){let e=n.length/3;if(p){let e=0*L;for(let t=0;t<R;t++){let r=T[t];B(r[2]+e,r[1]+e,r[0]+e)}e=L*(c+2*v);for(let t=0;t<R;t++){let r=T[t];B(r[0]+e,r[1]+e,r[2]+e)}}else{for(let e=0;e<R;e++){let t=T[e];B(t[2],t[1],t[0])}for(let e=0;e<R;e++){let t=T[e];B(t[0]+L*c,t[1]+L*c,t[2]+L*c)}}r.addGroup(e,n.length/3-e,0)})(),function(){let e=n.length/3,t=0;k(E,0),t+=E.length;for(let e=0,r=S.length;e<r;e++){let r=S[e];k(r,t),t+=r.length}r.addGroup(e,n.length/3-e,1)}()})(e[a]);this.setAttribute("position",new tm(n,3)),this.setAttribute("uv",new tm(i,2)),this.computeVertexNormals()}toJSON(){let e=tT.prototype.toJSON.call(this);return function(e,t,r){if(r.shapes=[],Array.isArray(e))for(let t=0,n=e.length;t<n;t++){let n=e[t];r.shapes.push(n.uuid)}else r.shapes.push(e.uuid);return void 0!==t.extrudePath&&(r.options.extrudePath=t.extrudePath.toJSON()),r}(this.parameters.shapes,this.parameters.options,e)}}let i5={generateTopUV:function(e,t,r,n,i){let a=t[3*r],s=t[3*r+1],o=t[3*n],l=t[3*n+1],h=t[3*i],u=t[3*i+1];return[new O(a,s),new O(o,l),new O(h,u)]},generateSideWallUV:function(e,t,r,n,i,a){let s=t[3*r],o=t[3*r+1],l=t[3*r+2],h=t[3*n],u=t[3*n+1],c=t[3*n+2],d=t[3*i],p=t[3*i+1],f=t[3*i+2],m=t[3*a],g=t[3*a+1],v=t[3*a+2];return .01>Math.abs(o-u)?[new O(s,1-l),new O(h,1-c),new O(d,1-f),new O(m,1-v)]:[new O(o,1-l),new O(u,1-c),new O(p,1-f),new O(g,1-v)]}};function i6(e,t,r){tT.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:r};let n=[],i=[],a=[],s=[],o=new V,l=new V,h=new V,u=new V,c=new V;e.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");let d=t+1;for(let n=0;n<=r;n++){let d=n/r;for(let r=0;r<=t;r++){let n=r/t;e(n,d,l),i.push(l.x,l.y,l.z),n-1e-5>=0?(e(n-1e-5,d,h),u.subVectors(l,h)):(e(n+1e-5,d,h),u.subVectors(h,l)),d-1e-5>=0?(e(n,d-1e-5,h),c.subVectors(l,h)):(e(n,d+1e-5,h),c.subVectors(h,l)),o.crossVectors(u,c).normalize(),a.push(o.x,o.y,o.z),s.push(n,d)}}for(let e=0;e<r;e++)for(let r=0;r<t;r++){let t=e*d+r,i=e*d+r+1,a=(e+1)*d+r+1,s=(e+1)*d+r;n.push(t,i,s),n.push(i,a,s)}this.setIndex(n),this.setAttribute("position",new tm(i,3)),this.setAttribute("normal",new tm(a,3)),this.setAttribute("uv",new tm(s,2))}i6.prototype=Object.create(tT.prototype),i6.prototype.constructor=i6;class i8 extends tT{constructor(e,t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};let r=[],n=[],i=[],a=[],s=0,o=0;if(!1===Array.isArray(e))l(e);else for(let t=0;t<e.length;t++)l(e[t]),this.addGroup(s,o,t),s+=o,o=0;function l(e){let s=n.length/3,l=e.extractPoints(t),h=l.shape,u=l.holes;!1===i1.isClockWise(h)&&(h=h.reverse());for(let e=0,t=u.length;e<t;e++){let t=u[e];!0===i1.isClockWise(t)&&(u[e]=t.reverse())}let c=i1.triangulateShape(h,u);for(let e=0,t=u.length;e<t;e++){let t=u[e];h=h.concat(t)}for(let e=0,t=h.length;e<t;e++){let t=h[e];n.push(t.x,t.y,0),i.push(0,0,1),a.push(t.x,t.y)}for(let e=0,t=c.length;e<t;e++){let t=c[e],n=t[0]+s,i=t[1]+s,a=t[2]+s;r.push(n,i,a),o+=3}}this.setIndex(r),this.setAttribute("position",new tm(n,3)),this.setAttribute("normal",new tm(i,3)),this.setAttribute("uv",new tm(a,2))}toJSON(){let e=tT.prototype.toJSON.call(this);return function(e,t){if(t.shapes=[],Array.isArray(e))for(let r=0,n=e.length;r<n;r++){let n=e[r];t.shapes.push(n.uuid)}else t.shapes.push(e.uuid);return t}(this.parameters.shapes,e)}}function i7(e){e5.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new tr(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new tr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=L,this.normalScale=new O(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.vertexTangents=!1,this.setValues(e)}function i9(e){i7.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new O(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,Object.defineProperty(this,"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(e){this.reflectivity=D.clamp(2.5*(e-1)/(e+1),0,1)}}),this.sheen=null,this.transmission=0,this.transmissionMap=null,this.setValues(e)}(class extends e5{constructor(e){super(),this.type="ShadowMaterial",this.color=new tr(0),this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this}}).prototype.isShadowMaterial=!0,(class extends tZ{constructor(e){super(e),this.type="RawShaderMaterial"}}).prototype.isRawShaderMaterial=!0,i7.prototype=Object.create(e5.prototype),i7.prototype.constructor=i7,i7.prototype.isMeshStandardMaterial=!0,i7.prototype.copy=function(e){return e5.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.flatShading=e.flatShading,this.vertexTangents=e.vertexTangents,this},i9.prototype=Object.create(i7.prototype),i9.prototype.constructor=i9,i9.prototype.isMeshPhysicalMaterial=!0,i9.prototype.copy=function(e){return i7.prototype.copy.call(this,e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.reflectivity=e.reflectivity,e.sheen?this.sheen=(this.sheen||new tr).copy(e.sheen):this.sheen=null,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this};class ae extends e5{constructor(e){super(),this.type="MeshPhongMaterial",this.color=new tr(16777215),this.specular=new tr(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new tr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=L,this.normalScale=new O(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.flatShading=e.flatShading,this}}ae.prototype.isMeshPhongMaterial=!0,(class extends e5{constructor(e){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new tr(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new tr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=L,this.normalScale=new O(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this}}).prototype.isMeshToonMaterial=!0,(class extends e5{constructor(e){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=L,this.normalScale=new O(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.flatShading=e.flatShading,this}}).prototype.isMeshNormalMaterial=!0,(class extends e5{constructor(e){super(),this.type="MeshLambertMaterial",this.color=new tr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new tr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this}}).prototype.isMeshLambertMaterial=!0,(class extends e5{constructor(e){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new tr(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=L,this.normalScale=new O(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.flatShading=e.flatShading,this}}).prototype.isMeshMatcapMaterial=!0,(class extends iy{constructor(e){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}).prototype.isLineDashedMaterial=!0;let at={arraySlice:function(e,t,r){return at.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==r?r:e.length)):e.slice(t,r)},convertArray:function(e,t,r){return e&&(r||e.constructor!==t)?"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e):e},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){let t=e.length,r=Array(t);for(let e=0;e!==t;++e)r[e]=e;return r.sort(function(t,r){return e[t]-e[r]}),r},sortedArray:function(e,t,r){let n=e.length,i=new e.constructor(n);for(let a=0,s=0;s!==n;++a){let n=r[a]*t;for(let r=0;r!==t;++r)i[s++]=e[n+r]}return i},flattenJSON:function(e,t,r,n){let i=1,a=e[0];for(;void 0!==a&&void 0===a[n];)a=e[i++];if(void 0===a)return;let s=a[n];if(void 0!==s){if(Array.isArray(s))do void 0!==(s=a[n])&&(t.push(a.time),r.push.apply(r,s)),a=e[i++];while(void 0!==a)else if(void 0!==s.toArray)do void 0!==(s=a[n])&&(t.push(a.time),s.toArray(r,r.length)),a=e[i++];while(void 0!==a)else do void 0!==(s=a[n])&&(t.push(a.time),r.push(s)),a=e[i++];while(void 0!==a)}},subclip:function(e,t,r,n,i=30){let a=e.clone();a.name=t;let s=[];for(let e=0;e<a.tracks.length;++e){let t=a.tracks[e],o=t.getValueSize(),l=[],h=[];for(let e=0;e<t.times.length;++e){let a=t.times[e]*i;if(!(a<r)&&!(a>=n)){l.push(t.times[e]);for(let r=0;r<o;++r)h.push(t.values[e*o+r])}}0!==l.length&&(t.times=at.convertArray(l,t.times.constructor),t.values=at.convertArray(h,t.values.constructor),s.push(t))}a.tracks=s;let o=1/0;for(let e=0;e<a.tracks.length;++e)o>a.tracks[e].times[0]&&(o=a.tracks[e].times[0]);for(let e=0;e<a.tracks.length;++e)a.tracks[e].shift(-1*o);return a.resetDuration(),a},makeClipAdditive:function(e,t=0,r=e,n=30){n<=0&&(n=30);let i=r.tracks.length,a=t/n;for(let t=0;t<i;++t){let n;let i=r.tracks[t],s=i.ValueTypeName;if("bool"===s||"string"===s)continue;let o=e.tracks.find(function(e){return e.name===i.name&&e.ValueTypeName===s});if(void 0===o)continue;let l=0,h=i.getValueSize();i.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(l=h/3);let u=0,c=o.getValueSize();o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=c/3);let d=i.times.length-1;if(a<=i.times[0]){let e=l,t=h-l;n=at.arraySlice(i.values,e,t)}else if(a>=i.times[d]){let e=d*h+l,t=e+h-l;n=at.arraySlice(i.values,e,t)}else{let e=i.createInterpolant(),t=l,r=h-l;e.evaluate(a),n=at.arraySlice(e.resultBuffer,t,r)}"quaternion"===s&&new G().fromArray(n).normalize().conjugate().toArray(n);let p=o.times.length;for(let e=0;e<p;++e){let t=e*c+u;if("quaternion"===s)G.multiplyQuaternionsFlat(o.values,t,n,0,o.values,t);else{let e=c-2*u;for(let r=0;r<e;++r)o.values[t+r]-=n[r]}}}return e.blendMode=2501,e}};function ar(e,t,r,n){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new t.constructor(r),this.sampleValues=t,this.valueSize=r}function an(e,t,r,n){ar.call(this,e,t,r,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function ai(e,t,r,n){ar.call(this,e,t,r,n)}function aa(e,t,r,n){ar.call(this,e,t,r,n)}Object.assign(ar.prototype,{evaluate:function(e){let t=this.parameterPositions,r=this._cachedIndex,n=t[r],i=t[r-1];e:{t:{let a;r:{n:if(!(e<n)){for(let a=r+2;;){if(void 0===n){if(e<i)break n;return r=t.length,this._cachedIndex=r,this.afterEnd_(r-1,e,i)}if(r===a)break;if(i=n,e<(n=t[++r]))break t}a=t.length;break r}if(!(e>=i)){let s=t[1];e<s&&(r=2,i=s);for(let a=r-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,e,n);if(r===a)break;if(n=i,e>=(i=t[--r-1]))break t}a=r,r=0;break r}break e}for(;r<a;){let n=r+a>>>1;e<t[n]?a=n:r=n+1}if(n=t[r],void 0===(i=t[r-1]))return this._cachedIndex=0,this.beforeStart_(0,e,n);if(void 0===n)return r=t.length,this._cachedIndex=r,this.afterEnd_(r-1,i,e)}this._cachedIndex=r,this.intervalChanged_(r,i,n)}return this.interpolate_(r,i,e,n)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){let t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,i=e*n;for(let e=0;e!==n;++e)t[e]=r[i+e];return t},interpolate_:function(){throw Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(ar.prototype,{beforeStart_:ar.prototype.copySampleValue_,afterEnd_:ar.prototype.copySampleValue_}),an.prototype=Object.assign(Object.create(ar.prototype),{constructor:an,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(e,t,r){let n=this.parameterPositions,i=e-2,a=e+1,s=n[i],o=n[a];if(void 0===s)switch(this.getSettings_().endingStart){case 2401:i=e,s=2*t-r;break;case 2402:i=n.length-2,s=t+n[i]-n[i+1];break;default:i=e,s=r}if(void 0===o)switch(this.getSettings_().endingEnd){case 2401:a=e,o=2*r-t;break;case 2402:a=1,o=r+n[1]-n[0];break;default:a=e-1,o=t}let l=(r-t)*.5,h=this.valueSize;this._weightPrev=l/(t-s),this._weightNext=l/(o-r),this._offsetPrev=i*h,this._offsetNext=a*h},interpolate_:function(e,t,r,n){let i=this.resultBuffer,a=this.sampleValues,s=this.valueSize,o=e*s,l=o-s,h=this._offsetPrev,u=this._offsetNext,c=this._weightPrev,d=this._weightNext,p=(r-t)/(n-t),f=p*p,m=f*p,g=-c*m+2*c*f-c*p,v=(1+c)*m+(-1.5-2*c)*f+(-.5+c)*p+1,y=(-1-d)*m+(1.5+d)*f+.5*p,x=d*m-d*f;for(let e=0;e!==s;++e)i[e]=g*a[h+e]+v*a[l+e]+y*a[o+e]+x*a[u+e];return i}}),ai.prototype=Object.assign(Object.create(ar.prototype),{constructor:ai,interpolate_:function(e,t,r,n){let i=this.resultBuffer,a=this.sampleValues,s=this.valueSize,o=e*s,l=o-s,h=(r-t)/(n-t),u=1-h;for(let e=0;e!==s;++e)i[e]=a[l+e]*u+a[o+e]*h;return i}}),aa.prototype=Object.assign(Object.create(ar.prototype),{constructor:aa,interpolate_:function(e){return this.copySampleValue_(e-1)}});class as{constructor(e,t,r,n){if(void 0===e)throw Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=at.convertArray(t,this.TimeBufferType),this.values=at.convertArray(r,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}static toJSON(e){let t;let r=e.constructor;if(r.toJSON!==this.toJSON)t=r.toJSON(e);else{t={name:e.name,times:at.convertArray(e.times,Array),values:at.convertArray(e.values,Array)};let r=e.getInterpolation();r!==e.DefaultInterpolation&&(t.interpolation=r)}return t.type=e.ValueTypeName,t}InterpolantFactoryMethodDiscrete(e){return new aa(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new ai(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new an(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case w:t=this.InterpolantFactoryMethodDiscrete;break;case M:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){let t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw Error(t)}return console.warn("THREE.KeyframeTrack:",t),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return w;case this.InterpolantFactoryMethodLinear:return M;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){let t=this.times;for(let r=0,n=t.length;r!==n;++r)t[r]+=e}return this}scale(e){if(1!==e){let t=this.times;for(let r=0,n=t.length;r!==n;++r)t[r]*=e}return this}trim(e,t){let r=this.times,n=r.length,i=0,a=n-1;for(;i!==n&&r[i]<e;)++i;for(;-1!==a&&r[a]>t;)--a;if(++a,0!==i||a!==n){i>=a&&(i=(a=Math.max(a,1))-1);let e=this.getValueSize();this.times=at.arraySlice(r,i,a),this.values=at.arraySlice(this.values,i*e,a*e)}return this}validate(){let e=!0,t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);let r=this.times,n=this.values,i=r.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let t=0;t!==i;t++){let n=r[t];if("number"==typeof n&&isNaN(n)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,t,n),e=!1;break}if(null!==a&&a>n){console.error("THREE.KeyframeTrack: Out of order keys.",this,t,n,a),e=!1;break}a=n}if(void 0!==n&&at.isTypedArray(n))for(let t=0,r=n.length;t!==r;++t){let r=n[t];if(isNaN(r)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,t,r),e=!1;break}}return e}optimize(){let e=at.arraySlice(this.times),t=at.arraySlice(this.values),r=this.getValueSize(),n=2302===this.getInterpolation(),i=e.length-1,a=1;for(let s=1;s<i;++s){let i=!1,o=e[s];if(o!==e[s+1]&&(1!==s||o!==e[0])){if(n)i=!0;else{let e=s*r,n=e-r,a=e+r;for(let s=0;s!==r;++s){let r=t[e+s];if(r!==t[n+s]||r!==t[a+s]){i=!0;break}}}}if(i){if(s!==a){e[a]=e[s];let n=s*r,i=a*r;for(let e=0;e!==r;++e)t[i+e]=t[n+e]}++a}}if(i>0){e[a]=e[i];for(let e=i*r,n=a*r,s=0;s!==r;++s)t[n+s]=t[e+s];++a}return a!==e.length?(this.times=at.arraySlice(e,0,a),this.values=at.arraySlice(t,0,a*r)):(this.times=e,this.values=t),this}clone(){let e=at.arraySlice(this.times,0),t=at.arraySlice(this.values,0),r=new this.constructor(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}as.prototype.TimeBufferType=Float32Array,as.prototype.ValueBufferType=Float32Array,as.prototype.DefaultInterpolation=M;class ao extends as{}ao.prototype.ValueTypeName="bool",ao.prototype.ValueBufferType=Array,ao.prototype.DefaultInterpolation=w,ao.prototype.InterpolantFactoryMethodLinear=void 0,ao.prototype.InterpolantFactoryMethodSmooth=void 0;class al extends as{}al.prototype.ValueTypeName="color";class ah extends as{}function au(e,t,r,n){ar.call(this,e,t,r,n)}ah.prototype.ValueTypeName="number",au.prototype=Object.assign(Object.create(ar.prototype),{constructor:au,interpolate_:function(e,t,r,n){let i=this.resultBuffer,a=this.sampleValues,s=this.valueSize,o=(r-t)/(n-t),l=e*s;for(let e=l+s;l!==e;l+=4)G.slerpFlat(i,0,a,l-s,a,l,o);return i}});class ac extends as{InterpolantFactoryMethodLinear(e){return new au(this.times,this.values,this.getValueSize(),e)}}ac.prototype.ValueTypeName="quaternion",ac.prototype.DefaultInterpolation=M,ac.prototype.InterpolantFactoryMethodSmooth=void 0;class ad extends as{}ad.prototype.ValueTypeName="string",ad.prototype.ValueBufferType=Array,ad.prototype.DefaultInterpolation=w,ad.prototype.InterpolantFactoryMethodLinear=void 0,ad.prototype.InterpolantFactoryMethodSmooth=void 0;class ap extends as{}ap.prototype.ValueTypeName="vector";class af{constructor(e,t=-1,r,n=2500){this.name=e,this.tracks=r,this.duration=t,this.blendMode=n,this.uuid=D.generateUUID(),this.duration<0&&this.resetDuration()}static parse(e){let t=[],r=e.tracks,n=1/(e.fps||1);for(let e=0,i=r.length;e!==i;++e)t.push((function(e){if(void 0===e.type)throw Error("THREE.KeyframeTrack: track type undefined, can not parse");let t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return ah;case"vector":case"vector2":case"vector3":case"vector4":return ap;case"color":return al;case"quaternion":return ac;case"bool":case"boolean":return ao;case"string":return ad}throw Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){let t=[],r=[];at.flattenJSON(e.keys,t,r,"value"),e.times=t,e.values=r}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)})(r[e]).scale(n));let i=new this(e.name,e.duration,t,e.blendMode);return i.uuid=e.uuid,i}static toJSON(e){let t=[],r=e.tracks,n={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let e=0,n=r.length;e!==n;++e)t.push(as.toJSON(r[e]));return n}static CreateFromMorphTargetSequence(e,t,r,n){let i=t.length,a=[];for(let e=0;e<i;e++){let s=[],o=[];s.push((e+i-1)%i,e,(e+1)%i),o.push(0,1,0);let l=at.getKeyframeOrder(s);s=at.sortedArray(s,1,l),o=at.sortedArray(o,1,l),n||0!==s[0]||(s.push(i),o.push(o[0])),a.push(new ah(".morphTargetInfluences["+t[e].name+"]",s,o).scale(1/r))}return new this(e,-1,a)}static findByName(e,t){let r=e;Array.isArray(e)||(r=e.geometry&&e.geometry.animations||e.animations);for(let e=0;e<r.length;e++)if(r[e].name===t)return r[e];return null}static CreateClipsFromMorphTargetSequences(e,t,r){let n={},i=/^([\w-]*?)([\d]+)$/;for(let t=0,r=e.length;t<r;t++){let r=e[t],a=r.name.match(i);if(a&&a.length>1){let e=a[1],t=n[e];t||(n[e]=t=[]),t.push(r)}}let a=[];for(let e in n)a.push(this.CreateFromMorphTargetSequence(e,n[e],t,r));return a}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let r=function(e,t,r,n,i){if(0!==r.length){let a=[],s=[];at.flattenJSON(r,a,s,n),0!==a.length&&i.push(new e(t,a,s))}},n=[],i=e.name||"default",a=e.fps||30,s=e.blendMode,o=e.length||-1,l=e.hierarchy||[];for(let e=0;e<l.length;e++){let i=l[e].keys;if(i&&0!==i.length){if(i[0].morphTargets){let e;let t={};for(e=0;e<i.length;e++)if(i[e].morphTargets)for(let r=0;r<i[e].morphTargets.length;r++)t[i[e].morphTargets[r]]=-1;for(let r in t){let t=[],a=[];for(let n=0;n!==i[e].morphTargets.length;++n){let n=i[e];t.push(n.time),a.push(n.morphTarget===r?1:0)}n.push(new ah(".morphTargetInfluence["+r+"]",t,a))}o=t.length*(a||1)}else{let a=".bones["+t[e].name+"]";r(ap,a+".position",i,"pos",n),r(ac,a+".quaternion",i,"rot",n),r(ap,a+".scale",i,"scl",n)}}}return 0===n.length?null:new this(i,o,n,s)}resetDuration(){let e=this.tracks,t=0;for(let r=0,n=e.length;r!==n;++r){let e=this.tracks[r];t=Math.max(t,e.times[e.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){let e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}let am={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function ag(e,t,r){let n;let i=this,a=!1,s=0,o=0,l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(e){o++,!1===a&&void 0!==i.onStart&&i.onStart(e,s,o),a=!0},this.itemEnd=function(e){s++,void 0!==i.onProgress&&i.onProgress(e,s,o),s===o&&(a=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(e){void 0!==i.onError&&i.onError(e)},this.resolveURL=function(e){return n?n(e):e},this.setURLModifier=function(e){return n=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){let t=l.indexOf(e);return -1!==t&&l.splice(t,2),this},this.getHandler=function(e){for(let t=0,r=l.length;t<r;t+=2){let r=l[t],n=l[t+1];if(r.global&&(r.lastIndex=0),r.test(e))return n}return null}}let av=new ag;function ay(e){this.manager=void 0!==e?e:av,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}Object.assign(ay.prototype,{load:function(){},loadAsync:function(e,t){let r=this;return new Promise(function(n,i){r.load(e,n,t,i)})},parse:function(){},setCrossOrigin:function(e){return this.crossOrigin=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}});let ax={};function a_(e){ay.call(this,e)}function ab(e){ay.call(this,e)}a_.prototype=Object.assign(Object.create(ay.prototype),{constructor:a_,load:function(e,t,r,n){let i;void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);let a=this,s=am.get(e);if(void 0!==s)return a.manager.itemStart(e),setTimeout(function(){t&&t(s),a.manager.itemEnd(e)},0),s;if(void 0!==ax[e]){ax[e].push({onLoad:t,onProgress:r,onError:n});return}let o=e.match(/^data:(.*?)(;base64)?,(.*)$/);if(o){let r=o[1],i=!!o[2],s=o[3];s=decodeURIComponent(s),i&&(s=atob(s));try{let n;let i=(this.responseType||"").toLowerCase();switch(i){case"arraybuffer":case"blob":let o=new Uint8Array(s.length);for(let e=0;e<s.length;e++)o[e]=s.charCodeAt(e);n="blob"===i?new Blob([o.buffer],{type:r}):o.buffer;break;case"document":n=new DOMParser().parseFromString(s,r);break;case"json":n=JSON.parse(s);break;default:n=s}setTimeout(function(){t&&t(n),a.manager.itemEnd(e)},0)}catch(t){setTimeout(function(){n&&n(t),a.manager.itemError(e),a.manager.itemEnd(e)},0)}}else{for(let s in ax[e]=[],ax[e].push({onLoad:t,onProgress:r,onError:n}),(i=new XMLHttpRequest).open("GET",e,!0),i.addEventListener("load",function(t){let r=this.response,n=ax[e];if(delete ax[e],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),am.add(e,r);for(let e=0,t=n.length;e<t;e++){let t=n[e];t.onLoad&&t.onLoad(r)}a.manager.itemEnd(e)}else{for(let e=0,r=n.length;e<r;e++){let r=n[e];r.onError&&r.onError(t)}a.manager.itemError(e),a.manager.itemEnd(e)}},!1),i.addEventListener("progress",function(t){let r=ax[e];for(let e=0,n=r.length;e<n;e++){let n=r[e];n.onProgress&&n.onProgress(t)}},!1),i.addEventListener("error",function(t){let r=ax[e];delete ax[e];for(let e=0,n=r.length;e<n;e++){let n=r[e];n.onError&&n.onError(t)}a.manager.itemError(e),a.manager.itemEnd(e)},!1),i.addEventListener("abort",function(t){let r=ax[e];delete ax[e];for(let e=0,n=r.length;e<n;e++){let n=r[e];n.onError&&n.onError(t)}a.manager.itemError(e),a.manager.itemEnd(e)},!1),void 0!==this.responseType&&(i.responseType=this.responseType),void 0!==this.withCredentials&&(i.withCredentials=this.withCredentials),i.overrideMimeType&&i.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)i.setRequestHeader(s,this.requestHeader[s]);i.send(null)}return a.manager.itemStart(e),i},setResponseType:function(e){return this.responseType=e,this},setMimeType:function(e){return this.mimeType=e,this}}),ab.prototype=Object.assign(Object.create(ay.prototype),{constructor:ab,load:function(e,t,r,n){let i=this,a=[],s=new iN,o=new a_(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(i.withCredentials);let l=0;if(Array.isArray(e))for(let h=0,u=e.length;h<u;++h)!function(h){o.load(e[h],function(e){let r=i.parse(e,!0);a[h]={width:r.width,height:r.height,format:r.format,mipmaps:r.mipmaps},6===(l+=1)&&(1===r.mipmapCount&&(s.minFilter=v),s.image=a,s.format=r.format,s.needsUpdate=!0,t&&t(s))},r,n)}(h);else o.load(e,function(e){let r=i.parse(e,!0);if(r.isCubemap){let e=r.mipmaps.length/r.mipmapCount;for(let t=0;t<e;t++){a[t]={mipmaps:[]};for(let e=0;e<r.mipmapCount;e++)a[t].mipmaps.push(r.mipmaps[t*r.mipmapCount+e]),a[t].format=r.format,a[t].width=r.width,a[t].height=r.height}s.image=a}else s.image.width=r.width,s.image.height=r.height,s.mipmaps=r.mipmaps;1===r.mipmapCount&&(s.minFilter=v),s.format=r.format,s.needsUpdate=!0,t&&t(s)},r,n);return s}});class aw extends ay{constructor(e){super(e)}load(e,t,r,n){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);let i=this,a=am.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout(function(){t&&t(a),i.manager.itemEnd(e)},0),a;let s=document.createElementNS("http://www.w3.org/1999/xhtml","img");function o(){s.removeEventListener("load",o,!1),s.removeEventListener("error",l,!1),am.add(e,this),t&&t(this),i.manager.itemEnd(e)}function l(t){s.removeEventListener("load",o,!1),s.removeEventListener("error",l,!1),n&&n(t),i.manager.itemError(e),i.manager.itemEnd(e)}return s.addEventListener("load",o,!1),s.addEventListener("error",l,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(s.crossOrigin=this.crossOrigin),i.manager.itemStart(e),s.src=e,s}}class aM extends ay{constructor(e){super(e)}load(e,t,r,n){let i=new t$,a=new aw(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);let s=0;for(let r=0;r<e.length;++r)!function(r){a.load(e[r],function(e){i.images[r]=e,6==++s&&(i.needsUpdate=!0,t&&t(i))},void 0,n)}(r);return i}}function aS(e){ay.call(this,e)}function aT(e){ay.call(this,e)}function aE(){this.type="Curve",this.arcLengthDivisions=200}aS.prototype=Object.assign(Object.create(ay.prototype),{constructor:aS,load:function(e,t,r,n){let i=this,a=new t1,s=new a_(this.manager);return s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setPath(this.path),s.setWithCredentials(i.withCredentials),s.load(e,function(e){let r=i.parse(e);r&&(void 0!==r.image?a.image=r.image:void 0!==r.data&&(a.image.width=r.width,a.image.height=r.height,a.image.data=r.data),a.wrapS=void 0!==r.wrapS?r.wrapS:d,a.wrapT=void 0!==r.wrapT?r.wrapT:d,a.magFilter=void 0!==r.magFilter?r.magFilter:v,a.minFilter=void 0!==r.minFilter?r.minFilter:v,a.anisotropy=void 0!==r.anisotropy?r.anisotropy:1,void 0!==r.encoding&&(a.encoding=r.encoding),void 0!==r.flipY&&(a.flipY=r.flipY),void 0!==r.format&&(a.format=r.format),void 0!==r.type&&(a.type=r.type),void 0!==r.mipmaps&&(a.mipmaps=r.mipmaps,a.minFilter=x),1===r.mipmapCount&&(a.minFilter=v),a.needsUpdate=!0,t&&t(a,r))},r,n),a}}),aT.prototype=Object.assign(Object.create(ay.prototype),{constructor:aT,load:function(e,t,r,n){let i=new F,a=new aw(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(r){i.image=r;let n=e.search(/\.jpe?g($|\?)/i)>0||0===e.search(/^data\:image\/jpeg/);i.format=n?_:b,i.needsUpdate=!0,void 0!==t&&t(i)},r,n),i}}),Object.assign(aE.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,t){let r=this.getUtoTmapping(e);return this.getPoint(r,t)},getPoints:function(e=5){let t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return t},getSpacedPoints:function(e=5){let t=[];for(let r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t},getLength:function(){let e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(void 0===e&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let t=[],r,n=this.getPoint(0),i=0;t.push(0);for(let a=1;a<=e;a++)t.push(i+=(r=this.getPoint(a/e)).distanceTo(n)),n=r;return this.cacheArcLengths=t,t},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){let r;let n=this.getLengths(),i=0,a=n.length;r=t||e*n[a-1];let s=0,o=a-1,l;for(;s<=o;)if((l=n[i=Math.floor(s+(o-s)/2)]-r)<0)s=i+1;else if(l>0)o=i-1;else{o=i;break}if(n[i=o]===r)return i/(a-1);let h=n[i],u=n[i+1];return(i+(r-h)/(u-h))/(a-1)},getTangent:function(e,t){let r=e-1e-4,n=e+1e-4;r<0&&(r=0),n>1&&(n=1);let i=this.getPoint(r),a=this.getPoint(n),s=t||(i.isVector2?new O:new V);return s.copy(a).sub(i).normalize(),s},getTangentAt:function(e,t){let r=this.getUtoTmapping(e);return this.getTangent(r,t)},computeFrenetFrames:function(e,t){let r=new V,n=[],i=[],a=[],s=new V,o=new ev;for(let t=0;t<=e;t++){let r=t/e;n[t]=this.getTangentAt(r,new V),n[t].normalize()}i[0]=new V,a[0]=new V;let l=Number.MAX_VALUE,h=Math.abs(n[0].x),u=Math.abs(n[0].y),c=Math.abs(n[0].z);h<=l&&(l=h,r.set(1,0,0)),u<=l&&(l=u,r.set(0,1,0)),c<=l&&r.set(0,0,1),s.crossVectors(n[0],r).normalize(),i[0].crossVectors(n[0],s),a[0].crossVectors(n[0],i[0]);for(let t=1;t<=e;t++){if(i[t]=i[t-1].clone(),a[t]=a[t-1].clone(),s.crossVectors(n[t-1],n[t]),s.length()>Number.EPSILON){s.normalize();let e=Math.acos(D.clamp(n[t-1].dot(n[t]),-1,1));i[t].applyMatrix4(o.makeRotationAxis(s,e))}a[t].crossVectors(n[t],i[t])}if(!0===t){let t=Math.acos(D.clamp(i[0].dot(i[e]),-1,1));t/=e,n[0].dot(s.crossVectors(i[0],i[e]))>0&&(t=-t);for(let r=1;r<=e;r++)i[r].applyMatrix4(o.makeRotationAxis(n[r],t*r)),a[r].crossVectors(n[r],i[r])}return{tangents:n,normals:i,binormals:a}},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){let e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}});class aA extends aE{constructor(e=0,t=0,r=1,n=1,i=0,a=2*Math.PI,s=!1,o=0){super(),this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=r,this.yRadius=n,this.aStartAngle=i,this.aEndAngle=a,this.aClockwise=s,this.aRotation=o}getPoint(e,t){let r=t||new O,n=2*Math.PI,i=this.aEndAngle-this.aStartAngle,a=Math.abs(i)<Number.EPSILON;for(;i<0;)i+=n;for(;i>n;)i-=n;i<Number.EPSILON&&(i=a?0:n),!0!==this.aClockwise||a||(i===n?i=-n:i-=n);let s=this.aStartAngle+e*i,o=this.aX+this.xRadius*Math.cos(s),l=this.aY+this.yRadius*Math.sin(s);if(0!==this.aRotation){let e=Math.cos(this.aRotation),t=Math.sin(this.aRotation),r=o-this.aX,n=l-this.aY;o=r*e-n*t+this.aX,l=r*t+n*e+this.aY}return r.set(o,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){let e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}aA.prototype.isEllipseCurve=!0;class aL extends aA{constructor(e,t,r,n,i,a){super(e,t,r,r,n,i,a),this.type="ArcCurve"}}function aR(){let e=0,t=0,r=0,n=0;function i(i,a,s,o){e=i,t=s,r=-3*i+3*a-2*s-o,n=2*i-2*a+s+o}return{initCatmullRom:function(e,t,r,n,a){i(t,r,a*(r-e),a*(n-t))},initNonuniformCatmullRom:function(e,t,r,n,a,s,o){let l=(t-e)/a-(r-e)/(a+s)+(r-t)/s,h=(r-t)/s-(n-t)/(s+o)+(n-r)/o;i(t,r,l*=s,h*=s)},calc:function(i){let a=i*i;return e+t*i+r*a+a*i*n}}}aL.prototype.isArcCurve=!0;let aP=new V,aC=new aR,aI=new aR,aD=new aR;class aO extends aE{constructor(e=[],t=!1,r="centripetal",n=.5){super(),this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=r,this.tension=n}getPoint(e,t=new V){let r,n;let i=this.points,a=i.length,s=(a-(this.closed?0:1))*e,o=Math.floor(s),l=s-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/a)+1)*a:0===l&&o===a-1&&(o=a-2,l=1),this.closed||o>0?r=i[(o-1)%a]:(aP.subVectors(i[0],i[1]).add(i[0]),r=aP);let h=i[o%a],u=i[(o+1)%a];if(this.closed||o+2<a?n=i[(o+2)%a]:(aP.subVectors(i[a-1],i[a-2]).add(i[a-1]),n=aP),"centripetal"===this.curveType||"chordal"===this.curveType){let e="chordal"===this.curveType?.5:.25,t=Math.pow(r.distanceToSquared(h),e),i=Math.pow(h.distanceToSquared(u),e),a=Math.pow(u.distanceToSquared(n),e);i<1e-4&&(i=1),t<1e-4&&(t=i),a<1e-4&&(a=i),aC.initNonuniformCatmullRom(r.x,h.x,u.x,n.x,t,i,a),aI.initNonuniformCatmullRom(r.y,h.y,u.y,n.y,t,i,a),aD.initNonuniformCatmullRom(r.z,h.z,u.z,n.z,t,i,a)}else"catmullrom"===this.curveType&&(aC.initCatmullRom(r.x,h.x,u.x,n.x,this.tension),aI.initCatmullRom(r.y,h.y,u.y,n.y,this.tension),aD.initCatmullRom(r.z,h.z,u.z,n.z,this.tension));return t.set(aC.calc(l),aI.calc(l),aD.calc(l)),t}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){let r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let r=e.points[t];this.points.push(new V().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function aU(e,t,r,n,i){let a=(n-t)*.5,s=(i-r)*.5,o=e*e;return e*o*(2*r-2*n+a+s)+(-3*r+3*n-2*a-s)*o+a*e+r}function aN(e,t,r,n){return function(e,t){let r=1-e;return r*r*t}(e,t)+2*(1-e)*e*r+e*e*n}function ak(e,t,r,n,i){return function(e,t){let r=1-e;return r*r*r*t}(e,t)+function(e,t){let r=1-e;return 3*r*r*e*t}(e,r)+3*(1-e)*e*e*n+e*e*e*i}aO.prototype.isCatmullRomCurve3=!0;class aF extends aE{constructor(e=new O,t=new O,r=new O,n=new O){super(),this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=r,this.v3=n}getPoint(e,t=new O){let r=this.v0,n=this.v1,i=this.v2,a=this.v3;return t.set(ak(e,r.x,n.x,i.x,a.x),ak(e,r.y,n.y,i.y,a.y)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}aF.prototype.isCubicBezierCurve=!0;class aB extends aE{constructor(e=new V,t=new V,r=new V,n=new V){super(),this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=r,this.v3=n}getPoint(e,t=new V){let r=this.v0,n=this.v1,i=this.v2,a=this.v3;return t.set(ak(e,r.x,n.x,i.x,a.x),ak(e,r.y,n.y,i.y,a.y),ak(e,r.z,n.z,i.z,a.z)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}aB.prototype.isCubicBezierCurve3=!0;class az extends aE{constructor(e=new O,t=new O){super(),this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new O){return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){let r=t||new O;return r.copy(this.v2).sub(this.v1).normalize(),r}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}az.prototype.isLineCurve=!0;class aH extends aE{constructor(e=new O,t=new O,r=new O){super(),this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new O){let r=this.v0,n=this.v1,i=this.v2;return t.set(aN(e,r.x,n.x,i.x),aN(e,r.y,n.y,i.y)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}aH.prototype.isQuadraticBezierCurve=!0;class aG extends aE{constructor(e=new V,t=new V,r=new V){super(),this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new V){let r=this.v0,n=this.v1,i=this.v2;return t.set(aN(e,r.x,n.x,i.x),aN(e,r.y,n.y,i.y),aN(e,r.z,n.z,i.z)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}aG.prototype.isQuadraticBezierCurve3=!0;class aV extends aE{constructor(e=[]){super(),this.type="SplineCurve",this.points=e}getPoint(e,t=new O){let r=this.points,n=(r.length-1)*e,i=Math.floor(n),a=n-i,s=r[0===i?i:i-1],o=r[i],l=r[i>r.length-2?r.length-1:i+1],h=r[i>r.length-3?r.length-1:i+2];return t.set(aU(a,s.x,o.x,l.x,h.x),aU(a,s.y,o.y,l.y,h.y)),t}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let r=e.points[t];this.points.push(r.clone())}return this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){let r=this.points[t];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let r=e.points[t];this.points.push(new O().fromArray(r))}return this}}aV.prototype.isSplineCurve=!0;var aW=/*#__PURE__*/Object.freeze({__proto__:null,ArcCurve:aL,CatmullRomCurve3:aO,CubicBezierCurve:aF,CubicBezierCurve3:aB,EllipseCurve:aA,LineCurve:az,LineCurve3:class extends aE{constructor(e=new V,t=new V){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=e,this.v2=t}getPoint(e,t=new V){return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},QuadraticBezierCurve:aH,QuadraticBezierCurve3:aG,SplineCurve:aV});class aj extends aE{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){let e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new az(t,e))}getPoint(e){let t=e*this.getLength(),r=this.getCurveLengths(),n=0;for(;n<r.length;){if(r[n]>=t){let e=r[n]-t,i=this.curves[n],a=i.getLength(),s=0===a?0:1-e/a;return i.getPointAt(s)}n++}return null}getLength(){let e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let e=[],t=0;for(let r=0,n=this.curves.length;r<n;r++)e.push(t+=this.curves[r].getLength());return this.cacheLengths=e,e}getSpacedPoints(e=40){let t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){let t;let r=[];for(let n=0,i=this.curves;n<i.length;n++){let a=i[n],s=a&&a.isEllipseCurve?2*e:a&&(a.isLineCurve||a.isLineCurve3)?1:a&&a.isSplineCurve?e*a.points.length:e,o=a.getPoints(s);for(let e=0;e<o.length;e++){let n=o[e];t&&t.equals(n)||(r.push(n),t=n)}}return this.autoClose&&r.length>1&&!r[r.length-1].equals(r[0])&&r.push(r[0]),r}copy(e){super.copy(e),this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){let r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){let e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,r=this.curves.length;t<r;t++){let r=this.curves[t];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){let r=e.curves[t];this.curves.push(new aW[r.type]().fromJSON(r))}return this}}class aq extends aj{constructor(e){super(),this.type="Path",this.currentPoint=new O,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){let r=new az(this.currentPoint.clone(),new O(e,t));return this.curves.push(r),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,r,n){let i=new aH(this.currentPoint.clone(),new O(e,t),new O(r,n));return this.curves.push(i),this.currentPoint.set(r,n),this}bezierCurveTo(e,t,r,n,i,a){let s=new aF(this.currentPoint.clone(),new O(e,t),new O(r,n),new O(i,a));return this.curves.push(s),this.currentPoint.set(i,a),this}splineThru(e){let t=new aV([this.currentPoint.clone()].concat(e));return this.curves.push(t),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,r,n,i,a){let s=this.currentPoint.x,o=this.currentPoint.y;return this.absarc(e+s,t+o,r,n,i,a),this}absarc(e,t,r,n,i,a){return this.absellipse(e,t,r,r,n,i,a),this}ellipse(e,t,r,n,i,a,s,o){let l=this.currentPoint.x,h=this.currentPoint.y;return this.absellipse(e+l,t+h,r,n,i,a,s,o),this}absellipse(e,t,r,n,i,a,s,o){let l=new aA(e,t,r,n,i,a,s,o);if(this.curves.length>0){let e=l.getPoint(0);e.equals(this.currentPoint)||this.lineTo(e.x,e.y)}this.curves.push(l);let h=l.getPoint(1);return this.currentPoint.copy(h),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){let e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class aX extends aq{constructor(e){super(e),this.uuid=D.generateUUID(),this.type="Shape",this.holes=[]}getPointsHoles(e){let t=[];for(let r=0,n=this.holes.length;r<n;r++)t[r]=this.holes[r].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){let r=e.holes[t];this.holes.push(r.clone())}return this}toJSON(){let e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,r=this.holes.length;t<r;t++){let r=this.holes[t];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){let r=e.holes[t];this.holes.push(new aq().fromJSON(r))}return this}}class aY extends eG{constructor(e,t=1){super(),this.type="Light",this.color=new tr(e),this.intensity=t}copy(e){return super.copy(e),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}aY.prototype.isLight=!0,(class extends aY{constructor(e,t,r){super(e,r),this.type="HemisphereLight",this.position.copy(eG.DefaultUp),this.updateMatrix(),this.groundColor=new tr(t)}copy(e){return aY.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}).prototype.isHemisphereLight=!0;let aZ=/*@__PURE__*/new ev,aJ=/*@__PURE__*/new V,aK=/*@__PURE__*/new V;class aQ{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new O(512,512),this.map=null,this.mapPass=null,this.matrix=new ev,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new t4,this._frameExtents=new O(1,1),this._viewportCount=1,this._viewports=[new z(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){let t=this.camera,r=this.matrix;aJ.setFromMatrixPosition(e.matrixWorld),t.position.copy(aJ),aK.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(aK),t.updateMatrixWorld(),aZ.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(aZ),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(t.projectionMatrix),r.multiply(t.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class a$ extends aQ{constructor(){super(new tK(50,1,.5,500)),this.focus=1}updateMatrices(e){let t=this.camera,r=2*D.RAD2DEG*e.angle*this.focus,n=this.mapSize.width/this.mapSize.height,i=e.distance||t.far;(r!==t.fov||n!==t.aspect||i!==t.far)&&(t.fov=r,t.aspect=n,t.far=i,t.updateProjectionMatrix()),super.updateMatrices(e)}}a$.prototype.isSpotLightShadow=!0;class a0 extends aY{constructor(e,t,r=0,n=Math.PI/3,i=0,a=1){super(e,t),this.type="SpotLight",this.position.copy(eG.DefaultUp),this.updateMatrix(),this.target=new eG,this.distance=r,this.angle=n,this.penumbra=i,this.decay=a,this.shadow=new a$}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}copy(e){return super.copy(e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}a0.prototype.isSpotLight=!0;let a1=/*@__PURE__*/new ev,a2=/*@__PURE__*/new V,a3=/*@__PURE__*/new V;class a4 extends aQ{constructor(){super(new tK(90,1,.5,500)),this._frameExtents=new O(4,2),this._viewportCount=6,this._viewports=[new z(2,1,1,1),new z(0,1,1,1),new z(3,1,1,1),new z(1,1,1,1),new z(3,0,1,1),new z(1,0,1,1)],this._cubeDirections=[new V(1,0,0),new V(-1,0,0),new V(0,0,1),new V(0,0,-1),new V(0,1,0),new V(0,-1,0)],this._cubeUps=[new V(0,1,0),new V(0,1,0),new V(0,1,0),new V(0,1,0),new V(0,0,1),new V(0,0,-1)]}updateMatrices(e,t=0){let r=this.camera,n=this.matrix;a2.setFromMatrixPosition(e.matrixWorld),r.position.copy(a2),a3.copy(r.position),a3.add(this._cubeDirections[t]),r.up.copy(this._cubeUps[t]),r.lookAt(a3),r.updateMatrixWorld(),n.makeTranslation(-a2.x,-a2.y,-a2.z),a1.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(a1)}}a4.prototype.isPointLightShadow=!0;class a5 extends aY{constructor(e,t,r=0,n=1){super(e,t),this.type="PointLight",this.distance=r,this.decay=n,this.shadow=new a4}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}copy(e){return super.copy(e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}a5.prototype.isPointLight=!0;class a6 extends tJ{constructor(e=-1,t=1,r=1,n=-1,i=.1,a=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=n,this.near=i,this.far=a,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,r,n,i,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=n,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,n=(this.top+this.bottom)/2,i=r-e,a=r+e,s=n+t,o=n-t;if(null!==this.view&&this.view.enabled){let e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i+=e*this.view.offsetX,a=i+e*this.view.width,s-=t*this.view.offsetY,o=s-t*this.view.height}this.projectionMatrix.makeOrthographic(i,a,s,o,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=eG.prototype.toJSON.call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}a6.prototype.isOrthographicCamera=!0;class a8 extends aQ{constructor(){super(new a6(-5,5,5,-5,.5,500))}}a8.prototype.isDirectionalLightShadow=!0;class a7 extends aY{constructor(e,t){super(e,t),this.type="DirectionalLight",this.position.copy(eG.DefaultUp),this.updateMatrix(),this.target=new eG,this.shadow=new a8}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}a7.prototype.isDirectionalLight=!0;class a9 extends aY{constructor(e,t){super(e,t),this.type="AmbientLight"}}a9.prototype.isAmbientLight=!0,(class extends aY{constructor(e,t,r=10,n=10){super(e,t),this.type="RectAreaLight",this.width=r,this.height=n}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){let t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}).prototype.isRectAreaLight=!0;class se{constructor(){this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new V)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){let r=e.x,n=e.y,i=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.282095),t.addScaledVector(a[1],.488603*n),t.addScaledVector(a[2],.488603*i),t.addScaledVector(a[3],.488603*r),t.addScaledVector(a[4],r*n*1.092548),t.addScaledVector(a[5],n*i*1.092548),t.addScaledVector(a[6],.315392*(3*i*i-1)),t.addScaledVector(a[7],r*i*1.092548),t.addScaledVector(a[8],.546274*(r*r-n*n)),t}getIrradianceAt(e,t){let r=e.x,n=e.y,i=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.886227),t.addScaledVector(a[1],1.023328*n),t.addScaledVector(a[2],1.023328*i),t.addScaledVector(a[3],1.023328*r),t.addScaledVector(a[4],.858086*r*n),t.addScaledVector(a[5],.858086*n*i),t.addScaledVector(a[6],.743125*i*i-.247708),t.addScaledVector(a[7],.858086*r*i),t.addScaledVector(a[8],.429043*(r*r-n*n)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let r=0;r<9;r++)this.coefficients[r].addScaledVector(e.coefficients[r],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let r=0;r<9;r++)this.coefficients[r].lerp(e.coefficients[r],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){let r=this.coefficients;for(let n=0;n<9;n++)r[n].fromArray(e,t+3*n);return this}toArray(e=[],t=0){let r=this.coefficients;for(let n=0;n<9;n++)r[n].toArray(e,t+3*n);return e}static getBasisAt(e,t){let r=e.x,n=e.y,i=e.z;t[0]=.282095,t[1]=.488603*n,t[2]=.488603*i,t[3]=.488603*r,t[4]=1.092548*r*n,t[5]=1.092548*n*i,t[6]=.315392*(3*i*i-1),t[7]=1.092548*r*i,t[8]=.546274*(r*r-n*n)}}se.prototype.isSphericalHarmonics3=!0;class st extends aY{constructor(e=new se,t=1){super(void 0,t),this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){let t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}st.prototype.isLightProbe=!0;let sr={decodeText:function(e){if("undefined"!=typeof TextDecoder)return new TextDecoder().decode(e);let t="";for(let r=0,n=e.length;r<n;r++)t+=String.fromCharCode(e[r]);try{return decodeURIComponent(escape(t))}catch(e){return t}},extractUrlBase:function(e){let t=e.lastIndexOf("/");return -1===t?"./":e.substr(0,t+1)}};function sn(){tT.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}function si(e,t,r,n){"number"==typeof r&&(n=r,r=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),ts.call(this,e,t,r),this.meshPerAttribute=n||1}function sa(e){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),ay.call(this,e),this.options={premultiplyAlpha:"none"}}sn.prototype=Object.assign(Object.create(tT.prototype),{constructor:sn,isInstancedBufferGeometry:!0,copy:function(e){return tT.prototype.copy.call(this,e),this.instanceCount=e.instanceCount,this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){let e=tT.prototype.toJSON.call(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}),si.prototype=Object.assign(Object.create(ts.prototype),{constructor:si,isInstancedBufferAttribute:!0,copy:function(e){return ts.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},toJSON:function(){let e=ts.prototype.toJSON.call(this);return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}),sa.prototype=Object.assign(Object.create(ay.prototype),{constructor:sa,isImageBitmapLoader:!0,setOptions:function(e){return this.options=e,this},load:function(e,t,r,n){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);let i=this,a=am.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout(function(){t&&t(a),i.manager.itemEnd(e)},0),a;let s={};s.credentials="anonymous"===this.crossOrigin?"same-origin":"include",s.headers=this.requestHeader,fetch(e,s).then(function(e){return e.blob()}).then(function(e){return createImageBitmap(e,Object.assign(i.options,{colorSpaceConversion:"none"}))}).then(function(r){am.add(e,r),t&&t(r),i.manager.itemEnd(e)}).catch(function(t){n&&n(t),i.manager.itemError(e),i.manager.itemEnd(e)}),i.manager.itemStart(e)}});class ss{constructor(){this.type="ShapePath",this.color=new tr,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new aq,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,r,n){return this.currentPath.quadraticCurveTo(e,t,r,n),this}bezierCurveTo(e,t,r,n,i,a){return this.currentPath.bezierCurveTo(e,t,r,n,i,a),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e,t){let r,n,i,a,s;function o(e){let t=[];for(let r=0,n=e.length;r<n;r++){let n=e[r],i=new aX;i.curves=n.curves,t.push(i)}return t}let l=i1.isClockWise,h=this.subPaths;if(0===h.length)return[];if(!0===t)return o(h);let u=[];if(1===h.length)return n=h[0],(i=new aX).curves=n.curves,u.push(i),u;let c=!l(h[0].getPoints());c=e?!c:c;let d=[],p=[],f=[],m=0;p[0]=void 0,f[m]=[];for(let t=0,i=h.length;t<i;t++)r=l(a=(n=h[t]).getPoints()),(r=e?!r:r)?(!c&&p[m]&&m++,p[m]={s:new aX,p:a},p[m].s.curves=n.curves,c&&m++,f[m]=[]):f[m].push({h:n,p:a[0]});if(!p[0])return o(h);if(p.length>1){let e=!1,t=[];for(let e=0,t=p.length;e<t;e++)d[e]=[];for(let r=0,n=p.length;r<n;r++){let n=f[r];for(let i=0;i<n.length;i++){let a=n[i],s=!0;for(let n=0;n<p.length;n++)(function(e,t){let r=t.length,n=!1;for(let i=r-1,a=0;a<r;i=a++){let r=t[i],s=t[a],o=s.x-r.x,l=s.y-r.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(r=t[a],o=-o,s=t[i],l=-l),e.y<r.y||e.y>s.y)continue;if(e.y===r.y){if(e.x===r.x)return!0}else{let t=l*(e.x-r.x)-o*(e.y-r.y);if(0===t)return!0;if(t<0)continue;n=!n}}else{if(e.y!==r.y)continue;if(s.x<=e.x&&e.x<=r.x||r.x<=e.x&&e.x<=s.x)return!0}}return n})(a.p,p[n].p)&&(r!==n&&t.push({froms:r,tos:n,hole:i}),s?(s=!1,d[n].push(a)):e=!0);s&&d[r].push(a)}}t.length>0&&!e&&(f=d)}for(let e=0,t=p.length;e<t;e++){i=p[e].s,u.push(i),s=f[e];for(let e=0,t=s.length;e<t;e++)i.holes.push(s[e].h)}return u}}(class{constructor(e){this.type="Font",this.data=e}generateShapes(e,t=100){let r=[],n=function(e,t,r){let n=Array.from(e),i=t/r.resolution,a=(r.boundingBox.yMax-r.boundingBox.yMin+r.underlineThickness)*i,s=[],o=0,l=0;for(let e=0;e<n.length;e++){let t=n[e];if("\n"===t)o=0,l-=a;else{let e=function(e,t,r,n,i){let a,s,o,l,h,u,c,d;let p=i.glyphs[e]||i.glyphs["?"];if(!p){console.error('THREE.Font: character "'+e+'" does not exists in font family '+i.familyName+".");return}let f=new ss;if(p.o){let e=p._cachedOutline||(p._cachedOutline=p.o.split(" "));for(let i=0,p=e.length;i<p;)switch(e[i++]){case"m":a=e[i++]*t+r,s=e[i++]*t+n,f.moveTo(a,s);break;case"l":a=e[i++]*t+r,s=e[i++]*t+n,f.lineTo(a,s);break;case"q":o=e[i++]*t+r,l=e[i++]*t+n,h=e[i++]*t+r,u=e[i++]*t+n,f.quadraticCurveTo(h,u,o,l);break;case"b":o=e[i++]*t+r,l=e[i++]*t+n,h=e[i++]*t+r,u=e[i++]*t+n,c=e[i++]*t+r,d=e[i++]*t+n,f.bezierCurveTo(h,u,c,d,o,l)}}return{offsetX:p.ha*t,path:f}}(t,i,o,l,r);o+=e.offsetX,s.push(e.path)}}return s}(e,t,this.data);for(let e=0,t=n.length;e<t;e++)Array.prototype.push.apply(r,n[e].toShapes());return r}}).prototype.isFont=!0;let so={getContext:function(){return void 0===a&&(a=new(window.AudioContext||window.webkitAudioContext)),a}};class sl extends ay{constructor(e){super(e)}load(e,t,r,n){let i=this,a=new a_(this.manager);a.setResponseType("arraybuffer"),a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(r){try{let e=r.slice(0);so.getContext().decodeAudioData(e,function(e){t(e)})}catch(t){n?n(t):console.error(t),i.manager.itemError(e)}},r,n)}}(class extends st{constructor(e,t,r=1){super(void 0,r);let n=new tr().set(e),i=new tr().set(t),a=new V(n.r,n.g,n.b),s=new V(i.r,i.g,i.b),o=Math.sqrt(Math.PI),l=o*Math.sqrt(.75);this.sh.coefficients[0].copy(a).add(s).multiplyScalar(o),this.sh.coefficients[1].copy(a).sub(s).multiplyScalar(l)}}).prototype.isHemisphereLightProbe=!0,(class extends st{constructor(e,t=1){super(void 0,t);let r=new tr().set(e);this.sh.coefficients[0].set(r.r,r.g,r.b).multiplyScalar(2*Math.sqrt(Math.PI))}}).prototype.isAmbientLightProbe=!0,new ev,new ev;class sh{constructor(e){this.autoStart=void 0===e||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=su(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let t=su();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function su(){return("undefined"==typeof performance?Date:performance).now()}class sc{constructor(e,t,r){let n,i,a;switch(this.binding=e,this.valueSize=r,t){case"quaternion":n=this._slerp,i=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*r),this._workIndex=5;break;case"string":case"bool":n=this._select,i=this._select,a=this._setAdditiveIdentityOther,this.buffer=Array(5*r);break;default:n=this._lerp,i=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*r)}this._mixBufferRegion=n,this._mixBufferRegionAdditive=i,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){let r=this.buffer,n=this.valueSize,i=e*n+n,a=this.cumulativeWeight;if(0===a){for(let e=0;e!==n;++e)r[i+e]=r[e];a=t}else{a+=t;let e=t/a;this._mixBufferRegion(r,i,0,e,n)}this.cumulativeWeight=a}accumulateAdditive(e){let t=this.buffer,r=this.valueSize,n=r*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,n,0,e,r),this.cumulativeWeightAdditive+=e}apply(e){let t=this.valueSize,r=this.buffer,n=e*t+t,i=this.cumulativeWeight,a=this.cumulativeWeightAdditive,s=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,i<1){let e=t*this._origIndex;this._mixBufferRegion(r,n,e,1-i,t)}a>0&&this._mixBufferRegionAdditive(r,n,this._addIndex*t,1,t);for(let e=t,i=t+t;e!==i;++e)if(r[e]!==r[e+t]){s.setValue(r,n);break}}saveOriginalState(){let e=this.binding,t=this.buffer,r=this.valueSize,n=r*this._origIndex;e.getValue(t,n);for(let e=r;e!==n;++e)t[e]=t[n+e%r];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){let e=3*this.valueSize;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){let e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let r=e;r<t;r++)this.buffer[r]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){let e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let r=0;r<this.valueSize;r++)this.buffer[t+r]=this.buffer[e+r]}_select(e,t,r,n,i){if(n>=.5)for(let n=0;n!==i;++n)e[t+n]=e[r+n]}_slerp(e,t,r,n){G.slerpFlat(e,t,e,t,e,r,n)}_slerpAdditive(e,t,r,n,i){let a=this._workIndex*i;G.multiplyQuaternionsFlat(e,a,e,t,e,r),G.slerpFlat(e,t,e,t,e,a,n)}_lerp(e,t,r,n,i){let a=1-n;for(let s=0;s!==i;++s){let i=t+s;e[i]=e[i]*a+e[r+s]*n}}_lerpAdditive(e,t,r,n,i){for(let a=0;a!==i;++a){let i=t+a;e[i]=e[i]+e[r+a]*n}}}let sd="\\[\\]\\.:\\/",sp=RegExp("["+sd+"]","g"),sf="[^"+sd+"]",sm="[^"+sd.replace("\\.","")+"]",sg=/((?:WC+[\/:])*)/.source.replace("WC",sf),sv=RegExp("^"+sg+/(WCOD+)?/.source.replace("WCOD",sm)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",sf)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",sf)+"$"),sy=["material","materials","bones"];function sx(e,t,r){let n=r||s_.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,n)}function s_(e,t,r){this.path=t,this.parsedPath=r||s_.parseTrackName(t),this.node=s_.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}Object.assign(sx.prototype,{getValue:function(e,t){this.bind();let r=this._targetGroup.nCachedObjects_,n=this._bindings[r];void 0!==n&&n.getValue(e,t)},setValue:function(e,t){let r=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=r.length;n!==i;++n)r[n].setValue(e,t)},bind:function(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()},unbind:function(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}}),Object.assign(s_,{Composite:sx,create:function(e,t,r){return e&&e.isAnimationObjectGroup?new s_.Composite(e,t,r):new s_(e,t,r)},sanitizeNodeName:function(e){return e.replace(/\s/g,"_").replace(sp,"")},parseTrackName:function(e){let t=sv.exec(e);if(!t)throw Error("PropertyBinding: Cannot parse trackName: "+e);let r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},n=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==n&&-1!==n){let e=r.nodeName.substring(n+1);-1!==sy.indexOf(e)&&(r.nodeName=r.nodeName.substring(0,n),r.objectName=e)}if(null===r.propertyName||0===r.propertyName.length)throw Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r},findNode:function(e,t){if(!t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){let r=e.skeleton.getBoneByName(t);if(void 0!==r)return r}if(e.children){let r=function(e){for(let n=0;n<e.length;n++){let i=e[n];if(i.name===t||i.uuid===t)return i;let a=r(i.children);if(a)return a}return null},n=r(e.children);if(n)return n}return null}}),Object.assign(s_.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(e,t){let r=this.resolvedProperty;for(let n=0,i=r.length;n!==i;++n)e[t++]=r[n]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.targetObject[this.propertyName]=e[t]},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){let r=this.resolvedProperty;for(let n=0,i=r.length;n!==i;++n)r[n]=e[t++]},function(e,t){let r=this.resolvedProperty;for(let n=0,i=r.length;n!==i;++n)r[n]=e[t++];this.targetObject.needsUpdate=!0},function(e,t){let r=this.resolvedProperty;for(let n=0,i=r.length;n!==i;++n)r[n]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,t){this.bind(),this.getValue(e,t)},setValue:function(e,t){this.bind(),this.setValue(e,t)},bind:function(){let e=this.node,t=this.parsedPath,r=t.objectName,n=t.propertyName,i=t.propertyIndex;if(e||(e=s_.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(r){let n=t.objectIndex;switch(r){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===n){n=t;break}break;default:if(void 0===e[r]){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[r]}if(void 0!==n){if(void 0===e[n]){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[n]}}let a=e[n];if(void 0===a){console.error("THREE.PropertyBinding: Trying to update property for track: "+t.nodeName+"."+n+" but it wasn't found.",e);return}let s=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?s=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(s=this.Versioning.MatrixWorldNeedsUpdate);let o=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===n){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}void 0!==e.morphTargetDictionary[i]&&(i=e.morphTargetDictionary[i])}else{console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);return}}o=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=i}else void 0!==a.fromArray&&void 0!==a.toArray?(o=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(o=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=n;this.getValue=this.GetterByBindingType[o],this.setValue=this.SetterByBindingTypeAndVersioning[o][s]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(s_.prototype,{_getValue_unbound:s_.prototype.getValue,_setValue_unbound:s_.prototype.setValue}),(class{constructor(){this.uuid=D.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;let e={};this._indicesByUUID=e;for(let t=0,r=arguments.length;t!==r;++t)e[arguments[t].uuid]=t;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};let t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){let e=this._objects,t=this._indicesByUUID,r=this._paths,n=this._parsedPaths,i=this._bindings,a=i.length,s,o=e.length,l=this.nCachedObjects_;for(let h=0,u=arguments.length;h!==u;++h){let u=arguments[h],c=u.uuid,d=t[c];if(void 0===d){d=o++,t[c]=d,e.push(u);for(let e=0;e!==a;++e)i[e].push(new s_(u,r[e],n[e]))}else if(d<l){s=e[d];let o=--l,h=e[o];t[h.uuid]=d,e[d]=h,t[c]=o,e[o]=u;for(let e=0;e!==a;++e){let t=i[e],a=t[o],s=t[d];t[d]=a,void 0===s&&(s=new s_(u,r[e],n[e])),t[o]=s}}else e[d]!==s&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l}remove(){let e=this._objects,t=this._indicesByUUID,r=this._bindings,n=r.length,i=this.nCachedObjects_;for(let a=0,s=arguments.length;a!==s;++a){let s=arguments[a],o=s.uuid,l=t[o];if(void 0!==l&&l>=i){let a=i++,h=e[a];t[h.uuid]=l,e[l]=h,t[o]=a,e[a]=s;for(let e=0;e!==n;++e){let t=r[e],n=t[a],i=t[l];t[l]=n,t[a]=i}}}this.nCachedObjects_=i}uncache(){let e=this._objects,t=this._indicesByUUID,r=this._bindings,n=r.length,i=this.nCachedObjects_,a=e.length;for(let s=0,o=arguments.length;s!==o;++s){let o=arguments[s],l=o.uuid,h=t[l];if(void 0!==h){if(delete t[l],h<i){let s=--i,o=e[s],l=--a,u=e[l];t[o.uuid]=h,e[h]=o,t[u.uuid]=s,e[s]=u,e.pop();for(let e=0;e!==n;++e){let t=r[e],n=t[s],i=t[l];t[h]=n,t[s]=i,t.pop()}}else{let i=--a,s=e[i];i>0&&(t[s.uuid]=h),e[h]=s,e.pop();for(let e=0;e!==n;++e){let t=r[e];t[h]=t[i],t.pop()}}}}this.nCachedObjects_=i}subscribe_(e,t){let r=this._bindingsIndicesByPath,n=r[e],i=this._bindings;if(void 0!==n)return i[n];let a=this._paths,s=this._parsedPaths,o=this._objects,l=o.length,h=this.nCachedObjects_,u=Array(l);n=i.length,r[e]=n,a.push(e),s.push(t),i.push(u);for(let r=h,n=o.length;r!==n;++r){let n=o[r];u[r]=new s_(n,e,t)}return u}unsubscribe_(e){let t=this._bindingsIndicesByPath,r=t[e];if(void 0!==r){let n=this._paths,i=this._parsedPaths,a=this._bindings,s=a.length-1,o=a[s];t[e[s]]=r,a[r]=o,a.pop(),i[r]=i[s],i.pop(),n[r]=n[s],n.pop()}}}).prototype.isAnimationObjectGroup=!0;class sb{constructor(e,t,r=null,n=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=r,this.blendMode=n;let i=t.tracks,a=i.length,s=Array(a),o={endingStart:2400,endingEnd:2400};for(let e=0;e!==a;++e){let t=i[e].createInterpolant(null);s[e]=t,t.settings=o}this._interpolantSettings=o,this._interpolants=s,this._propertyBindings=Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,r){if(e.fadeOut(t),this.fadeIn(t),r){let r=this._clip.duration,n=e._clip.duration;e.warp(1,n/r,t),this.warp(r/n,1,t)}return this}crossFadeTo(e,t,r){return e.crossFadeFrom(this,t,r)}stopFading(){let e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,r){let n=this._mixer,i=n.time,a=this.timeScale,s=this._timeScaleInterpolant;null===s&&(s=n._lendControlInterpolant(),this._timeScaleInterpolant=s);let o=s.parameterPositions,l=s.sampleValues;return o[0]=i,o[1]=i+r,l[0]=e/a,l[1]=t/a,this}stopWarping(){let e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,r,n){if(!this.enabled){this._updateWeight(e);return}let i=this._startTime;if(null!==i){let n=(e-i)*r;if(n<0||0===r)return;this._startTime=null,t=r*n}t*=this._updateTimeScale(e);let a=this._updateTime(t),s=this._updateWeight(e);if(s>0){let e=this._interpolants,t=this._propertyBindings;if(2501===this.blendMode)for(let r=0,n=e.length;r!==n;++r)e[r].evaluate(a),t[r].accumulateAdditive(s);else for(let r=0,i=e.length;r!==i;++r)e[r].evaluate(a),t[r].accumulate(n,s)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;let r=this._weightInterpolant;if(null!==r){let n=r.evaluate(e)[0];t*=n,e>r.parameterPositions[1]&&(this.stopFading(),0===n&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;let r=this._timeScaleInterpolant;null!==r&&(t*=r.evaluate(e)[0],e>r.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t,t}_updateTime(e){let t=this._clip.duration,r=this.loop,n=this.time+e,i=this._loopCount,a=2202===r;if(0===e)return -1===i?n:a&&(1&i)==1?t-n:n;if(2200===r){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));i:{if(n>=t)n=t;else if(n<0)n=0;else{this.time=n;break i}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===i&&(e>=0?(i=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),n>=t||n<0){let r=Math.floor(n/t);n-=t*r,i+=Math.abs(r);let s=this.repetitions-i;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,n=e>0?t:0,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===s){let t=e<0;this._setEndings(t,!t,a)}else this._setEndings(!1,!1,a);this._loopCount=i,this.time=n,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:r})}}else this.time=n;if(a&&(1&i)==1)return t-n}return n}_setEndings(e,t,r){let n=this._interpolantSettings;r?(n.endingStart=2401,n.endingEnd=2401):(e?n.endingStart=this.zeroSlopeAtStart?2401:2400:n.endingStart=2402,t?n.endingEnd=this.zeroSlopeAtEnd?2401:2400:n.endingEnd=2402)}_scheduleFading(e,t,r){let n=this._mixer,i=n.time,a=this._weightInterpolant;null===a&&(a=n._lendControlInterpolant(),this._weightInterpolant=a);let s=a.parameterPositions,o=a.sampleValues;return s[0]=i,o[0]=t,s[1]=i+e,o[1]=r,this}}(class extends P{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){let r=e._localRoot||this._root,n=e._clip.tracks,i=n.length,a=e._propertyBindings,s=e._interpolants,o=r.uuid,l=this._bindingsByRootAndName,h=l[o];void 0===h&&(h={},l[o]=h);for(let e=0;e!==i;++e){let i=n[e],l=i.name,u=h[l];if(void 0!==u)a[e]=u;else{if(void 0!==(u=a[e])){null===u._cacheIndex&&(++u.referenceCount,this._addInactiveBinding(u,o,l));continue}let n=t&&t._propertyBindings[e].binding.parsedPath;u=new sc(s_.create(r,l,n),i.ValueTypeName,i.getValueSize()),++u.referenceCount,this._addInactiveBinding(u,o,l),a[e]=u}s[e].resultBuffer=u.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){let t=(e._localRoot||this._root).uuid,r=e._clip.uuid,n=this._actionsByClip[r];this._bindAction(e,n&&n.knownActions[0]),this._addInactiveAction(e,r,t)}let t=e._propertyBindings;for(let e=0,r=t.length;e!==r;++e){let r=t[e];0==r.useCount++&&(this._lendBinding(r),r.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){let t=e._propertyBindings;for(let e=0,r=t.length;e!==r;++e){let r=t[e];0==--r.useCount&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;let e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){let t=e._cacheIndex;return null!==t&&t<this._nActiveActions}_addInactiveAction(e,t,r){let n=this._actions,i=this._actionsByClip,a=i[t];if(void 0===a)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=a;else{let t=a.knownActions;e._byClipCacheIndex=t.length,t.push(e)}e._cacheIndex=n.length,n.push(e),a.actionByRoot[r]=e}_removeInactiveAction(e){let t=this._actions,r=t[t.length-1],n=e._cacheIndex;r._cacheIndex=n,t[n]=r,t.pop(),e._cacheIndex=null;let i=e._clip.uuid,a=this._actionsByClip,s=a[i],o=s.knownActions,l=o[o.length-1],h=e._byClipCacheIndex;l._byClipCacheIndex=h,o[h]=l,o.pop(),e._byClipCacheIndex=null;let u=s.actionByRoot,c=(e._localRoot||this._root).uuid;delete u[c],0===o.length&&delete a[i],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){let t=e._propertyBindings;for(let e=0,r=t.length;e!==r;++e){let r=t[e];0==--r.referenceCount&&this._removeInactiveBinding(r)}}_lendAction(e){let t=this._actions,r=e._cacheIndex,n=this._nActiveActions++,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i}_takeBackAction(e){let t=this._actions,r=e._cacheIndex,n=--this._nActiveActions,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i}_addInactiveBinding(e,t,r){let n=this._bindingsByRootAndName,i=this._bindings,a=n[t];void 0===a&&(a={},n[t]=a),a[r]=e,e._cacheIndex=i.length,i.push(e)}_removeInactiveBinding(e){let t=this._bindings,r=e.binding,n=r.rootNode.uuid,i=r.path,a=this._bindingsByRootAndName,s=a[n],o=t[t.length-1],l=e._cacheIndex;o._cacheIndex=l,t[l]=o,t.pop(),delete s[i],0===Object.keys(s).length&&delete a[n]}_lendBinding(e){let t=this._bindings,r=e._cacheIndex,n=this._nActiveBindings++,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i}_takeBackBinding(e){let t=this._bindings,r=e._cacheIndex,n=--this._nActiveBindings,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i}_lendControlInterpolant(){let e=this._controlInterpolants,t=this._nActiveControlInterpolants++,r=e[t];return void 0===r&&((r=new ai(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t,e[t]=r),r}_takeBackControlInterpolant(e){let t=this._controlInterpolants,r=e.__cacheIndex,n=--this._nActiveControlInterpolants,i=t[n];e.__cacheIndex=n,t[n]=e,i.__cacheIndex=r,t[r]=i}clipAction(e,t,r){let n=t||this._root,i=n.uuid,a="string"==typeof e?af.findByName(n,e):e,s=null!==a?a.uuid:e,o=this._actionsByClip[s],l=null;if(void 0===r&&(r=null!==a?a.blendMode:2500),void 0!==o){let e=o.actionByRoot[i];if(void 0!==e&&e.blendMode===r)return e;l=o.knownActions[0],null===a&&(a=l._clip)}if(null===a)return null;let h=new sb(this,a,t,r);return this._bindAction(h,l),this._addInactiveAction(h,s,i),h}existingAction(e,t){let r=t||this._root,n=r.uuid,i="string"==typeof e?af.findByName(r,e):e,a=i?i.uuid:e,s=this._actionsByClip[a];return void 0!==s&&s.actionByRoot[n]||null}stopAllAction(){let e=this._actions,t=this._nActiveActions;for(let r=t-1;r>=0;--r)e[r].stop();return this}update(e){e*=this.timeScale;let t=this._actions,r=this._nActiveActions,n=this.time+=e,i=Math.sign(e),a=this._accuIndex^=1;for(let s=0;s!==r;++s)t[s]._update(n,e,i,a);let s=this._bindings,o=this._nActiveBindings;for(let e=0;e!==o;++e)s[e].apply(a);return this}setTime(e){this.time=0;for(let e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){let t=this._actions,r=e.uuid,n=this._actionsByClip,i=n[r];if(void 0!==i){let e=i.knownActions;for(let r=0,n=e.length;r!==n;++r){let n=e[r];this._deactivateAction(n);let i=n._cacheIndex,a=t[t.length-1];n._cacheIndex=null,n._byClipCacheIndex=null,a._cacheIndex=i,t[i]=a,t.pop(),this._removeInactiveBindingsForAction(n)}delete n[r]}}uncacheRoot(e){let t=e.uuid,r=this._actionsByClip;for(let e in r){let n=r[e].actionByRoot[t];void 0!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}let n=this._bindingsByRootAndName[t];if(void 0!==n)for(let e in n){let t=n[e];t.restoreOriginalState(),this._removeInactiveBinding(t)}}uncacheAction(e,t){let r=this.existingAction(e,t);null!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}}).prototype._controlInterpolantsResultBuffer=new Float32Array(1);class sw{constructor(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}clone(){return new sw(void 0===this.value.clone?this.value:this.value.clone())}}function sM(e,t,r){nq.call(this,e,t),this.meshPerAttribute=r||1}function sS(e,t,r,n,i){this.buffer=e,this.type=t,this.itemSize=r,this.elementSize=n,this.count=i,this.version=0}function sT(e,t,r=0,n=1/0){this.ray=new eg(e,t),this.near=r,this.far=n,this.camera=null,this.layers=new eL,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function sE(e,t){return e.distance-t.distance}function sA(e,t,r,n){if(e.layers.test(t.layers)&&e.raycast(t,r),!0===n){let n=e.children;for(let e=0,i=n.length;e<i;e++)sA(n[e],t,r,!0)}}sM.prototype=Object.assign(Object.create(nq.prototype),{constructor:sM,isInstancedInterleavedBuffer:!0,copy:function(e){return nq.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},clone:function(e){let t=nq.prototype.clone.call(this,e);return t.meshPerAttribute=this.meshPerAttribute,t},toJSON:function(e){let t=nq.prototype.toJSON.call(this,e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}),Object.defineProperty(sS.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(sS.prototype,{isGLBufferAttribute:!0,setBuffer:function(e){return this.buffer=e,this},setType:function(e,t){return this.type=e,this.elementSize=t,this},setItemSize:function(e){return this.itemSize=e,this},setCount:function(e){return this.count=e,this}}),Object.assign(sT.prototype,{set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)},intersectObject:function(e,t=!1,r=[]){return sA(e,this,r,t),r.sort(sE),r},intersectObjects:function(e,t=!1,r=[]){for(let n=0,i=e.length;n<i;n++)sA(e[n],this,r,t);return r.sort(sE),r}});class sL{constructor(e=1,t=0,r=0){return this.radius=e,this.phi=t,this.theta=r,this}set(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+t*t+r*r),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(D.clamp(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}let sR=/*@__PURE__*/new O;class sP{constructor(e=new O(1/0,1/0),t=new O(-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let r=sR.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return void 0===e&&(console.warn("THREE.Box2: .getCenter() target is now required"),e=new O),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return void 0===e&&(console.warn("THREE.Box2: .getSize() target is now required"),e=new O),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x)&&!(e.x>this.max.x)&&!(e.y<this.min.y)&&!(e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return void 0===t&&(console.warn("THREE.Box2: .getParameter() target is now required"),t=new O),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x)&&!(e.min.x>this.max.x)&&!(e.max.y<this.min.y)&&!(e.min.y>this.max.y)}clampPoint(e,t){return void 0===t&&(console.warn("THREE.Box2: .clampPoint() target is now required"),t=new O),t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return sR.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}sP.prototype.isBox2=!0;let sC=/*@__PURE__*/new V,sI=/*@__PURE__*/new V;function sD(e){eG.call(this),this.material=e,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}sD.prototype=Object.create(eG.prototype),sD.prototype.constructor=sD,sD.prototype.isImmediateRenderObject=!0;let sO=/*@__PURE__*/new V,sU=/*@__PURE__*/new ev,sN=/*@__PURE__*/new ev;new Int32Array(new Float32Array(1).buffer);let sk=new tn({side:1,depthWrite:!1,depthTest:!1});new tV(new tj,sk),aE.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(aE.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},aq.prototype.fromPoints=function(e){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)},(class extends iA{constructor(e=10,t=10,r=4473924,n=8947848){r=new tr(r),n=new tr(n);let i=t/2,a=e/t,s=e/2,o=[],l=[];for(let e=0,h=0,u=-s;e<=t;e++,u+=a){o.push(-s,0,u,s,0,u),o.push(u,0,-s,u,0,s);let t=e===i?r:n;t.toArray(l,h),h+=3,t.toArray(l,h),h+=3,t.toArray(l,h),h+=3,t.toArray(l,h),h+=3}let h=new tT;h.setAttribute("position",new tm(o,3)),h.setAttribute("color",new tm(l,3)),super(h,new iy({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}).prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},(class extends iA{constructor(e){let t=function e(t){let r=[];t&&t.isBone&&r.push(t);for(let n=0;n<t.children.length;n++)r.push.apply(r,e(t.children[n]));return r}(e),r=new tT,n=[],i=[],a=new tr(0,0,1),s=new tr(0,1,0);for(let e=0;e<t.length;e++){let r=t[e];r.parent&&r.parent.isBone&&(n.push(0,0,0),n.push(0,0,0),i.push(a.r,a.g,a.b),i.push(s.r,s.g,s.b))}r.setAttribute("position",new tm(n,3)),r.setAttribute("color",new tm(i,3)),super(r,new iy({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){let t=this.bones,r=this.geometry,n=r.getAttribute("position");sN.copy(this.root.matrixWorld).invert();for(let e=0,r=0;e<t.length;e++){let i=t[e];i.parent&&i.parent.isBone&&(sU.multiplyMatrices(sN,i.matrixWorld),sO.setFromMatrixPosition(sU),n.setXYZ(r,sO.x,sO.y,sO.z),sU.multiplyMatrices(sN,i.parent.matrixWorld),sO.setFromMatrixPosition(sU),n.setXYZ(r+1,sO.x,sO.y,sO.z),r+=2)}r.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}}).prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},ay.prototype.extractUrlBase=function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),sr.extractUrlBase(e)},ay.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},sP.prototype.center=function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},sP.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},sP.prototype.isIntersectionBox=function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},sP.prototype.size=function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)},q.prototype.center=function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},q.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},q.prototype.isIntersectionBox=function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},q.prototype.isIntersectionSphere=function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},q.prototype.size=function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)},el.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},t4.prototype.setFromMatrix=function(e){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(e)},(class{constructor(e=new V,t=new V){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return void 0===e&&(console.warn("THREE.Line3: .getCenter() target is now required"),e=new V),e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return void 0===e&&(console.warn("THREE.Line3: .delta() target is now required"),e=new V),e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return void 0===t&&(console.warn("THREE.Line3: .at() target is now required"),t=new V),this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){sC.subVectors(e,this.start),sI.subVectors(this.end,this.start);let r=sI.dot(sI),n=sI.dot(sC)/r;return t&&(n=D.clamp(n,0,1)),n}closestPointToPoint(e,t,r){let n=this.closestPointToPointParameter(e,t);return void 0===r&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),r=new V),this.delta(r).multiplyScalar(n).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}).prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},D.random16=function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},D.nearestPowerOfTwo=function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),D.floorPowerOfTwo(e)},D.nextPowerOfTwo=function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),D.ceilPowerOfTwo(e)},U.prototype.flattenToArrayOffset=function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},U.prototype.multiplyVector3=function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},U.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},U.prototype.applyToBufferAttribute=function(e){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},U.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},U.prototype.getInverse=function(e){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(e).invert()},ev.prototype.extractPosition=function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},ev.prototype.flattenToArrayOffset=function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},ev.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new V().setFromMatrixColumn(this,3)},ev.prototype.setRotationFromQuaternion=function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},ev.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},ev.prototype.multiplyVector3=function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},ev.prototype.multiplyVector4=function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},ev.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},ev.prototype.rotateAxis=function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},ev.prototype.crossVector=function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},ev.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},ev.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},ev.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},ev.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},ev.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},ev.prototype.applyToBufferAttribute=function(e){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},ev.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},ev.prototype.makeFrustum=function(e,t,r,n,i,a){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,n,r,i,a)},ev.prototype.getInverse=function(e){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(e).invert()},eq.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},G.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},G.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},eg.prototype.isIntersectionBox=function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},eg.prototype.isIntersectionPlane=function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},eg.prototype.isIntersectionSphere=function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},e3.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},e3.prototype.barycoordFromPoint=function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},e3.prototype.midpoint=function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},e3.prototypenormal=function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},e3.prototype.plane=function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)},e3.barycoordFromPoint=function(e,t,r,n,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),e3.getBarycoord(e,t,r,n,i)},e3.normal=function(e,t,r,n){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),e3.getNormal(e,t,r,n)},aX.prototype.extractAllPoints=function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},aX.prototype.extrude=function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new i4(this,e)},aX.prototype.makeGeometry=function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new i8(this,e)},O.prototype.fromAttribute=function(e,t,r){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,r)},O.prototype.distanceToManhattan=function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},O.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},V.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},V.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},V.prototype.getPositionFromMatrix=function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},V.prototype.getScaleFromMatrix=function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},V.prototype.getColumnFromMatrix=function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},V.prototype.applyProjection=function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},V.prototype.fromAttribute=function(e,t,r){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,r)},V.prototype.distanceToManhattan=function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},V.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},z.prototype.fromAttribute=function(e,t,r){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,r)},z.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},eG.prototype.getChildByName=function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},eG.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},eG.prototype.translate=function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},eG.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},eG.prototype.applyMatrix=function(e){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)},Object.defineProperties(eG.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),tV.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(tV.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties((class extends eG{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);let t=e.levels;for(let e=0,r=t.length;e<r;e++){let r=t[e];this.addLevel(r.object.clone(),r.distance)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0){let r;t=Math.abs(t);let n=this.levels;for(r=0;r<n.length&&!(t<n[r].distance);r++);return n.splice(r,0,{distance:t,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){let t=this.levels;if(t.length>0){let r,n;for(r=1,n=t.length;r<n&&!(e<t[r].distance);r++);return t[r-1].object}return null}raycast(e,t){if(this.levels.length>0){n9.setFromMatrixPosition(this.matrixWorld);let r=e.ray.origin.distanceTo(n9);this.getObjectForDistance(r).raycast(e,t)}}update(e){let t=this.levels;if(t.length>1){let r,n;n9.setFromMatrixPosition(e.matrixWorld),ie.setFromMatrixPosition(this.matrixWorld);let i=n9.distanceTo(ie)/e.zoom;for(r=1,t[0].object.visible=!0,n=t.length;r<n&&i>=t[r].distance;r++)t[r-1].object.visible=!1,t[r].object.visible=!0;for(this._currentLevel=r-1;r<n;r++)t[r].object.visible=!1}}toJSON(e){let t=super.toJSON(e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];let r=this.levels;for(let e=0,n=r.length;e<n;e++){let n=r[e];t.object.levels.push({object:n.object.uuid,distance:n.distance})}return t}}).prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(ic.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),io.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(aE.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),tK.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(aY.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(ts.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),35048===this.usage},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(35048)}}}),ts.prototype.setDynamic=function(e){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?35048:35044),this},ts.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},ts.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},tT.prototype.addIndex=function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},tT.prototype.addAttribute=function(e,t){return(console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute)?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):this.setAttribute(e,t):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(e,new ts(arguments[1],arguments[2])))},tT.prototype.addDrawCall=function(e,t,r){void 0!==r&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},tT.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},tT.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},tT.prototype.removeAttribute=function(e){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(e)},tT.prototype.applyMatrix=function(e){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)},Object.defineProperties(tT.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(sn.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(e){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=e}}}),Object.defineProperties(sT.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(e){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=e}}}),Object.defineProperties(nq.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),35048===this.usage},set:function(e){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(e)}}}),nq.prototype.setDynamic=function(e){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?35048:35044),this},nq.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},i4.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},i4.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},i4.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},nj.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},Object.defineProperties(sw.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(e5.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new tr}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===e}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(e){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=e}}}),Object.defineProperties(ae.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(i9.prototype,{transparency:{get:function(){return console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission},set:function(e){console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission=e}}}),Object.defineProperties(tZ.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),nG.prototype.clearTarget=function(e,t,r,n){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(t,r,n)},nG.prototype.animate=function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},nG.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},nG.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},nG.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},nG.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},nG.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},nG.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},nG.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},nG.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},nG.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},nG.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},nG.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},nG.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},nG.prototype.enableScissorTest=function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},nG.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},nG.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},nG.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},nG.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},nG.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},nG.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},nG.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},nG.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},nG.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},nG.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(nG.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(e){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===e?E:3e3}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(nD.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(H.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Object.defineProperties((class extends eG{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(!0===this.isPlaying){console.warn("THREE.Audio: Audio is already playing.");return}if(!1===this.hasPlaybackControl){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;let t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1===this.hasPlaybackControl){console.warn("THREE.Audio: this Audio has no playback control.");return}return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(!1===this.hasPlaybackControl){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(!1===this.hasPlaybackControl){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(!1===this.hasPlaybackControl){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}).prototype,{load:{value:function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");let t=this;return new sl().load(e,function(e){t.setBuffer(e)}),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),(class{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0,t=this.getFrequencyData();for(let r=0;r<t.length;r++)e+=t[r];return e/t.length}}).prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},tQ.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)},tQ.prototype.clear=function(e,t,r,n){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(e,t,r,n)},N.crossOrigin=void 0,N.loadTexture=function(e,t,r,n){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");let i=new aT;i.setCrossOrigin(this.crossOrigin);let a=i.load(e,r,void 0,n);return t&&(a.mapping=t),a},N.loadTextureCube=function(e,t,r,n){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");let i=new aM;i.setCrossOrigin(this.crossOrigin);let a=i.load(e,r,void 0,n);return t&&(a.mapping=t),a},N.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},N.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"126"}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="126")}),c("2Tywo",function(e,r){function n(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function i(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}t(e.exports,"_config",()=>C),t(e.exports,"_isString",()=>B),t(e.exports,"_isUndefined",()=>G),t(e.exports,"_numExp",()=>J),t(e.exports,"_numWithUnitExp",()=>K),t(e.exports,"_relExp",()=>$),t(e.exports,"gsap",()=>rT),t(e.exports,"_missingPlugin",()=>ea),t(e.exports,"_plugins",()=>em),t(e.exports,"GSCache",()=>tH),t(e.exports,"_getCache",()=>eb),t(e.exports,"_getProperty",()=>ew),t(e.exports,"_forEachName",()=>eM),t(e.exports,"_round",()=>eS),t(e.exports,"_parseRelative",()=>eE),t(e.exports,"_ticker",()=>tE),t(e.exports,"getUnit",()=>te),t(e.exports,"_replaceRandom",()=>tc),t(e.exports,"_getSetter",()=>rr),t(e.exports,"PropTween",()=>rc),t(e.exports,"_colorExp",()=>tM),t(e.exports,"_colorStringFilter",()=>tT),t(e.exports,"_renderComplexString",()=>ra),t(e.exports,"_checkPlugin",()=>t$),t(e.exports,"_sortPropTweensByPriority",()=>ru),t(e.exports,"Power1",()=>rE);/*!
 * GSAP 3.12.5
 * https://gsap.com
 *
 * @license Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var a,s,o,l,h,u,c,d,p,f,m,g,v,y,x,_,b,w,M,S,T,E,A,L,R,P,C={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},I={duration:.5,overwrite:!1,delay:0},D=2*Math.PI,O=D/4,U=0,N=Math.sqrt,k=Math.cos,F=Math.sin,B=function(e){return"string"==typeof e},z=function(e){return"function"==typeof e},H=function(e){return"number"==typeof e},G=function(e){return void 0===e},V=function(e){return"object"==typeof e},W=function(e){return!1!==e},j=function(){return"undefined"!=typeof window},q=function(e){return z(e)||B(e)},X="function"==typeof ArrayBuffer&&ArrayBuffer.isView||function(){},Y=Array.isArray,Z=/(?:-?\.?\d|\.)+/gi,J=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,K=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,Q=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,$=/[+-]=-?[.\d]+/,ee=/[^,'"\[\]\s]+/gi,et=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,er={},en={},ei=function(e){return(en=eD(e,er))&&rT},ea=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},es=function(e,t){return!t&&console.warn(e)},eo=function(e,t){return e&&(er[e]=t)&&en&&(en[e]=t)||er},el=function(){return 0},eh={suppressEvents:!0,isStart:!0,kill:!1},eu={suppressEvents:!0,kill:!1},ec={suppressEvents:!0},ed={},ep=[],ef={},em={},eg={},ev=30,ey=[],ex="",e_=function(e){var t,r,n=e[0];if(V(n)||z(n)||(e=[e]),!(t=(n._gsap||{}).harness)){for(r=ey.length;r--&&!ey[r].targetTest(n););t=ey[r]}for(r=e.length;r--;)e[r]&&(e[r]._gsap||(e[r]._gsap=new tH(e[r],t)))||e.splice(r,1);return e},eb=function(e){return e._gsap||e_(tn(e))[0]._gsap},ew=function(e,t,r){return(r=e[t])&&z(r)?e[t]():G(r)&&e.getAttribute&&e.getAttribute(t)||r},eM=function(e,t){return(e=e.split(",")).forEach(t)||e},eS=function(e){return Math.round(1e5*e)/1e5||0},eT=function(e){return Math.round(1e7*e)/1e7||0},eE=function(e,t){var r=t.charAt(0),n=parseFloat(t.substr(2));return e=parseFloat(e),"+"===r?e+n:"-"===r?e-n:"*"===r?e*n:e/n},eA=function(e,t){for(var r=t.length,n=0;0>e.indexOf(t[n])&&++n<r;);return n<r},eL=function(){var e,t,r=ep.length,n=ep.slice(0);for(e=0,ef={},ep.length=0;e<r;e++)(t=n[e])&&t._lazy&&(t.render(t._lazy[0],t._lazy[1],!0)._lazy=0)},eR=function(e,t,r,n){ep.length&&!b&&eL(),e.render(t,r,n||b&&t<0&&(e._initted||e._startAt)),ep.length&&!b&&eL()},eP=function(e){var t=parseFloat(e);return(t||0===t)&&(e+"").match(ee).length<2?t:B(e)?e.trim():e},eC=function(e){return e},eI=function(e,t){for(var r in t)r in e||(e[r]=t[r]);return e},eD=function(e,t){for(var r in t)e[r]=t[r];return e},eO=function e(t,r){for(var n in r)"__proto__"!==n&&"constructor"!==n&&"prototype"!==n&&(t[n]=V(r[n])?e(t[n]||(t[n]={}),r[n]):r[n]);return t},eU=function(e,t){var r,n={};for(r in e)r in t||(n[r]=e[r]);return n},eN=function(e){var t,r=e.parent||M,n=e.keyframes?(t=Y(e.keyframes),function(e,r){for(var n in r)n in e||"duration"===n&&t||"ease"===n||(e[n]=r[n])}):eI;if(W(e.inherit))for(;r;)n(e,r.vars.defaults),r=r.parent||r._dp;return e},ek=function(e,t){for(var r=e.length,n=r===t.length;n&&r--&&e[r]===t[r];);return r<0},eF=function(e,t,r,n,i){void 0===r&&(r="_first"),void 0===n&&(n="_last");var a,s=e[n];if(i)for(a=t[i];s&&s[i]>a;)s=s._prev;return s?(t._next=s._next,s._next=t):(t._next=e[r],e[r]=t),t._next?t._next._prev=t:e[n]=t,t._prev=s,t.parent=t._dp=e,t},eB=function(e,t,r,n){void 0===r&&(r="_first"),void 0===n&&(n="_last");var i=t._prev,a=t._next;i?i._next=a:e[r]===t&&(e[r]=a),a?a._prev=i:e[n]===t&&(e[n]=i),t._next=t._prev=t.parent=null},ez=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove&&e.parent.remove(e),e._act=0},eH=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var r=e;r;)r._dirty=1,r=r.parent;return e},eG=function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e},eV=function(e,t,r,n){return e._startAt&&(b?e._startAt.revert(eu):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(t,!0,n))},eW=function(e){return e._repeat?ej(e._tTime,e=e.duration()+e._rDelay)*e:0},ej=function(e,t){var r=Math.floor(e/=t);return e&&r===e?r-1:r},eq=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},eX=function(e){return e._end=eT(e._start+(e._tDur/Math.abs(e._ts||e._rts||1e-8)||0))},eY=function(e,t){var r=e._dp;return r&&r.smoothChildTiming&&e._ts&&(e._start=eT(r._time-(e._ts>0?t/e._ts:-(((e._dirty?e.totalDuration():e._tDur)-t)/e._ts))),eX(e),r._dirty||eH(r,e)),e},eZ=function(e,t){var r;if((t._time||!t._dur&&t._initted||t._start<e._time&&(t._dur||!t.add))&&(r=eq(e.rawTime(),t),(!t._dur||e9(0,t.totalDuration(),r)-t._tTime>1e-8)&&t.render(r,!0)),eH(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(r=e;r._dp;)r.rawTime()>=0&&r.totalTime(r._tTime),r=r._dp;e._zTime=-.00000001}},eJ=function(e,t,r,n){return t.parent&&ez(t),t._start=eT((H(r)?r:r||e!==M?e6(e,r,t):e._time)+t._delay),t._end=eT(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),eF(e,t,"_first","_last",e._sort?"_start":0),e0(t)||(e._recent=t),n||eZ(e,t),e._ts<0&&eY(e,e._tTime),e},eK=function(e,t){return(er.ScrollTrigger||ea("scrollTrigger",t))&&er.ScrollTrigger.create(t,e)},eQ=function(e,t,r,n,i){return(t0(e,t,i),e._initted)?!r&&e._pt&&!b&&(e._dur&&!1!==e.vars.lazy||!e._dur&&e.vars.lazy)&&L!==tE.frame?(ep.push(e),e._lazy=[i,n],1):void 0:1},e$=function e(t){var r=t.parent;return r&&r._ts&&r._initted&&!r._lock&&(0>r.rawTime()||e(r))},e0=function(e){var t=e.data;return"isFromStart"===t||"isStart"===t},e1=function(e,t,r,n){var i,a,s,o=e.ratio,l=t<0||!t&&(!e._start&&e$(e)&&!(!e._initted&&e0(e))||(e._ts<0||e._dp._ts<0)&&!e0(e))?0:1,h=e._rDelay,u=0;if(h&&e._repeat&&(a=ej(u=e9(0,e._tDur,t),h),e._yoyo&&1&a&&(l=1-l),a!==ej(e._tTime,h)&&(o=1-l,e.vars.repeatRefresh&&e._initted&&e.invalidate())),l!==o||b||n||1e-8===e._zTime||!t&&e._zTime){if(!e._initted&&eQ(e,t,n,r,u))return;for(s=e._zTime,e._zTime=t||(r?1e-8:0),r||(r=t&&!s),e.ratio=l,e._from&&(l=1-l),e._time=0,e._tTime=u,i=e._pt;i;)i.r(l,i.d),i=i._next;t<0&&eV(e,t,r,!0),e._onUpdate&&!r&&tf(e,"onUpdate"),u&&e._repeat&&!r&&e.parent&&tf(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===l&&(l&&ez(e,1),r||b||(tf(e,l?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)},e2=function(e,t,r){var n;if(r>t)for(n=e._first;n&&n._start<=r;){if("isPause"===n.data&&n._start>t)return n;n=n._next}else for(n=e._last;n&&n._start>=r;){if("isPause"===n.data&&n._start<t)return n;n=n._prev}},e3=function(e,t,r,n){var i=e._repeat,a=eT(t)||0,s=e._tTime/e._tDur;return s&&!n&&(e._time*=a/e._dur),e._dur=a,e._tDur=i?i<0?1e10:eT(a*(i+1)+e._rDelay*i):a,s>0&&!n&&eY(e,e._tTime=e._tDur*s),e.parent&&eX(e),r||eH(e.parent,e),e},e4=function(e){return e instanceof tV?eH(e):e3(e,e._dur)},e5={_start:0,endTime:el,totalDuration:el},e6=function e(t,r,n){var i,a,s,o=t.labels,l=t._recent||e5,h=t.duration()>=1e8?l.endTime(!1):t._dur;return B(r)&&(isNaN(r)||r in o)?(a=r.charAt(0),s="%"===r.substr(-1),i=r.indexOf("="),"<"===a||">"===a)?(i>=0&&(r=r.replace(/=/,"")),("<"===a?l._start:l.endTime(l._repeat>=0))+(parseFloat(r.substr(1))||0)*(s?(i<0?l:n).totalDuration()/100:1)):i<0?(r in o||(o[r]=h),o[r]):(a=parseFloat(r.charAt(i-1)+r.substr(i+1)),s&&n&&(a=a/100*(Y(n)?n[0]:n).totalDuration()),i>1?e(t,r.substr(0,i-1),n)+a:h+a):null==r?h:+r},e8=function(e,t,r){var n,i,a=H(t[1]),s=(a?2:1)+(e<2?0:1),o=t[s];if(a&&(o.duration=t[1]),o.parent=r,e){for(n=o,i=r;i&&!("immediateRender"in n);)n=i.vars.defaults||{},i=W(i.vars.inherit)&&i.parent;o.immediateRender=W(n.immediateRender),e<2?o.runBackwards=1:o.startAt=t[s-1]}return new t8(t[0],o,t[s+1])},e7=function(e,t){return e||0===e?t(e):t},e9=function(e,t,r){return r<e?e:r>t?t:r},te=function(e,t){return B(e)&&(t=et.exec(e))?t[1]:""},tt=[].slice,tr=function(e,t){return e&&V(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&V(e[0]))&&!e.nodeType&&e!==S},tn=function(e,t,r){var n;return w&&!t&&w.selector?w.selector(e):B(e)&&!r&&(T||!tA())?tt.call((t||E).querySelectorAll(e),0):Y(e)?(void 0===n&&(n=[]),e.forEach(function(e){var t;return B(e)&&!r||tr(e,1)?(t=n).push.apply(t,tn(e)):n.push(e)})||n):tr(e)?tt.call(e,0):e?[e]:[]},ti=function(e){return e=tn(e)[0]||es("Invalid scope")||{},function(t){var r=e.current||e.nativeElement||e;return tn(t,r.querySelectorAll?r:r===e?es("Invalid scope")||E.createElement("div"):e)}},ta=function(e){return e.sort(function(){return .5-Math.random()})},ts=function(e){if(z(e))return e;var t=V(e)?e:{each:e},r=tN(t.ease),n=t.from||0,i=parseFloat(t.base)||0,a={},s=n>0&&n<1,o=isNaN(n)||s,l=t.axis,h=n,u=n;return B(n)?h=u=({center:.5,edges:.5,end:1})[n]||0:!s&&o&&(h=n[0],u=n[1]),function(e,s,c){var d,p,f,m,g,v,y,x,_,b=(c||t).length,w=a[b];if(!w){if(!(_="auto"===t.grid?0:(t.grid||[1,1e8])[1])){for(y=-1e8;y<(y=c[_++].getBoundingClientRect().left)&&_<b;);_<b&&_--}for(v=0,w=a[b]=[],d=o?Math.min(_,b)*h-.5:n%_,p=1e8===_?0:o?b*u/_-.5:n/_|0,y=0,x=1e8;v<b;v++)f=v%_-d,m=p-(v/_|0),w[v]=g=l?Math.abs("y"===l?m:f):N(f*f+m*m),g>y&&(y=g),g<x&&(x=g);"random"===n&&ta(w),w.max=y-x,w.min=x,w.v=b=(parseFloat(t.amount)||parseFloat(t.each)*(_>b?b-1:l?"y"===l?b/_:_:Math.max(_,b/_))||0)*("edges"===n?-1:1),w.b=b<0?i-b:i,w.u=te(t.amount||t.each)||0,r=r&&b<0?tO(r):r}return b=(w[e]-w.min)/w.max||0,eT(w.b+(r?r(b):b)*w.v)+w.u}},to=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(r){var n=eT(Math.round(parseFloat(r)/e)*e*t);return(n-n%1)/t+(H(r)?0:te(r))}},tl=function(e,t){var r,n,i=Y(e);return!i&&V(e)&&(r=i=e.radius||1e8,e.values?(n=!H((e=tn(e.values))[0]))&&(r*=r):e=to(e.increment)),e7(t,i?z(e)?function(t){return Math.abs((n=e(t))-t)<=r?n:t}:function(t){for(var i,a,s=parseFloat(n?t.x:t),o=parseFloat(n?t.y:0),l=1e8,h=0,u=e.length;u--;)(i=n?(i=e[u].x-s)*i+(a=e[u].y-o)*a:Math.abs(e[u]-s))<l&&(l=i,h=u);return h=!r||l<=r?e[h]:t,n||h===t||H(t)?h:h+te(t)}:to(e))},th=function(e,t,r,n){return e7(Y(e)?!t:!0===r?(r=0,!1):!n,function(){return Y(e)?e[~~(Math.random()*e.length)]:(n=(r=r||1e-5)<1?Math.pow(10,(r+"").length-2):1)&&Math.floor(Math.round((e-r/2+Math.random()*(t-e+.99*r))/r)*r*n)/n})},tu=function(e,t,r){return e7(r,function(r){return e[~~t(r)]})},tc=function(e){for(var t,r,n,i,a=0,s="";~(t=e.indexOf("random(",a));)n=e.indexOf(")",t),i="["===e.charAt(t+7),r=e.substr(t+7,n-t-7).match(i?ee:Z),s+=e.substr(a,t-a)+th(i?r:+r[0],i?0:+r[1],+r[2]||1e-5),a=n+1;return s+e.substr(a,e.length-a)},td=function(e,t,r,n,i){var a=t-e,s=n-r;return e7(i,function(t){return r+((t-e)/a*s||0)})},tp=function(e,t,r){var n,i,a,s=e.labels,o=1e8;for(n in s)(i=s[n]-t)<0==!!r&&i&&o>(i=Math.abs(i))&&(a=n,o=i);return a},tf=function(e,t,r){var n,i,a,s=e.vars,o=s[t],l=w,h=e._ctx;if(o)return n=s[t+"Params"],i=s.callbackScope||e,r&&ep.length&&eL(),h&&(w=h),a=n?o.apply(i,n):o.call(i),w=l,a},tm=function(e){return ez(e),e.scrollTrigger&&e.scrollTrigger.kill(!!b),1>e.progress()&&tf(e,"onInterrupt"),e},tg=[],tv=function(e){if(e){if(e=!e.name&&e.default||e,j()||e.headless){var t=e.name,r=z(e),n=t&&!r&&e.init?function(){this._props=[]}:e,i={init:el,render:rs,add:tK,kill:rl,modifier:ro,rawVars:0},a={targetTest:0,get:0,getSetter:rr,aliases:{},register:0};if(tA(),e!==n){if(em[t])return;eI(n,eI(eU(e,i),a)),eD(n.prototype,eD(i,eU(e,a))),em[n.prop=t]=n,e.targetTest&&(ey.push(n),ed[t]=1),t=("css"===t?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}eo(t,n),e.register&&e.register(rT,n,rc)}else tg.push(e)}},ty={aqua:[0,255,255],lime:[0,255,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,255],navy:[0,0,128],white:[255,255,255],olive:[128,128,0],yellow:[255,255,0],orange:[255,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[255,0,0],pink:[255,192,203],cyan:[0,255,255],transparent:[255,255,255,0]},tx=function(e,t,r){return(6*(e+=e<0?1:e>1?-1:0)<1?t+(r-t)*e*6:e<.5?r:3*e<2?t+(r-t)*(2/3-e)*6:t)*255+.5|0},t_=function(e,t,r){var n,i,a,s,o,l,h,u,c,d,p=e?H(e)?[e>>16,e>>8&255,255&e]:0:ty.black;if(!p){if(","===e.substr(-1)&&(e=e.substr(0,e.length-1)),ty[e])p=ty[e];else if("#"===e.charAt(0)){if(e.length<6&&(e="#"+(n=e.charAt(1))+n+(i=e.charAt(2))+i+(a=e.charAt(3))+a+(5===e.length?e.charAt(4)+e.charAt(4):"")),9===e.length)return[(p=parseInt(e.substr(1,6),16))>>16,p>>8&255,255&p,parseInt(e.substr(7),16)/255];p=[(e=parseInt(e.substr(1),16))>>16,e>>8&255,255&e]}else if("hsl"===e.substr(0,3)){if(p=d=e.match(Z),t){if(~e.indexOf("="))return p=e.match(J),r&&p.length<4&&(p[3]=1),p}else s=+p[0]%360/360,o=+p[1]/100,i=(l=+p[2]/100)<=.5?l*(o+1):l+o-l*o,n=2*l-i,p.length>3&&(p[3]*=1),p[0]=tx(s+1/3,n,i),p[1]=tx(s,n,i),p[2]=tx(s-1/3,n,i)}else p=e.match(Z)||ty.transparent;p=p.map(Number)}return t&&!d&&(l=((h=Math.max(n=p[0]/255,i=p[1]/255,a=p[2]/255))+(u=Math.min(n,i,a)))/2,h===u?s=o=0:(c=h-u,o=l>.5?c/(2-h-u):c/(h+u),s=(h===n?(i-a)/c+(i<a?6:0):h===i?(a-n)/c+2:(n-i)/c+4)*60),p[0]=~~(s+.5),p[1]=~~(100*o+.5),p[2]=~~(100*l+.5)),r&&p.length<4&&(p[3]=1),p},tb=function(e){var t=[],r=[],n=-1;return e.split(tM).forEach(function(e){var i=e.match(K)||[];t.push.apply(t,i),r.push(n+=i.length+1)}),t.c=r,t},tw=function(e,t,r){var n,i,a,s,o="",l=(e+o).match(tM),h=t?"hsla(":"rgba(",u=0;if(!l)return e;if(l=l.map(function(e){return(e=t_(e,t,1))&&h+(t?e[0]+","+e[1]+"%,"+e[2]+"%,"+e[3]:e.join(","))+")"}),r&&(a=tb(e),(n=r.c).join(o)!==a.c.join(o)))for(s=(i=e.replace(tM,"1").split(K)).length-1;u<s;u++)o+=i[u]+(~n.indexOf(u)?l.shift()||h+"0,0,0,0)":(a.length?a:l.length?l:r).shift());if(!i)for(s=(i=e.split(tM)).length-1;u<s;u++)o+=i[u]+l[u];return o+i[s]},tM=function(){var e,t="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b";for(e in ty)t+="|"+e+"\\b";return RegExp(t+")","gi")}(),tS=/hsl[a]?\(/,tT=function(e){var t,r=e.join(" ");if(tM.lastIndex=0,tM.test(r))return t=tS.test(r),e[1]=tw(e[1],t),e[0]=tw(e[0],t,tb(e[1])),!0},tE=(c=Date.now,d=500,p=33,m=f=c(),g=1e3/240,v=1e3/240,y=[],x=function e(t){var r,n,i,o,x=c()-m,_=!0===t;if((x>d||x<0)&&(f+=x-p),m+=x,((r=(i=m-f)-v)>0||_)&&(o=++l.frame,h=i-1e3*l.time,l.time=i/=1e3,v+=r+(r>=g?4:g-r),n=1),_||(a=s(e)),n)for(u=0;u<y.length;u++)y[u](i,h,o,t)},l={time:0,frame:0,tick:function(){x(!0)},deltaRatio:function(e){return h/(1e3/(e||60))},wake:function(){A&&(!T&&j()&&(E=(S=T=window).document||{},er.gsap=rT,(S.gsapVersions||(S.gsapVersions=[])).push(rT.version),ei(en||S.GreenSockGlobals||!S.gsap&&S||{}),tg.forEach(tv)),o="undefined"!=typeof requestAnimationFrame&&requestAnimationFrame,a&&l.sleep(),s=o||function(e){return setTimeout(e,v-1e3*l.time+1|0)},P=1,x(2))},sleep:function(){(o?cancelAnimationFrame:clearTimeout)(a),P=0,s=el},lagSmoothing:function(e,t){p=Math.min(t||33,d=e||1/0)},fps:function(e){g=1e3/(e||240),v=1e3*l.time+g},add:function(e,t,r){var n=t?function(t,r,i,a){e(t,r,i,a),l.remove(n)}:e;return l.remove(e),y[r?"unshift":"push"](n),tA(),n},remove:function(e,t){~(t=y.indexOf(e))&&y.splice(t,1)&&u>=t&&u--},_listeners:y}),tA=function(){return!P&&tE.wake()},tL={},tR=/^[\d.\-M][\d.\-,\s]/,tP=/["']/g,tC=function(e){for(var t,r,n,i={},a=e.substr(1,e.length-3).split(":"),s=a[0],o=1,l=a.length;o<l;o++)r=a[o],t=o!==l-1?r.lastIndexOf(","):r.length,n=r.substr(0,t),i[s]=isNaN(n)?n.replace(tP,"").trim():+n,s=r.substr(t+1).trim();return i},tI=function(e){var t=e.indexOf("(")+1,r=e.indexOf(")"),n=e.indexOf("(",t);return e.substring(t,~n&&n<r?e.indexOf(")",r+1):r)},tD=function(e){var t=(e+"").split("("),r=tL[t[0]];return r&&t.length>1&&r.config?r.config.apply(null,~e.indexOf("{")?[tC(t[1])]:tI(e).split(",").map(eP)):tL._CE&&tR.test(e)?tL._CE("",e):r},tO=function(e){return function(t){return 1-e(1-t)}},tU=function e(t,r){for(var n,i=t._first;i;)i instanceof tV?e(i,r):!i.vars.yoyoEase||i._yoyo&&i._repeat||i._yoyo===r||(i.timeline?e(i.timeline,r):(n=i._ease,i._ease=i._yEase,i._yEase=n,i._yoyo=r)),i=i._next},tN=function(e,t){return e&&(z(e)?e:tL[e]||tD(e))||t},tk=function(e,t,r,n){void 0===r&&(r=function(e){return 1-t(1-e)}),void 0===n&&(n=function(e){return e<.5?t(2*e)/2:1-t((1-e)*2)/2});var i,a={easeIn:t,easeOut:r,easeInOut:n};return eM(e,function(e){for(var t in tL[e]=er[e]=a,tL[i=e.toLowerCase()]=r,a)tL[i+("easeIn"===t?".in":"easeOut"===t?".out":".inOut")]=tL[e+"."+t]=a[t]}),a},tF=function(e){return function(t){return t<.5?(1-e(1-2*t))/2:.5+e((t-.5)*2)/2}},tB=function e(t,r,n){var i=r>=1?r:1,a=(n||(t?.3:.45))/(r<1?r:1),s=a/D*(Math.asin(1/i)||0),o=function(e){return 1===e?1:i*Math.pow(2,-10*e)*F((e-s)*a)+1},l="out"===t?o:"in"===t?function(e){return 1-o(1-e)}:tF(o);return a=D/a,l.config=function(r,n){return e(t,r,n)},l},tz=function e(t,r){void 0===r&&(r=1.70158);var n=function(e){return e?--e*e*((r+1)*e+r)+1:0},i="out"===t?n:"in"===t?function(e){return 1-n(1-e)}:tF(n);return i.config=function(r){return e(t,r)},i};eM("Linear,Quad,Cubic,Quart,Quint,Strong",function(e,t){var r=t<5?t+1:t;tk(e+",Power"+(r-1),t?function(e){return Math.pow(e,r)}:function(e){return e},function(e){return 1-Math.pow(1-e,r)},function(e){return e<.5?Math.pow(2*e,r)/2:1-Math.pow((1-e)*2,r)/2})}),tL.Linear.easeNone=tL.none=tL.Linear.easeIn,tk("Elastic",tB("in"),tB("out"),tB()),tj=2*(tW=1/2.75),tq=2.5*tW,tk("Bounce",function(e){return 1-tX(1-e)},tX=function(e){return e<tW?7.5625*e*e:e<tj?7.5625*Math.pow(e-1.5/2.75,2)+.75:e<tq?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*Math.pow(e-2.625/2.75,2)+.984375}),tk("Expo",function(e){return e?Math.pow(2,10*(e-1)):0}),tk("Circ",function(e){return-(N(1-e*e)-1)}),tk("Sine",function(e){return 1===e?1:-k(e*O)+1}),tk("Back",tz("in"),tz("out"),tz()),tL.SteppedEase=tL.steps=er.SteppedEase={config:function(e,t){void 0===e&&(e=1);var r=1/e,n=e+(t?0:1),i=t?1:0;return function(e){return((n*e9(0,.99999999,e)|0)+i)*r}}},I.ease=tL["quad.out"],eM("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(e){return ex+=e+","+e+"Params,"});var tH=function(e,t){this.id=U++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:ew,this.set=t?t.getSetter:rr},tG=/*#__PURE__*/function(){function e(e){this.vars=e,this._delay=+e.delay||0,(this._repeat=e.repeat===1/0?-2:e.repeat||0)&&(this._rDelay=e.repeatDelay||0,this._yoyo=!!e.yoyo||!!e.yoyoEase),this._ts=1,e3(this,+e.duration,1,1),this.data=e.data,w&&(this._ctx=w,w.data.push(this)),P||tE.wake()}var t=e.prototype;return t.delay=function(e){return e||0===e?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+e-this._delay),this._delay=e,this):this._delay},t.duration=function(e){return arguments.length?this.totalDuration(this._repeat>0?e+(e+this._rDelay)*this._repeat:e):this.totalDuration()&&this._dur},t.totalDuration=function(e){return arguments.length?(this._dirty=0,e3(this,this._repeat<0?e:(e-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},t.totalTime=function(e,t){if(tA(),!arguments.length)return this._tTime;var r=this._dp;if(r&&r.smoothChildTiming&&this._ts){for(eY(this,e),!r._dp||r.parent||eZ(r,this);r&&r.parent;)r.parent._time!==r._start+(r._ts>=0?r._tTime/r._ts:-((r.totalDuration()-r._tTime)/r._ts))&&r.totalTime(r._tTime,!0),r=r.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&e<this._tDur||this._ts<0&&e>0||!this._tDur&&!e)&&eJ(this._dp,this,this._start-this._delay)}return this._tTime===e&&(this._dur||t)&&(!this._initted||1e-8!==Math.abs(this._zTime))&&(e||this._initted||!this.add&&!this._ptLookup)||(this._ts||(this._pTime=e),eR(this,e,t)),this},t.time=function(e,t){return arguments.length?this.totalTime(Math.min(this.totalDuration(),e+eW(this))%(this._dur+this._rDelay)||(e?this._dur:0),t):this._time},t.totalProgress=function(e,t){return arguments.length?this.totalTime(this.totalDuration()*e,t):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>0?1:0},t.progress=function(e,t){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(1&this.iteration())?1-e:e)+eW(this),t):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},t.iteration=function(e,t){var r=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(e-1)*r,t):this._repeat?ej(this._tTime,r)+1:1},t.timeScale=function(e,t){if(!arguments.length)return -.00000001===this._rts?0:this._rts;if(this._rts===e)return this;var r=this.parent&&this._ts?eq(this.parent._time,this):this._tTime;return this._rts=+e||0,this._ts=this._ps||-.00000001===e?0:this._rts,this.totalTime(e9(-Math.abs(this._delay),this._tDur,r),!1!==t),eX(this),eG(this)},t.paused=function(e){return arguments.length?(this._ps!==e&&(this._ps=e,e?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(tA(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,1===this.progress()&&1e-8!==Math.abs(this._zTime)&&(this._tTime-=1e-8)))),this):this._ps},t.startTime=function(e){if(arguments.length){this._start=e;var t=this.parent||this._dp;return t&&(t._sort||!this.parent)&&eJ(t,this,e-this._delay),this}return this._start},t.endTime=function(e){return this._start+(W(e)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},t.rawTime=function(e){var t=this.parent||this._dp;return t?e&&(!this._ts||this._repeat&&this._time&&1>this.totalProgress())?this._tTime%(this._dur+this._rDelay):this._ts?eq(t.rawTime(e),this):this._tTime:this._tTime},t.revert=function(e){void 0===e&&(e=ec);var t=b;return b=e,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(e),this.totalTime(-.01,e.suppressEvents)),"nested"!==this.data&&!1!==e.kill&&this.kill(),b=t,this},t.globalTime=function(e){for(var t=this,r=arguments.length?e:t.rawTime();t;)r=t._start+r/(Math.abs(t._ts)||1),t=t._dp;return!this.parent&&this._sat?this._sat.globalTime(e):r},t.repeat=function(e){return arguments.length?(this._repeat=e===1/0?-2:e,e4(this)):-2===this._repeat?1/0:this._repeat},t.repeatDelay=function(e){if(arguments.length){var t=this._time;return this._rDelay=e,e4(this),t?this.time(t):this}return this._rDelay},t.yoyo=function(e){return arguments.length?(this._yoyo=e,this):this._yoyo},t.seek=function(e,t){return this.totalTime(e6(this,e),W(t))},t.restart=function(e,t){return this.play().totalTime(e?-this._delay:0,W(t))},t.play=function(e,t){return null!=e&&this.seek(e,t),this.reversed(!1).paused(!1)},t.reverse=function(e,t){return null!=e&&this.seek(e||this.totalDuration(),t),this.reversed(!0).paused(!1)},t.pause=function(e,t){return null!=e&&this.seek(e,t),this.paused(!0)},t.resume=function(){return this.paused(!1)},t.reversed=function(e){return arguments.length?(!!e!==this.reversed()&&this.timeScale(-this._rts||(e?-.00000001:0)),this):this._rts<0},t.invalidate=function(){return this._initted=this._act=0,this._zTime=-.00000001,this},t.isActive=function(){var e,t=this.parent||this._dp,r=this._start;return!!(!t||this._ts&&this._initted&&t.isActive()&&(e=t.rawTime(!0))>=r&&e<this.endTime(!0)-1e-8)},t.eventCallback=function(e,t,r){var n=this.vars;return arguments.length>1?(t?(n[e]=t,r&&(n[e+"Params"]=r),"onUpdate"===e&&(this._onUpdate=t)):delete n[e],this):n[e]},t.then=function(e){var t=this;return new Promise(function(r){var n=z(e)?e:eC,i=function(){var e=t.then;t.then=null,z(n)&&(n=n(t))&&(n.then||n===t)&&(t.then=e),r(n),t.then=e};t._initted&&1===t.totalProgress()&&t._ts>=0||!t._tTime&&t._ts<0?i():t._prom=i})},t.kill=function(){tm(this)},e}();eI(tG.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-.00000001,_prom:0,_ps:!1,_rts:1});var tV=/*#__PURE__*/function(e){function t(t,r){var i;return void 0===t&&(t={}),(i=e.call(this,t)||this).labels={},i.smoothChildTiming=!!t.smoothChildTiming,i.autoRemoveChildren=!!t.autoRemoveChildren,i._sort=W(t.sortChildren),M&&eJ(t.parent||M,n(i),r),t.reversed&&i.reverse(),t.paused&&i.paused(!0),t.scrollTrigger&&eK(n(i),t.scrollTrigger),i}i(t,e);var r=t.prototype;return r.to=function(e,t,r){return e8(0,arguments,this),this},r.from=function(e,t,r){return e8(1,arguments,this),this},r.fromTo=function(e,t,r,n){return e8(2,arguments,this),this},r.set=function(e,t,r){return t.duration=0,t.parent=this,eN(t).repeatDelay||(t.repeat=0),t.immediateRender=!!t.immediateRender,new t8(e,t,e6(this,r),1),this},r.call=function(e,t,r){return eJ(this,t8.delayedCall(0,e,t),r)},r.staggerTo=function(e,t,r,n,i,a,s){return r.duration=t,r.stagger=r.stagger||n,r.onComplete=a,r.onCompleteParams=s,r.parent=this,new t8(e,r,e6(this,i)),this},r.staggerFrom=function(e,t,r,n,i,a,s){return r.runBackwards=1,eN(r).immediateRender=W(r.immediateRender),this.staggerTo(e,t,r,n,i,a,s)},r.staggerFromTo=function(e,t,r,n,i,a,s,o){return n.startAt=r,eN(n).immediateRender=W(n.immediateRender),this.staggerTo(e,t,n,i,a,s,o)},r.render=function(e,t,r){var n,i,a,s,o,l,h,u,c,d,p,f,m=this._time,g=this._dirty?this.totalDuration():this._tDur,v=this._dur,y=e<=0?0:eT(e),x=this._zTime<0!=e<0&&(this._initted||!v);if(this!==M&&y>g&&e>=0&&(y=g),y!==this._tTime||r||x){if(m!==this._time&&v&&(y+=this._time-m,e+=this._time-m),n=y,c=this._start,l=!(u=this._ts),x&&(v||(m=this._zTime),(e||!t)&&(this._zTime=e)),this._repeat){if(p=this._yoyo,o=v+this._rDelay,this._repeat<-1&&e<0)return this.totalTime(100*o+e,t,r);if(n=eT(y%o),y===g?(s=this._repeat,n=v):((s=~~(y/o))&&s===y/o&&(n=v,s--),n>v&&(n=v)),d=ej(this._tTime,o),!m&&this._tTime&&d!==s&&this._tTime-d*o-this._dur<=0&&(d=s),p&&1&s&&(n=v-n,f=1),s!==d&&!this._lock){var _=p&&1&d,w=_===(p&&1&s);if(s<d&&(_=!_),m=_?0:y%v?v:y,this._lock=1,this.render(m||(f?0:eT(s*o)),t,!v)._lock=0,this._tTime=y,!t&&this.parent&&tf(this,"onRepeat"),this.vars.repeatRefresh&&!f&&(this.invalidate()._lock=1),m&&m!==this._time||!this._ts!==l||this.vars.onRepeat&&!this.parent&&!this._act||(v=this._dur,g=this._tDur,w&&(this._lock=2,m=_?v:-.0001,this.render(m,!0),this.vars.repeatRefresh&&!f&&this.invalidate()),this._lock=0,!this._ts&&!l))return this;tU(this,f)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(h=e2(this,eT(m),eT(n)))&&(y-=n-(n=h._start)),this._tTime=y,this._time=n,this._act=!u,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=e,m=0),!m&&n&&!t&&!s&&(tf(this,"onStart"),this._tTime!==y))return this;if(n>=m&&e>=0)for(i=this._first;i;){if(a=i._next,(i._act||n>=i._start)&&i._ts&&h!==i){if(i.parent!==this)return this.render(e,t,r);if(i.render(i._ts>0?(n-i._start)*i._ts:(i._dirty?i.totalDuration():i._tDur)+(n-i._start)*i._ts,t,r),n!==this._time||!this._ts&&!l){h=0,a&&(y+=this._zTime=-.00000001);break}}i=a}else{i=this._last;for(var S=e<0?e:n;i;){if(a=i._prev,(i._act||S<=i._end)&&i._ts&&h!==i){if(i.parent!==this)return this.render(e,t,r);if(i.render(i._ts>0?(S-i._start)*i._ts:(i._dirty?i.totalDuration():i._tDur)+(S-i._start)*i._ts,t,r||b&&(i._initted||i._startAt)),n!==this._time||!this._ts&&!l){h=0,a&&(y+=this._zTime=S?-.00000001:1e-8);break}}i=a}}if(h&&!t&&(this.pause(),h.render(n>=m?0:-.00000001)._zTime=n>=m?1:-1,this._ts))return this._start=c,eX(this),this.render(e,t,r);this._onUpdate&&!t&&tf(this,"onUpdate",!0),(y===g&&this._tTime>=this.totalDuration()||!y&&m)&&(c===this._start||Math.abs(u)!==Math.abs(this._ts))&&!this._lock&&((e||!v)&&(y===g&&this._ts>0||!y&&this._ts<0)&&ez(this,1),t||e<0&&!m||!y&&!m&&g||(tf(this,y===g&&e>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(y<g&&this.timeScale()>0)&&this._prom()))}return this},r.add=function(e,t){var r=this;if(H(t)||(t=e6(this,t,e)),!(e instanceof tG)){if(Y(e))return e.forEach(function(e){return r.add(e,t)}),this;if(B(e))return this.addLabel(e,t);if(!z(e))return this;e=t8.delayedCall(0,e)}return this!==e?eJ(this,e,t):this},r.getChildren=function(e,t,r,n){void 0===e&&(e=!0),void 0===t&&(t=!0),void 0===r&&(r=!0),void 0===n&&(n=-1e8);for(var i=[],a=this._first;a;)a._start>=n&&(a instanceof t8?t&&i.push(a):(r&&i.push(a),e&&i.push.apply(i,a.getChildren(!0,t,r)))),a=a._next;return i},r.getById=function(e){for(var t=this.getChildren(1,1,1),r=t.length;r--;)if(t[r].vars.id===e)return t[r]},r.remove=function(e){return B(e)?this.removeLabel(e):z(e)?this.killTweensOf(e):(eB(this,e),e===this._recent&&(this._recent=this._last),eH(this))},r.totalTime=function(t,r){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=eT(tE.time-(this._ts>0?t/this._ts:-((this.totalDuration()-t)/this._ts)))),e.prototype.totalTime.call(this,t,r),this._forcing=0,this):this._tTime},r.addLabel=function(e,t){return this.labels[e]=e6(this,t),this},r.removeLabel=function(e){return delete this.labels[e],this},r.addPause=function(e,t,r){var n=t8.delayedCall(0,t||el,r);return n.data="isPause",this._hasPause=1,eJ(this,n,e6(this,e))},r.removePause=function(e){var t=this._first;for(e=e6(this,e);t;)t._start===e&&"isPause"===t.data&&ez(t),t=t._next},r.killTweensOf=function(e,t,r){for(var n=this.getTweensOf(e,r),i=n.length;i--;)tY!==n[i]&&n[i].kill(e,t);return this},r.getTweensOf=function(e,t){for(var r,n=[],i=tn(e),a=this._first,s=H(t);a;)a instanceof t8?eA(a._targets,i)&&(s?(!tY||a._initted&&a._ts)&&a.globalTime(0)<=t&&a.globalTime(a.totalDuration())>t:!t||a.isActive())&&n.push(a):(r=a.getTweensOf(i,t)).length&&n.push.apply(n,r),a=a._next;return n},r.tweenTo=function(e,t){t=t||{};var r,n=this,i=e6(n,e),a=t,s=a.startAt,o=a.onStart,l=a.onStartParams,h=a.immediateRender,u=t8.to(n,eI({ease:t.ease||"none",lazy:!1,immediateRender:!1,time:i,overwrite:"auto",duration:t.duration||Math.abs((i-(s&&"time"in s?s.time:n._time))/n.timeScale())||1e-8,onStart:function(){if(n.pause(),!r){var e=t.duration||Math.abs((i-(s&&"time"in s?s.time:n._time))/n.timeScale());u._dur!==e&&e3(u,e,0,1).render(u._time,!0,!0),r=1}o&&o.apply(u,l||[])}},t));return h?u.render(0):u},r.tweenFromTo=function(e,t,r){return this.tweenTo(t,eI({startAt:{time:e6(this,e)}},r))},r.recent=function(){return this._recent},r.nextLabel=function(e){return void 0===e&&(e=this._time),tp(this,e6(this,e))},r.previousLabel=function(e){return void 0===e&&(e=this._time),tp(this,e6(this,e),1)},r.currentLabel=function(e){return arguments.length?this.seek(e,!0):this.previousLabel(this._time+1e-8)},r.shiftChildren=function(e,t,r){void 0===r&&(r=0);for(var n,i=this._first,a=this.labels;i;)i._start>=r&&(i._start+=e,i._end+=e),i=i._next;if(t)for(n in a)a[n]>=r&&(a[n]+=e);return eH(this)},r.invalidate=function(t){var r=this._first;for(this._lock=0;r;)r.invalidate(t),r=r._next;return e.prototype.invalidate.call(this,t)},r.clear=function(e){void 0===e&&(e=!0);for(var t,r=this._first;r;)t=r._next,this.remove(r),r=t;return this._dp&&(this._time=this._tTime=this._pTime=0),e&&(this.labels={}),eH(this)},r.totalDuration=function(e){var t,r,n,i=0,a=this._last,s=1e8;if(arguments.length)return this.timeScale((this._repeat<0?this.duration():this.totalDuration())/(this.reversed()?-e:e));if(this._dirty){for(n=this.parent;a;)t=a._prev,a._dirty&&a.totalDuration(),(r=a._start)>s&&this._sort&&a._ts&&!this._lock?(this._lock=1,eJ(this,a,r-a._delay,1)._lock=0):s=r,r<0&&a._ts&&(i-=r,(!n&&!this._dp||n&&n.smoothChildTiming)&&(this._start+=r/this._ts,this._time-=r,this._tTime-=r),this.shiftChildren(-r,!1,-1/0),s=0),a._end>i&&a._ts&&(i=a._end),a=t;e3(this,this===M&&this._time>i?this._time:i,1,1),this._dirty=0}return this._tDur},t.updateRoot=function(e){if(M._ts&&(eR(M,eq(e,M)),L=tE.frame),tE.frame>=ev){ev+=C.autoSleep||120;var t=M._first;if((!t||!t._ts)&&C.autoSleep&&tE._listeners.length<2){for(;t&&!t._ts;)t=t._next;t||tE.sleep()}}},t}(tG);eI(tV.prototype,{_lock:0,_hasPause:0,_forcing:0});var tW,tj,tq,tX,tY,tZ,tJ=function(e,t,r,n,i,a,s){var o,l,h,u,c,d,p,f,m=new rc(this._pt,e,t,0,1,ra,null,i),g=0,v=0;for(m.b=r,m.e=n,r+="",n+="",(p=~n.indexOf("random("))&&(n=tc(n)),a&&(a(f=[r,n],e,t),r=f[0],n=f[1]),l=r.match(Q)||[];o=Q.exec(n);)u=o[0],c=n.substring(g,o.index),h?h=(h+1)%5:"rgba("===c.substr(-5)&&(h=1),u!==l[v++]&&(d=parseFloat(l[v-1])||0,m._pt={_next:m._pt,p:c||1===v?c:",",s:d,c:"="===u.charAt(1)?eE(d,u)-d:parseFloat(u)-d,m:h&&h<4?Math.round:0},g=Q.lastIndex);return m.c=g<n.length?n.substring(g,n.length):"",m.fp=s,($.test(n)||p)&&(m.e=0),this._pt=m,m},tK=function(e,t,r,n,i,a,s,o,l,h){z(n)&&(n=n(i||0,e,a));var u,c=e[t],d="get"!==r?r:z(c)?l?e[t.indexOf("set")||!z(e["get"+t.substr(3)])?t:"get"+t.substr(3)](l):e[t]():c,p=z(c)?l?re:t9:t7;if(B(n)&&(~n.indexOf("random(")&&(n=tc(n)),"="===n.charAt(1)&&((u=eE(d,n)+(te(d)||0))||0===u)&&(n=u)),!h||d!==n||tZ)return isNaN(d*n)||""===n?(c||t in e||ea(t,n),tJ.call(this,e,t,d,n,p,o||C.stringFilter,l)):(u=new rc(this._pt,e,t,+d||0,n-(d||0),"boolean"==typeof c?ri:rn,0,p),l&&(u.fp=l),s&&u.modifier(s,this,e),this._pt=u)},tQ=function(e,t,r,n,i){if(z(e)&&(e=t4(e,i,t,r,n)),!V(e)||e.style&&e.nodeType||Y(e)||X(e))return B(e)?t4(e,i,t,r,n):e;var a,s={};for(a in e)s[a]=t4(e[a],i,t,r,n);return s},t$=function(e,t,r,n,i,a){var s,o,l,h;if(em[e]&&!1!==(s=new em[e]).init(i,s.rawVars?t[e]:tQ(t[e],n,i,a,r),r,n,a)&&(r._pt=o=new rc(r._pt,i,e,0,1,s.render,s,0,s.priority),r!==R))for(l=r._ptLookup[r._targets.indexOf(i)],h=s._props.length;h--;)l[s._props[h]]=o;return s},t0=function e(t,r,n){var i,a,s,o,l,h,u,c,d,p,f,m,g,v=t.vars,y=v.ease,x=v.startAt,w=v.immediateRender,S=v.lazy,T=v.onUpdate,E=v.runBackwards,A=v.yoyoEase,L=v.keyframes,R=v.autoRevert,P=t._dur,C=t._startAt,D=t._targets,O=t.parent,U=O&&"nested"===O.data?O.vars.targets:D,N="auto"===t._overwrite&&!_,k=t.timeline;if(!k||L&&y||(y="none"),t._ease=tN(y,I.ease),t._yEase=A?tO(tN(!0===A?y:A,I.ease)):0,A&&t._yoyo&&!t._repeat&&(A=t._yEase,t._yEase=t._ease,t._ease=A),t._from=!k&&!!v.runBackwards,!k||L&&!v.stagger){if(m=(c=D[0]?eb(D[0]).harness:0)&&v[c.prop],i=eU(v,ed),C&&(C._zTime<0&&C.progress(1),r<0&&E&&w&&!R?C.render(-1,!0):C.revert(E&&P?eu:eh),C._lazy=0),x){if(ez(t._startAt=t8.set(D,eI({data:"isStart",overwrite:!1,parent:O,immediateRender:!0,lazy:!C&&W(S),startAt:null,delay:0,onUpdate:T&&function(){return tf(t,"onUpdate")},stagger:0},x))),t._startAt._dp=0,t._startAt._sat=t,r<0&&(b||!w&&!R)&&t._startAt.revert(eu),w&&P&&r<=0&&n<=0){r&&(t._zTime=r);return}}else if(E&&P&&!C){if(r&&(w=!1),s=eI({overwrite:!1,data:"isFromStart",lazy:w&&!C&&W(S),immediateRender:w,stagger:0,parent:O},i),m&&(s[c.prop]=m),ez(t._startAt=t8.set(D,s)),t._startAt._dp=0,t._startAt._sat=t,r<0&&(b?t._startAt.revert(eu):t._startAt.render(-1,!0)),t._zTime=r,w){if(!r)return}else e(t._startAt,1e-8,1e-8)}for(a=0,t._pt=t._ptCache=0,S=P&&W(S)||S&&!P;a<D.length;a++){if(u=(l=D[a])._gsap||e_(D)[a]._gsap,t._ptLookup[a]=p={},ef[u.id]&&ep.length&&eL(),f=U===D?a:U.indexOf(l),c&&!1!==(d=new c).init(l,m||i,t,f,U)&&(t._pt=o=new rc(t._pt,l,d.name,0,1,d.render,d,0,d.priority),d._props.forEach(function(e){p[e]=o}),d.priority&&(h=1)),!c||m)for(s in i)em[s]&&(d=t$(s,i,t,f,l,U))?d.priority&&(h=1):p[s]=o=tK.call(t,l,s,"get",i[s],f,U,0,v.stringFilter);t._op&&t._op[a]&&t.kill(l,t._op[a]),N&&t._pt&&(tY=t,M.killTweensOf(l,p,t.globalTime(r)),g=!t.parent,tY=0),t._pt&&S&&(ef[u.id]=1)}h&&ru(t),t._onInit&&t._onInit(t)}t._onUpdate=T,t._initted=(!t._op||t._pt)&&!g,L&&r<=0&&k.render(1e8,!0,!0)},t1=function(e,t,r,n,i,a,s,o){var l,h,u,c,d=(e._pt&&e._ptCache||(e._ptCache={}))[t];if(!d)for(d=e._ptCache[t]=[],u=e._ptLookup,c=e._targets.length;c--;){if((l=u[c][t])&&l.d&&l.d._pt)for(l=l.d._pt;l&&l.p!==t&&l.fp!==t;)l=l._next;if(!l)return tZ=1,e.vars[t]="+=0",t0(e,s),tZ=0,o?es(t+" not eligible for reset"):1;d.push(l)}for(c=d.length;c--;)(l=(h=d[c])._pt||h).s=(n||0===n)&&!i?n:l.s+(n||0)+a*l.c,l.c=r-l.s,h.e&&(h.e=eS(r)+te(h.e)),h.b&&(h.b=l.s+te(h.b))},t2=function(e,t){var r,n,i,a,s=e[0]?eb(e[0]).harness:0,o=s&&s.aliases;if(!o)return t;for(n in r=eD({},t),o)if(n in r)for(i=(a=o[n].split(",")).length;i--;)r[a[i]]=r[n];return r},t3=function(e,t,r,n){var i,a,s=t.ease||n||"power1.inOut";if(Y(t))a=r[e]||(r[e]=[]),t.forEach(function(e,r){return a.push({t:r/(t.length-1)*100,v:e,e:s})});else for(i in t)a=r[i]||(r[i]=[]),"ease"===i||a.push({t:parseFloat(e),v:t[i],e:s})},t4=function(e,t,r,n,i){return z(e)?e.call(t,r,n,i):B(e)&&~e.indexOf("random(")?tc(e):e},t5=ex+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",t6={};eM(t5+",id,stagger,delay,duration,paused,scrollTrigger",function(e){return t6[e]=1});var t8=/*#__PURE__*/function(e){function t(t,r,i,a){"number"==typeof r&&(i.duration=r,r=i,i=null);var s,o,l,h,u,c,d,p,f,m=(s=e.call(this,a?r:eN(r))||this).vars,g=m.duration,v=m.delay,y=m.immediateRender,x=m.stagger,b=m.overwrite,w=m.keyframes,S=m.defaults,T=m.scrollTrigger,E=m.yoyoEase,A=r.parent||M,L=(Y(t)||X(t)?H(t[0]):"length"in r)?[t]:tn(t);if(s._targets=L.length?e_(L):es("GSAP target "+t+" not found. https://gsap.com",!C.nullTargetWarn)||[],s._ptLookup=[],s._overwrite=b,w||x||q(g)||q(v)){if(r=s.vars,(o=s.timeline=new tV({data:"nested",defaults:S||{},targets:A&&"nested"===A.data?A.vars.targets:L})).kill(),o.parent=o._dp=n(s),o._start=0,x||q(g)||q(v)){if(u=L.length,p=x&&ts(x),V(x))for(c in x)~t5.indexOf(c)&&(f||(f={}),f[c]=x[c]);for(l=0;l<u;l++)(h=eU(r,t6)).stagger=0,E&&(h.yoyoEase=E),f&&eD(h,f),d=L[l],h.duration=+t4(g,n(s),l,d,L),h.delay=(+t4(v,n(s),l,d,L)||0)-s._delay,!x&&1===u&&h.delay&&(s._delay=v=h.delay,s._start+=v,h.delay=0),o.to(d,h,p?p(l,d,L):0),o._ease=tL.none;o.duration()?g=v=0:s.timeline=0}else if(w){eN(eI(o.vars.defaults,{ease:"none"})),o._ease=tN(w.ease||r.ease||"none");var R,P,I,D=0;if(Y(w))w.forEach(function(e){return o.to(L,e,">")}),o.duration();else{for(c in h={},w)"ease"===c||"easeEach"===c||t3(c,w[c],h,w.easeEach);for(c in h)for(l=0,R=h[c].sort(function(e,t){return e.t-t.t}),D=0;l<R.length;l++)(I={ease:(P=R[l]).e,duration:(P.t-(l?R[l-1].t:0))/100*g})[c]=P.v,o.to(L,I,D),D+=I.duration;o.duration()<g&&o.to({},{duration:g-o.duration()})}}g||s.duration(g=o.duration())}else s.timeline=0;return!0!==b||_||(tY=n(s),M.killTweensOf(L),tY=0),eJ(A,n(s),i),r.reversed&&s.reverse(),r.paused&&s.paused(!0),(y||!g&&!w&&s._start===eT(A._time)&&W(y)&&function e(t){return!t||t._ts&&e(t.parent)}(n(s))&&"nested"!==A.data)&&(s._tTime=-.00000001,s.render(Math.max(0,-v)||0)),T&&eK(n(s),T),s}i(t,e);var r=t.prototype;return r.render=function(e,t,r){var n,i,a,s,o,l,h,u,c,d=this._time,p=this._tDur,f=this._dur,m=e<0,g=e>p-1e-8&&!m?p:e<1e-8?0:e;if(f){if(g!==this._tTime||!e||r||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==m){if(n=g,u=this.timeline,this._repeat){if(s=f+this._rDelay,this._repeat<-1&&m)return this.totalTime(100*s+e,t,r);if(n=eT(g%s),g===p?(a=this._repeat,n=f):((a=~~(g/s))&&a===eT(g/s)&&(n=f,a--),n>f&&(n=f)),(l=this._yoyo&&1&a)&&(c=this._yEase,n=f-n),o=ej(this._tTime,s),n===d&&!r&&this._initted&&a===o)return this._tTime=g,this;a!==o&&(u&&this._yEase&&tU(u,l),this.vars.repeatRefresh&&!l&&!this._lock&&this._time!==s&&this._initted&&(this._lock=r=1,this.render(eT(s*a),!0).invalidate()._lock=0))}if(!this._initted){if(eQ(this,m?e:n,r,t,g))return this._tTime=0,this;if(d!==this._time&&!(r&&this.vars.repeatRefresh&&a!==o))return this;if(f!==this._dur)return this.render(e,t,r)}if(this._tTime=g,this._time=n,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=h=(c||this._ease)(n/f),this._from&&(this.ratio=h=1-h),n&&!d&&!t&&!a&&(tf(this,"onStart"),this._tTime!==g))return this;for(i=this._pt;i;)i.r(h,i.d),i=i._next;u&&u.render(e<0?e:u._dur*u._ease(n/this._dur),t,r)||this._startAt&&(this._zTime=e),this._onUpdate&&!t&&(m&&eV(this,e,t,r),tf(this,"onUpdate")),this._repeat&&a!==o&&this.vars.onRepeat&&!t&&this.parent&&tf(this,"onRepeat"),(g===this._tDur||!g)&&this._tTime===g&&(m&&!this._onUpdate&&eV(this,e,!0,!0),(e||!f)&&(g===this._tDur&&this._ts>0||!g&&this._ts<0)&&ez(this,1),!t&&!(m&&!d)&&(g||d||l)&&(tf(this,g===p?"onComplete":"onReverseComplete",!0),this._prom&&!(g<p&&this.timeScale()>0)&&this._prom()))}}else e1(this,e,t,r);return this},r.targets=function(){return this._targets},r.invalidate=function(t){return t&&this.vars.runBackwards||(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(t),e.prototype.invalidate.call(this,t)},r.resetTo=function(e,t,r,n,i){P||tE.wake(),this._ts||this.play();var a=Math.min(this._dur,(this._dp._time-this._start)*this._ts);return(this._initted||t0(this,a),t1(this,e,t,r,n,this._ease(a/this._dur),a,i))?this.resetTo(e,t,r,n,1):(eY(this,0),this.parent||eF(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},r.kill=function(e,t){if(void 0===t&&(t="all"),!e&&(!t||"all"===t))return this._lazy=this._pt=0,this.parent?tm(this):this;if(this.timeline){var r=this.timeline.totalDuration();return this.timeline.killTweensOf(e,t,tY&&!0!==tY.vars.overwrite)._first||tm(this),this.parent&&r!==this.timeline.totalDuration()&&e3(this,this._dur*this.timeline._tDur/r,0,1),this}var n,i,a,s,o,l,h,u=this._targets,c=e?tn(e):u,d=this._ptLookup,p=this._pt;if((!t||"all"===t)&&ek(u,c))return"all"===t&&(this._pt=0),tm(this);for(n=this._op=this._op||[],"all"!==t&&(B(t)&&(o={},eM(t,function(e){return o[e]=1}),t=o),t=t2(u,t)),h=u.length;h--;)if(~c.indexOf(u[h]))for(o in i=d[h],"all"===t?(n[h]=t,s=i,a={}):(a=n[h]=n[h]||{},s=t),s)(l=i&&i[o])&&("kill"in l.d&&!0!==l.d.kill(o)||eB(this,l,"_pt"),delete i[o]),"all"!==a&&(a[o]=1);return this._initted&&!this._pt&&p&&tm(this),this},t.to=function(e,r){return new t(e,r,arguments[2])},t.from=function(e,t){return e8(1,arguments)},t.delayedCall=function(e,r,n,i){return new t(r,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:e,onComplete:r,onReverseComplete:r,onCompleteParams:n,onReverseCompleteParams:n,callbackScope:i})},t.fromTo=function(e,t,r){return e8(2,arguments)},t.set=function(e,r){return r.duration=0,r.repeatDelay||(r.repeat=0),new t(e,r)},t.killTweensOf=function(e,t,r){return M.killTweensOf(e,t,r)},t}(tG);eI(t8.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),eM("staggerTo,staggerFrom,staggerFromTo",function(e){t8[e]=function(){var t=new tV,r=tt.call(arguments,0);return r.splice("staggerFromTo"===e?5:4,0,0),t[e].apply(t,r)}});var t7=function(e,t,r){return e[t]=r},t9=function(e,t,r){return e[t](r)},re=function(e,t,r,n){return e[t](n.fp,r)},rt=function(e,t,r){return e.setAttribute(t,r)},rr=function(e,t){return z(e[t])?t9:G(e[t])&&e.setAttribute?rt:t7},rn=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e6)/1e6,t)},ri=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},ra=function(e,t){var r=t._pt,n="";if(!e&&t.b)n=t.b;else if(1===e&&t.e)n=t.e;else{for(;r;)n=r.p+(r.m?r.m(r.s+r.c*e):Math.round((r.s+r.c*e)*1e4)/1e4)+n,r=r._next;n+=t.c}t.set(t.t,t.p,n,t)},rs=function(e,t){for(var r=t._pt;r;)r.r(e,r.d),r=r._next},ro=function(e,t,r,n){for(var i,a=this._pt;a;)i=a._next,a.p===n&&a.modifier(e,t,r),a=i},rl=function(e){for(var t,r,n=this._pt;n;)r=n._next,(n.p!==e||n.op)&&n.op!==e?n.dep||(t=1):eB(this,n,"_pt"),n=r;return!t},rh=function(e,t,r,n){n.mSet(e,t,n.m.call(n.tween,r,n.mt),n)},ru=function(e){for(var t,r,n,i,a=e._pt;a;){for(t=a._next,r=n;r&&r.pr>a.pr;)r=r._next;(a._prev=r?r._prev:i)?a._prev._next=a:n=a,(a._next=r)?r._prev=a:i=a,a=t}e._pt=n},rc=/*#__PURE__*/function(){function e(e,t,r,n,i,a,s,o,l){this.t=t,this.s=n,this.c=i,this.p=r,this.r=a||rn,this.d=s||this,this.set=o||t7,this.pr=l||0,this._next=e,e&&(e._prev=this)}return e.prototype.modifier=function(e,t,r){this.mSet=this.mSet||this.set,this.set=rh,this.m=e,this.mt=r,this.tween=t},e}();eM(ex+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(e){return ed[e]=1}),er.TweenMax=er.TweenLite=t8,er.TimelineLite=er.TimelineMax=tV,M=new tV({sortChildren:!1,defaults:I,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),C.stringFilter=tT;var rd=[],rp={},rf=[],rm=0,rg=0,rv=function(e){return(rp[e]||rf).map(function(e){return e()})},ry=function(){var e=Date.now(),t=[];e-rm>2&&(rv("matchMediaInit"),rd.forEach(function(e){var r,n,i,a,s=e.queries,o=e.conditions;for(n in s)(r=S.matchMedia(s[n]).matches)&&(i=1),r!==o[n]&&(o[n]=r,a=1);a&&(e.revert(),i&&t.push(e))}),rv("matchMediaRevert"),t.forEach(function(e){return e.onMatch(e,function(t){return e.add(null,t)})}),rm=e,rv("matchMedia"))},rx=/*#__PURE__*/function(){function e(e,t){this.selector=t&&ti(t),this.data=[],this._r=[],this.isReverted=!1,this.id=rg++,e&&this.add(e)}var t=e.prototype;return t.add=function(e,t,r){z(e)&&(r=t,t=e,e=z);var n=this,i=function(){var e,i=w,a=n.selector;return i&&i!==n&&i.data.push(n),r&&(n.selector=ti(r)),w=n,e=t.apply(n,arguments),z(e)&&n._r.push(e),w=i,n.selector=a,n.isReverted=!1,e};return n.last=i,e===z?i(n,function(e){return n.add(null,e)}):e?n[e]=i:i},t.ignore=function(e){var t=w;w=null,e(this),w=t},t.getTweens=function(){var t=[];return this.data.forEach(function(r){return r instanceof e?t.push.apply(t,r.getTweens()):r instanceof t8&&!(r.parent&&"nested"===r.parent.data)&&t.push(r)}),t},t.clear=function(){this._r.length=this.data.length=0},t.kill=function(e,t){var r=this;if(e?function(){for(var t,n=r.getTweens(),i=r.data.length;i--;)"isFlip"===(t=r.data[i]).data&&(t.revert(),t.getChildren(!0,!0,!1).forEach(function(e){return n.splice(n.indexOf(e),1)}));for(n.map(function(e){return{g:e._dur||e._delay||e._sat&&!e._sat.vars.immediateRender?e.globalTime(0):-1/0,t:e}}).sort(function(e,t){return t.g-e.g||-1/0}).forEach(function(t){return t.t.revert(e)}),i=r.data.length;i--;)(t=r.data[i])instanceof tV?"nested"!==t.data&&(t.scrollTrigger&&t.scrollTrigger.revert(),t.kill()):t instanceof t8||!t.revert||t.revert(e);r._r.forEach(function(t){return t(e,r)}),r.isReverted=!0}():this.data.forEach(function(e){return e.kill&&e.kill()}),this.clear(),t)for(var n=rd.length;n--;)rd[n].id===this.id&&rd.splice(n,1)},t.revert=function(e){this.kill(e||{})},e}(),r_=/*#__PURE__*/function(){function e(e){this.contexts=[],this.scope=e,w&&w.data.push(this)}var t=e.prototype;return t.add=function(e,t,r){V(e)||(e={matches:e});var n,i,a,s=new rx(0,r||this.scope),o=s.conditions={};for(i in w&&!s.selector&&(s.selector=w.selector),this.contexts.push(s),t=s.add("onMatch",t),s.queries=e,e)"all"===i?a=1:(n=S.matchMedia(e[i]))&&(0>rd.indexOf(s)&&rd.push(s),(o[i]=n.matches)&&(a=1),n.addListener?n.addListener(ry):n.addEventListener("change",ry));return a&&t(s,function(e){return s.add(null,e)}),this},t.revert=function(e){this.kill(e||{})},t.kill=function(e){this.contexts.forEach(function(t){return t.kill(e,!0)})},e}(),rb={registerPlugin:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];t.forEach(function(e){return tv(e)})},timeline:function(e){return new tV(e)},getTweensOf:function(e,t){return M.getTweensOf(e,t)},getProperty:function(e,t,r,n){B(e)&&(e=tn(e)[0]);var i=eb(e||{}).get,a=r?eC:eP;return"native"===r&&(r=""),e?t?a((em[t]&&em[t].get||i)(e,t,r,n)):function(t,r,n){return a((em[t]&&em[t].get||i)(e,t,r,n))}:e},quickSetter:function(e,t,r){if((e=tn(e)).length>1){var n=e.map(function(e){return rT.quickSetter(e,t,r)}),i=n.length;return function(e){for(var t=i;t--;)n[t](e)}}e=e[0]||{};var a=em[t],s=eb(e),o=s.harness&&(s.harness.aliases||{})[t]||t,l=a?function(t){var n=new a;R._pt=0,n.init(e,r?t+r:t,R,0,[e]),n.render(1,n),R._pt&&rs(1,R)}:s.set(e,o);return a?l:function(t){return l(e,o,r?t+r:t,s,1)}},quickTo:function(e,t,r){var n,i=rT.to(e,eD(((n={})[t]="+=0.1",n.paused=!0,n),r||{})),a=function(e,r,n){return i.resetTo(t,e,r,n)};return a.tween=i,a},isTweening:function(e){return M.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=tN(e.ease,I.ease)),eO(I,e||{})},config:function(e){return eO(C,e||{})},registerEffect:function(e){var t=e.name,r=e.effect,n=e.plugins,i=e.defaults,a=e.extendTimeline;(n||"").split(",").forEach(function(e){return e&&!em[e]&&!er[e]&&es(t+" effect requires "+e+" plugin.")}),eg[t]=function(e,t,n){return r(tn(e),eI(t||{},i),n)},a&&(tV.prototype[t]=function(e,r,n){return this.add(eg[t](e,V(r)?r:(n=r)&&{},this),n)})},registerEase:function(e,t){tL[e]=tN(t)},parseEase:function(e,t){return arguments.length?tN(e,t):tL},getById:function(e){return M.getById(e)},exportRoot:function(e,t){void 0===e&&(e={});var r,n,i=new tV(e);for(i.smoothChildTiming=W(e.smoothChildTiming),M.remove(i),i._dp=0,i._time=i._tTime=M._time,r=M._first;r;)n=r._next,(t||!(!r._dur&&r instanceof t8&&r.vars.onComplete===r._targets[0]))&&eJ(i,r,r._start-r._delay),r=n;return eJ(M,i,0),i},context:function(e,t){return e?new rx(e,t):w},matchMedia:function(e){return new r_(e)},matchMediaRefresh:function(){return rd.forEach(function(e){var t,r,n=e.conditions;for(r in n)n[r]&&(n[r]=!1,t=1);t&&e.revert()})||ry()},addEventListener:function(e,t){var r=rp[e]||(rp[e]=[]);~r.indexOf(t)||r.push(t)},removeEventListener:function(e,t){var r=rp[e],n=r&&r.indexOf(t);n>=0&&r.splice(n,1)},utils:{wrap:function e(t,r,n){var i=r-t;return Y(t)?tu(t,e(0,t.length),r):e7(n,function(e){return(i+(e-t)%i)%i+t})},wrapYoyo:function e(t,r,n){var i=r-t,a=2*i;return Y(t)?tu(t,e(0,t.length-1),r):e7(n,function(e){return e=(a+(e-t)%a)%a||0,t+(e>i?a-e:e)})},distribute:ts,random:th,snap:tl,normalize:function(e,t,r){return td(e,t,0,1,r)},getUnit:te,clamp:function(e,t,r){return e7(r,function(r){return e9(e,t,r)})},splitColor:t_,toArray:tn,selector:ti,mapRange:td,pipe:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return t.reduce(function(e,t){return t(e)},e)}},unitize:function(e,t){return function(r){return e(parseFloat(r))+(t||te(r))}},interpolate:function e(t,r,n,i){var a=isNaN(t+r)?0:function(e){return(1-e)*t+e*r};if(!a){var s,o,l,h,u,c=B(t),d={};if(!0===n&&(i=1)&&(n=null),c)t={p:t},r={p:r};else if(Y(t)&&!Y(r)){for(o=1,l=[],u=(h=t.length)-2;o<h;o++)l.push(e(t[o-1],t[o]));h--,a=function(e){var t=Math.min(u,~~(e*=h));return l[t](e-t)},n=r}else i||(t=eD(Y(t)?[]:{},t));if(!l){for(s in r)tK.call(d,t,s,"get",r[s]);a=function(e){return rs(e,d)||(c?t.p:t)}}}return e7(n,a)},shuffle:ta},install:ei,effects:eg,ticker:tE,updateRoot:tV.updateRoot,plugins:em,globalTimeline:M,core:{PropTween:rc,globals:eo,Tween:t8,Timeline:tV,Animation:tG,getCache:eb,_removeLinkedListItem:eB,reverting:function(){return b},context:function(e){return e&&w&&(w.data.push(e),e._ctx=w),w},suppressOverwrites:function(e){return _=e}}};eM("to,from,fromTo,delayedCall,set,killTweensOf",function(e){return rb[e]=t8[e]}),tE.add(tV.updateRoot),R=rb.to({},{duration:0});var rw=function(e,t){for(var r=e._pt;r&&r.p!==t&&r.op!==t&&r.fp!==t;)r=r._next;return r},rM=function(e,t){var r,n,i,a=e._targets;for(r in t)for(n=a.length;n--;)(i=e._ptLookup[n][r])&&(i=i.d)&&(i._pt&&(i=rw(i,r)),i&&i.modifier&&i.modifier(t[r],e,a[n],r))},rS=function(e,t){return{name:e,rawVars:1,init:function(e,r,n){n._onInit=function(e){var n,i;if(B(r)&&(n={},eM(r,function(e){return n[e]=1}),r=n),t){for(i in n={},r)n[i]=t(r[i]);r=n}rM(e,r)}}}},rT=rb.registerPlugin({name:"attr",init:function(e,t,r,n,i){var a,s,o;for(a in this.tween=r,t)o=e.getAttribute(a)||"",(s=this.add(e,"setAttribute",(o||0)+"",t[a],n,i,0,0,a)).op=a,s.b=o,this._props.push(a)},render:function(e,t){for(var r=t._pt;r;)b?r.set(r.t,r.p,r.b,r):r.r(e,r.d),r=r._next}},{name:"endArray",init:function(e,t){for(var r=t.length;r--;)this.add(e,r,e[r]||0,t[r],0,0,0,0,0,1)}},rS("roundProps",to),rS("modifiers"),rS("snap",tl))||rb;t8.version=tV.version=rT.version="3.12.5",A=1,j()&&tA(),tL.Power0;var rE=tL.Power1;tL.Power2,tL.Power3,tL.Power4,tL.Linear,tL.Quad,tL.Cubic,tL.Quart,tL.Quint,tL.Strong,tL.Elastic,tL.Back,tL.SteppedEase,tL.Bounce,tL.Sine,tL.Expo,tL.Circ});var d=(u("ilwiq"),u("ilwiq")),p=function(e,t){void 0===t&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),t===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=e,this.domElement=t,this.enabled=!0,this.target=new d.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:d.MOUSE.ROTATE,MIDDLE:d.MOUSE.DOLLY,RIGHT:d.MOUSE.PAN},this.touches={ONE:d.TOUCH.ROTATE,TWO:d.TOUCH.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return x.phi},this.getAzimuthalAngle=function(){return x.theta},this.listenToKeyEvents=function(e){e.addEventListener("keydown",Q),this._domElementKeyEvents=e},this.saveState=function(){c.target0.copy(c.target),c.position0.copy(c.object.position),c.zoom0=c.object.zoom},this.reset=function(){c.target.copy(c.target0),c.object.position.copy(c.position0),c.object.zoom=c.zoom0,c.object.updateProjectionMatrix(),c.dispatchEvent(p),c.update(),v=g.NONE},this.update=(r=new d.Vector3,i=(n=new(0,d.Quaternion)().setFromUnitVectors(e.up,new d.Vector3(0,1,0))).clone().invert(),a=new d.Vector3,s=new d.Quaternion,o=2*Math.PI,function(){var e=c.object.position;r.copy(e).sub(c.target),r.applyQuaternion(n),x.setFromVector3(r),c.autoRotate&&v===g.NONE&&O(2*Math.PI/60/60*c.autoRotateSpeed),c.enableDamping?(x.theta+=_.theta*c.dampingFactor,x.phi+=_.phi*c.dampingFactor):(x.theta+=_.theta,x.phi+=_.phi);var t=c.minAzimuthAngle,l=c.maxAzimuthAngle;return isFinite(t)&&isFinite(l)&&(t<-Math.PI?t+=o:t>Math.PI&&(t-=o),l<-Math.PI?l+=o:l>Math.PI&&(l-=o),t<=l?x.theta=Math.max(t,Math.min(l,x.theta)):x.theta=x.theta>(t+l)/2?Math.max(t,x.theta):Math.min(l,x.theta)),x.phi=Math.max(c.minPolarAngle,Math.min(c.maxPolarAngle,x.phi)),x.makeSafe(),x.radius*=b,x.radius=Math.max(c.minDistance,Math.min(c.maxDistance,x.radius)),!0===c.enableDamping?c.target.addScaledVector(w,c.dampingFactor):c.target.add(w),r.setFromSpherical(x),r.applyQuaternion(i),e.copy(c.target).add(r),c.object.lookAt(c.target),!0===c.enableDamping?(_.theta*=1-c.dampingFactor,_.phi*=1-c.dampingFactor,w.multiplyScalar(1-c.dampingFactor)):(_.set(0,0,0),w.set(0,0,0)),b=1,!!(M||a.distanceToSquared(c.object.position)>y||8*(1-s.dot(c.object.quaternion))>y)&&(c.dispatchEvent(p),a.copy(c.object.position),s.copy(c.object.quaternion),M=!1,!0)}),this.dispose=function(){c.domElement.removeEventListener("contextmenu",er),c.domElement.removeEventListener("pointerdown",Y),c.domElement.removeEventListener("wheel",K),c.domElement.removeEventListener("touchstart",$),c.domElement.removeEventListener("touchend",et),c.domElement.removeEventListener("touchmove",ee),c.domElement.ownerDocument.removeEventListener("pointermove",Z),c.domElement.ownerDocument.removeEventListener("pointerup",J),null!==c._domElementKeyEvents&&c._domElementKeyEvents.removeEventListener("keydown",Q)};var r,n,i,a,s,o,l,h,u,c=this,p={type:"change"},f={type:"start"},m={type:"end"},g={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},v=g.NONE,y=1e-6,x=new d.Spherical,_=new d.Spherical,b=1,w=new d.Vector3,M=!1,S=new d.Vector2,T=new d.Vector2,E=new d.Vector2,A=new d.Vector2,L=new d.Vector2,R=new d.Vector2,P=new d.Vector2,C=new d.Vector2,I=new d.Vector2;function D(){return Math.pow(.95,c.zoomSpeed)}function O(e){_.theta-=e}var U=(l=new d.Vector3,function(e,t){l.setFromMatrixColumn(t,0),l.multiplyScalar(-e),w.add(l)}),N=(h=new d.Vector3,function(e,t){!0===c.screenSpacePanning?h.setFromMatrixColumn(t,1):(h.setFromMatrixColumn(t,0),h.crossVectors(c.object.up,h)),h.multiplyScalar(e),w.add(h)}),k=(u=new d.Vector3,function(e,t){var r=c.domElement;if(c.object.isPerspectiveCamera){var n=c.object.position;u.copy(n).sub(c.target);var i=u.length();U(2*e*(i*=Math.tan(c.object.fov/2*Math.PI/180))/r.clientHeight,c.object.matrix),N(2*t*i/r.clientHeight,c.object.matrix)}else c.object.isOrthographicCamera?(U(e*(c.object.right-c.object.left)/c.object.zoom/r.clientWidth,c.object.matrix),N(t*(c.object.top-c.object.bottom)/c.object.zoom/r.clientHeight,c.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),c.enablePan=!1)});function F(e){c.object.isPerspectiveCamera?b/=e:c.object.isOrthographicCamera?(c.object.zoom=Math.max(c.minZoom,Math.min(c.maxZoom,c.object.zoom*e)),c.object.updateProjectionMatrix(),M=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),c.enableZoom=!1)}function B(e){c.object.isPerspectiveCamera?b*=e:c.object.isOrthographicCamera?(c.object.zoom=Math.max(c.minZoom,Math.min(c.maxZoom,c.object.zoom/e)),c.object.updateProjectionMatrix(),M=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),c.enableZoom=!1)}function z(e){S.set(e.clientX,e.clientY)}function H(e){A.set(e.clientX,e.clientY)}function G(e){if(1==e.touches.length)S.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),r=.5*(e.touches[0].pageY+e.touches[1].pageY);S.set(t,r)}}function V(e){if(1==e.touches.length)A.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),r=.5*(e.touches[0].pageY+e.touches[1].pageY);A.set(t,r)}}function W(e){var t=e.touches[0].pageX-e.touches[1].pageX,r=e.touches[0].pageY-e.touches[1].pageY,n=Math.sqrt(t*t+r*r);P.set(0,n)}function j(e){if(1==e.touches.length)T.set(e.touches[0].pageX,e.touches[0].pageY);else{var t,r=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);T.set(r,n)}E.subVectors(T,S).multiplyScalar(c.rotateSpeed);var i=c.domElement;O(2*Math.PI*E.x/i.clientHeight),t=2*Math.PI*E.y/i.clientHeight,_.phi-=t,S.copy(T)}function q(e){if(1==e.touches.length)L.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),r=.5*(e.touches[0].pageY+e.touches[1].pageY);L.set(t,r)}R.subVectors(L,A).multiplyScalar(c.panSpeed),k(R.x,R.y),A.copy(L)}function X(e){var t=e.touches[0].pageX-e.touches[1].pageX,r=e.touches[0].pageY-e.touches[1].pageY,n=Math.sqrt(t*t+r*r);C.set(0,n),I.set(0,Math.pow(C.y/P.y,c.zoomSpeed)),F(I.y),P.copy(C)}function Y(e){if(!1!==c.enabled)switch(e.pointerType){case"mouse":case"pen":!function(e){var t;switch(e.preventDefault(),c.domElement.focus?c.domElement.focus():window.focus(),e.button){case 0:t=c.mouseButtons.LEFT;break;case 1:t=c.mouseButtons.MIDDLE;break;case 2:t=c.mouseButtons.RIGHT;break;default:t=-1}switch(t){case d.MOUSE.DOLLY:if(!1===c.enableZoom)return;P.set(e.clientX,e.clientY),v=g.DOLLY;break;case d.MOUSE.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===c.enablePan)return;H(e),v=g.PAN}else{if(!1===c.enableRotate)return;z(e),v=g.ROTATE}break;case d.MOUSE.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===c.enableRotate)return;z(e),v=g.ROTATE}else{if(!1===c.enablePan)return;H(e),v=g.PAN}break;default:v=g.NONE}v!==g.NONE&&(c.domElement.ownerDocument.addEventListener("pointermove",Z),c.domElement.ownerDocument.addEventListener("pointerup",J),c.dispatchEvent(f))}(e)}}function Z(e){if(!1!==c.enabled)switch(e.pointerType){case"mouse":case"pen":!function(e){var t,r;if(!1!==c.enabled)switch(e.preventDefault(),v){case g.ROTATE:if(!1===c.enableRotate)return;T.set(e.clientX,e.clientY),E.subVectors(T,S).multiplyScalar(c.rotateSpeed),t=c.domElement,O(2*Math.PI*E.x/t.clientHeight),r=2*Math.PI*E.y/t.clientHeight,_.phi-=r,S.copy(T),c.update();break;case g.DOLLY:if(!1===c.enableZoom)return;C.set(e.clientX,e.clientY),I.subVectors(C,P),I.y>0?F(D()):I.y<0&&B(D()),P.copy(C),c.update();break;case g.PAN:if(!1===c.enablePan)return;L.set(e.clientX,e.clientY),R.subVectors(L,A).multiplyScalar(c.panSpeed),k(R.x,R.y),A.copy(L),c.update()}}(e)}}function J(e){switch(e.pointerType){case"mouse":case"pen":c.domElement.ownerDocument.removeEventListener("pointermove",Z),c.domElement.ownerDocument.removeEventListener("pointerup",J),!1!==c.enabled&&(c.dispatchEvent(m),v=g.NONE)}}function K(e){!1!==c.enabled&&!1!==c.enableZoom&&(v===g.NONE||v===g.ROTATE)&&(e.preventDefault(),e.stopPropagation(),c.dispatchEvent(f),e.deltaY<0?B(D()):e.deltaY>0&&F(D()),c.update(),c.dispatchEvent(m))}function Q(e){!1!==c.enabled&&!1!==c.enablePan&&function(e){var t=!1;switch(e.keyCode){case c.keys.UP:k(0,c.keyPanSpeed),t=!0;break;case c.keys.BOTTOM:k(0,-c.keyPanSpeed),t=!0;break;case c.keys.LEFT:k(c.keyPanSpeed,0),t=!0;break;case c.keys.RIGHT:k(-c.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),c.update())}(e)}function $(e){if(!1!==c.enabled){switch(e.preventDefault(),e.touches.length){case 1:switch(c.touches.ONE){case d.TOUCH.ROTATE:if(!1===c.enableRotate)return;G(e),v=g.TOUCH_ROTATE;break;case d.TOUCH.PAN:if(!1===c.enablePan)return;V(e),v=g.TOUCH_PAN;break;default:v=g.NONE}break;case 2:switch(c.touches.TWO){case d.TOUCH.DOLLY_PAN:if(!1===c.enableZoom&&!1===c.enablePan)return;c.enableZoom&&W(e),c.enablePan&&V(e),v=g.TOUCH_DOLLY_PAN;break;case d.TOUCH.DOLLY_ROTATE:if(!1===c.enableZoom&&!1===c.enableRotate)return;c.enableZoom&&W(e),c.enableRotate&&G(e),v=g.TOUCH_DOLLY_ROTATE;break;default:v=g.NONE}break;default:v=g.NONE}v!==g.NONE&&c.dispatchEvent(f)}}function ee(e){if(!1!==c.enabled)switch(e.preventDefault(),e.stopPropagation(),v){case g.TOUCH_ROTATE:if(!1===c.enableRotate)return;j(e),c.update();break;case g.TOUCH_PAN:if(!1===c.enablePan)return;q(e),c.update();break;case g.TOUCH_DOLLY_PAN:if(!1===c.enableZoom&&!1===c.enablePan)return;c.enableZoom&&X(e),c.enablePan&&q(e),c.update();break;case g.TOUCH_DOLLY_ROTATE:if(!1===c.enableZoom&&!1===c.enableRotate)return;c.enableZoom&&X(e),c.enableRotate&&j(e),c.update();break;default:v=g.NONE}}function et(e){!1!==c.enabled&&(c.dispatchEvent(m),v=g.NONE)}function er(e){!1!==c.enabled&&e.preventDefault()}c.domElement.addEventListener("contextmenu",er),c.domElement.addEventListener("pointerdown",Y),c.domElement.addEventListener("wheel",K),c.domElement.addEventListener("touchstart",$),c.domElement.addEventListener("touchend",et),c.domElement.addEventListener("touchmove",ee),this.update()};p.prototype=Object.create(d.EventDispatcher.prototype),p.prototype.constructor=p;var f=function(e,t){p.call(this,e,t),this.screenSpacePanning=!1,this.mouseButtons.LEFT=d.MOUSE.PAN,this.mouseButtons.RIGHT=d.MOUSE.ROTATE,this.touches.ONE=d.TOUCH.PAN,this.touches.TWO=d.TOUCH.DOLLY_ROTATE};f.prototype=Object.create(d.EventDispatcher.prototype),f.prototype.constructor=f;var d=u("ilwiq"),m=function(){function e(e){(0,d.Loader).call(this,e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(e){return new a(e)}),this.register(function(e){return new o(e)}),this.register(function(e){return new l(e)}),this.register(function(e){return new s(e)}),this.register(function(e){return new n(e)}),this.register(function(e){return new h(e)})}function t(){var e={};return{get:function(t){return e[t]},add:function(t,r){e[t]=r},remove:function(t){delete e[t]},removeAll:function(){e={}}}}e.prototype=Object.assign(Object.create(d.Loader.prototype),{constructor:e,load:function(e,t,r,n){var i,a=this;i=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:(0,d.LoaderUtils).extractUrlBase(e),this.manager.itemStart(e);var s=function(t){n?n(t):console.error(t),a.manager.itemError(e),a.manager.itemEnd(e)},o=new d.FileLoader(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(r){try{a.parse(r,i,function(r){t(r),a.manager.itemEnd(e)},s)}catch(e){s(e)}},r,s)},setDRACOLoader:function(e){return this.dracoLoader=e,this},setDDSLoader:function(){throw Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')},setKTX2Loader:function(e){return this.ktx2Loader=e,this},setMeshoptDecoder:function(e){return this.meshoptDecoder=e,this},register:function(e){return -1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this},unregister:function(e){return -1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this},parse:function(e,t,n,a){var s,o={},l={};if("string"==typeof e)s=e;else if((0,d.LoaderUtils).decodeText(new Uint8Array(e,0,4))===u){try{o[r.KHR_BINARY_GLTF]=new p(e)}catch(e){a&&a(e);return}s=o[r.KHR_BINARY_GLTF].content}else s=(0,d.LoaderUtils).decodeText(new Uint8Array(e));var h=JSON.parse(s);if(void 0===h.asset||h.asset.version[0]<2){a&&a(Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}var c=new D(h,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});c.fileLoader.setRequestHeader(this.requestHeader);for(var g=0;g<this.pluginCallbacks.length;g++){var x=this.pluginCallbacks[g](c);l[x.name]=x,o[x.name]=!0}if(h.extensionsUsed)for(var g=0;g<h.extensionsUsed.length;++g){var _=h.extensionsUsed[g],b=h.extensionsRequired||[];switch(_){case r.KHR_MATERIALS_UNLIT:o[_]=new i;break;case r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:o[_]=new v;break;case r.KHR_DRACO_MESH_COMPRESSION:o[_]=new f(h,this.dracoLoader);break;case r.KHR_TEXTURE_TRANSFORM:o[_]=new m;break;case r.KHR_MESH_QUANTIZATION:o[_]=new y;break;default:b.indexOf(_)>=0&&void 0===l[_]&&console.warn('THREE.GLTFLoader: Unknown extension "'+_+'".')}}c.setExtensions(o),c.setPlugins(l),c.parse(n,a)}});var r={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"};function n(e){this.parser=e,this.name=r.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}function i(){this.name=r.KHR_MATERIALS_UNLIT}function a(e){this.parser=e,this.name=r.KHR_MATERIALS_CLEARCOAT}function s(e){this.parser=e,this.name=r.KHR_MATERIALS_TRANSMISSION}function o(e){this.parser=e,this.name=r.KHR_TEXTURE_BASISU}function l(e){this.parser=e,this.name=r.EXT_TEXTURE_WEBP,this.isSupported=null}function h(e){this.name=r.EXT_MESHOPT_COMPRESSION,this.parser=e}n.prototype._markDefs=function(){for(var e=this.parser,t=this.parser.json.nodes||[],r=0,n=t.length;r<n;r++){var i=t[r];i.extensions&&i.extensions[this.name]&&void 0!==i.extensions[this.name].light&&e._addNodeRef(this.cache,i.extensions[this.name].light)}},n.prototype._loadLight=function(e){var t,r=this.parser,n="light:"+e,i=r.cache.get(n);if(i)return i;var a=r.json,s=((a.extensions&&a.extensions[this.name]||{}).lights||[])[e],o=new d.Color(16777215);void 0!==s.color&&o.fromArray(s.color);var l=void 0!==s.range?s.range:0;switch(s.type){case"directional":(t=new d.DirectionalLight(o)).target.position.set(0,0,-1),t.add(t.target);break;case"point":(t=new d.PointLight(o)).distance=l;break;case"spot":(t=new d.SpotLight(o)).distance=l,s.spot=s.spot||{},s.spot.innerConeAngle=void 0!==s.spot.innerConeAngle?s.spot.innerConeAngle:0,s.spot.outerConeAngle=void 0!==s.spot.outerConeAngle?s.spot.outerConeAngle:Math.PI/4,t.angle=s.spot.outerConeAngle,t.penumbra=1-s.spot.innerConeAngle/s.spot.outerConeAngle,t.target.position.set(0,0,-1),t.add(t.target);break;default:throw Error("THREE.GLTFLoader: Unexpected light type: "+s.type)}return t.position.set(0,0,0),t.decay=2,void 0!==s.intensity&&(t.intensity=s.intensity),t.name=r.createUniqueName(s.name||"light_"+e),i=Promise.resolve(t),r.cache.add(n,i),i},n.prototype.createNodeAttachment=function(e){var t=this,r=this.parser,n=r.json.nodes[e],i=(n.extensions&&n.extensions[this.name]||{}).light;return void 0===i?null:this._loadLight(i).then(function(e){return r._getNodeRef(t.cache,i,e)})},i.prototype.getMaterialType=function(){return d.MeshBasicMaterial},i.prototype.extendParams=function(e,t,r){var n=[];e.color=new d.Color(1,1,1),e.opacity=1;var i=t.pbrMetallicRoughness;if(i){if(Array.isArray(i.baseColorFactor)){var a=i.baseColorFactor;e.color.fromArray(a),e.opacity=a[3]}void 0!==i.baseColorTexture&&n.push(r.assignTexture(e,"map",i.baseColorTexture))}return Promise.all(n)},a.prototype.getMaterialType=function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?d.MeshPhysicalMaterial:null},a.prototype.extendMaterialParams=function(e,t){var r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();var i=[],a=n.extensions[this.name];if(void 0!==a.clearcoatFactor&&(t.clearcoat=a.clearcoatFactor),void 0!==a.clearcoatTexture&&i.push(r.assignTexture(t,"clearcoatMap",a.clearcoatTexture)),void 0!==a.clearcoatRoughnessFactor&&(t.clearcoatRoughness=a.clearcoatRoughnessFactor),void 0!==a.clearcoatRoughnessTexture&&i.push(r.assignTexture(t,"clearcoatRoughnessMap",a.clearcoatRoughnessTexture)),void 0!==a.clearcoatNormalTexture&&(i.push(r.assignTexture(t,"clearcoatNormalMap",a.clearcoatNormalTexture)),void 0!==a.clearcoatNormalTexture.scale)){var s=a.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new d.Vector2(s,-s)}return Promise.all(i)},s.prototype.getMaterialType=function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?d.MeshPhysicalMaterial:null},s.prototype.extendMaterialParams=function(e,t){var r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();var i=[],a=n.extensions[this.name];return void 0!==a.transmissionFactor&&(t.transmission=a.transmissionFactor),void 0!==a.transmissionTexture&&i.push(r.assignTexture(t,"transmissionMap",a.transmissionTexture)),Promise.all(i)},o.prototype.loadTexture=function(e){var t=this.parser,r=t.json,n=r.textures[e];if(!n.extensions||!n.extensions[this.name])return null;var i=n.extensions[this.name],a=r.images[i.source],s=t.options.ktx2Loader;if(!s){if(!(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0))return null;throw Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures")}return t.loadTextureImage(e,a,s)},l.prototype.loadTexture=function(e){var t=this.name,r=this.parser,n=r.json,i=n.textures[e];if(!i.extensions||!i.extensions[t])return null;var a=i.extensions[t],s=n.images[a.source],o=r.textureLoader;if(s.uri){var l=r.options.manager.getHandler(s.uri);null!==l&&(o=l)}return this.detectSupport().then(function(i){if(i)return r.loadTextureImage(e,s,o);if(n.extensionsRequired&&n.extensionsRequired.indexOf(t)>=0)throw Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return r.loadTexture(e)})},l.prototype.detectSupport=function(){return this.isSupported||(this.isSupported=new Promise(function(e){var t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported},h.prototype.loadBufferView=function(e){var t=this.parser.json,r=t.bufferViews[e];if(!r.extensions||!r.extensions[this.name])return null;var n=r.extensions[this.name],i=this.parser.getDependency("buffer",n.buffer),a=this.parser.options.meshoptDecoder;if(!a||!a.supported){if(!(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0))return null;throw Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files")}return Promise.all([i,a.ready]).then(function(e){var t=n.byteOffset||0,r=n.byteLength||0,i=n.count,s=n.byteStride,o=new ArrayBuffer(i*s),l=new Uint8Array(e[0],t,r);return a.decodeGltfBuffer(new Uint8Array(o),i,s,l,n.mode,n.filter),o})};var u="glTF",c={JSON:1313821514,BIN:5130562};function p(e){this.name=r.KHR_BINARY_GLTF,this.content=null,this.body=null;var t=new DataView(e,0,12);if(this.header={magic:(0,d.LoaderUtils).decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==u)throw Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw Error("THREE.GLTFLoader: Legacy binary file detected.");for(var n=this.header.length-12,i=new DataView(e,12),a=0;a<n;){var s=i.getUint32(a,!0);a+=4;var o=i.getUint32(a,!0);if(a+=4,o===c.JSON){var l=new Uint8Array(e,12+a,s);this.content=(0,d.LoaderUtils).decodeText(l)}else if(o===c.BIN){var h=12+a;this.body=e.slice(h,h+s)}a+=s}if(null===this.content)throw Error("THREE.GLTFLoader: JSON content not found.")}function f(e,t){if(!t)throw Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=r.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}function m(){this.name=r.KHR_TEXTURE_TRANSFORM}function g(e){(0,d.MeshStandardMaterial).call(this),this.isGLTFSpecularGlossinessMaterial=!0;var t={specular:{value:new(0,d.Color)().setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=t,this.onBeforeCompile=function(e){for(var r in t)e.uniforms[r]=t[r];e.fragmentShader=e.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>","#ifdef USE_SPECULARMAP\n	uniform sampler2D specularMap;\n#endif").replace("#include <metalnessmap_pars_fragment>","#ifdef USE_GLOSSINESSMAP\n	uniform sampler2D glossinessMap;\n#endif").replace("#include <roughnessmap_fragment>","vec3 specularFactor = specular;\n#ifdef USE_SPECULARMAP\n	vec4 texelSpecular = texture2D( specularMap, vUv );\n	texelSpecular = sRGBToLinear( texelSpecular );\n	// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture\n	specularFactor *= texelSpecular.rgb;\n#endif").replace("#include <metalnessmap_fragment>","float glossinessFactor = glossiness;\n#ifdef USE_GLOSSINESSMAP\n	vec4 texelGlossiness = texture2D( glossinessMap, vUv );\n	// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture\n	glossinessFactor *= texelGlossiness.a;\n#endif").replace("#include <lights_physical_fragment>","PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.\nmaterial.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\nmaterial.specularColor = specularFactor;")},Object.defineProperties(this,{specular:{get:function(){return t.specular.value},set:function(e){t.specular.value=e}},specularMap:{get:function(){return t.specularMap.value},set:function(e){t.specularMap.value=e,e?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return t.glossiness.value},set:function(e){t.glossiness.value=e}},glossinessMap:{get:function(){return t.glossinessMap.value},set:function(e){t.glossinessMap.value=e,e?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(e)}function v(){return{name:r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return g},extendParams:function(e,t,r){var n=t.extensions[this.name];e.color=new d.Color(1,1,1),e.opacity=1;var i=[];if(Array.isArray(n.diffuseFactor)){var a=n.diffuseFactor;e.color.fromArray(a),e.opacity=a[3]}if(void 0!==n.diffuseTexture&&i.push(r.assignTexture(e,"map",n.diffuseTexture)),e.emissive=new d.Color(0,0,0),e.glossiness=void 0!==n.glossinessFactor?n.glossinessFactor:1,e.specular=new d.Color(1,1,1),Array.isArray(n.specularFactor)&&e.specular.fromArray(n.specularFactor),void 0!==n.specularGlossinessTexture){var s=n.specularGlossinessTexture;i.push(r.assignTexture(e,"glossinessMap",s)),i.push(r.assignTexture(e,"specularMap",s))}return Promise.all(i)},createMaterial:function(e){var t=new g(e);return t.fog=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,t.normalMapType=d.TangentSpaceNormalMap,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t}}}function y(){this.name=r.KHR_MESH_QUANTIZATION}function x(e,t,r,n){(0,d.Interpolant).call(this,e,t,r,n)}f.prototype.decodePrimitive=function(e,t){var r=this.json,n=this.dracoLoader,i=e.extensions[this.name].bufferView,a=e.extensions[this.name].attributes,s={},o={},l={};for(var h in a){var u=T[h]||h.toLowerCase();s[u]=a[h]}for(h in e.attributes){var u=T[h]||h.toLowerCase();if(void 0!==a[h]){var c=r.accessors[e.attributes[h]],d=b[c.componentType];l[u]=d,o[u]=!0===c.normalized}}return t.getDependency("bufferView",i).then(function(e){return new Promise(function(t){n.decodeDracoFile(e,function(e){for(var r in e.attributes){var n=e.attributes[r],i=o[r];void 0!==i&&(n.normalized=i)}t(e)},s,l)})})},m.prototype.extendTexture=function(e,t){return e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),e.needsUpdate=!0,e},g.prototype=Object.create(d.MeshStandardMaterial.prototype),g.prototype.constructor=g,g.prototype.copy=function(e){return(0,d.MeshStandardMaterial).prototype.copy.call(this,e),this.specularMap=e.specularMap,this.specular.copy(e.specular),this.glossinessMap=e.glossinessMap,this.glossiness=e.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this},x.prototype=Object.create(d.Interpolant.prototype),x.prototype.constructor=x,x.prototype.copySampleValue_=function(e){for(var t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,i=e*n*3+n,a=0;a!==n;a++)t[a]=r[i+a];return t},x.prototype.beforeStart_=x.prototype.copySampleValue_,x.prototype.afterEnd_=x.prototype.copySampleValue_,x.prototype.interpolate_=function(e,t,r,n){for(var i=this.resultBuffer,a=this.sampleValues,s=this.valueSize,o=2*s,l=3*s,h=n-t,u=(r-t)/h,c=u*u,d=c*u,p=e*l,f=p-l,m=-2*d+3*c,g=d-c,v=1-m,y=g-c+u,x=0;x!==s;x++){var _=a[f+x+s],b=a[f+x+o]*h,w=a[p+x+s],M=a[p+x]*h;i[x]=v*_+y*b+m*w+g*M}return i};var _={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},b={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},w={9728:d.NearestFilter,9729:d.LinearFilter,9984:d.NearestMipmapNearestFilter,9985:d.LinearMipmapNearestFilter,9986:d.NearestMipmapLinearFilter,9987:d.LinearMipmapLinearFilter},M={33071:d.ClampToEdgeWrapping,33648:d.MirroredRepeatWrapping,10497:d.RepeatWrapping},S={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},T={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},E={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},A={CUBICSPLINE:void 0,LINEAR:d.InterpolateLinear,STEP:d.InterpolateDiscrete},L={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function R(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e))?e:t+e}function P(e,t,r){for(var n in r.extensions)void 0===e[n]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[n]=r.extensions[n])}function C(e,t){void 0!==t.extras&&("object"==typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function I(e){for(var t="",r=Object.keys(e).sort(),n=0,i=r.length;n<i;n++)t+=r[n]+":"+e[r[n]]+";";return t}function D(e,r){this.json=e||{},this.extensions={},this.plugins={},this.options=r||{},this.cache=new t,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.nodeNamesUsed={},"undefined"!=typeof createImageBitmap&&!1===/Firefox/.test(navigator.userAgent)?this.textureLoader=new d.ImageBitmapLoader(this.options.manager):this.textureLoader=new d.TextureLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new d.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}function O(e,t,r){var n=t.attributes,i=[];for(var a in n){var s=T[a]||a.toLowerCase();s in e.attributes||i.push(function(t,n){return r.getDependency("accessor",t).then(function(t){e.setAttribute(n,t)})}(n[a],s))}if(void 0!==t.indices&&!e.index){var o=r.getDependency("accessor",t.indices).then(function(t){e.setIndex(t)});i.push(o)}return C(e,t),!function(e,t,r){var n=t.attributes,i=new d.Box3;if(void 0!==n.POSITION){var a=r.json.accessors[n.POSITION],s=a.min,o=a.max;if(void 0!==s&&void 0!==o)i.set(new d.Vector3(s[0],s[1],s[2]),new d.Vector3(o[0],o[1],o[2]));else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}var l=t.targets;if(void 0!==l){for(var h=new d.Vector3,u=new d.Vector3,c=0,p=l.length;c<p;c++){var f=l[c];if(void 0!==f.POSITION){var a=r.json.accessors[f.POSITION],s=a.min,o=a.max;void 0!==s&&void 0!==o?(u.setX(Math.max(Math.abs(s[0]),Math.abs(o[0]))),u.setY(Math.max(Math.abs(s[1]),Math.abs(o[1]))),u.setZ(Math.max(Math.abs(s[2]),Math.abs(o[2]))),h.max(u)):console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}i.expandByVector(h)}e.boundingBox=i;var m=new d.Sphere;i.getCenter(m.center),m.radius=i.min.distanceTo(i.max)/2,e.boundingSphere=m}}(e,t,r),Promise.all(i).then(function(){return void 0!==t.targets?function(e,t,r){for(var n=!1,i=!1,a=0,s=t.length;a<s;a++){var o=t[a];if(void 0!==o.POSITION&&(n=!0),void 0!==o.NORMAL&&(i=!0),n&&i)break}if(!n&&!i)return Promise.resolve(e);for(var l=[],h=[],a=0,s=t.length;a<s;a++){var o=t[a];if(n){var u=void 0!==o.POSITION?r.getDependency("accessor",o.POSITION):e.attributes.position;l.push(u)}if(i){var u=void 0!==o.NORMAL?r.getDependency("accessor",o.NORMAL):e.attributes.normal;h.push(u)}}return Promise.all([Promise.all(l),Promise.all(h)]).then(function(t){var r=t[0],a=t[1];return n&&(e.morphAttributes.position=r),i&&(e.morphAttributes.normal=a),e.morphTargetsRelative=!0,e})}(e,t.targets,r):e})}function U(e,t){var r=e.getIndex();if(null===r){var n=[],i=e.getAttribute("position");if(void 0===i)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(var a=0;a<i.count;a++)n.push(a);e.setIndex(n),r=e.getIndex()}var s=r.count-2,o=[];if(t===d.TriangleFanDrawMode)for(var a=1;a<=s;a++)o.push(r.getX(0)),o.push(r.getX(a)),o.push(r.getX(a+1));else for(var a=0;a<s;a++)a%2==0?(o.push(r.getX(a)),o.push(r.getX(a+1)),o.push(r.getX(a+2))):(o.push(r.getX(a+2)),o.push(r.getX(a+1)),o.push(r.getX(a)));o.length/3!==s&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var l=e.clone();return l.setIndex(o),l}return D.prototype.setExtensions=function(e){this.extensions=e},D.prototype.setPlugins=function(e){this.plugins=e},D.prototype.parse=function(e,t){var r=this,n=this.json,i=this.extensions;this.cache.removeAll(),this._invokeAll(function(e){return e._markDefs&&e._markDefs()}),Promise.all(this._invokeAll(function(e){return e.beforeRoot&&e.beforeRoot()})).then(function(){return Promise.all([r.getDependencies("scene"),r.getDependencies("animation"),r.getDependencies("camera")])}).then(function(t){var a={scene:t[0][n.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:n.asset,parser:r,userData:{}};P(i,a,n),C(a,n),Promise.all(r._invokeAll(function(e){return e.afterRoot&&e.afterRoot(a)})).then(function(){e(a)})}).catch(t)},D.prototype._markDefs=function(){for(var e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[],n=0,i=t.length;n<i;n++)for(var a=t[n].joints,s=0,o=a.length;s<o;s++)e[a[s]].isBone=!0;for(var l=0,h=e.length;l<h;l++){var u=e[l];void 0!==u.mesh&&(this._addNodeRef(this.meshCache,u.mesh),void 0!==u.skin&&(r[u.mesh].isSkinnedMesh=!0)),void 0!==u.camera&&this._addNodeRef(this.cameraCache,u.camera)}},D.prototype._addNodeRef=function(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)},D.prototype._getNodeRef=function(e,t,r){if(e.refs[t]<=1)return r;var n=r.clone();return n.name+="_instance_"+e.uses[t]++,n},D.prototype._invokeOne=function(e){var t=Object.values(this.plugins);t.push(this);for(var r=0;r<t.length;r++){var n=e(t[r]);if(n)return n}},D.prototype._invokeAll=function(e){var t=Object.values(this.plugins);t.unshift(this);for(var r=[],n=0;n<t.length;n++){var i=e(t[n]);i&&r.push(i)}return r},D.prototype.getDependency=function(e,t){var r=e+":"+t,n=this.cache.get(r);if(!n){switch(e){case"scene":n=this.loadScene(t);break;case"node":n=this.loadNode(t);break;case"mesh":n=this._invokeOne(function(e){return e.loadMesh&&e.loadMesh(t)});break;case"accessor":n=this.loadAccessor(t);break;case"bufferView":n=this._invokeOne(function(e){return e.loadBufferView&&e.loadBufferView(t)});break;case"buffer":n=this.loadBuffer(t);break;case"material":n=this._invokeOne(function(e){return e.loadMaterial&&e.loadMaterial(t)});break;case"texture":n=this._invokeOne(function(e){return e.loadTexture&&e.loadTexture(t)});break;case"skin":n=this.loadSkin(t);break;case"animation":n=this.loadAnimation(t);break;case"camera":n=this.loadCamera(t);break;default:throw Error("Unknown type: "+e)}this.cache.add(r,n)}return n},D.prototype.getDependencies=function(e){var t=this.cache.get(e);if(!t){var r=this;t=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map(function(t,n){return r.getDependency(e,n)})),this.cache.add(e,t)}return t},D.prototype.loadBuffer=function(e){var t=this.json.buffers[e],n=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[r.KHR_BINARY_GLTF].body);var i=this.options;return new Promise(function(e,r){n.load(R(t.uri,i.path),e,void 0,function(){r(Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})},D.prototype.loadBufferView=function(e){var t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(e){var r=t.byteLength||0,n=t.byteOffset||0;return e.slice(n,n+r)})},D.prototype.loadAccessor=function(e){var t=this,r=this.json,n=this.json.accessors[e];if(void 0===n.bufferView&&void 0===n.sparse)return Promise.resolve(null);var i=[];return void 0!==n.bufferView?i.push(this.getDependency("bufferView",n.bufferView)):i.push(null),void 0!==n.sparse&&(i.push(this.getDependency("bufferView",n.sparse.indices.bufferView)),i.push(this.getDependency("bufferView",n.sparse.values.bufferView))),Promise.all(i).then(function(e){var i,a,s=e[0],o=S[n.type],l=b[n.componentType],h=l.BYTES_PER_ELEMENT,u=h*o,c=n.byteOffset||0,p=void 0!==n.bufferView?r.bufferViews[n.bufferView].byteStride:void 0,f=!0===n.normalized;if(p&&p!==u){var m=Math.floor(c/p),g="InterleavedBuffer:"+n.bufferView+":"+n.componentType+":"+m+":"+n.count,v=t.cache.get(g);v||(i=new l(s,m*p,n.count*p/h),v=new d.InterleavedBuffer(i,p/h),t.cache.add(g,v)),a=new d.InterleavedBufferAttribute(v,o,c%p/h,f)}else i=null===s?new l(n.count*o):new l(s,c,n.count*o),a=new d.BufferAttribute(i,o,f);if(void 0!==n.sparse){var y=S.SCALAR,x=b[n.sparse.indices.componentType],_=n.sparse.indices.byteOffset||0,w=n.sparse.values.byteOffset||0,M=new x(e[1],_,n.sparse.count*y),T=new l(e[2],w,n.sparse.count*o);null!==s&&(a=new d.BufferAttribute(a.array.slice(),a.itemSize,a.normalized));for(var E=0,A=M.length;E<A;E++){var L=M[E];if(a.setX(L,T[E*o]),o>=2&&a.setY(L,T[E*o+1]),o>=3&&a.setZ(L,T[E*o+2]),o>=4&&a.setW(L,T[E*o+3]),o>=5)throw Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return a})},D.prototype.loadTexture=function(e){var t=this.json,r=this.options,n=t.textures[e],i=t.images[n.source],a=this.textureLoader;if(i.uri){var s=r.manager.getHandler(i.uri);null!==s&&(a=s)}return this.loadTextureImage(e,i,a)},D.prototype.loadTextureImage=function(e,t,r){var n=this,i=this.json,a=this.options,s=i.textures[e],o=self.URL||self.webkitURL,l=t.uri,h=!1,u=!0;if("image/jpeg"===t.mimeType&&(u=!1),void 0!==t.bufferView)l=n.getDependency("bufferView",t.bufferView).then(function(e){if("image/png"===t.mimeType){var r=new DataView(e,25,1).getUint8(0,!1);u=6===r||4===r||3===r}h=!0;var n=new Blob([e],{type:t.mimeType});return l=o.createObjectURL(n)});else if(void 0===t.uri)throw Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");return Promise.resolve(l).then(function(e){return new Promise(function(t,n){var i=t;!0===r.isImageBitmapLoader&&(i=function(e){t(new d.CanvasTexture(e))}),r.load(R(e,a.path),i,void 0,n)})}).then(function(t){!0===h&&o.revokeObjectURL(l),t.flipY=!1,s.name&&(t.name=s.name),u||(t.format=d.RGBFormat);var r=(i.samplers||{})[s.sampler]||{};return t.magFilter=w[r.magFilter]||d.LinearFilter,t.minFilter=w[r.minFilter]||d.LinearMipmapLinearFilter,t.wrapS=M[r.wrapS]||d.RepeatWrapping,t.wrapT=M[r.wrapT]||d.RepeatWrapping,n.associations.set(t,{type:"textures",index:e}),t})},D.prototype.assignTexture=function(e,t,n){var i=this;return this.getDependency("texture",n.index).then(function(a){if(void 0===n.texCoord||0==n.texCoord||"aoMap"===t&&1==n.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+n.texCoord+" for texture "+t+" not yet supported."),i.extensions[r.KHR_TEXTURE_TRANSFORM]){var s=void 0!==n.extensions?n.extensions[r.KHR_TEXTURE_TRANSFORM]:void 0;if(s){var o=i.associations.get(a);a=i.extensions[r.KHR_TEXTURE_TRANSFORM].extendTexture(a,s),i.associations.set(a,o)}}e[t]=a})},D.prototype.assignFinalMaterial=function(e){var t=e.geometry,r=e.material,n=void 0!==t.attributes.tangent,i=void 0!==t.attributes.color,a=void 0===t.attributes.normal,s=!0===e.isSkinnedMesh,o=Object.keys(t.morphAttributes).length>0,l=o&&void 0!==t.morphAttributes.normal;if(e.isPoints){var h="PointsMaterial:"+r.uuid,u=this.cache.get(h);u||(u=new d.PointsMaterial,(0,d.Material).prototype.copy.call(u,r),u.color.copy(r.color),u.map=r.map,u.sizeAttenuation=!1,this.cache.add(h,u)),r=u}else if(e.isLine){var h="LineBasicMaterial:"+r.uuid,c=this.cache.get(h);c||(c=new d.LineBasicMaterial,(0,d.Material).prototype.copy.call(c,r),c.color.copy(r.color),this.cache.add(h,c)),r=c}if(n||i||a||s||o){var h="ClonedMaterial:"+r.uuid+":";r.isGLTFSpecularGlossinessMaterial&&(h+="specular-glossiness:"),s&&(h+="skinning:"),n&&(h+="vertex-tangents:"),i&&(h+="vertex-colors:"),a&&(h+="flat-shading:"),o&&(h+="morph-targets:"),l&&(h+="morph-normals:");var p=this.cache.get(h);p||(p=r.clone(),s&&(p.skinning=!0),i&&(p.vertexColors=!0),a&&(p.flatShading=!0),o&&(p.morphTargets=!0),l&&(p.morphNormals=!0),n&&(p.vertexTangents=!0,p.normalScale&&(p.normalScale.y*=-1),p.clearcoatNormalScale&&(p.clearcoatNormalScale.y*=-1)),this.cache.add(h,p),this.associations.set(p,this.associations.get(r))),r=p}r.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&t.setAttribute("uv2",t.attributes.uv),e.material=r},D.prototype.getMaterialType=function(){return d.MeshStandardMaterial},D.prototype.loadMaterial=function(e){var t,n=this,i=this.json,a=this.extensions,s=i.materials[e],o={},l=s.extensions||{},h=[];if(l[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var u=a[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];t=u.getMaterialType(),h.push(u.extendParams(o,s,n))}else if(l[r.KHR_MATERIALS_UNLIT]){var c=a[r.KHR_MATERIALS_UNLIT];t=c.getMaterialType(),h.push(c.extendParams(o,s,n))}else{var p=s.pbrMetallicRoughness||{};if(o.color=new d.Color(1,1,1),o.opacity=1,Array.isArray(p.baseColorFactor)){var f=p.baseColorFactor;o.color.fromArray(f),o.opacity=f[3]}void 0!==p.baseColorTexture&&h.push(n.assignTexture(o,"map",p.baseColorTexture)),o.metalness=void 0!==p.metallicFactor?p.metallicFactor:1,o.roughness=void 0!==p.roughnessFactor?p.roughnessFactor:1,void 0!==p.metallicRoughnessTexture&&(h.push(n.assignTexture(o,"metalnessMap",p.metallicRoughnessTexture)),h.push(n.assignTexture(o,"roughnessMap",p.metallicRoughnessTexture))),t=this._invokeOne(function(t){return t.getMaterialType&&t.getMaterialType(e)}),h.push(Promise.all(this._invokeAll(function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,o)})))}!0===s.doubleSided&&(o.side=d.DoubleSide);var m=s.alphaMode||L.OPAQUE;return m===L.BLEND?(o.transparent=!0,o.depthWrite=!1):(o.transparent=!1,m===L.MASK&&(o.alphaTest=void 0!==s.alphaCutoff?s.alphaCutoff:.5)),void 0!==s.normalTexture&&t!==d.MeshBasicMaterial&&(h.push(n.assignTexture(o,"normalMap",s.normalTexture)),o.normalScale=new d.Vector2(1,-1),void 0!==s.normalTexture.scale&&o.normalScale.set(s.normalTexture.scale,-s.normalTexture.scale)),void 0!==s.occlusionTexture&&t!==d.MeshBasicMaterial&&(h.push(n.assignTexture(o,"aoMap",s.occlusionTexture)),void 0!==s.occlusionTexture.strength&&(o.aoMapIntensity=s.occlusionTexture.strength)),void 0!==s.emissiveFactor&&t!==d.MeshBasicMaterial&&(o.emissive=new(0,d.Color)().fromArray(s.emissiveFactor)),void 0!==s.emissiveTexture&&t!==d.MeshBasicMaterial&&h.push(n.assignTexture(o,"emissiveMap",s.emissiveTexture)),Promise.all(h).then(function(){var i;return i=t===g?a[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(o):new t(o),s.name&&(i.name=s.name),i.map&&(i.map.encoding=d.sRGBEncoding),i.emissiveMap&&(i.emissiveMap.encoding=d.sRGBEncoding),C(i,s),n.associations.set(i,{type:"materials",index:e}),s.extensions&&P(a,i,s),i})},D.prototype.createUniqueName=function(e){for(var t=(0,d.PropertyBinding).sanitizeNodeName(e||""),r=t,n=1;this.nodeNamesUsed[r];++n)r=t+"_"+n;return this.nodeNamesUsed[r]=!0,r},D.prototype.loadGeometries=function(e){for(var t=this,n=this.extensions,i=this.primitiveCache,a=[],s=0,o=e.length;s<o;s++){var l,h=e[s],u=function(e){var t=e.extensions&&e.extensions[r.KHR_DRACO_MESH_COMPRESSION];return t?"draco:"+t.bufferView+":"+t.indices+":"+I(t.attributes):e.indices+":"+I(e.attributes)+":"+e.mode}(h),c=i[u];c?a.push(c.promise):(l=h.extensions&&h.extensions[r.KHR_DRACO_MESH_COMPRESSION]?function(e){return n[r.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then(function(r){return O(r,e,t)})}(h):O(new d.BufferGeometry,h,t),i[u]={primitive:h,promise:l},a.push(l))}return Promise.all(a)},D.prototype.loadMesh=function(e){for(var t=this,r=this.json,n=this.extensions,i=r.meshes[e],a=i.primitives,s=[],o=0,l=a.length;o<l;o++){var h,u=void 0===a[o].material?(void 0===(h=this.cache).DefaultMaterial&&(h.DefaultMaterial=new d.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:d.FrontSide})),h.DefaultMaterial):this.getDependency("material",a[o].material);s.push(u)}return s.push(t.loadGeometries(a)),Promise.all(s).then(function(r){for(var s=r.slice(0,r.length-1),o=r[r.length-1],l=[],h=0,u=o.length;h<u;h++){var c,p=o[h],f=a[h],m=s[h];if(f.mode===_.TRIANGLES||f.mode===_.TRIANGLE_STRIP||f.mode===_.TRIANGLE_FAN||void 0===f.mode)!0!==(c=!0===i.isSkinnedMesh?new d.SkinnedMesh(p,m):new d.Mesh(p,m)).isSkinnedMesh||c.geometry.attributes.skinWeight.normalized||c.normalizeSkinWeights(),f.mode===_.TRIANGLE_STRIP?c.geometry=U(c.geometry,d.TriangleStripDrawMode):f.mode===_.TRIANGLE_FAN&&(c.geometry=U(c.geometry,d.TriangleFanDrawMode));else if(f.mode===_.LINES)c=new d.LineSegments(p,m);else if(f.mode===_.LINE_STRIP)c=new d.Line(p,m);else if(f.mode===_.LINE_LOOP)c=new d.LineLoop(p,m);else if(f.mode===_.POINTS)c=new d.Points(p,m);else throw Error("THREE.GLTFLoader: Primitive mode unsupported: "+f.mode);Object.keys(c.geometry.morphAttributes).length>0&&function(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(var r=0,n=t.weights.length;r<n;r++)e.morphTargetInfluences[r]=t.weights[r];if(t.extras&&Array.isArray(t.extras.targetNames)){var i=t.extras.targetNames;if(e.morphTargetInfluences.length===i.length){e.morphTargetDictionary={};for(var r=0,n=i.length;r<n;r++)e.morphTargetDictionary[i[r]]=r}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}(c,i),c.name=t.createUniqueName(i.name||"mesh_"+e),C(c,i),f.extensions&&P(n,c,f),t.assignFinalMaterial(c),l.push(c)}if(1===l.length)return l[0];for(var g=new d.Group,h=0,u=l.length;h<u;h++)g.add(l[h]);return g})},D.prototype.loadCamera=function(e){var t,r=this.json.cameras[e],n=r[r.type];if(!n){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return"perspective"===r.type?t=new d.PerspectiveCamera((0,d.MathUtils).radToDeg(n.yfov),n.aspectRatio||1,n.znear||1,n.zfar||2e6):"orthographic"===r.type&&(t=new d.OrthographicCamera(-n.xmag,n.xmag,n.ymag,-n.ymag,n.znear,n.zfar)),r.name&&(t.name=this.createUniqueName(r.name)),C(t,r),Promise.resolve(t)},D.prototype.loadSkin=function(e){var t=this.json.skins[e],r={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(r):this.getDependency("accessor",t.inverseBindMatrices).then(function(e){return r.inverseBindMatrices=e,r})},D.prototype.loadAnimation=function(e){for(var t=this.json.animations[e],r=[],n=[],i=[],a=[],s=[],o=0,l=t.channels.length;o<l;o++){var h=t.channels[o],u=t.samplers[h.sampler],c=h.target,p=void 0!==c.node?c.node:c.id,f=void 0!==t.parameters?t.parameters[u.input]:u.input,m=void 0!==t.parameters?t.parameters[u.output]:u.output;r.push(this.getDependency("node",p)),n.push(this.getDependency("accessor",f)),i.push(this.getDependency("accessor",m)),a.push(u),s.push(c)}return Promise.all([Promise.all(r),Promise.all(n),Promise.all(i),Promise.all(a),Promise.all(s)]).then(function(r){for(var n=r[0],i=r[1],a=r[2],s=r[3],o=r[4],l=[],h=0,u=n.length;h<u;h++){var c=n[h],p=i[h],f=a[h],m=s[h],g=o[h];if(void 0!==c){switch(c.updateMatrix(),c.matrixAutoUpdate=!0,E[g.path]){case E.weights:w=d.NumberKeyframeTrack;break;case E.rotation:w=d.QuaternionKeyframeTrack;break;case E.position:case E.scale:default:w=d.VectorKeyframeTrack}var v=c.name?c.name:c.uuid,y=void 0!==m.interpolation?A[m.interpolation]:d.InterpolateLinear,_=[];E[g.path]===E.weights?c.traverse(function(e){!0===e.isMesh&&e.morphTargetInfluences&&_.push(e.name?e.name:e.uuid)}):_.push(v);var b=f.array;if(f.normalized){if(b.constructor===Int8Array)M=1/127;else if(b.constructor===Uint8Array)M=1/255;else if(b.constructor==Int16Array)M=1/32767;else if(b.constructor===Uint16Array)M=1/65535;else throw Error("THREE.GLTFLoader: Unsupported output accessor component type.");for(var w,M,S=new Float32Array(b.length),T=0,L=b.length;T<L;T++)S[T]=b[T]*M;b=S}for(var T=0,L=_.length;T<L;T++){var R=new w(_[T]+"."+E[g.path],p.array,b,y);"CUBICSPLINE"===m.interpolation&&(R.createInterpolant=function(e){return new x(this.times,this.values,this.getValueSize()/3,e)},R.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),l.push(R)}}}var P=t.name?t.name:"animation_"+e;return new d.AnimationClip(P,void 0,l)})},D.prototype.loadNode=function(e){var t,r=this.json,n=this.extensions,i=this,a=r.nodes[e],s=a.name?i.createUniqueName(a.name):"";return(t=[],void 0!==a.mesh&&t.push(i.getDependency("mesh",a.mesh).then(function(e){var t=i._getNodeRef(i.meshCache,a.mesh,e);return void 0!==a.weights&&t.traverse(function(e){if(e.isMesh)for(var t=0,r=a.weights.length;t<r;t++)e.morphTargetInfluences[t]=a.weights[t]}),t})),void 0!==a.camera&&t.push(i.getDependency("camera",a.camera).then(function(e){return i._getNodeRef(i.cameraCache,a.camera,e)})),i._invokeAll(function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)}).forEach(function(e){t.push(e)}),Promise.all(t)).then(function(t){var r;if((r=!0===a.isBone?new d.Bone:t.length>1?new d.Group:1===t.length?t[0]:new d.Object3D)!==t[0])for(var o=0,l=t.length;o<l;o++)r.add(t[o]);if(a.name&&(r.userData.name=a.name,r.name=s),C(r,a),a.extensions&&P(n,r,a),void 0!==a.matrix){var h=new d.Matrix4;h.fromArray(a.matrix),r.applyMatrix4(h)}else void 0!==a.translation&&r.position.fromArray(a.translation),void 0!==a.rotation&&r.quaternion.fromArray(a.rotation),void 0!==a.scale&&r.scale.fromArray(a.scale);return i.associations.set(r,{type:"nodes",index:e}),r})},D.prototype.loadScene=function(e){var t=this.json,r=this.extensions,n=this.json.scenes[e],i=new d.Group;n.name&&(i.name=this.createUniqueName(n.name)),C(i,n),n.extensions&&P(r,i,n);for(var a=n.nodes||[],s=[],o=0,l=a.length;o<l;o++)s.push(function e(t,r,n,i){var a=n.nodes[t];return i.getDependency("node",t).then(function(e){var t;return void 0===a.skin?e:i.getDependency("skin",a.skin).then(function(e){t=e;for(var r=[],n=0,a=t.joints.length;n<a;n++)r.push(i.getDependency("node",t.joints[n]));return Promise.all(r)}).then(function(r){return e.traverse(function(e){if(e.isMesh){for(var n=[],i=[],a=0,s=r.length;a<s;a++){var o=r[a];if(o){n.push(o);var l=new d.Matrix4;void 0!==t.inverseBindMatrices&&l.fromArray(t.inverseBindMatrices.array,16*a),i.push(l)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[a])}e.bind(new d.Skeleton(n,i),e.matrixWorld)}}),e})}).then(function(t){r.add(t);var s=[];if(a.children)for(var o=a.children,l=0,h=o.length;l<h;l++){var u=o[l];s.push(e(u,t,n,i))}return Promise.all(s)})}(a[o],i,t,this));return Promise.all(s).then(function(){return i})},e}(),d=u("ilwiq"),g={};function v(){throw Error("setTimeout has not been defined")}function y(){throw Error("clearTimeout has not been defined")}function x(e){if(eg===setTimeout)return setTimeout(e,0);if((eg===v||!eg)&&setTimeout)return eg=setTimeout,setTimeout(e,0);try{return eg(e,0)}catch(t){try{return eg.call(null,e,0)}catch(t){return eg.call(this,e,0)}}}!function(){try{eg="function"==typeof setTimeout?setTimeout:v}catch(e){eg=v}try{ev="function"==typeof clearTimeout?clearTimeout:y}catch(e){ev=y}}();var _=[],b=!1,w=-1;function M(){b&&ey&&(b=!1,ey.length?_=ey.concat(_):w=-1,_.length&&S())}function S(){if(!b){var e=x(M);b=!0;for(var t=_.length;t;){for(ey=_,_=[];++w<t;)ey&&ey[w].run();w=-1,t=_.length}ey=null,b=!1,function(e){if(ev===clearTimeout)return clearTimeout(e);if((ev===y||!ev)&&clearTimeout)return ev=clearTimeout,clearTimeout(e);try{ev(e)}catch(t){try{return ev.call(null,e)}catch(t){return ev.call(this,e)}}}(e)}}function T(e,t){this.fun=e,this.array=t}function E(){}function A(){var e,t=0,r=[],n=0,i=0,a=d(function(e){i||o(1,e)}),s=d(function(e){i||o(-1,e)});function o(r,n){i++;var a=0;try{n===m&&p();var s=r>0&&c(n);s?s.call(n,d(function(e){a++,o(1,e)}),d(function(e){a++,o(-1,e)})):(t=r,e=n,l())}catch(e){t||a||o(-1,e)}}function l(){n||(setTimeout(h,0),n=1)}function h(){var e=r;n=0,r=[],e.forEach(u)}function u(e){e()}function c(e){var t=e&&(f(e)||"object"==typeof e)&&e.then;return f(t)&&t}function d(e){var t=0;return function(){for(var r=[],n=arguments.length;n--;)r[n]=arguments[n];t++||e.apply(this,r)}}function p(){throw TypeError("Chaining cycle detected")}var f=function(e){return"function"==typeof e},m={then:function(n,i){var a=A();return r.push(function(){var r=t>0?n:i;if(f(r))try{var s=r(e);s===a&&p();var o=c(s);o?o.call(s,a.resolve,a.reject):a.resolve(s)}catch(e){a.reject(e)}else a[t>0?"resolve":"reject"](e)}),t&&l(),a},resolve:a,reject:s};return m}function L(){var e,t,r=new Promise(function(r,n){e=r,t=n});return{then:r.then.bind(r),resolve:e,reject:t}}g.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];_.push(new T(e,t)),1!==_.length||b||x(S)},T.prototype.run=function(){this.fun.apply(null,this.array)},g.title="browser",g.browser=!0,g.env={},g.argv=[],g.version="",g.versions={},g.on=E,g.addListener=E,g.once=E,g.off=E,g.removeListener=E,g.removeAllListeners=E,g.emit=E,g.prependListener=E,g.prependOnceListener=E,g.listeners=function(e){return[]},g.binding=function(e){throw Error("process.binding is not supported")},g.cwd=function(){return"/"},g.chdir=function(e){throw Error("process.chdir is not supported")},g.umask=function(){return 0},A.all=L.all=function(e){var t=0,r=[],n=R();return 0===e.length?n.resolve([]):e.forEach(function(i,a){var s=R();s.resolve(i),s.then(function(i){t++,r[a]=i,t===e.length&&n.resolve(r)},n.reject)}),n};var R="function"==typeof Promise?L:A;function P(){var e=Object.create(null);function t(e,t){var r=void 0;self.troikaDefine=function(e){return r=e};var n=URL.createObjectURL(new Blob(["/** "+e.replace(/\*/g,"")+" **/\n\ntroikaDefine(\n"+t+"\n)"],{type:"application/javascript"}));try{importScripts(n)}catch(e){console.error(e)}return URL.revokeObjectURL(n),delete self.troikaDefine,r}self.addEventListener("message",function(r){var n=r.data,i=n.messageId,a=n.action,s=n.data;try{"registerModule"===a&&function r(n,i){var a=n.id,s=n.name,o=n.dependencies;void 0===o&&(o=[]);var l=n.init;void 0===l&&(l=function(){});var h=n.getTransferables;if(void 0===h&&(h=null),!e[a])try{o=o.map(function(t){return t&&t.isWorkerModule&&(r(t,function(e){if(e instanceof Error)throw e}),t=e[t.id].value),t}),l=t("<"+s+">.init",l),h&&(h=t("<"+s+">.getTransferables",h));var u=null;"function"==typeof l?u=l.apply(void 0,o):console.error("worker module init function failed to rehydrate"),e[a]={id:a,value:u,getTransferables:h},i(u)}catch(e){e&&e.noLog||console.error(e),i(e)}}(s,function(e){e instanceof Error?postMessage({messageId:i,success:!1,error:e.message}):postMessage({messageId:i,success:!0,result:{isCallable:"function"==typeof e}})}),"callModule"===a&&function(t,r){var n,i=t.id,a=t.args;e[i]&&"function"==typeof e[i].value||r(Error("Worker module "+i+": not found or its 'init' did not return a function"));try{var s=(n=e[i]).value.apply(n,a);s&&"function"==typeof s.then?s.then(o,function(e){return r(e instanceof Error?e:Error(""+e))}):o(s)}catch(e){r(e)}function o(t){try{var n=e[i].getTransferables&&e[i].getTransferables(t);n&&Array.isArray(n)&&n.length||(n=void 0),r(t,n)}catch(e){console.error(e),r(e)}}}(s,function(e,t){e instanceof Error?postMessage({messageId:i,success:!1,error:e.message}):postMessage({messageId:i,success:!0,result:e},t||void 0)})}catch(e){postMessage({messageId:i,success:!1,error:e.stack})}})}var C=function(){var e=!1;if("undefined"!=typeof window&&void 0!==window.document)try{new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"}))).terminate(),e=!0}catch(e){console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+e.message+"]")}return C=function(){return e},e},I=0,D=0,O=!1,U=Object.create(null),N=Object.create(null),k=Object.create(null);function F(e){if((!e||"function"!=typeof e.init)&&!O)throw Error("requires `options.init` function");var t,r=e.dependencies,n=e.init,i=e.getTransferables,a=e.workerId;if(!C())return(t=function(){for(var e=[],r=arguments.length;r--;)e[r]=arguments[r];return t._getInitResult().then(function(t){if("function"==typeof t)return t.apply(void 0,e);throw Error("Worker module function was called but `init` did not return a callable function")})})._getInitResult=function(){var r=e.dependencies,n=e.init;r=Array.isArray(r)?r.map(function(e){return e&&e._getInitResult?e._getInitResult():e}):[];var i=R.all(r).then(function(e){return n.apply(null,e)});return t._getInitResult=function(){return i},i},t;null==a&&(a="#default");var s="workerModule"+ ++I,o=e.name||s,l=null;function h(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(!l){l=z(a,"registerModule",h.workerModuleData);var r=function(){l=null,N[a].delete(r)};(N[a]||(N[a]=new Set)).add(r)}return l.then(function(t){if(t.isCallable)return z(a,"callModule",{id:s,args:e});throw Error("Worker module function was called but `init` did not return a callable function")})}return r=r&&r.map(function(e){return"function"!=typeof e||e.workerModuleData||(O=!0,e=F({workerId:a,name:"<"+o+"> function dependency: "+e.name,init:"function(){return (\n"+B(e)+"\n)}"}),O=!1),e&&e.workerModuleData&&(e=e.workerModuleData),e}),h.workerModuleData={isWorkerModule:!0,id:s,name:o,dependencies:r,init:B(n),getTransferables:i&&B(i)},h}function B(e){var t=e.toString();return!/^function/.test(t)&&/^\w+\s*\(/.test(t)&&(t="function "+t),t}function z(e,t,r){var n=R(),i=++D;return k[i]=function(e){e.success?n.resolve(e.result):n.reject(Error("Error in worker "+t+" call: "+e.error))},(function(e){var t=U[e];if(!t){var r=B(P);(t=U[e]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+e.replace(/\*/g,"")+" **/\n\n;("+r+")()"],{type:"application/javascript"})))).onmessage=function(e){var t=e.data,r=t.messageId,n=k[r];if(!n)throw Error("WorkerModule response with empty or unknown messageId");delete k[r],n(t)}}return t})(e).postMessage({messageId:i,action:t,data:r}),n}var H=/*#__PURE__*/F({name:"Thenable",dependencies:[R],init:function(e){return e}}),d=u("ilwiq");const G=/\bvoid\s+main\s*\(\s*\)\s*{/g;function V(e){return e.replace(/^[ \t]*#include +<([\w\d./]+)>/gm,function(e,t){let r=d.ShaderChunk[t];return r?V(r):e})}const W=[];for(let e=0;e<256;e++)W[e]=(e<16?"0":"")+e.toString(16);const j=Object.assign||function(){let e=arguments[0];for(let t=1,r=arguments.length;t<r;t++){let r=arguments[t];if(r)for(let t in r)r.hasOwnProperty(t)&&(e[t]=r[t])}return e},q=Date.now(),X=new WeakMap,Y=new Map;let Z=1e10;function J(e,t,r,n,i){return(n||i||r)&&(e=e.replace(G,`
${r}
void troikaOrigMain${t}() {`)+`
void main() {
  ${n}
  troikaOrigMain${t}();
  ${i}
}`),e}function K(e,t){return"uniforms"===e?void 0:"function"==typeof t?t.toString():t}let Q=0;const $=new Map;function ee(e){function t(){return(self.performance||Date).now()}return function(r,n,i,a,s,o=1){let l,h,u,c,d;let p=t(),f=new Uint8Array(r*n),m=a[2]-a[0],g=a[3]-a[1],v=e(a),y=/([MLQCZ])([^MLQCZ]*)/g;for(;l=y.exec(i);){let e=l[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(e=>parseFloat(e));switch(l[1]){case"M":c=h=e[0],d=u=e[1];break;case"L":(e[0]!==c||e[1]!==d)&&v.addLineSegment(c,d,c=e[0],d=e[1]);break;case"Q":{let t={x:c,y:d};for(let r=1;r<16;r++){let n=function(e,t,r,n,i,a,s){let o=1-s;return{x:o*o*e+2*o*s*r+s*s*i,y:o*o*t+2*o*s*n+s*s*a}}(c,d,e[0],e[1],e[2],e[3],r/15);v.addLineSegment(t.x,t.y,n.x,n.y),t=n}c=e[2],d=e[3];break}case"C":{let t={x:c,y:d};for(let r=1;r<16;r++){let n=function(e,t,r,n,i,a,s,o,l){let h=1-l;return{x:h*h*h*e+3*h*h*l*r+3*h*l*l*i+l*l*l*s,y:h*h*h*t+3*h*h*l*n+3*h*l*l*a+l*l*l*o}}(c,d,e[0],e[1],e[2],e[3],e[4],e[5],r/15);v.addLineSegment(t.x,t.y,n.x,n.y),t=n}c=e[4],d=e[5];break}case"Z":(c!==h||d!==u)&&v.addLineSegment(c,d,h,u)}}for(let e=0;e<r;e++)for(let t=0;t<n;t++){let i=v.findNearestSignedDistance(a[0]+m*(e+.5)/r,a[1]+g*(t+.5)/n,s),l=Math.pow(1-Math.abs(i)/s,o)/2;i<0&&(l=1-l),l=Math.max(0,Math.min(255,Math.round(255*l))),f[t*r+e]=l}return{textureData:f,timing:t()-p}}}function et(e){let t=!1,r=[];function n(){t&&(r.sort(function(e,t){return e.maxX-t.maxX}),t=!1)}return{addLineSegment:function(e,n,i,a){r.push({x0:e,y0:n,x1:i,y1:a,minX:Math.min(e,i),minY:Math.min(n,a),maxX:Math.max(e,i),maxY:Math.max(n,a)}),t=!0},findNearestSignedDistance:function(e,t){n();let i=1/0,a=1/0;for(let n=r.length;n--;){let s=r[n];if(s.maxX+a<=e)break;if(e+a>s.minX&&t-a<s.maxY&&t+a>s.minY){let r=function(e,t,r,n,i,a){let s=i-r,o=a-n,l=s*s+o*o,h=l?Math.max(0,Math.min(1,((e-r)*s+(t-n)*o)/l)):0,u=e-(r+h*s),c=t-(n+h*o);return u*u+c*c}(e,t,s.x0,s.y0,s.x1,s.y1);r<i&&(a=Math.sqrt(i=r))}}return function(e,t){n();let i=!1;for(let n=r.length;n--;){let a=r[n];if(a.maxX<=e)break;a.minY<t&&a.maxY>t&&a.y0>t!=a.y1>t&&e<(a.x1-a.x0)*(t-a.y0)/(a.y1-a.y0)+a.x0&&(i=!i)}return i}(e,t)&&(a=-a),a}}}/*#__PURE__*/d.DoubleSide;const er=/*#__PURE__*/F({name:"Typr Font Parser",dependencies:[/*!
Custom build of Typr.ts (https://github.com/fredli74/Typr.ts) for use in Troika text rendering.
Original MIT license applies: https://github.com/fredli74/Typr.ts/blob/master/LICENSE
*/function(){var e,t,r;return"undefined"==typeof window&&(self.window=self),(e={},(t={parse:function(e){var r=t._bin,n=new Uint8Array(e);if("ttcf"==r.readASCII(n,0,4)){var i=4;r.readUshort(n,i),i+=2,r.readUshort(n,i),i+=2;var a=r.readUint(n,i);i+=4;for(var s=[],o=0;o<a;o++){var l=r.readUint(n,i);i+=4,s.push(t._readFont(n,l))}return s}return[t._readFont(n,0)]},_readFont:function(e,r){var n=t._bin,i=r;n.readFixed(e,r),r+=4;var a=n.readUshort(e,r);r+=2,n.readUshort(e,r),r+=2,n.readUshort(e,r),r+=2,n.readUshort(e,r),r+=2;for(var s=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GPOS","GSUB","SVG "],o={_data:e,_offset:i},l={},h=0;h<a;h++){var u=n.readASCII(e,r,4);r+=4,n.readUint(e,r),r+=4;var c=n.readUint(e,r);r+=4;var d=n.readUint(e,r);r+=4,l[u]={offset:c,length:d}}for(h=0;h<s.length;h++){var p=s[h];l[p]&&(o[p.trim()]=t[p.trim()].parse(e,l[p].offset,l[p].length,o))}return o},_tabOffset:function(e,r,n){for(var i=t._bin,a=i.readUshort(e,n+4),s=n+12,o=0;o<a;o++){var l=i.readASCII(e,s,4);s+=4,i.readUint(e,s),s+=4;var h=i.readUint(e,s);if(s+=4,i.readUint(e,s),s+=4,l==r)return h}return 0}})._bin={readFixed:function(e,t){return(e[t]<<8|e[t+1])+(e[t+2]<<8|e[t+3])/65540},readF2dot14:function(e,r){return t._bin.readShort(e,r)/16384},readInt:function(e,r){var n=t._bin.t.uint8;return n[0]=e[r+3],n[1]=e[r+2],n[2]=e[r+1],n[3]=e[r],t._bin.t.int32[0]},readInt8:function(e,r){return t._bin.t.uint8[0]=e[r],t._bin.t.int8[0]},readShort:function(e,r){var n=t._bin.t.uint8;return n[1]=e[r],n[0]=e[r+1],t._bin.t.int16[0]},readUshort:function(e,t){return e[t]<<8|e[t+1]},readUshorts:function(e,r,n){for(var i=[],a=0;a<n;a++)i.push(t._bin.readUshort(e,r+2*a));return i},readUint:function(e,r){var n=t._bin.t.uint8;return n[3]=e[r],n[2]=e[r+1],n[1]=e[r+2],n[0]=e[r+3],t._bin.t.uint32[0]},readUint64:function(e,r){return 4294967296*t._bin.readUint(e,r)+t._bin.readUint(e,r+4)},readASCII:function(e,t,r){for(var n="",i=0;i<r;i++)n+=String.fromCharCode(e[t+i]);return n},readUnicode:function(e,t,r){for(var n="",i=0;i<r;i++)n+=String.fromCharCode(e[t++]<<8|e[t++]);return n},_tdec:"undefined"!=typeof window&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(e,r,n){var i=t._bin._tdec;return i&&0==r&&n==e.length?i.decode(e):t._bin.readASCII(e,r,n)},readBytes:function(e,t,r){for(var n=[],i=0;i<r;i++)n.push(e[t+i]);return n},readASCIIArray:function(e,t,r){for(var n=[],i=0;i<r;i++)n.push(String.fromCharCode(e[t+i]));return n}},t._bin.t={buff:new ArrayBuffer(8)},t._bin.t.int8=new Int8Array(t._bin.t.buff),t._bin.t.uint8=new Uint8Array(t._bin.t.buff),t._bin.t.int16=new Int16Array(t._bin.t.buff),t._bin.t.uint16=new Uint16Array(t._bin.t.buff),t._bin.t.int32=new Int32Array(t._bin.t.buff),t._bin.t.uint32=new Uint32Array(t._bin.t.buff),t._lctf={},t._lctf.parse=function(e,r,n,i,a){var s=t._bin,o={},l=r;s.readFixed(e,r),r+=4;var h=s.readUshort(e,r);r+=2;var u=s.readUshort(e,r);r+=2;var c=s.readUshort(e,r);return r+=2,o.scriptList=t._lctf.readScriptList(e,l+h),o.featureList=t._lctf.readFeatureList(e,l+u),o.lookupList=t._lctf.readLookupList(e,l+c,a),o},t._lctf.readLookupList=function(e,r,n){var i=t._bin,a=r,s=[],o=i.readUshort(e,r);r+=2;for(var l=0;l<o;l++){var h=i.readUshort(e,r);r+=2;var u=t._lctf.readLookupTable(e,a+h,n);s.push(u)}return s},t._lctf.readLookupTable=function(e,r,n){var i=t._bin,a=r,s={tabs:[]};s.ltype=i.readUshort(e,r),r+=2,s.flag=i.readUshort(e,r),r+=2;var o=i.readUshort(e,r);r+=2;for(var l=s.ltype,h=0;h<o;h++){var u=i.readUshort(e,r);r+=2;var c=n(e,l,a+u,s);s.tabs.push(c)}return s},t._lctf.numOfOnes=function(e){for(var t=0,r=0;r<32;r++)0!=(e>>>r&1)&&t++;return t},t._lctf.readClassDef=function(e,r){var n=t._bin,i=[],a=n.readUshort(e,r);if(r+=2,1==a){var s=n.readUshort(e,r);r+=2;var o=n.readUshort(e,r);r+=2;for(var l=0;l<o;l++)i.push(s+l),i.push(s+l),i.push(n.readUshort(e,r)),r+=2}if(2==a){var h=n.readUshort(e,r);for(r+=2,l=0;l<h;l++)i.push(n.readUshort(e,r)),r+=2,i.push(n.readUshort(e,r)),r+=2,i.push(n.readUshort(e,r)),r+=2}return i},t._lctf.getInterval=function(e,t){for(var r=0;r<e.length;r+=3){var n=e[r],i=e[r+1];if(e[r+2],n<=t&&t<=i)return r}return -1},t._lctf.readCoverage=function(e,r){var n=t._bin,i={};i.fmt=n.readUshort(e,r),r+=2;var a=n.readUshort(e,r);return r+=2,1==i.fmt&&(i.tab=n.readUshorts(e,r,a)),2==i.fmt&&(i.tab=n.readUshorts(e,r,3*a)),i},t._lctf.coverageIndex=function(e,r){var n=e.tab;if(1==e.fmt)return n.indexOf(r);if(2==e.fmt){var i=t._lctf.getInterval(n,r);if(-1!=i)return n[i+2]+(r-n[i])}return -1},t._lctf.readFeatureList=function(e,r){var n=t._bin,i=r,a=[],s=n.readUshort(e,r);r+=2;for(var o=0;o<s;o++){var l=n.readASCII(e,r,4);r+=4;var h=n.readUshort(e,r);r+=2;var u=t._lctf.readFeatureTable(e,i+h);u.tag=l.trim(),a.push(u)}return a},t._lctf.readFeatureTable=function(e,r){var n=t._bin,i=r,a={},s=n.readUshort(e,r);r+=2,s>0&&(a.featureParams=i+s);var o=n.readUshort(e,r);r+=2,a.tab=[];for(var l=0;l<o;l++)a.tab.push(n.readUshort(e,r+2*l));return a},t._lctf.readScriptList=function(e,r){var n=t._bin,i=r,a={},s=n.readUshort(e,r);r+=2;for(var o=0;o<s;o++){var l=n.readASCII(e,r,4);r+=4;var h=n.readUshort(e,r);r+=2,a[l.trim()]=t._lctf.readScriptTable(e,i+h)}return a},t._lctf.readScriptTable=function(e,r){var n=t._bin,i=r,a={},s=n.readUshort(e,r);r+=2,a.default=t._lctf.readLangSysTable(e,i+s);var o=n.readUshort(e,r);r+=2;for(var l=0;l<o;l++){var h=n.readASCII(e,r,4);r+=4;var u=n.readUshort(e,r);r+=2,a[h.trim()]=t._lctf.readLangSysTable(e,i+u)}return a},t._lctf.readLangSysTable=function(e,r){var n=t._bin,i={};n.readUshort(e,r),r+=2,i.reqFeature=n.readUshort(e,r),r+=2;var a=n.readUshort(e,r);return r+=2,i.features=n.readUshorts(e,r,a),i},t.CFF={},t.CFF.parse=function(e,r,n){var i=t._bin;(e=new Uint8Array(e.buffer,r,n))[r=0],e[++r],e[++r],e[++r],r++;var a=[];r=t.CFF.readIndex(e,r,a);for(var s=[],o=0;o<a.length-1;o++)s.push(i.readASCII(e,r+a[o],a[o+1]-a[o]));r+=a[a.length-1];var l=[];r=t.CFF.readIndex(e,r,l);var h=[];for(o=0;o<l.length-1;o++)h.push(t.CFF.readDict(e,r+l[o],r+l[o+1]));r+=l[l.length-1];var u=h[0],c=[];r=t.CFF.readIndex(e,r,c);var d=[];for(o=0;o<c.length-1;o++)d.push(i.readASCII(e,r+c[o],c[o+1]-c[o]));if(r+=c[c.length-1],t.CFF.readSubrs(e,r,u),u.CharStrings){r=u.CharStrings,c=[],r=t.CFF.readIndex(e,r,c);var p=[];for(o=0;o<c.length-1;o++)p.push(i.readBytes(e,r+c[o],c[o+1]-c[o]));u.CharStrings=p}if(u.ROS){r=u.FDArray;var f=[];for(r=t.CFF.readIndex(e,r,f),u.FDArray=[],o=0;o<f.length-1;o++){var m=t.CFF.readDict(e,r+f[o],r+f[o+1]);t.CFF._readFDict(e,m,d),u.FDArray.push(m)}r+=f[f.length-1],r=u.FDSelect,u.FDSelect=[];var g=e[r];if(r++,3!=g)throw g;var v=i.readUshort(e,r);for(r+=2,o=0;o<v+1;o++)u.FDSelect.push(i.readUshort(e,r),e[r+2]),r+=3}return u.Encoding&&(u.Encoding=t.CFF.readEncoding(e,u.Encoding,u.CharStrings.length)),u.charset&&(u.charset=t.CFF.readCharset(e,u.charset,u.CharStrings.length)),t.CFF._readFDict(e,u,d),u},t.CFF._readFDict=function(e,r,n){var i;for(var a in r.Private&&(i=r.Private[1],r.Private=t.CFF.readDict(e,i,i+r.Private[0]),r.Private.Subrs&&t.CFF.readSubrs(e,i+r.Private.Subrs,r.Private)),r)-1!=["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(a)&&(r[a]=n[r[a]-426+35])},t.CFF.readSubrs=function(e,r,n){var i=t._bin,a=[];r=t.CFF.readIndex(e,r,a);var s,o=a.length;s=o<1240?107:o<33900?1131:32768,n.Bias=s,n.Subrs=[];for(var l=0;l<a.length-1;l++)n.Subrs.push(i.readBytes(e,r+a[l],a[l+1]-a[l]))},t.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],t.CFF.glyphByUnicode=function(e,t){for(var r=0;r<e.charset.length;r++)if(e.charset[r]==t)return r;return -1},t.CFF.glyphBySE=function(e,r){return r<0||r>255?-1:t.CFF.glyphByUnicode(e,t.CFF.tableSE[r])},t.CFF.readEncoding=function(e,r,n){t._bin;var i=[".notdef"],a=e[r];if(r++,0!=a)throw"error: unknown encoding format: "+a;var s=e[r];r++;for(var o=0;o<s;o++)i.push(e[r+o]);return i},t.CFF.readCharset=function(e,r,n){var i=t._bin,a=[".notdef"],s=e[r];if(r++,0==s)for(var o=0;o<n;o++){var l=i.readUshort(e,r);r+=2,a.push(l)}else{if(1!=s&&2!=s)throw"error: format: "+s;for(;a.length<n;){l=i.readUshort(e,r),r+=2;var h=0;for(1==s?(h=e[r],r++):(h=i.readUshort(e,r),r+=2),o=0;o<=h;o++)a.push(l),l++}}return a},t.CFF.readIndex=function(e,r,n){var i=t._bin,a=i.readUshort(e,r)+1,s=e[r+=2];if(r++,1==s)for(var o=0;o<a;o++)n.push(e[r+o]);else if(2==s)for(o=0;o<a;o++)n.push(i.readUshort(e,r+2*o));else if(3==s)for(o=0;o<a;o++)n.push(16777215&i.readUint(e,r+3*o-1));else if(1!=a)throw"unsupported offset size: "+s+", count: "+a;return(r+=a*s)-1},t.CFF.getCharString=function(e,r,n){var i=t._bin,a=e[r],s=e[r+1];e[r+2],e[r+3],e[r+4];var o=1,l=null,h=null;a<=20&&(l=a,o=1),12==a&&(l=100*a+s,o=2),21<=a&&a<=27&&(l=a,o=1),28==a&&(h=i.readShort(e,r+1),o=3),29<=a&&a<=31&&(l=a,o=1),32<=a&&a<=246&&(h=a-139,o=1),247<=a&&a<=250&&(h=256*(a-247)+s+108,o=2),251<=a&&a<=254&&(h=-(256*(a-251))-s-108,o=2),255==a&&(h=i.readInt(e,r+1)/65535,o=5),n.val=null!=h?h:"o"+l,n.size=o},t.CFF.readCharString=function(e,r,n){for(var i=r+n,a=t._bin,s=[];r<i;){var o=e[r],l=e[r+1];e[r+2],e[r+3],e[r+4];var h=1,u=null,c=null;o<=20&&(u=o,h=1),12==o&&(u=100*o+l,h=2),19!=o&&20!=o||(u=o,h=2),21<=o&&o<=27&&(u=o,h=1),28==o&&(c=a.readShort(e,r+1),h=3),29<=o&&o<=31&&(u=o,h=1),32<=o&&o<=246&&(c=o-139,h=1),247<=o&&o<=250&&(c=256*(o-247)+l+108,h=2),251<=o&&o<=254&&(c=-(256*(o-251))-l-108,h=2),255==o&&(c=a.readInt(e,r+1)/65535,h=5),s.push(null!=c?c:"o"+u),r+=h}return s},t.CFF.readDict=function(e,r,n){for(var i=t._bin,a={},s=[];r<n;){var o=e[r],l=e[r+1];e[r+2],e[r+3],e[r+4];var h=1,u=null,c=null;if(28==o&&(c=i.readShort(e,r+1),h=3),29==o&&(c=i.readInt(e,r+1),h=5),32<=o&&o<=246&&(c=o-139,h=1),247<=o&&o<=250&&(c=256*(o-247)+l+108,h=2),251<=o&&o<=254&&(c=-(256*(o-251))-l-108,h=2),255==o)throw c=i.readInt(e,r+1)/65535,h=5,"unknown number";if(30==o){var d=[];for(h=1;;){var p=e[r+h];h++;var f=p>>4,m=15&p;if(15!=f&&d.push(f),15!=m&&d.push(m),15==m)break}for(var g="",v=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],y=0;y<d.length;y++)g+=v[d[y]];c=parseFloat(g)}o<=21&&(u=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][o],h=1,12==o&&(u=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][l],h=2)),null!=u?(a[u]=1==s.length?s[0]:s,s=[]):s.push(c),r+=h}return a},t.cmap={},t.cmap.parse=function(e,r,n){e=new Uint8Array(e.buffer,r,n),r=0;var i=t._bin,a={};i.readUshort(e,r),r+=2;var s=i.readUshort(e,r);r+=2;var o=[];a.tables=[];for(var l=0;l<s;l++){var h=i.readUshort(e,r);r+=2;var u=i.readUshort(e,r);r+=2;var c=i.readUint(e,r);r+=4;var d="p"+h+"e"+u,p=o.indexOf(c);if(-1==p){p=a.tables.length,o.push(c);var f,m=i.readUshort(e,c);0==m?f=t.cmap.parse0(e,c):4==m?f=t.cmap.parse4(e,c):6==m?f=t.cmap.parse6(e,c):12==m?f=t.cmap.parse12(e,c):console.debug("unknown format: "+m,h,u,c),a.tables.push(f)}if(null!=a[d])throw"multiple tables for one platform+encoding";a[d]=p}return a},t.cmap.parse0=function(e,r){var n=t._bin,i={};i.format=n.readUshort(e,r),r+=2;var a=n.readUshort(e,r);r+=2,n.readUshort(e,r),r+=2,i.map=[];for(var s=0;s<a-6;s++)i.map.push(e[r+s]);return i},t.cmap.parse4=function(e,r){var n=t._bin,i=r,a={};a.format=n.readUshort(e,r),r+=2;var s=n.readUshort(e,r);r+=2,n.readUshort(e,r),r+=2;var o=n.readUshort(e,r);r+=2;var l=o/2;a.searchRange=n.readUshort(e,r),r+=2,a.entrySelector=n.readUshort(e,r),r+=2,a.rangeShift=n.readUshort(e,r),r+=2,a.endCount=n.readUshorts(e,r,l),r+=2*l+2,a.startCount=n.readUshorts(e,r,l),r+=2*l,a.idDelta=[];for(var h=0;h<l;h++)a.idDelta.push(n.readShort(e,r)),r+=2;for(a.idRangeOffset=n.readUshorts(e,r,l),r+=2*l,a.glyphIdArray=[];r<i+s;)a.glyphIdArray.push(n.readUshort(e,r)),r+=2;return a},t.cmap.parse6=function(e,r){var n=t._bin,i={};i.format=n.readUshort(e,r),r+=2,n.readUshort(e,r),r+=2,n.readUshort(e,r),r+=2,i.firstCode=n.readUshort(e,r),r+=2;var a=n.readUshort(e,r);r+=2,i.glyphIdArray=[];for(var s=0;s<a;s++)i.glyphIdArray.push(n.readUshort(e,r)),r+=2;return i},t.cmap.parse12=function(e,r){var n=t._bin,i={};i.format=n.readUshort(e,r),r+=4,n.readUint(e,r),r+=4,n.readUint(e,r),r+=4;var a=n.readUint(e,r);r+=4,i.groups=[];for(var s=0;s<a;s++){var o=r+12*s,l=n.readUint(e,o+0),h=n.readUint(e,o+4),u=n.readUint(e,o+8);i.groups.push([l,h,u])}return i},t.glyf={},t.glyf.parse=function(e,t,r,n){for(var i=[],a=0;a<n.maxp.numGlyphs;a++)i.push(null);return i},t.glyf._parseGlyf=function(e,r){var n,i=t._bin,a=e._data,s=t._tabOffset(a,"glyf",e._offset)+e.loca[r];if(e.loca[r]==e.loca[r+1])return null;var o={};if(o.noc=i.readShort(a,s),s+=2,o.xMin=i.readShort(a,s),s+=2,o.yMin=i.readShort(a,s),s+=2,o.xMax=i.readShort(a,s),s+=2,o.yMax=i.readShort(a,s),s+=2,o.xMin>=o.xMax||o.yMin>=o.yMax)return null;if(o.noc>0){o.endPts=[];for(var l=0;l<o.noc;l++)o.endPts.push(i.readUshort(a,s)),s+=2;var h=i.readUshort(a,s);if(s+=2,a.length-s<h)return null;o.instructions=i.readBytes(a,s,h),s+=h;var u=o.endPts[o.noc-1]+1;for(l=0,o.flags=[];l<u;l++){var c=a[s];if(s++,o.flags.push(c),0!=(8&c)){var d=a[s];s++;for(var p=0;p<d;p++)o.flags.push(c),l++}}for(l=0,o.xs=[];l<u;l++){var f=0!=(2&o.flags[l]),m=0!=(16&o.flags[l]);f?(o.xs.push(m?a[s]:-a[s]),s++):m?o.xs.push(0):(o.xs.push(i.readShort(a,s)),s+=2)}for(l=0,o.ys=[];l<u;l++)f=0!=(4&o.flags[l]),m=0!=(32&o.flags[l]),f?(o.ys.push(m?a[s]:-a[s]),s++):m?o.ys.push(0):(o.ys.push(i.readShort(a,s)),s+=2);var g=0,v=0;for(l=0;l<u;l++)g+=o.xs[l],v+=o.ys[l],o.xs[l]=g,o.ys[l]=v}else{o.parts=[];do{n=i.readUshort(a,s),s+=2;var y={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(o.parts.push(y),y.glyphIndex=i.readUshort(a,s),s+=2,1&n){var x=i.readShort(a,s);s+=2;var _=i.readShort(a,s);s+=2}else x=i.readInt8(a,s),s++,_=i.readInt8(a,s),s++;2&n?(y.m.tx=x,y.m.ty=_):(y.p1=x,y.p2=_),8&n?(y.m.a=y.m.d=i.readF2dot14(a,s),s+=2):64&n?(y.m.a=i.readF2dot14(a,s),s+=2,y.m.d=i.readF2dot14(a,s),s+=2):128&n&&(y.m.a=i.readF2dot14(a,s),s+=2,y.m.b=i.readF2dot14(a,s),s+=2,y.m.c=i.readF2dot14(a,s),s+=2,y.m.d=i.readF2dot14(a,s),s+=2)}while(32&n)if(256&n){var b=i.readUshort(a,s);for(s+=2,o.instr=[],l=0;l<b;l++)o.instr.push(a[s]),s++}}return o},t.GPOS={},t.GPOS.parse=function(e,r,n,i){return t._lctf.parse(e,r,n,i,t.GPOS.subt)},t.GPOS.subt=function(e,r,n,i){var a=t._bin,s=n,o={};if(o.fmt=a.readUshort(e,n),n+=2,1==r||2==r||3==r||7==r||8==r&&o.fmt<=2){var l=a.readUshort(e,n);n+=2,o.coverage=t._lctf.readCoverage(e,l+s)}if(1==r&&1==o.fmt){var h=a.readUshort(e,n);n+=2;var u=t._lctf.numOfOnes(h);0!=h&&(o.pos=t.GPOS.readValueRecord(e,n,h))}else if(2==r&&o.fmt>=1&&o.fmt<=2){h=a.readUshort(e,n),n+=2;var c=a.readUshort(e,n);n+=2,u=t._lctf.numOfOnes(h);var d=t._lctf.numOfOnes(c);if(1==o.fmt){o.pairsets=[];var p=a.readUshort(e,n);n+=2;for(var f=0;f<p;f++){var m=s+a.readUshort(e,n);n+=2;var g=a.readUshort(e,m);m+=2;for(var v=[],y=0;y<g;y++){var x=a.readUshort(e,m);m+=2,0!=h&&(T=t.GPOS.readValueRecord(e,m,h),m+=2*u),0!=c&&(E=t.GPOS.readValueRecord(e,m,c),m+=2*d),v.push({gid2:x,val1:T,val2:E})}o.pairsets.push(v)}}if(2==o.fmt){var _=a.readUshort(e,n);n+=2;var b=a.readUshort(e,n);n+=2;var w=a.readUshort(e,n);n+=2;var M=a.readUshort(e,n);for(n+=2,o.classDef1=t._lctf.readClassDef(e,s+_),o.classDef2=t._lctf.readClassDef(e,s+b),o.matrix=[],f=0;f<w;f++){var S=[];for(y=0;y<M;y++){var T=null,E=null;0!=h&&(T=t.GPOS.readValueRecord(e,n,h),n+=2*u),0!=c&&(E=t.GPOS.readValueRecord(e,n,c),n+=2*d),S.push({val1:T,val2:E})}o.matrix.push(S)}}}else{if(9==r&&1==o.fmt){var A=a.readUshort(e,n);n+=2;var L=a.readUint(e,n);if(n+=4,9==i.ltype)i.ltype=A;else if(i.ltype!=A)throw"invalid extension substitution";return t.GPOS.subt(e,i.ltype,s+L)}console.debug("unsupported GPOS table LookupType",r,"format",o.fmt)}return o},t.GPOS.readValueRecord=function(e,r,n){var i=t._bin,a=[];return a.push(1&n?i.readShort(e,r):0),r+=1&n?2:0,a.push(2&n?i.readShort(e,r):0),r+=2&n?2:0,a.push(4&n?i.readShort(e,r):0),r+=4&n?2:0,a.push(8&n?i.readShort(e,r):0),r+=8&n?2:0,a},t.GSUB={},t.GSUB.parse=function(e,r,n,i){return t._lctf.parse(e,r,n,i,t.GSUB.subt)},t.GSUB.subt=function(e,r,n,i){var a=t._bin,s=n,o={};if(o.fmt=a.readUshort(e,n),n+=2,1!=r&&4!=r&&5!=r&&6!=r)return null;if(1==r||4==r||5==r&&o.fmt<=2||6==r&&o.fmt<=2){var l=a.readUshort(e,n);n+=2,o.coverage=t._lctf.readCoverage(e,s+l)}if(1==r&&o.fmt>=1&&o.fmt<=2){if(1==o.fmt)o.delta=a.readShort(e,n),n+=2;else if(2==o.fmt){var h=a.readUshort(e,n);n+=2,o.newg=a.readUshorts(e,n,h),n+=2*o.newg.length}}else if(4==r){o.vals=[],h=a.readUshort(e,n),n+=2;for(var u=0;u<h;u++){var c=a.readUshort(e,n);n+=2,o.vals.push(t.GSUB.readLigatureSet(e,s+c))}}else if(5==r&&2==o.fmt){if(2==o.fmt){var d=a.readUshort(e,n);n+=2,o.cDef=t._lctf.readClassDef(e,s+d),o.scset=[];var p=a.readUshort(e,n);for(n+=2,u=0;u<p;u++){var f=a.readUshort(e,n);n+=2,o.scset.push(0==f?null:t.GSUB.readSubClassSet(e,s+f))}}}else if(6==r&&3==o.fmt){if(3==o.fmt){for(u=0;u<3;u++){h=a.readUshort(e,n),n+=2;for(var m=[],g=0;g<h;g++)m.push(t._lctf.readCoverage(e,s+a.readUshort(e,n+2*g)));n+=2*h,0==u&&(o.backCvg=m),1==u&&(o.inptCvg=m),2==u&&(o.ahedCvg=m)}h=a.readUshort(e,n),n+=2,o.lookupRec=t.GSUB.readSubstLookupRecords(e,n,h)}}else{if(7==r&&1==o.fmt){var v=a.readUshort(e,n);n+=2;var y=a.readUint(e,n);if(n+=4,9==i.ltype)i.ltype=v;else if(i.ltype!=v)throw"invalid extension substitution";return t.GSUB.subt(e,i.ltype,s+y)}console.debug("unsupported GSUB table LookupType",r,"format",o.fmt)}return o},t.GSUB.readSubClassSet=function(e,r){var n=t._bin.readUshort,i=r,a=[],s=n(e,r);r+=2;for(var o=0;o<s;o++){var l=n(e,r);r+=2,a.push(t.GSUB.readSubClassRule(e,i+l))}return a},t.GSUB.readSubClassRule=function(e,r){var n=t._bin.readUshort,i={},a=n(e,r),s=n(e,r+=2);r+=2,i.input=[];for(var o=0;o<a-1;o++)i.input.push(n(e,r)),r+=2;return i.substLookupRecords=t.GSUB.readSubstLookupRecords(e,r,s),i},t.GSUB.readSubstLookupRecords=function(e,r,n){for(var i=t._bin.readUshort,a=[],s=0;s<n;s++)a.push(i(e,r),i(e,r+2)),r+=4;return a},t.GSUB.readChainSubClassSet=function(e,r){var n=t._bin,i=r,a=[],s=n.readUshort(e,r);r+=2;for(var o=0;o<s;o++){var l=n.readUshort(e,r);r+=2,a.push(t.GSUB.readChainSubClassRule(e,i+l))}return a},t.GSUB.readChainSubClassRule=function(e,r){for(var n=t._bin,i={},a=["backtrack","input","lookahead"],s=0;s<a.length;s++){var o=n.readUshort(e,r);r+=2,1==s&&o--,i[a[s]]=n.readUshorts(e,r,o),r+=2*i[a[s]].length}return o=n.readUshort(e,r),r+=2,i.subst=n.readUshorts(e,r,2*o),r+=2*i.subst.length,i},t.GSUB.readLigatureSet=function(e,r){var n=t._bin,i=r,a=[],s=n.readUshort(e,r);r+=2;for(var o=0;o<s;o++){var l=n.readUshort(e,r);r+=2,a.push(t.GSUB.readLigature(e,i+l))}return a},t.GSUB.readLigature=function(e,r){var n=t._bin,i={chain:[]};i.nglyph=n.readUshort(e,r),r+=2;var a=n.readUshort(e,r);r+=2;for(var s=0;s<a-1;s++)i.chain.push(n.readUshort(e,r)),r+=2;return i},t.head={},t.head.parse=function(e,r,n){var i=t._bin,a={};return i.readFixed(e,r),r+=4,a.fontRevision=i.readFixed(e,r),r+=4,i.readUint(e,r),r+=4,i.readUint(e,r),r+=4,a.flags=i.readUshort(e,r),r+=2,a.unitsPerEm=i.readUshort(e,r),r+=2,a.created=i.readUint64(e,r),r+=8,a.modified=i.readUint64(e,r),r+=8,a.xMin=i.readShort(e,r),r+=2,a.yMin=i.readShort(e,r),r+=2,a.xMax=i.readShort(e,r),r+=2,a.yMax=i.readShort(e,r),r+=2,a.macStyle=i.readUshort(e,r),r+=2,a.lowestRecPPEM=i.readUshort(e,r),r+=2,a.fontDirectionHint=i.readShort(e,r),r+=2,a.indexToLocFormat=i.readShort(e,r),r+=2,a.glyphDataFormat=i.readShort(e,r),r+=2,a},t.hhea={},t.hhea.parse=function(e,r,n){var i=t._bin,a={};return i.readFixed(e,r),r+=4,a.ascender=i.readShort(e,r),r+=2,a.descender=i.readShort(e,r),r+=2,a.lineGap=i.readShort(e,r),r+=2,a.advanceWidthMax=i.readUshort(e,r),r+=2,a.minLeftSideBearing=i.readShort(e,r),r+=2,a.minRightSideBearing=i.readShort(e,r),r+=2,a.xMaxExtent=i.readShort(e,r),r+=2,a.caretSlopeRise=i.readShort(e,r),r+=2,a.caretSlopeRun=i.readShort(e,r),r+=2,a.caretOffset=i.readShort(e,r),r+=10,a.metricDataFormat=i.readShort(e,r),r+=2,a.numberOfHMetrics=i.readUshort(e,r),r+=2,a},t.hmtx={},t.hmtx.parse=function(e,r,n,i){for(var a=t._bin,s={aWidth:[],lsBearing:[]},o=0,l=0,h=0;h<i.maxp.numGlyphs;h++)h<i.hhea.numberOfHMetrics&&(o=a.readUshort(e,r),r+=2,l=a.readShort(e,r),r+=2),s.aWidth.push(o),s.lsBearing.push(l);return s},t.kern={},t.kern.parse=function(e,r,n,i){var a=t._bin,s=a.readUshort(e,r);if(r+=2,1==s)return t.kern.parseV1(e,r-2,n,i);var o=a.readUshort(e,r);r+=2;for(var l={glyph1:[],rval:[]},h=0;h<o;h++){r+=2,n=a.readUshort(e,r),r+=2;var u=a.readUshort(e,r);r+=2;var c=u>>>8;if(0!=(c&=15))throw"unknown kern table format: "+c;r=t.kern.readFormat0(e,r,l)}return l},t.kern.parseV1=function(e,r,n,i){var a=t._bin;a.readFixed(e,r),r+=4;var s=a.readUint(e,r);r+=4;for(var o={glyph1:[],rval:[]},l=0;l<s;l++){a.readUint(e,r),r+=4;var h=a.readUshort(e,r);r+=2,a.readUshort(e,r),r+=2;var u=h>>>8;if(0!=(u&=15))throw"unknown kern table format: "+u;r=t.kern.readFormat0(e,r,o)}return o},t.kern.readFormat0=function(e,r,n){var i=t._bin,a=-1,s=i.readUshort(e,r);r+=2,i.readUshort(e,r),r+=2,i.readUshort(e,r),r+=2,i.readUshort(e,r),r+=2;for(var o=0;o<s;o++){var l=i.readUshort(e,r);r+=2;var h=i.readUshort(e,r);r+=2;var u=i.readShort(e,r);r+=2,l!=a&&(n.glyph1.push(l),n.rval.push({glyph2:[],vals:[]}));var c=n.rval[n.rval.length-1];c.glyph2.push(h),c.vals.push(u),a=l}return r},t.loca={},t.loca.parse=function(e,r,n,i){var a=t._bin,s=[],o=i.head.indexToLocFormat,l=i.maxp.numGlyphs+1;if(0==o)for(var h=0;h<l;h++)s.push(a.readUshort(e,r+(h<<1))<<1);if(1==o)for(h=0;h<l;h++)s.push(a.readUint(e,r+(h<<2)));return s},t.maxp={},t.maxp.parse=function(e,r,n){var i=t._bin,a={},s=i.readUint(e,r);return r+=4,a.numGlyphs=i.readUshort(e,r),r+=2,65536==s&&(a.maxPoints=i.readUshort(e,r),r+=2,a.maxContours=i.readUshort(e,r),r+=2,a.maxCompositePoints=i.readUshort(e,r),r+=2,a.maxCompositeContours=i.readUshort(e,r),r+=2,a.maxZones=i.readUshort(e,r),r+=2,a.maxTwilightPoints=i.readUshort(e,r),r+=2,a.maxStorage=i.readUshort(e,r),r+=2,a.maxFunctionDefs=i.readUshort(e,r),r+=2,a.maxInstructionDefs=i.readUshort(e,r),r+=2,a.maxStackElements=i.readUshort(e,r),r+=2,a.maxSizeOfInstructions=i.readUshort(e,r),r+=2,a.maxComponentElements=i.readUshort(e,r),r+=2,a.maxComponentDepth=i.readUshort(e,r),r+=2),a},t.name={},t.name.parse=function(e,r,n){var i=t._bin,a={};i.readUshort(e,r),r+=2;var s=i.readUshort(e,r);r+=2,i.readUshort(e,r);for(var o,l=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],h=r+=2,u=0;u<s;u++){var c=i.readUshort(e,r);r+=2;var d=i.readUshort(e,r);r+=2;var p=i.readUshort(e,r);r+=2;var f=i.readUshort(e,r);r+=2;var m=i.readUshort(e,r);r+=2;var g=i.readUshort(e,r);r+=2;var v,y=l[f],x=h+12*s+g;if(0==c)v=i.readUnicode(e,x,m/2);else if(3==c&&0==d)v=i.readUnicode(e,x,m/2);else if(0==d)v=i.readASCII(e,x,m);else if(1==d)v=i.readUnicode(e,x,m/2);else if(3==d)v=i.readUnicode(e,x,m/2);else{if(1!=c)throw"unknown encoding "+d+", platformID: "+c;v=i.readASCII(e,x,m),console.debug("reading unknown MAC encoding "+d+" as ASCII")}var _="p"+c+","+p.toString(16);null==a[_]&&(a[_]={}),a[_][void 0!==y?y:f]=v,a[_]._lang=p}for(var b in a)if(null!=a[b].postScriptName&&1033==a[b]._lang)return a[b];for(var b in a)if(null!=a[b].postScriptName&&0==a[b]._lang)return a[b];for(var b in a)if(null!=a[b].postScriptName&&3084==a[b]._lang)return a[b];for(var b in a)if(null!=a[b].postScriptName)return a[b];for(var b in a){o=b;break}return console.debug("returning name table with languageID "+a[o]._lang),a[o]},t["OS/2"]={},t["OS/2"].parse=function(e,r,n){var i=t._bin.readUshort(e,r);r+=2;var a={};if(0==i)t["OS/2"].version0(e,r,a);else if(1==i)t["OS/2"].version1(e,r,a);else if(2==i||3==i||4==i)t["OS/2"].version2(e,r,a);else{if(5!=i)throw"unknown OS/2 table version: "+i;t["OS/2"].version5(e,r,a)}return a},t["OS/2"].version0=function(e,r,n){var i=t._bin;return n.xAvgCharWidth=i.readShort(e,r),r+=2,n.usWeightClass=i.readUshort(e,r),r+=2,n.usWidthClass=i.readUshort(e,r),r+=2,n.fsType=i.readUshort(e,r),r+=2,n.ySubscriptXSize=i.readShort(e,r),r+=2,n.ySubscriptYSize=i.readShort(e,r),r+=2,n.ySubscriptXOffset=i.readShort(e,r),r+=2,n.ySubscriptYOffset=i.readShort(e,r),r+=2,n.ySuperscriptXSize=i.readShort(e,r),r+=2,n.ySuperscriptYSize=i.readShort(e,r),r+=2,n.ySuperscriptXOffset=i.readShort(e,r),r+=2,n.ySuperscriptYOffset=i.readShort(e,r),r+=2,n.yStrikeoutSize=i.readShort(e,r),r+=2,n.yStrikeoutPosition=i.readShort(e,r),r+=2,n.sFamilyClass=i.readShort(e,r),r+=2,n.panose=i.readBytes(e,r,10),r+=10,n.ulUnicodeRange1=i.readUint(e,r),r+=4,n.ulUnicodeRange2=i.readUint(e,r),r+=4,n.ulUnicodeRange3=i.readUint(e,r),r+=4,n.ulUnicodeRange4=i.readUint(e,r),r+=4,n.achVendID=[i.readInt8(e,r),i.readInt8(e,r+1),i.readInt8(e,r+2),i.readInt8(e,r+3)],r+=4,n.fsSelection=i.readUshort(e,r),r+=2,n.usFirstCharIndex=i.readUshort(e,r),r+=2,n.usLastCharIndex=i.readUshort(e,r),r+=2,n.sTypoAscender=i.readShort(e,r),r+=2,n.sTypoDescender=i.readShort(e,r),r+=2,n.sTypoLineGap=i.readShort(e,r),r+=2,n.usWinAscent=i.readUshort(e,r),r+=2,n.usWinDescent=i.readUshort(e,r),r+=2},t["OS/2"].version1=function(e,r,n){var i=t._bin;return r=t["OS/2"].version0(e,r,n),n.ulCodePageRange1=i.readUint(e,r),r+=4,n.ulCodePageRange2=i.readUint(e,r),r+=4},t["OS/2"].version2=function(e,r,n){var i=t._bin;return r=t["OS/2"].version1(e,r,n),n.sxHeight=i.readShort(e,r),r+=2,n.sCapHeight=i.readShort(e,r),r+=2,n.usDefault=i.readUshort(e,r),r+=2,n.usBreak=i.readUshort(e,r),r+=2,n.usMaxContext=i.readUshort(e,r),r+=2},t["OS/2"].version5=function(e,r,n){var i=t._bin;return r=t["OS/2"].version2(e,r,n),n.usLowerOpticalPointSize=i.readUshort(e,r),r+=2,n.usUpperOpticalPointSize=i.readUshort(e,r),r+=2},t.post={},t.post.parse=function(e,r,n){var i=t._bin,a={};return a.version=i.readFixed(e,r),r+=4,a.italicAngle=i.readFixed(e,r),r+=4,a.underlinePosition=i.readShort(e,r),r+=2,a.underlineThickness=i.readShort(e,r),r+=2,a},null==t&&(t={}),null==t.U&&(t.U={}),t.U.codeToGlyph=function(e,t){var r=e.cmap,n=-1;if(null!=r.p0e4?n=r.p0e4:null!=r.p3e1?n=r.p3e1:null!=r.p1e0?n=r.p1e0:null!=r.p0e3&&(n=r.p0e3),-1==n)throw"no familiar platform and encoding!";var i=r.tables[n];if(0==i.format)return t>=i.map.length?0:i.map[t];if(4==i.format){for(var a=-1,s=0;s<i.endCount.length;s++)if(t<=i.endCount[s]){a=s;break}return -1==a||i.startCount[a]>t?0:65535&(0!=i.idRangeOffset[a]?i.glyphIdArray[t-i.startCount[a]+(i.idRangeOffset[a]>>1)-(i.idRangeOffset.length-a)]:t+i.idDelta[a])}if(12==i.format){if(t>i.groups[i.groups.length-1][1])return 0;for(s=0;s<i.groups.length;s++){var o=i.groups[s];if(o[0]<=t&&t<=o[1])return o[2]+(t-o[0])}return 0}throw"unknown cmap table format "+i.format},t.U.glyphToPath=function(e,r){var n={cmds:[],crds:[]};if(e.SVG&&e.SVG.entries[r]){var i=e.SVG.entries[r];return null==i?n:("string"==typeof i&&(i=t.SVG.toPath(i),e.SVG.entries[r]=i),i)}if(e.CFF){var a={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:e.CFF.Private?e.CFF.Private.defaultWidthX:0,open:!1},s=e.CFF,o=e.CFF.Private;if(s.ROS){for(var l=0;s.FDSelect[l+2]<=r;)l+=2;o=s.FDArray[s.FDSelect[l+1]].Private}t.U._drawCFF(e.CFF.CharStrings[r],a,s,o,n)}else e.glyf&&t.U._drawGlyf(r,e,n);return n},t.U._drawGlyf=function(e,r,n){var i=r.glyf[e];null==i&&(i=r.glyf[e]=t.glyf._parseGlyf(r,e)),null!=i&&(i.noc>-1?t.U._simpleGlyph(i,n):t.U._compoGlyph(i,r,n))},t.U._simpleGlyph=function(e,r){for(var n=0;n<e.noc;n++){for(var i=0==n?0:e.endPts[n-1]+1,a=e.endPts[n],s=i;s<=a;s++){var o=s==i?a:s-1,l=s==a?i:s+1,h=1&e.flags[s],u=1&e.flags[o],c=1&e.flags[l],d=e.xs[s],p=e.ys[s];if(s==i){if(h){if(!u){t.U.P.moveTo(r,d,p);continue}t.U.P.moveTo(r,e.xs[o],e.ys[o])}else u?t.U.P.moveTo(r,e.xs[o],e.ys[o]):t.U.P.moveTo(r,(e.xs[o]+d)/2,(e.ys[o]+p)/2)}h?u&&t.U.P.lineTo(r,d,p):c?t.U.P.qcurveTo(r,d,p,e.xs[l],e.ys[l]):t.U.P.qcurveTo(r,d,p,(d+e.xs[l])/2,(p+e.ys[l])/2)}t.U.P.closePath(r)}},t.U._compoGlyph=function(e,r,n){for(var i=0;i<e.parts.length;i++){var a={cmds:[],crds:[]},s=e.parts[i];t.U._drawGlyf(s.glyphIndex,r,a);for(var o=s.m,l=0;l<a.crds.length;l+=2){var h=a.crds[l],u=a.crds[l+1];n.crds.push(h*o.a+u*o.b+o.tx),n.crds.push(h*o.c+u*o.d+o.ty)}for(l=0;l<a.cmds.length;l++)n.cmds.push(a.cmds[l])}},t.U._getGlyphClass=function(e,r){var n=t._lctf.getInterval(r,e);return -1==n?0:r[n+2]},t.U.getPairAdjustment=function(e,r,n){var i=0;if(e.GPOS)for(var a=e.GPOS,s=a.lookupList,o=a.featureList,l=[],h=0;h<o.length;h++){var u=o[h];if("kern"==u.tag){for(var c=0;c<u.tab.length;c++)if(!l[u.tab[c]]){l[u.tab[c]]=!0;for(var d=s[u.tab[c]],p=0;p<d.tabs.length;p++)if(null!=d.tabs[p]){var f,m,g=d.tabs[p];if(!g.coverage||-1!=(m=t._lctf.coverageIndex(g.coverage,r))){if(1==d.ltype);else if(2==d.ltype){if(1==g.fmt){var v=g.pairsets[m];for(h=0;h<v.length;h++)v[h].gid2==n&&(f=v[h])}else if(2==g.fmt){var y=t.U._getGlyphClass(r,g.classDef1),x=t.U._getGlyphClass(n,g.classDef2);f=g.matrix[y][x]}f&&f.val1&&f.val1[2]&&(i+=f.val1[2]),f&&f.val2&&f.val2[0]&&(i+=f.val2[0])}}}}}}if(e.kern){var _=e.kern.glyph1.indexOf(r);if(-1!=_){var b=e.kern.rval[_].glyph2.indexOf(n);-1!=b&&(i+=e.kern.rval[_].vals[b])}}return i},t.U._applySubs=function(e,r,n,i){for(var a=e.length-r-1,s=0;s<n.tabs.length;s++)if(null!=n.tabs[s]){var o,l=n.tabs[s];if(!l.coverage||-1!=(o=t._lctf.coverageIndex(l.coverage,e[r]))){if(1==n.ltype)e[r],1==l.fmt?e[r]=e[r]+l.delta:e[r]=l.newg[o];else if(4==n.ltype)for(var h=l.vals[o],u=0;u<h.length;u++){var c=h[u],d=c.chain.length;if(!(d>a)){for(var p=!0,f=0,m=0;m<d;m++){for(;-1==e[r+f+(1+m)];)f++;c.chain[m]!=e[r+f+(1+m)]&&(p=!1)}if(p){for(m=0,e[r]=c.nglyph;m<d+f;m++)e[r+m+1]=-1;break}}}else if(5==n.ltype&&2==l.fmt)for(var g=t._lctf.getInterval(l.cDef,e[r]),v=l.cDef[g+2],y=l.scset[v],x=0;x<y.length;x++){var _=y[x],b=_.input;if(!(b.length>a)){for(p=!0,m=0;m<b.length;m++){var w=t._lctf.getInterval(l.cDef,e[r+1+m]);if(-1==g&&l.cDef[w+2]!=b[m]){p=!1;break}}if(p){var M=_.substLookupRecords;for(u=0;u<M.length;u+=2)M[u],M[u+1]}}}else if(6==n.ltype&&3==l.fmt){if(!t.U._glsCovered(e,l.backCvg,r-l.backCvg.length)||!t.U._glsCovered(e,l.inptCvg,r)||!t.U._glsCovered(e,l.ahedCvg,r+l.inptCvg.length))continue;var S=l.lookupRec;for(x=0;x<S.length;x+=2){g=S[x];var T=i[S[x+1]];t.U._applySubs(e,r+g,T,i)}}}}},t.U._glsCovered=function(e,r,n){for(var i=0;i<r.length;i++)if(-1==t._lctf.coverageIndex(r[i],e[n+i]))return!1;return!0},t.U.glyphsToPath=function(e,r,n){for(var i={cmds:[],crds:[]},a=0,s=0;s<r.length;s++){var o=r[s];if(-1!=o){for(var l=s<r.length-1&&-1!=r[s+1]?r[s+1]:0,h=t.U.glyphToPath(e,o),u=0;u<h.crds.length;u+=2)i.crds.push(h.crds[u]+a),i.crds.push(h.crds[u+1]);for(n&&i.cmds.push(n),u=0;u<h.cmds.length;u++)i.cmds.push(h.cmds[u]);n&&i.cmds.push("X"),a+=e.hmtx.aWidth[o],s<r.length-1&&(a+=t.U.getPairAdjustment(e,o,l))}}return i},t.U.P={},t.U.P.moveTo=function(e,t,r){e.cmds.push("M"),e.crds.push(t,r)},t.U.P.lineTo=function(e,t,r){e.cmds.push("L"),e.crds.push(t,r)},t.U.P.curveTo=function(e,t,r,n,i,a,s){e.cmds.push("C"),e.crds.push(t,r,n,i,a,s)},t.U.P.qcurveTo=function(e,t,r,n,i){e.cmds.push("Q"),e.crds.push(t,r,n,i)},t.U.P.closePath=function(e){e.cmds.push("Z")},t.U._drawCFF=function(e,r,n,i,a){for(var s=r.stack,o=r.nStems,l=r.haveWidth,h=r.width,u=r.open,c=0,d=r.x,p=r.y,f=0,m=0,g=0,v=0,y=0,x=0,_=0,b=0,w=0,M=0,S={val:0,size:0};c<e.length;){t.CFF.getCharString(e,c,S);var T=S.val;if(c+=S.size,"o1"==T||"o18"==T)s.length%2==0||l||(h=s.shift()+i.nominalWidthX),o+=s.length>>1,s.length=0,l=!0;else if("o3"==T||"o23"==T)s.length%2==0||l||(h=s.shift()+i.nominalWidthX),o+=s.length>>1,s.length=0,l=!0;else if("o4"==T)s.length>1&&!l&&(h=s.shift()+i.nominalWidthX,l=!0),u&&t.U.P.closePath(a),p+=s.pop(),t.U.P.moveTo(a,d,p),u=!0;else if("o5"==T)for(;s.length>0;)d+=s.shift(),p+=s.shift(),t.U.P.lineTo(a,d,p);else if("o6"==T||"o7"==T)for(var E=s.length,A="o6"==T,L=0;L<E;L++){var R=s.shift();A?d+=R:p+=R,A=!A,t.U.P.lineTo(a,d,p)}else if("o8"==T||"o24"==T){E=s.length;for(var P=0;P+6<=E;)f=d+s.shift(),m=p+s.shift(),g=f+s.shift(),v=m+s.shift(),d=g+s.shift(),p=v+s.shift(),t.U.P.curveTo(a,f,m,g,v,d,p),P+=6;"o24"==T&&(d+=s.shift(),p+=s.shift(),t.U.P.lineTo(a,d,p))}else{if("o11"==T)break;if("o1234"==T||"o1235"==T||"o1236"==T||"o1237"==T)"o1234"==T&&(m=p,g=(f=d+s.shift())+s.shift(),M=v=m+s.shift(),x=v,b=p,d=(_=(y=(w=g+s.shift())+s.shift())+s.shift())+s.shift(),t.U.P.curveTo(a,f,m,g,v,w,M),t.U.P.curveTo(a,y,x,_,b,d,p)),"o1235"==T&&(f=d+s.shift(),m=p+s.shift(),g=f+s.shift(),v=m+s.shift(),w=g+s.shift(),M=v+s.shift(),y=w+s.shift(),x=M+s.shift(),_=y+s.shift(),b=x+s.shift(),d=_+s.shift(),p=b+s.shift(),s.shift(),t.U.P.curveTo(a,f,m,g,v,w,M),t.U.P.curveTo(a,y,x,_,b,d,p)),"o1236"==T&&(f=d+s.shift(),m=p+s.shift(),g=f+s.shift(),M=v=m+s.shift(),x=v,_=(y=(w=g+s.shift())+s.shift())+s.shift(),b=x+s.shift(),d=_+s.shift(),t.U.P.curveTo(a,f,m,g,v,w,M),t.U.P.curveTo(a,y,x,_,b,d,p)),"o1237"==T&&(f=d+s.shift(),m=p+s.shift(),g=f+s.shift(),v=m+s.shift(),w=g+s.shift(),M=v+s.shift(),y=w+s.shift(),x=M+s.shift(),Math.abs((_=y+s.shift())-d)>Math.abs((b=x+s.shift())-p)?d=_+s.shift():p=b+s.shift(),t.U.P.curveTo(a,f,m,g,v,w,M),t.U.P.curveTo(a,y,x,_,b,d,p));else if("o14"==T){if(s.length>0&&!l&&(h=s.shift()+n.nominalWidthX,l=!0),4==s.length){var C=s.shift(),I=s.shift(),D=s.shift(),O=s.shift(),U=t.CFF.glyphBySE(n,D),N=t.CFF.glyphBySE(n,O);t.U._drawCFF(n.CharStrings[U],r,n,i,a),r.x=C,r.y=I,t.U._drawCFF(n.CharStrings[N],r,n,i,a)}u&&(t.U.P.closePath(a),u=!1)}else if("o19"==T||"o20"==T)s.length%2==0||l||(h=s.shift()+i.nominalWidthX),o+=s.length>>1,s.length=0,l=!0,c+=o+7>>3;else if("o21"==T)s.length>2&&!l&&(h=s.shift()+i.nominalWidthX,l=!0),p+=s.pop(),d+=s.pop(),u&&t.U.P.closePath(a),t.U.P.moveTo(a,d,p),u=!0;else if("o22"==T)s.length>1&&!l&&(h=s.shift()+i.nominalWidthX,l=!0),d+=s.pop(),u&&t.U.P.closePath(a),t.U.P.moveTo(a,d,p),u=!0;else if("o25"==T){for(;s.length>6;)d+=s.shift(),p+=s.shift(),t.U.P.lineTo(a,d,p);f=d+s.shift(),m=p+s.shift(),g=f+s.shift(),v=m+s.shift(),d=g+s.shift(),p=v+s.shift(),t.U.P.curveTo(a,f,m,g,v,d,p)}else if("o26"==T)for(s.length%2&&(d+=s.shift());s.length>0;)f=d,m=p+s.shift(),d=g=f+s.shift(),p=(v=m+s.shift())+s.shift(),t.U.P.curveTo(a,f,m,g,v,d,p);else if("o27"==T)for(s.length%2&&(p+=s.shift());s.length>0;)m=p,g=(f=d+s.shift())+s.shift(),v=m+s.shift(),d=g+s.shift(),p=v,t.U.P.curveTo(a,f,m,g,v,d,p);else if("o10"==T||"o29"==T){var k="o10"==T?i:n;if(0==s.length)console.debug("error: empty stack");else{var F=s.pop(),B=k.Subrs[F+k.Bias];r.x=d,r.y=p,r.nStems=o,r.haveWidth=l,r.width=h,r.open=u,t.U._drawCFF(B,r,n,i,a),d=r.x,p=r.y,o=r.nStems,l=r.haveWidth,h=r.width,u=r.open}}else if("o30"==T||"o31"==T){var z=s.length,H=(P=0,"o31"==T);for(P+=z-(E=-3&z);P<E;)H?(m=p,g=(f=d+s.shift())+s.shift(),p=(v=m+s.shift())+s.shift(),E-P==5?(d=g+s.shift(),P++):d=g,H=!1):(f=d,m=p+s.shift(),g=f+s.shift(),v=m+s.shift(),d=g+s.shift(),E-P==5?(p=v+s.shift(),P++):p=v,H=!0),t.U.P.curveTo(a,f,m,g,v,d,p),P+=4}else{if("o"==(T+"").charAt(0))throw console.debug("Unknown operation: "+T,e),T;s.push(T)}}}r.x=d,r.y=p,r.nStems=o,r.haveWidth=l,r.width=h,r.open=u},r=t,e.Typr=r,e.default={Typr:r},Object.defineProperty(e,"__esModule",{value:!0}),e).Typr},/*!
Custom bundle of woff2otf (https://github.com/arty-name/woff2otf) with fflate
(https://github.com/101arrowz/fflate) for use in Troika text rendering. 
Original licenses apply: 
- fflate: https://github.com/101arrowz/fflate/blob/master/LICENSE (MIT)
- woff2otf.js: https://github.com/arty-name/woff2otf/blob/master/woff2otf.js (Apache2)
*/function(){return function(e){var t=Uint8Array,r=Uint16Array,n=Uint32Array,i=new t([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),a=new t([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),s=new t([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),o=function(e,t){for(var i=new r(31),a=0;a<31;++a)i[a]=t+=1<<e[a-1];var s=new n(i[30]);for(a=1;a<30;++a)for(var o=i[a];o<i[a+1];++o)s[o]=o-i[a]<<5|a;return[i,s]},l=o(i,2),h=l[0],u=l[1];h[28]=258,u[258]=28;for(var c=o(a,0)[0],d=new r(32768),p=0;p<32768;++p){var f=(43690&p)>>>1|(21845&p)<<1;f=(61680&(f=(52428&f)>>>2|(13107&f)<<2))>>>4|(3855&f)<<4,d[p]=((65280&f)>>>8|(255&f)<<8)>>>1}var m=function(e,t,n){for(var i=e.length,a=0,s=new r(t);a<i;++a)++s[e[a]-1];var o,l=new r(t);for(a=0;a<t;++a)l[a]=l[a-1]+s[a-1]<<1;if(n){o=new r(1<<t);var h=15-t;for(a=0;a<i;++a)if(e[a])for(var u=a<<4|e[a],c=t-e[a],p=l[e[a]-1]++<<c,f=p|(1<<c)-1;p<=f;++p)o[d[p]>>>h]=u}else for(o=new r(i),a=0;a<i;++a)e[a]&&(o[a]=d[l[e[a]-1]++]>>>15-e[a]);return o},g=new t(288);for(p=0;p<144;++p)g[p]=8;for(p=144;p<256;++p)g[p]=9;for(p=256;p<280;++p)g[p]=7;for(p=280;p<288;++p)g[p]=8;var v=new t(32);for(p=0;p<32;++p)v[p]=5;var y=m(g,9,1),x=m(v,5,1),_=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},b=function(e,t,r){var n=t/8|0;return(e[n]|e[n+1]<<8)>>(7&t)&r},w=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(7&t)},M=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],S=function(e,t,r){var n=Error(t||M[e]);if(n.code=e,Error.captureStackTrace&&Error.captureStackTrace(n,S),!r)throw n;return n},T=function(e,o,l){var u,d,p,f,g=e.length;if(!g||l&&!l.l&&g<5)return o||new t(0);var v=!o||l,M=!l||l.i;l||(l={}),o||(o=new t(3*g));var T,E=function(e){var r=o.length;if(e>r){var n=new t(Math.max(2*r,e));n.set(o),o=n}},A=l.f||0,L=l.p||0,R=l.b||0,P=l.l,C=l.d,I=l.m,D=l.n,O=8*g;do{if(!P){l.f=A=b(e,L,1);var U=b(e,L+1,3);if(L+=3,!U){var N=e[(X=((T=L)/8|0)+(7&T&&1)+4)-4]|e[X-3]<<8,k=X+N;if(k>g){M&&S(0);break}v&&E(R+N),o.set(e.subarray(X,k),R),l.b=R+=N,l.p=L=8*k;continue}if(1==U)P=y,C=x,I=9,D=5;else if(2==U){var F=b(e,L,31)+257,B=b(e,L+10,15)+4,z=F+b(e,L+5,31)+1;L+=14;for(var H=new t(z),G=new t(19),V=0;V<B;++V)G[s[V]]=b(e,L+3*V,7);L+=3*B;var W=_(G),j=(1<<W)-1,q=m(G,W,1);for(V=0;V<z;){var X,Y=q[b(e,L,j)];if(L+=15&Y,(X=Y>>>4)<16)H[V++]=X;else{var Z=0,J=0;for(16==X?(J=3+b(e,L,3),L+=2,Z=H[V-1]):17==X?(J=3+b(e,L,7),L+=3):18==X&&(J=11+b(e,L,127),L+=7);J--;)H[V++]=Z}}var K=H.subarray(0,F),Q=H.subarray(F);I=_(K),D=_(Q),P=m(K,I,1),C=m(Q,D,1)}else S(1);if(L>O){M&&S(0);break}}v&&E(R+131072);for(var $=(1<<I)-1,ee=(1<<D)-1,et=L;;et=L){var er=(Z=P[w(e,L)&$])>>>4;if((L+=15&Z)>O){M&&S(0);break}if(Z||S(2),er<256)o[R++]=er;else{if(256==er){et=L,P=null;break}var en=er-254;if(er>264){var ei=i[V=er-257];en=b(e,L,(1<<ei)-1)+h[V],L+=ei}var ea=C[w(e,L)&ee],es=ea>>>4;if(ea||S(3),L+=15&ea,Q=c[es],es>3&&(ei=a[es],Q+=w(e,L)&(1<<ei)-1,L+=ei),L>O){M&&S(0);break}v&&E(R+131072);for(var eo=R+en;R<eo;R+=4)o[R]=o[R-Q],o[R+1]=o[R+1-Q],o[R+2]=o[R+2-Q],o[R+3]=o[R+3-Q];R=eo}}l.l=P,l.p=et,l.b=R,P&&(A=1,l.m=I,l.d=C,l.n=D)}while(!A)return R==o.length?o:(u=o,(d=0)<0&&(d=0),(null==(p=R)||p>u.length)&&(p=u.length),(f=new(u instanceof r?r:u instanceof n?n:t)(p-d)).set(u.subarray(d,p)),f)},E=new t(0),A="undefined"!=typeof TextDecoder&&new TextDecoder;try{A.decode(E,{stream:!0})}catch(e){}return e.convert_streams=function(e){var t=new DataView(e),r=0;function n(){var e=t.getUint16(r);return r+=2,e}function i(){var e=t.getUint32(r);return r+=4,e}function a(e){v.setUint16(y,e),y+=2}function s(e){v.setUint32(y,e),y+=4}for(var o={signature:i(),flavor:i(),length:i(),numTables:n(),reserved:n(),totalSfntSize:i(),majorVersion:n(),minorVersion:n(),metaOffset:i(),metaLength:i(),metaOrigLength:i(),privOffset:i(),privLength:i()},l=0;Math.pow(2,l)<=o.numTables;)l++;l--;for(var h=16*Math.pow(2,l),u=16*o.numTables-h,c=12,d=[],p=0;p<o.numTables;p++)d.push({tag:i(),offset:i(),compLength:i(),origLength:i(),origChecksum:i()}),c+=16;var f,m=new Uint8Array(12+16*d.length+d.reduce(function(e,t){return e+t.origLength+4},0)),g=m.buffer,v=new DataView(g),y=0;return s(o.flavor),a(o.numTables),a(h),a(l),a(u),d.forEach(function(e){s(e.tag),s(e.origChecksum),s(c),s(e.origLength),e.outOffset=c,(c+=e.origLength)%4!=0&&(c+=4-c%4)}),d.forEach(function(t){var r=e.slice(t.offset,t.offset+t.compLength);if(t.compLength!=t.origLength){var n=new Uint8Array(t.origLength);T(new Uint8Array(r,2),n)}else n=new Uint8Array(r);m.set(n,t.outOffset);var i=0;(c=t.outOffset+t.origLength)%4!=0&&(i=4-c%4),m.set(new Uint8Array(i).buffer,t.outOffset+t.origLength),f=c+i}),g.slice(0,f)},Object.defineProperty(e,"__esModule",{value:!0}),e}({}).convert_streams},function(e,t){let r;let n={M:2,L:2,Q:4,C:6,Z:0},i={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},a=[null,"isol","init","fina","medi"];return function(s){let o=new Uint8Array(s,0,4),l=e._bin.readASCII(o,0,4);if("wOFF"===l)s=t(s);else if("wOF2"===l)throw Error("woff2 fonts not supported");return function(t){let s=Object.create(null),o={unitsPerEm:t.head.unitsPerEm,ascender:t.hhea.ascender,descender:t.hhea.descender,forEachGlyph(l,h,u,c){let d=0,p=1/o.unitsPerEm*h,f=function(t,n){let s=[];for(let r=0;r<n.length;r++){let i=n.codePointAt(r);i>65535&&r++,s.push(e.U.codeToGlyph(t,i))}let o=t.GSUB;if(o){let t;let{lookupList:l,featureList:h}=o,u=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws)$/,c=[];h.forEach(o=>{if(u.test(o.tag))for(let h=0;h<o.tab.length;h++){if(c[o.tab[h]])continue;c[o.tab[h]]=!0;let u=l[o.tab[h]],d=/^(isol|init|fina|medi)$/.test(o.tag);d&&!t&&(t=function(e){let t=new Uint8Array(e.length),n=32,a=1,s=-1;for(let o=0;o<e.length;o++){let l=e.codePointAt(o),h=0|function(e){if(!r){let e={R:2,L:1,D:4,C:16,U:32,T:8};for(let t in r=new Map,i){let n=0;i[t].split(",").forEach(i=>{let[a,s]=i.split("+");a=parseInt(a,36),s=s?parseInt(s,36):0,r.set(n+=a,e[t]);for(let i=s;i--;)r.set(++n,e[t])})}}return r.get(e)||32}(l),u=1;!(8&h)&&(21&n?22&h?(u=3,(1===a||3===a)&&t[s]++):33&h&&(2===a||4===a)&&t[s]--:34&n&&(2===a||4===a)&&t[s]--,a=t[o]=u,n=h,s=o,l>65535&&o++)}return t}(n));for(let r=0;r<s.length;r++)t&&d&&a[t[r]]!==o.tag||e.U._applySubs(s,r,u,l)}})}return s}(t,l),m=0,g=-1;return f.forEach((r,i)=>{if(-1!==r){let i=s[r];if(!i){let a,o,l,h;let{cmds:u,crds:c}=e.U.glyphToPath(t,r),d="",p=0;for(let e=0,t=u.length;e<t;e++){let t=n[u[e]];d+=u[e];for(let e=1;e<=t;e++)d+=(e>1?",":"")+c[p++]}if(c.length){a=o=1/0,l=h=-1/0;for(let e=0,t=c.length;e<t;e+=2){let t=c[e],r=c[e+1];t<a&&(a=t),r<o&&(o=r),t>l&&(l=t),r>h&&(h=r)}}else a=l=o=h=0;i=s[r]={index:r,advanceWidth:t.hmtx.aWidth[r],xMin:a,yMin:o,xMax:l,yMax:h,path:d,pathCommandCount:u.length}}-1!==g&&(d+=e.U.getPairAdjustment(t,g,r)*p),c.call(null,i,d,m),i.advanceWidth&&(d+=i.advanceWidth*p),u&&(d+=u*h),g=r}m+=l.codePointAt(m)>65535?2:1}),d}};return o}(e.parse(s)[0])}}],init:(e,t,r)=>r(e(),t())}),en={defaultFontURL:"https://fonts.gstatic.com/s/roboto/v18/KFOmCnqEu92Fr1Mu4mxM.woff",sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048},ei=/*#__PURE__*/new d.Color;function ea(){return(self.performance||Date).now()}const es=Object.create(null),eo=/*#__PURE__*/F({name:"Typesetter",dependencies:[en,er,function(e,t,r){let{defaultFontURL:n}=r,i=Object.create(null),a=1/0,s=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,o=/[\s\-\u007C\u00AD\u2010\u2012-\u2014\u2027\u2056\u2E17\u2E40]/;function l(t,r){t||(t=n);let a=i[t];if(a)a.pending?a.pending.push(r):r(a);else{var s,o;i[t]={pending:[r]},s=t,o=e=>{let r=i[t].pending;i[t]=e,r.forEach(t=>t(e))},function t(){let r=e=>{console.error(`Failure loading font ${s}${s===n?"":"; trying fallback"}`,e),s!==n&&(s=n,t())};try{let t=new XMLHttpRequest;t.open("get",s,!0),t.responseType="arraybuffer",t.onload=function(){if(t.status>=400)r(Error(t.statusText));else if(t.status>0)try{let r=e(t.response);o(r)}catch(e){r(e)}},t.onerror=r,t.send()}catch(e){r(e)}}()}}function h({text:e="",font:r=n,sdfGlyphSize:i=64,fontSize:p=1,letterSpacing:f=0,lineHeight:m="normal",maxWidth:g=a,direction:v,textAlign:y="left",textIndent:x=0,whiteSpace:_="normal",overflowWrap:b="normal",anchorX:w=0,anchorY:M=0,includeCaretPositions:S=!1,chunkedBoundsSize:T=8192,colorRanges:E=null},A,L=!1){let R=c(),P={fontLoad:0,typesetting:0};e.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),e=e.replace(/\r\n/g,"\n").replace(/\r/g,"\n")),p=+p,f=+f,g=+g,m=m||"normal",x=+x,l(r,r=>{let n=isFinite(g),i=null,l=null,h=null,C=null,I=null,D=null,O=null,U=0,N=0,k="nowrap"!==_,{ascender:F,descender:B,unitsPerEm:z}=r;P.fontLoad=c()-R;let H=c(),G=p/z;"normal"===m&&(m=(F-B)/z);let V=((m*=p)-(F-B)*G)/2,W=-(F*G+V),j=Math.min(m,(F-B)*G),q=(F+B)/2*G-j/2,X=x,Y=new d,Z=[Y];r.forEachGlyph(e,p,f,(t,r,i)=>{let a;let l=e.charAt(i),h=t.advanceWidth*G,u=Y.count;if("isEmpty"in t||(t.isWhitespace=!!l&&/\s/.test(l),t.canBreakAfter=!!l&&o.test(l),t.isEmpty=t.xMin===t.xMax||t.yMin===t.yMax||s.test(l)),!t.isWhitespace&&!t.isEmpty&&N++,k&&n&&!t.isWhitespace&&r+h+X>g&&u){if(Y.glyphAt(u-1).glyphObj.canBreakAfter)a=new d,X=-r;else for(let e=u;e--;){if(0===e&&"break-word"===b){a=new d,X=-r;break}if(Y.glyphAt(e).glyphObj.canBreakAfter){let t=(a=Y.splitAt(e+1)).glyphAt(0).x;X-=t;for(let e=a.count;e--;)a.glyphAt(e).x-=t;break}}a&&(Y.isSoftWrapped=!0,Y=a,Z.push(Y),U=g)}let c=Y.glyphAt(Y.count);c.glyphObj=t,c.x=r+X,c.width=h,c.charIndex=i,"\n"===l&&(Y=new d,Z.push(Y),X=-(r+h+f*p)+x)}),Z.forEach(e=>{for(let t=e.count;t--;){let{glyphObj:r,x:n,width:i}=e.glyphAt(t);if(!r.isWhitespace){e.width=n+i,e.width>U&&(U=e.width);return}}});let J=0,K=0;if(w&&("number"==typeof w?J=-w:"string"==typeof w&&(J=-U*("left"===w?0:"center"===w?.5:"right"===w?1:u(w)))),M){if("number"==typeof M)K=-M;else if("string"==typeof M){let e=Z.length*m;K="top"===M?0:"top-baseline"===M?-W:"middle"===M?e/2:"bottom"===M?e:"bottom-baseline"===M?e-V+B*G:u(M)*e}}if(!L){let n,s;let o=t.getEmbeddingLevels(e,v);i=new Uint16Array(N),l=new Float32Array(2*N),h={},D=[a,a,-a,-a],O=[];let u=W;S&&(I=new Float32Array(3*e.length)),E&&(C=new Uint8Array(3*N));let c=0,d=-1,p=-1;Z.forEach((f,g)=>{let{count:v,width:x}=f;if(v>0){let m,g=0;for(let e=v;e--&&f.glyphAt(e).glyphObj.isWhitespace;)g++;let _=0,b=0;if("center"===y)_=(U-x)/2;else if("right"===y)_=U-x;else if("justify"===y&&f.isSoftWrapped){let e=0;for(let t=v-g;t--;)f.glyphAt(t).glyphObj.isWhitespace&&e++;b=(U-x)/e}if(b||_){let e=0;for(let t=0;t<v;t++){let r=f.glyphAt(t),n=r.glyphObj;r.x+=_+e,0!==b&&n.isWhitespace&&t<v-g&&(e+=b,r.width+=b)}}let w=t.getReorderSegments(e,o,f.glyphAt(0).charIndex,f.glyphAt(f.count-1).charIndex);for(let e=0;e<w.length;e++){let[t,r]=w[e],n=1/0,i=-1/0;for(let e=0;e<v;e++)if(f.glyphAt(e).charIndex>=t){let t=e,a=e;for(;a<v;a++){let e=f.glyphAt(a);if(e.charIndex>r)break;a<v-g&&(n=Math.min(n,e.x),i=Math.max(i,e.x+e.width))}for(let e=t;e<a;e++){let t=f.glyphAt(e);t.x=i-(t.x+t.width-n)}break}}let M=e=>m=e;for(let g=0;g<v;g++){let v=f.glyphAt(g),y=(m=v.glyphObj).index,x=1&o.levels[v.charIndex];if(x){let n=t.getMirroredCharacter(e[v.charIndex]);n&&r.forEachGlyph(n,0,0,M)}if(S){let{charIndex:e}=v,t=v.x+J,r=v.x+v.width+J;for(I[3*e]=x?r:t,I[3*e+1]=x?t:r,I[3*e+2]=u+q+K;e-d>1;)I[(d+1)*3]=I[3*d],I[(d+1)*3+1]=I[3*d+1],I[(d+1)*3+2]=I[3*d+2],d++;d=e}if(E){let{charIndex:e}=v;for(;e>p;)p++,E.hasOwnProperty(p)&&(s=E[p])}if(!m.isWhitespace&&!m.isEmpty){let e=c++;h[y]||(h[y]={path:m.path,pathBounds:[m.xMin,m.yMin,m.xMax,m.yMax]});let t=v.x+J,r=u+K;l[2*e]=t,l[2*e+1]=r;let o=t+m.xMin*G,d=r+m.yMin*G,p=t+m.xMax*G,f=r+m.yMax*G;o<D[0]&&(D[0]=o),d<D[1]&&(D[1]=d),p>D[2]&&(D[2]=p),f>D[3]&&(D[3]=f),e%T==0&&(n={start:e,end:e,rect:[a,a,-a,-a]},O.push(n)),n.end++;let g=n.rect;if(o<g[0]&&(g[0]=o),d<g[1]&&(g[1]=d),p>g[2]&&(g[2]=p),f>g[3]&&(g[3]=f),i[e]=y,E){let t=3*e;C[t]=s>>16&255,C[t+1]=s>>8&255,C[t+2]=255&s}}}}u-=m})}P.typesetting=c()-H,A({glyphIds:i,glyphPositions:l,glyphData:h,caretPositions:I,caretHeight:j,glyphColors:C,chunkedBounds:O,fontSize:p,unitsPerEm:z,ascender:F*G,descender:B*G,lineHeight:m,topBaseline:W,blockBounds:[J,K-Z.length*m,J+U,K],visibleBounds:D,timings:P})})}function u(e){let t=e.match(/^([\d.]+)%$/),r=t?parseFloat(t[1]):NaN;return isNaN(r)?0:r/100}function c(){return(self.performance||Date).now()}function d(){this.data=[]}let p=["glyphObj","x","width","charIndex"];return d.prototype={width:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/p.length)},glyphAt(e){let t=d.flyweight;return t.data=this.data,t.index=e,t},splitAt(e){let t=new d;return t.data=this.data.splice(e*p.length),t}},d.flyweight=p.reduce((e,t,r,n)=>(Object.defineProperty(e,t,{get(){return this.data[this.index*p.length+r]},set(e){this.data[this.index*p.length+r]=e}}),e),{data:null,index:0}),{typeset:h,measure:function(e,t){h(e,e=>{let[r,n,i,a]=e.blockBounds;t({width:i-r,height:a-n})},{metricsOnly:!0})},loadFont:l}},function(){return function(e){var t,r,n,i,a={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},s={},o={};s.L=1,o[1]="L",Object.keys(a).forEach(function(e,t){s[e]=1<<t+1,o[s[e]]=e}),Object.freeze(s);var l=s.LRI|s.RLI|s.FSI,h=s.L|s.R|s.AL,u=s.B|s.S|s.WS|s.ON|s.FSI|s.LRI|s.RLI|s.PDI,c=s.BN|s.RLE|s.LRE|s.RLO|s.LRO|s.PDF,d=s.S|s.WS|s.B|l|s.PDI|c,p=null;function f(e){return!function(){if(!p){p=new Map;var e=function(e){if(a.hasOwnProperty(e)){var t=0;a[e].split(",").forEach(function(r){var n=r.split("+"),i=n[0],a=n[1];i=parseInt(i,36),a=a?parseInt(a,36):0,p.set(t+=i,s[e]);for(var o=0;o<a;o++)p.set(++t,s[e])})}};for(var t in a)e(t)}}(),p.get(e.codePointAt(0))||s.L}var m={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function g(e,t){var r,n=0,i=new Map,a=t&&new Map;return e.split(",").forEach(function e(s){if(-1!==s.indexOf("+"))for(var o=+s;o--;)e(r);else{r=s;var l=s.split(">"),h=l[0],u=l[1];h=String.fromCodePoint(n+=parseInt(h,36)),u=String.fromCodePoint(n+=parseInt(u,36)),i.set(h,u),t&&a.set(u,h)}}),{map:i,reverseMap:a}}function v(){if(!t){var e=g(m.pairs,!0),i=e.map,a=e.reverseMap;t=i,r=a,n=g(m.canonical,!1).map}}function y(e){return v(),t.get(e)||null}function x(e){return v(),r.get(e)||null}function _(e){return v(),n.get(e)||null}var b=s.L,w=s.R,M=s.EN,S=s.ES,T=s.ET,E=s.AN,A=s.CS,L=s.B,R=s.S,P=s.ON,C=s.BN,I=s.NSM,D=s.AL,O=s.LRO,U=s.RLO,N=s.LRE,k=s.RLE,F=s.PDF,B=s.LRI,z=s.RLI,H=s.FSI,G=s.PDI;function V(e){return!function(){if(!i){var e=g("14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",!0),t=e.map;e.reverseMap.forEach(function(e,r){t.set(r,e)}),i=t}}(),i.get(e)||null}function W(e,t,r,n){var i=e.length;r=Math.max(0,null==r?0:+r),n=Math.min(i-1,null==n?i-1:+n);var a=[];return t.paragraphs.forEach(function(i){var s=Math.max(r,i.start),o=Math.min(n,i.end);if(s<o){for(var l=t.levels.slice(s,o+1),h=o;h>=s&&f(e[h])&d;h--)l[h]=i.level;for(var u=i.level,c=1/0,p=0;p<l.length;p++){var m=l[p];m>u&&(u=m),m<c&&(c=1|m)}for(var g=u;g>=c;g--)for(var v=0;v<l.length;v++)if(l[v]>=g){for(var y=v;v+1<l.length&&l[v+1]>=g;)v++;v>y&&a.push([y+s,v+s])}}}),a}function j(e,t,r,n){for(var i=W(e,t,r,n),a=[],s=0;s<e.length;s++)a[s]=s;return i.forEach(function(e){for(var t=e[0],r=e[1],n=a.slice(t,r+1),i=n.length;i--;)a[r-i]=n[i]}),a}return e.closingToOpeningBracket=x,e.getBidiCharType=f,e.getBidiCharTypeName=function(e){return o[f(e)]},e.getCanonicalBracket=_,e.getEmbeddingLevels=function(e,t){for(var r=new Uint32Array(e.length),n=0;n<e.length;n++)r[n]=f(e[n]);var i=new Map;function a(e,t){var n=r[e];r[e]=t,i.set(n,i.get(n)-1),n&u&&i.set(u,i.get(u)-1),i.set(t,(i.get(t)||0)+1),t&u&&i.set(u,(i.get(u)||0)+1)}for(var s=new Uint8Array(e.length),o=new Map,p=[],m=null,g=0;g<e.length;g++)m||p.push(m={start:g,end:e.length-1,level:"rtl"===t?1:"ltr"===t?0:tP(g,!1)}),r[g]&L&&(m.end=g,m=null);for(var v=k|N|U|O|l|G|F|L,V=function(e){return e+(1&e?1:2)},W=function(e){return e+(1&e?2:1)},j=0;j<p.length;j++){var q=[{_level:(m=p[j]).level,_override:0,_isolate:0}],X=void 0,Y=0,Z=0,J=0;i.clear();for(var K=m.start;K<=m.end;K++){var Q=r[K];if(X=q[q.length-1],i.set(Q,(i.get(Q)||0)+1),Q&u&&i.set(u,(i.get(u)||0)+1),Q&v){if(Q&(k|N)){s[K]=X._level;var $=(Q===k?W:V)(X._level);!($<=125)||Y||Z?!Y&&Z++:q.push({_level:$,_override:0,_isolate:0})}else if(Q&(U|O)){s[K]=X._level;var ee=(Q===U?W:V)(X._level);!(ee<=125)||Y||Z?!Y&&Z++:q.push({_level:ee,_override:Q&U?w:b,_isolate:0})}else if(Q&l){Q&H&&(Q=1===tP(K+1,!0)?z:B),s[K]=X._level,X._override&&a(K,X._override);var et=(Q===z?W:V)(X._level);et<=125&&0===Y&&0===Z?(J++,q.push({_level:et,_override:0,_isolate:1,_isolInitIndex:K})):Y++}else if(Q&G){if(Y>0)Y--;else if(J>0){for(Z=0;!q[q.length-1]._isolate;)q.pop();var er=q[q.length-1]._isolInitIndex;null!=er&&(o.set(er,K),o.set(K,er)),q.pop(),J--}X=q[q.length-1],s[K]=X._level,X._override&&a(K,X._override)}else Q&F?(0===Y&&(Z>0?Z--:!X._isolate&&q.length>1&&(q.pop(),X=q[q.length-1])),s[K]=X._level):Q&L&&(s[K]=m.level)}else s[K]=X._level,X._override&&Q!==C&&a(K,X._override)}for(var en=[],ei=null,ea=m.start;ea<=m.end;ea++){var es=r[ea];if(!(es&c)){var eo=s[ea],el=es&l,eh=es===G;ei&&eo===ei._level?(ei._end=ea,ei._endsWithIsolInit=el):en.push(ei={_start:ea,_end:ea,_level:eo,_startsWithPDI:eh,_endsWithIsolInit:el})}}for(var eu=[],ec=0;ec<en.length;ec++){var ed=en[ec];if(!ed._startsWithPDI||ed._startsWithPDI&&!o.has(ed._start)){for(var ep=[ei=ed],ef=void 0;ei&&ei._endsWithIsolInit&&null!=(ef=o.get(ei._end));)for(var em=ec+1;em<en.length;em++)if(en[em]._start===ef){ep.push(ei=en[em]);break}for(var eg=[],ev=0;ev<ep.length;ev++)for(var ey=ep[ev],ex=ey._start;ex<=ey._end;ex++)eg.push(ex);for(var e_=s[eg[0]],eb=m.level,ew=eg[0]-1;ew>=0;ew--)if(!(r[ew]&c)){eb=s[ew];break}var eM=eg[eg.length-1],eS=s[eM],eT=m.level;if(!(r[eM]&l)){for(var eE=eM+1;eE<=m.end;eE++)if(!(r[eE]&c)){eT=s[eE];break}}eu.push({_seqIndices:eg,_sosType:Math.max(eb,e_)%2?w:b,_eosType:Math.max(eT,eS)%2?w:b})}}for(var eA=0;eA<eu.length;eA++){var eL=eu[eA],eR=eL._seqIndices,eP=eL._sosType,eC=eL._eosType,eI=1&s[eR[0]]?w:b;if(i.get(I))for(var eD=0;eD<eR.length;eD++){var eO=eR[eD];if(r[eO]&I){for(var eU=eP,eN=eD-1;eN>=0;eN--)if(!(r[eR[eN]]&c)){eU=r[eR[eN]];break}a(eO,eU&(l|G)?P:eU)}}if(i.get(M))for(var ek=0;ek<eR.length;ek++){var eF=eR[ek];if(r[eF]&M)for(var eB=ek-1;eB>=-1;eB--){var ez=-1===eB?eP:r[eR[eB]];if(ez&h){ez===D&&a(eF,E);break}}}if(i.get(D))for(var eH=0;eH<eR.length;eH++){var eG=eR[eH];r[eG]&D&&a(eG,w)}if(i.get(S)||i.get(A))for(var eV=1;eV<eR.length-1;eV++){var eW=eR[eV];if(r[eW]&(S|A)){for(var ej=0,eq=0,eX=eV-1;eX>=0&&(ej=r[eR[eX]])&c;eX--);for(var eY=eV+1;eY<eR.length&&(eq=r[eR[eY]])&c;eY++);ej===eq&&(r[eW]===S?ej===M:ej&(M|E))&&a(eW,ej)}}if(i.get(M)){for(var eZ=0;eZ<eR.length;eZ++)if(r[eR[eZ]]&M){for(var eJ=eZ-1;eJ>=0&&r[eR[eJ]]&(T|c);eJ--)a(eR[eJ],M);for(eZ++;eZ<eR.length&&r[eR[eZ]]&(T|c|M);eZ++)r[eR[eZ]]!==M&&a(eR[eZ],M)}}if(i.get(T)||i.get(S)||i.get(A))for(var eK=0;eK<eR.length;eK++){var eQ=eR[eK];if(r[eQ]&(T|S|A)){a(eQ,P);for(var e$=eK-1;e$>=0&&r[eR[e$]]&c;e$--)a(eR[e$],P);for(var e0=eK+1;e0<eR.length&&r[eR[e0]]&c;e0++)a(eR[e0],P)}}if(i.get(M))for(var e1=0,e2=eP;e1<eR.length;e1++){var e3=eR[e1],e4=r[e3];e4&M?e2===b&&a(e3,b):e4&h&&(e2=e4)}if(i.get(u)){for(var e5=w|M|E,e6=e5|b,e8=[],e7=[],e9=0;e9<eR.length;e9++)if(r[eR[e9]]&u){var te=e[eR[e9]],tt=void 0;if(null!==y(te)){if(e7.length<63)e7.push({char:te,seqIndex:e9});else break}else if(null!==(tt=x(te)))for(var tr=e7.length-1;tr>=0;tr--){var tn=e7[tr].char;if(tn===tt||tn===x(_(te))||y(_(tn))===te){e8.push([e7[tr].seqIndex,e9]),e7.length=tr;break}}}e8.sort(function(e,t){return e[0]-t[0]});for(var ti=0;ti<e8.length;ti++){for(var ta=e8[ti],ts=ta[0],to=ta[1],tl=!1,th=0,tu=ts+1;tu<to;tu++){var tc=eR[tu];if(r[tc]&e6){tl=!0;var td=r[tc]&e5?w:b;if(td===eI){th=td;break}}}if(tl&&!th){th=eP;for(var tp=ts-1;tp>=0;tp--){var tf=eR[tp];if(r[tf]&e6){var tm=r[tf]&e5?w:b;th=tm!==eI?tm:eI;break}}}if(th){if(r[eR[ts]]=r[eR[to]]=th,th!==eI){for(var tg=ts+1;tg<eR.length;tg++)if(!(r[eR[tg]]&c)){f(e[eR[tg]])&I&&(r[eR[tg]]=th);break}}if(th!==eI){for(var tv=to+1;tv<eR.length;tv++)if(!(r[eR[tv]]&c)){f(e[eR[tv]])&I&&(r[eR[tv]]=th);break}}}}for(var ty=0;ty<eR.length;ty++)if(r[eR[ty]]&u){for(var tx=ty,t_=ty,tb=eP,tw=ty-1;tw>=0;tw--)if(r[eR[tw]]&c)tx=tw;else{tb=r[eR[tw]]&e5?w:b;break}for(var tM=eC,tS=ty+1;tS<eR.length;tS++)if(r[eR[tS]]&(u|c))t_=tS;else{tM=r[eR[tS]]&e5?w:b;break}for(var tT=tx;tT<=t_;tT++)r[eR[tT]]=tb===tM?tb:eI;ty=t_}}}for(var tE=m.start;tE<=m.end;tE++){var tA=s[tE],tL=r[tE];if(1&tA?tL&(b|M|E)&&s[tE]++:tL&w?s[tE]++:tL&(E|M)&&(s[tE]+=2),tL&c&&(s[tE]=0===tE?m.level:s[tE-1]),tE===m.end||f(e[tE])&(R|L))for(var tR=tE;tR>=0&&f(e[tR])&d;tR--)s[tR]=m.level}}return{levels:s,paragraphs:p};function tP(t,n){for(var i=t;i<e.length;i++){var a=r[i];if(a&(w|D))return 1;if(a&(L|b)||n&&a===G)break;if(a&l){var s=function(t){for(var n=1,i=t+1;i<e.length;i++){var a=r[i];if(a&L)break;if(a&G){if(0==--n)return i}else a&l&&n++}return -1}(i);i=-1===s?e.length:s}}return 0}},e.getMirroredCharacter=V,e.getMirroredCharactersMap=function(e,t,r,n){var i=e.length;r=Math.max(0,null==r?0:+r),n=Math.min(i-1,null==n?i-1:+n);for(var a=new Map,s=r;s<=n;s++)if(1&t[s]){var o=V(e[s]);null!==o&&a.set(s,o)}return a},e.getReorderSegments=W,e.getReorderedIndices=j,e.getReorderedString=function(e,t,r,n){var i=j(e,t,r,n),a=[].concat(e);return i.forEach(function(r,n){a[n]=(1&t.levels[r]?V(e[r]):null)||e[r]}),a.join("")},e.openingToClosingBracket=y,Object.defineProperty(e,"__esModule",{value:!0}),e}({})}],init(e,t,r,n){let{defaultFontURL:i}=e;return r(t,n(),{defaultFontURL:i})}}),el=/*#__PURE__*/function(){let e={},t=0;return function(...r){let n="TroikaTextSDFGenerator_"+t++%4,i=e[n];return i||(i=e[n]={workerModule:F({name:n,workerId:n,dependencies:[en,et,ee],init(e,t,r){let{sdfExponent:n,sdfMargin:i}=e;return r(t,{sdfExponent:n,sdfMargin:i})},getTransferables:e=>[e.textureData.buffer]}),requests:0,idleTimer:null}),i.requests++,clearTimeout(i.idleTimer),i.workerModule(...r).then(e=>(0==--i.requests&&(i.idleTimer=setTimeout(()=>{N[n]&&N[n].forEach(function(e){e()}),U[n]&&(U[n].terminate(),delete U[n])},2e3)),e))}}(),eh=/*#__PURE__*/F({name:"Typesetter",dependencies:[eo,H],init:(e,t)=>function(r){let n=new t;return e.typeset(r,n.resolve),n},getTransferables(e){let t=[e.glyphPositions.buffer,e.glyphIds.buffer];return e.caretPositions&&t.push(e.caretPositions.buffer),t}}),eu=/*#__PURE__*/(()=>{let e={};new d.Vector3;let t="aTroikaGlyphIndex";class r extends d.InstancedBufferGeometry{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new d.Sphere,this.boundingBox=new d.Box3}computeBoundingSphere(){}computeBoundingBox(){}set detail(t){if(t!==this._detail){var r;let n;this._detail=t,("number"!=typeof t||t<1)&&(t=1);let i=((n=e[r=t])||(n=e[r]=new(0,d.PlaneBufferGeometry)(1,1,r,r).translate(.5,.5,0)),n);["position","normal","uv"].forEach(e=>{this.attributes[e]=i.attributes[e].clone()}),this.setIndex(i.getIndex().clone())}}get detail(){return this._detail}set curveRadius(e){e!==this._curveRadius&&(this._curveRadius=e,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(e,r,a,s,o){n(this,"aTroikaGlyphBounds",e,4),n(this,t,r,1),n(this,"aTroikaGlyphColor",o,3),this._blockBounds=a,this._chunkedBounds=s,i(this,r.length),this._updateBounds()}_updateBounds(){let e=this._blockBounds;if(e){let{curveRadius:t,boundingBox:r}=this;if(t){let{PI:n,floor:i,min:a,max:s,sin:o,cos:l}=Math,h=n/2,u=2*n,c=Math.abs(t),d=e[0]/c,p=e[2]/c,f=i((d+h)/u)!==i((p+h)/u)?-c:a(o(d)*c,o(p)*c),m=i((d-h)/u)!==i((p-h)/u)?c:s(o(d)*c,o(p)*c),g=i((d+n)/u)!==i((p+n)/u)?2*c:s(c-l(d)*c,c-l(p)*c);r.min.set(f,e[1],t<0?-g:0),r.max.set(m,e[3],t<0?0:g)}else r.min.set(e[0],e[1],0),r.max.set(e[2],e[3],0);r.getBoundingSphere(this.boundingSphere)}}applyClipRect(e){let r=this.getAttribute(t).count,n=this._chunkedBounds;if(n)for(let t=n.length;t--;){r=n[t].end;let i=n[t].rect;if(i[1]<e.w&&i[3]>e.y&&i[0]<e.z&&i[2]>e.x)break}i(this,r)}}function n(e,t,r,n){let i=e.getAttribute(t);r?i&&i.array.length===r.length?(i.array.set(r),i.needsUpdate=!0):(e.setAttribute(t,new d.InstancedBufferAttribute(r,n)),delete e._maxInstanceCount,e.dispose()):i&&e.deleteAttribute(t)}function i(e,t){e[e.hasOwnProperty("instanceCount")?"instanceCount":"maxInstancedCount"]=t}return r.prototype.setAttribute||(r.prototype.setAttribute=function(e,t){return this.attributes[e]=t,this}),r})(),ec=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaDistanceOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,ed=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaDistanceOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaDistanceOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,ep=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaDistanceOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaOutlineOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of encoding in SDFGenerator.js
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,ef=`
float aaDist = troikaGetAADist();
float distance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(distance, uTroikaDistanceOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  distance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`,em=/*#__PURE__*/(()=>{let t=new d.MeshBasicMaterial({color:16777215,side:d.DoubleSide,transparent:!0}),r=new d.Matrix4,n=new d.Vector3,i=new d.Vector3,a=[],s=new d.Vector3,o="+x+y";function l(e){return Array.isArray(e)?e[0]:e}let h=()=>{let e=new d.Mesh(new d.PlaneBufferGeometry(1,1),t);return h=()=>e,e},u=()=>{let e=new d.Mesh(new d.PlaneBufferGeometry(1,1,32,1),t);return u=()=>e,e},c={type:"syncstart"},p={type:"synccomplete"},f=["font","fontSize","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],m=f.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");class g extends d.Mesh{constructor(){super(new eu,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.fontSize=.1,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=8421504,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=o,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.debugSDF=!1}sync(t){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(t):(this._isSyncing=!0,this.dispatchEvent(c),function(t,r){var n;t=function(e,t){for(let r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}({},t);let i=ea();if(t.font=(n=t.font||en.defaultFontURL,e||(e="undefined"==typeof document?{}:document.createElement("a")),e.href=n,e.href),t.text=""+t.text,t.sdfGlyphSize=t.sdfGlyphSize||en.sdfGlyphSize,null!=t.colorRanges){let e={};for(let r in t.colorRanges)if(t.colorRanges.hasOwnProperty(r)){let n=t.colorRanges[r];"number"!=typeof n&&(n=ei.set(n).getHex()),e[r]=n}t.colorRanges=e}Object.freeze(t);let{textureWidth:a,sdfExponent:s}=en,{sdfGlyphSize:o}=t,l=`${t.font}@${o}`,h=es[l];h||((h=es[l]={count:0,glyphs:new Map,sdfTexture:new d.DataTexture(new Uint8Array(o*a*4),a,o,d.RGBAFormat,void 0,void 0,void 0,void 0,d.LinearFilter,d.LinearFilter)}).sdfTexture.font=t.font),eh(t).then(e=>{let{glyphIds:n,glyphPositions:a,fontSize:l,unitsPerEm:u,timings:c}=e,d=[],p=new Float32Array(4*n.length),f=l/u,m=0,g=0,v=ea();n.forEach((t,r)=>{let i=h.glyphs.get(t);if(!i){let{path:r,pathBounds:n}=e.glyphData[t],a=Math.max(n[2]-n[0],n[3]-n[1])/o*(en.sdfMargin*o+.5),s=h.count++,l=[n[0]-a,n[1]-a,n[2]+a,n[3]+a];h.glyphs.set(t,i={path:r,atlasIndex:s,sdfViewBox:l}),d.push(i)}let{sdfViewBox:s}=i,l=a[g++],u=a[g++];p[m++]=l+s[0]*f,p[m++]=u+s[1]*f,p[m++]=l+s[2]*f,p[m++]=u+s[3]*f,n[r]=i.atlasIndex}),c.quads=(c.quads||0)+(ea()-v);let y=ea();c.sdf={},R.all(d.map(({path:e,atlasIndex:t,sdfViewBox:r})=>{let n=Math.max(r[2]-r[0],r[3]-r[1]);return el(o,o,e,r,n,en.sdfExponent).then(({textureData:e,timing:r})=>(c.sdf[t]=r,{atlasIndex:t,textureData:e,timing:r}))})).then(a=>{a.length&&(a.forEach(({atlasIndex:e,textureData:t,timing:r})=>{let n=h.sdfTexture.image;for(;n.data.length<(e+1)*o*o;){let e=new Uint8Array(2*n.data.length);e.set(n.data),n.data=e,n.height*=2}let i=Math.floor(e/4),a=n.width/o,s=Math.floor(i/a)*n.width*o*4+i%a*o*4+e%4;for(let e=0;e<o;e++){let r=e*o,i=s+e*n.width*4;for(let e=0;e<o;e++)n.data[i+4*e]=t[r+e]}}),h.sdfTexture.needsUpdate=!0),c.sdfTotal=ea()-y,c.total=ea()-i,r(Object.freeze({parameters:t,sdfTexture:h.sdfTexture,sdfGlyphSize:o,sdfExponent:s,glyphBounds:p,glyphAtlasIndices:n,glyphColors:e.glyphColors,caretPositions:e.caretPositions,caretHeight:e.caretHeight,chunkedBounds:e.chunkedBounds,ascender:e.ascender,descender:e.descender,lineHeight:e.lineHeight,topBaseline:e.topBaseline,blockBounds:e.blockBounds,visibleBounds:e.visibleBounds,timings:e.timings,get totalBounds(){return console.log("totalBounds deprecated, use blockBounds instead"),e.blockBounds},get totalBlockSize(){console.log("totalBlockSize deprecated, use blockBounds instead");let[t,r,n,i]=e.blockBounds;return[n-t,i-r]}}))})})}({text:this.text,font:this.font,fontSize:this.fontSize||.1,letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize},e=>{this._isSyncing=!1,this._textRenderInfo=e,this.geometry.updateGlyphs(e.glyphBounds,e.glyphAtlasIndices,e.blockBounds,e.chunkedBounds,e.glyphColors);let r=this._queuedSyncs;r&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{r.forEach(e=>e&&e())})),this.dispatchEvent(p),t&&t()})))}onBeforeRender(e,t,r,n,i,a){this.sync(),i.isTroikaTextMaterial&&this._prepareForRender(i)}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}get material(){let e=this._derivedMaterial,r=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=t.clone());if(e&&e.baseMaterial===r||(e=this._derivedMaterial=function(e){let t=function e(t,r){let n=function(e){let t=JSON.stringify(e,K),r=$.get(t);return null==r&&$.set(t,r=++Q),r}(r),i=X.get(t);if(i||X.set(t,i=Object.create(null)),i[n])return new i[n];let a=`_onBeforeCompile${n}`,s=function(e){t.onBeforeCompile.call(this,e);let i=this.customProgramCacheKey()+"|"+e.vertexShader+"|"+e.fragmentShader,s=Y[i];if(!s){let t=function({vertexShader:e,fragmentShader:t},r,n){let{vertexDefs:i,vertexMainIntro:a,vertexMainOutro:s,vertexTransform:o,fragmentDefs:l,fragmentMainIntro:h,fragmentMainOutro:u,fragmentColorTransform:c,customRewriter:d,timeUniform:p}=r;if(i=i||"",a=a||"",s=s||"",l=l||"",h=h||"",u=u||"",(o||d)&&(e=V(e)),(c||d)&&(t=V(t=t.replace(/^[ \t]*#include <((?:tonemapping|encodings|fog|premultiplied_alpha|dithering)_fragment)>/gm,"\n//!BEGIN_POST_CHUNK $1\n$&\n//!END_POST_CHUNK\n"))),d){let r=d({vertexShader:e,fragmentShader:t});e=r.vertexShader,t=r.fragmentShader}if(c){let e=[];t=t.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,t=>(e.push(t),"")),u=`${c}
${e.join("\n")}
${u}`}if(p){let e=`
uniform float ${p};
`;i=e+i,l=e+l}return o&&(e=`vec3 troika_position_${n};
vec3 troika_normal_${n};
vec2 troika_uv_${n};
${e}
`,i=`${i}
void troikaVertexTransform${n}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${o}
}
`,a=`
troika_position_${n} = vec3(position);
troika_normal_${n} = vec3(normal);
troika_uv_${n} = vec2(uv);
troikaVertexTransform${n}(troika_position_${n}, troika_normal_${n}, troika_uv_${n});
${a}
`,e=e.replace(/\b(position|normal|uv)\b/g,(e,t,r,i)=>/\battribute\s+vec[23]\s+$/.test(i.substr(0,r))?t:`troika_${t}_${n}`)),{vertexShader:e=J(e,n,i,a,s),fragmentShader:t=J(t,n,l,h,u)}}(e,r,n);s=Y[i]=t}e.vertexShader=s.vertexShader,e.fragmentShader=s.fragmentShader,j(e.uniforms,this.uniforms),r.timeUniform&&(e.uniforms[r.timeUniform]={get value(){return Date.now()-q}}),this[a]&&this[a](e)},o=function(){return l(r.chained?t:t.clone())},l=function(e){let i=Object.create(e,h);return Object.defineProperty(i,"baseMaterial",{value:t}),Object.defineProperty(i,"id",{value:Z++}),i.uuid=function(){let e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,r=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(W[255&e]+W[e>>8&255]+W[e>>16&255]+W[e>>24&255]+"-"+W[255&t]+W[t>>8&255]+"-"+W[t>>16&15|64]+W[t>>24&255]+"-"+W[63&r|128]+W[r>>8&255]+"-"+W[r>>16&255]+W[r>>24&255]+W[255&n]+W[n>>8&255]+W[n>>16&255]+W[n>>24&255]).toUpperCase()}(),i.uniforms=j({},e.uniforms,r.uniforms),i.defines=j({},e.defines,r.defines),i.defines[`TROIKA_DERIVED_MATERIAL_${n}`]="",i.extensions=j({},e.extensions,r.extensions),i._listeners=void 0,i},h={constructor:{value:o},isDerivedMaterial:{value:!0},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return n}},onBeforeCompile:{get:()=>s,set(e){this[a]=e}},copy:{writable:!0,configurable:!0,value:function(e){return t.copy.call(this,e),t.isShaderMaterial||t.isDerivedMaterial||(j(this.extensions,e.extensions),j(this.defines,e.defines),j(this.uniforms,(0,d.UniformsUtils).clone(e.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){return l(new t.constructor).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let n=this._depthMaterial;return n||((n=this._depthMaterial=e(t.isDerivedMaterial?t.getDepthMaterial():new d.MeshDepthMaterial({depthPacking:d.RGBADepthPacking}),r)).defines.IS_DEPTH_MATERIAL="",n.uniforms=this.uniforms),n}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let n=this._distanceMaterial;return n||((n=this._distanceMaterial=e(t.isDerivedMaterial?t.getDistanceMaterial():new d.MeshDistanceMaterial,r)).defines.IS_DISTANCE_MATERIAL="",n.uniforms=this.uniforms),n}},dispose:{writable:!0,configurable:!0,value(){let{_depthMaterial:e,_distanceMaterial:r}=this;e&&e.dispose(),r&&r.dispose(),t.dispose.call(this)}}};return i[n]=o,new o}(e,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new d.Vector2},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new d.Vector4(0,0,0,0)},uTroikaClipRect:{value:new d.Vector4(0,0,0,0)},uTroikaDistanceOffset:{value:0},uTroikaOutlineOpacity:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new d.Vector2},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new d.Color},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new d.Matrix3},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:ec,vertexTransform:ed,fragmentDefs:ep,fragmentColorTransform:ef,customRewriter({vertexShader:e,fragmentShader:t}){let r=/\buniform\s+vec3\s+diffuse\b/;return r.test(t)&&(t=t.replace(r,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),r.test(e)||(e=e.replace(G,"uniform vec3 diffuse;\n$&\nvTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;\n"))),{vertexShader:e,fragmentShader:t}}});return t.transparent=!0,Object.defineProperties(t,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),t}(r),r.addEventListener("dispose",function t(){r.removeEventListener("dispose",t),e.dispose()})),!this.outlineWidth&&!this.outlineBlur&&!this.outlineOffsetX&&!this.outlineOffsetY)return e;{let t=e._outlineMtl;return t||((t=e._outlineMtl=Object.create(e,{id:{value:e.id+.1}})).isTextOutlineMaterial=!0,t.depthWrite=!1,t.map=null,e.addEventListener("dispose",function r(){e.removeEventListener("dispose",r),t.dispose()})),[t,e]}}set material(e){e&&e.isTroikaTextMaterial?(this._derivedMaterial=e,this._baseMaterial=e.baseMaterial):this._baseMaterial=e}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(e){this.geometry.detail=e}get curveRadius(){return this.geometry.curveRadius}set curveRadius(e){this.geometry.curveRadius=e}get customDepthMaterial(){return l(this.material).getDepthMaterial()}get customDistanceMaterial(){return l(this.material).getDistanceMaterial()}_prepareForRender(e){let t=e.isTextOutlineMaterial,a=e.uniforms,l=this.textRenderInfo;if(l){let e,r,n;let{sdfTexture:i,blockBounds:s}=l;a.uTroikaSDFTexture.value=i,a.uTroikaSDFTextureSize.value.set(i.image.width,i.image.height),a.uTroikaSDFGlyphSize.value=l.sdfGlyphSize,a.uTroikaSDFExponent.value=l.sdfExponent,a.uTroikaTotalBounds.value.fromArray(s),a.uTroikaUseGlyphColors.value=!t&&!!l.glyphColors;let o=0,h=0,u=0,c=0,d=0;if(t){let{outlineWidth:t,outlineOffsetX:r,outlineOffsetY:n,outlineBlur:i,outlineOpacity:a}=this;o=this._parsePercent(t)||0,h=Math.max(0,this._parsePercent(i)||0),e=a,c=this._parsePercent(r)||0,d=this._parsePercent(n)||0}else(u=Math.max(0,this._parsePercent(this.strokeWidth)||0))&&(n=this.strokeColor,a.uTroikaStrokeColor.value.set(null==n?8421504:n),null==(r=this.strokeOpacity)&&(r=1)),e=this.fillOpacity;a.uTroikaDistanceOffset.value=o,a.uTroikaPositionOffset.value.set(c,d),a.uTroikaBlurRadius.value=h,a.uTroikaStrokeWidth.value=u,a.uTroikaStrokeOpacity.value=r,a.uTroikaFillOpacity.value=null==e?1:e,a.uTroikaCurveRadius.value=this.curveRadius||0;let p=this.clipRect;if(p&&Array.isArray(p)&&4===p.length)a.uTroikaClipRect.value.fromArray(p);else{let e=100*(this.fontSize||.1);a.uTroikaClipRect.value.set(s[0]-e,s[1]-e,s[2]+e,s[3]+e)}this.geometry.applyClipRect(a.uTroikaClipRect.value)}a.uTroikaSDFDebug.value=!!this.debugSDF,e.polygonOffset=!!this.depthOffset,e.polygonOffsetFactor=e.polygonOffsetUnits=this.depthOffset||0;let h=t?this.outlineColor||0:this.color;if(null==h)delete e.color;else{let t=e.hasOwnProperty("color")?e.color:e.color=new d.Color;(h!==t._input||"object"==typeof h)&&t.set(t._input=h)}let u=this.orientation||o;if(u!==e._orientation){let t=a.uTroikaOrient.value,l=(u=u.replace(/[^-+xyz]/g,""))!==o&&u.match(/^([-+])([xyz])([-+])([xyz])$/);if(l){let[,e,a,o,h]=l;n.set(0,0,0)[a]="-"===e?1:-1,i.set(0,0,0)[h]="-"===o?-1:1,r.lookAt(s,n.cross(i),i),t.setFromMatrix4(r)}else t.identity();e._orientation=u}}_parsePercent(e){if("string"==typeof e){let t=e.match(/^(-?[\d.]+)%$/),r=t?parseFloat(t[1]):NaN;e=(isNaN(r)?0:r/100)*this.fontSize}return e}localPositionToTextCoords(e,t=new d.Vector2){t.copy(e);let r=this.curveRadius;return r&&(t.x=Math.atan2(e.x,Math.abs(r)-Math.abs(e.z))*Math.abs(r)),t}worldPositionToTextCoords(e,t=new d.Vector2){return n.copy(e),this.localPositionToTextCoords(this.worldToLocal(n),t)}raycast(e,t){let{textRenderInfo:r,curveRadius:n}=this;if(r){let i=r.blockBounds,s=n?u():h(),o=s.geometry,{position:l,uv:c}=o.attributes;for(let e=0;e<c.count;e++){let t=i[0]+c.getX(e)*(i[2]-i[0]),r=i[1]+c.getY(e)*(i[3]-i[1]),a=0;n&&(a=n-Math.cos(t/n)*n,t=Math.sin(t/n)*n),l.setXYZ(e,t,r,a)}o.boundingSphere=this.geometry.boundingSphere,o.boundingBox=this.geometry.boundingBox,s.matrixWorld=this.matrixWorld,s.material.side=this.material.side,a.length=0,s.raycast(e,a);for(let e=0;e<a.length;e++)a[e].object=this,t.push(a[e])}}copy(e){let t=this.geometry;return super.copy(e),this.geometry=t,m.forEach(t=>{this[t]=e[t]}),this}clone(){return new this.constructor().copy(this)}}f.forEach(e=>{let t="_private_"+e;Object.defineProperty(g.prototype,e,{get(){return this[t]},set(e){e!==this[t]&&(this[t]=e,this._needsSync=!0)}})});let v=!1;return Object.defineProperty(g.prototype,"anchor",{get(){return this._deprecated_anchor},set(e){this._deprecated_anchor=e,v||(console.warn("TextMesh: `anchor` has been deprecated; use `anchorX` and `anchorY` instead."),v=!0),Array.isArray(e)?(this.anchorX=`${100*(+e[0]||0)}%`,this.anchorY=`${100*(+e[1]||0)}%`):this.anchorX=this.anchorY=0}}),g})();new WeakMap,new WeakMap;/*!
 * CSSPlugin 3.12.5
 * https://gsap.com
 *
 * Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var eg,ev,ey,ex,e_,eb,ew,eM,eS,eT,eE=(u("2Tywo"),u("2Tywo")),eA={},eL=180/Math.PI,eR=Math.PI/180,eP=Math.atan2,eC=/([A-Z])/g,eI=/(left|right|width|margin|padding|x)/i,eD=/[\s,\(]\S/,eO={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},eU=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},eN=function(e,t){return t.set(t.t,t.p,1===e?t.e:Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},ek=function(e,t){return t.set(t.t,t.p,e?Math.round((t.s+t.c*e)*1e4)/1e4+t.u:t.b,t)},eF=function(e,t){var r=t.s+t.c*e;t.set(t.t,t.p,~~(r+(r<0?-.5:.5))+t.u,t)},eB=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},ez=function(e,t){return t.set(t.t,t.p,1!==e?t.b:t.e,t)},eH=function(e,t,r){return e.style[t]=r},eG=function(e,t,r){return e.style.setProperty(t,r)},eV=function(e,t,r){return e._gsap[t]=r},eW=function(e,t,r){return e._gsap.scaleX=e._gsap.scaleY=r},ej=function(e,t,r,n,i){var a=e._gsap;a.scaleX=a.scaleY=r,a.renderTransform(i,a)},eq=function(e,t,r,n,i){var a=e._gsap;a[t]=r,a.renderTransform(i,a)},eX="transform",eY=eX+"Origin",eZ=function e(t,r){var n=this,i=this.target,a=i.style,s=i._gsap;if(t in eA&&a){if(this.tfm=this.tfm||{},"transform"===t)return eO.transform.split(",").forEach(function(t){return e.call(n,t,r)});if(~(t=eO[t]||t).indexOf(",")?t.split(",").forEach(function(e){return n.tfm[e]=tn(i,e)}):this.tfm[t]=s.x?s[t]:tn(i,t),t===eY&&(this.tfm.zOrigin=s.zOrigin),this.props.indexOf(eX)>=0)return;s.svg&&(this.svgo=i.getAttribute("data-svg-origin"),this.props.push(eY,r,"")),t=eX}(a||r)&&this.props.push(t,r,a[t])},eJ=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},eK=function(){var e,t,r=this.props,n=this.target,i=n.style,a=n._gsap;for(e=0;e<r.length;e+=3)r[e+1]?n[r[e]]=r[e+2]:r[e+2]?i[r[e]]=r[e+2]:i.removeProperty("--"===r[e].substr(0,2)?r[e]:r[e].replace(eC,"-$1").toLowerCase());if(this.tfm){for(t in this.tfm)a[t]=this.tfm[t];a.svg&&(a.renderTransform(),n.setAttribute("data-svg-origin",this.svgo||"")),(e=eS())&&e.isStart||i[eX]||(eJ(i),a.zOrigin&&i[eY]&&(i[eY]+=" "+a.zOrigin+"px",a.zOrigin=0,a.renderTransform()),a.uncache=1)}},eQ=function(e,t){var r={target:e,props:[],revert:eK,save:eZ};return e._gsap||(0,eE.gsap).core.getCache(e),t&&t.split(",").forEach(function(e){return r.save(e)}),r},e$=function(e,t){var r=ex.createElementNS?ex.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):ex.createElement(e);return r&&r.style?r:ex.createElement(e)},e0=function e(t,r,n){var i=getComputedStyle(t);return i[r]||i.getPropertyValue(r.replace(eC,"-$1").toLowerCase())||i.getPropertyValue(r)||!n&&e(t,e2(r)||r,1)||""},e1="O,Moz,ms,Ms,Webkit".split(","),e2=function(e,t,r){var n=(t||ew).style,i=5;if(e in n&&!r)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);i--&&!(e1[i]+e in n););return i<0?null:(3===i?"ms":i>=0?e1[i]:"")+e},e3=function(){"undefined"!=typeof window&&window.document&&(e_=(ex=window.document).documentElement,ew=e$("div")||{style:{}},e$("div"),eY=(eX=e2(eX))+"Origin",ew.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",eT=!!e2("perspective"),eS=eE.gsap.core.reverting,eb=1)},e4=function e(t){var r,n=e$("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),i=this.parentNode,a=this.nextSibling,s=this.style.cssText;if(e_.appendChild(n),n.appendChild(this),this.style.display="block",t)try{r=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=e}catch(e){}else this._gsapBBox&&(r=this._gsapBBox());return i&&(a?i.insertBefore(this,a):i.appendChild(this)),e_.removeChild(n),this.style.cssText=s,r},e5=function(e,t){for(var r=t.length;r--;)if(e.hasAttribute(t[r]))return e.getAttribute(t[r])},e6=function(e){var t;try{t=e.getBBox()}catch(r){t=e4.call(e,!0)}return t&&(t.width||t.height)||e.getBBox===e4||(t=e4.call(e,!0)),!t||t.width||t.x||t.y?t:{x:+e5(e,["x","cx","x1"])||0,y:+e5(e,["y","cy","y1"])||0,width:0,height:0}},e8=function(e){return!!(e.getCTM&&(!e.parentNode||e.ownerSVGElement)&&e6(e))},e7=function(e,t){if(t){var r,n=e.style;t in eA&&t!==eY&&(t=eX),n.removeProperty?(("ms"===(r=t.substr(0,2))||"webkit"===t.substr(0,6))&&(t="-"+t),n.removeProperty("--"===r?t:t.replace(eC,"-$1").toLowerCase())):n.removeAttribute(t)}},e9=function(e,t,r,n,i,a){var s=new eE.PropTween(e._pt,t,r,0,1,a?ez:eB);return e._pt=s,s.b=n,s.e=i,e._props.push(r),s},te={deg:1,rad:1,turn:1},tt={grid:1,flex:1},tr=function e(t,r,n,i){var a,s,o,l,h=parseFloat(n)||0,u=(n+"").trim().substr((h+"").length)||"px",c=ew.style,d=eI.test(r),p="svg"===t.tagName.toLowerCase(),f=(p?"client":"offset")+(d?"Width":"Height"),m="px"===i,g="%"===i;if(i===u||!h||te[i]||te[u])return h;if("px"===u||m||(h=e(t,r,n,"px")),l=t.getCTM&&e8(t),(g||"%"===u)&&(eA[r]||~r.indexOf("adius")))return a=l?t.getBBox()[d?"width":"height"]:t[f],(0,eE._round)(g?h/a*100:h/100*a);if(c[d?"width":"height"]=100+(m?u:i),s=~r.indexOf("adius")||"em"===i&&t.appendChild&&!p?t:t.parentNode,l&&(s=(t.ownerSVGElement||{}).parentNode),s&&s!==ex&&s.appendChild||(s=ex.body),(o=s._gsap)&&g&&o.width&&d&&o.time===eE._ticker.time&&!o.uncache)return(0,eE._round)(h/o.width*100);if(g&&("height"===r||"width"===r)){var v=t.style[r];t.style[r]=100+i,a=t[f],v?t.style[r]=v:e7(t,r)}else(g||"%"===u)&&!tt[e0(s,"display")]&&(c.position=e0(t,"position")),s===t&&(c.position="static"),s.appendChild(ew),a=ew[f],s.removeChild(ew),c.position="absolute";return d&&g&&((o=(0,eE._getCache)(s)).time=eE._ticker.time,o.width=s[f]),(0,eE._round)(m?a*h/100:a&&h?100/a*h:0)},tn=function(e,t,r,n){var i;return eb||e3(),t in eO&&"transform"!==t&&~(t=eO[t]).indexOf(",")&&(t=t.split(",")[0]),eA[t]&&"transform"!==t?(i=tm(e,n),i="transformOrigin"!==t?i[t]:i.svg?i.origin:tg(e0(e,eY))+" "+i.zOrigin+"px"):(!(i=e.style[t])||"auto"===i||n||~(i+"").indexOf("calc("))&&(i=tl[t]&&tl[t](e,t,r)||e0(e,t)||(0,eE._getProperty)(e,t)||("opacity"===t?1:0)),r&&!~(i+"").trim().indexOf(" ")?tr(e,t,i,r)+r:i},ti=function(e,t,r,n){if(!r||"none"===r){var i=e2(t,e,1),a=i&&e0(e,i,1);a&&a!==r?(t=i,r=a):"borderColor"===t&&(r=e0(e,"borderTopColor"))}var s,o,l,h,u,c,d,p,f,m,g,v=new eE.PropTween(this._pt,e.style,t,0,1,eE._renderComplexString),y=0,x=0;if(v.b=r,v.e=n,r+="","auto"==(n+="")&&(c=e.style[t],e.style[t]=n,n=e0(e,t)||n,c?e.style[t]=c:e7(e,t)),s=[r,n],(0,eE._colorStringFilter)(s),r=s[0],n=s[1],l=r.match(eE._numWithUnitExp)||[],(n.match(eE._numWithUnitExp)||[]).length){for(;o=(0,eE._numWithUnitExp).exec(n);)d=o[0],f=n.substring(y,o.index),u?u=(u+1)%5:("rgba("===f.substr(-5)||"hsla("===f.substr(-5))&&(u=1),d!==(c=l[x++]||"")&&(h=parseFloat(c)||0,g=c.substr((h+"").length),"="===d.charAt(1)&&(d=(0,eE._parseRelative)(h,d)+g),p=parseFloat(d),m=d.substr((p+"").length),y=eE._numWithUnitExp.lastIndex-m.length,m||(m=m||eE._config.units[t]||g,y!==n.length||(n+=m,v.e+=m)),g!==m&&(h=tr(e,t,c,m)||0),v._pt={_next:v._pt,p:f||1===x?f:",",s:h,c:p-h,m:u&&u<4||"zIndex"===t?Math.round:0});v.c=y<n.length?n.substring(y,n.length):""}else v.r="display"===t&&"none"===n?ez:eB;return(0,eE._relExp).test(n)&&(v.e=0),this._pt=v,v},ta={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},ts=function(e){var t=e.split(" "),r=t[0],n=t[1]||"50%";return("top"===r||"bottom"===r||"left"===n||"right"===n)&&(e=r,r=n,n=e),t[0]=ta[r]||r,t[1]=ta[n]||n,t.join(" ")},to=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var r,n,i,a=t.t,s=a.style,o=t.u,l=a._gsap;if("all"===o||!0===o)s.cssText="",n=1;else for(i=(o=o.split(",")).length;--i>-1;)eA[r=o[i]]&&(n=1,r="transformOrigin"===r?eY:eX),e7(a,r);n&&(e7(a,eX),l&&(l.svg&&a.removeAttribute("transform"),tm(a,1),l.uncache=1,eJ(s)))}},tl={clearProps:function(e,t,r,n,i){if("isFromStart"!==i.data){var a=e._pt=new eE.PropTween(e._pt,t,r,0,0,to);return a.u=n,a.pr=-10,a.tween=i,e._props.push(r),1}}},th=[1,0,0,1,0,0],tu={},tc=function(e){return"matrix(1, 0, 0, 1, 0, 0)"===e||"none"===e||!e},td=function(e){var t=e0(e,eX);return tc(t)?th:t.substr(7).match(eE._numExp).map(eE._round)},tp=function(e,t){var r,n,i,a,s=e._gsap||(0,eE._getCache)(e),o=e.style,l=td(e);return s.svg&&e.getAttribute("transform")?"1,0,0,1,0,0"===(l=[(i=e.transform.baseVal.consolidate().matrix).a,i.b,i.c,i.d,i.e,i.f]).join(",")?th:l:(l!==th||e.offsetParent||e===e_||s.svg||(i=o.display,o.display="block",(r=e.parentNode)&&e.offsetParent||(a=1,n=e.nextElementSibling,e_.appendChild(e)),l=td(e),i?o.display=i:e7(e,"display"),a&&(n?r.insertBefore(e,n):r?r.appendChild(e):e_.removeChild(e))),t&&l.length>6?[l[0],l[1],l[4],l[5],l[12],l[13]]:l)},tf=function(e,t,r,n,i,a){var s,o,l,h,u=e._gsap,c=i||tp(e,!0),d=u.xOrigin||0,p=u.yOrigin||0,f=u.xOffset||0,m=u.yOffset||0,g=c[0],v=c[1],y=c[2],x=c[3],_=c[4],b=c[5],w=t.split(" "),M=parseFloat(w[0])||0,S=parseFloat(w[1])||0;r?c!==th&&(o=g*x-v*y)&&(l=x/o*M+-y/o*S+(y*b-x*_)/o,h=-v/o*M+g/o*S-(g*b-v*_)/o,M=l,S=h):(M=(s=e6(e)).x+(~w[0].indexOf("%")?M/100*s.width:M),S=s.y+(~(w[1]||w[0]).indexOf("%")?S/100*s.height:S)),n||!1!==n&&u.smooth?(_=M-d,b=S-p,u.xOffset=f+(_*g+b*y)-_,u.yOffset=m+(_*v+b*x)-b):u.xOffset=u.yOffset=0,u.xOrigin=M,u.yOrigin=S,u.smooth=!!n,u.origin=t,u.originIsAbsolute=!!r,e.style[eY]="0px 0px",a&&(e9(a,u,"xOrigin",d,M),e9(a,u,"yOrigin",p,S),e9(a,u,"xOffset",f,u.xOffset),e9(a,u,"yOffset",m,u.yOffset)),e.setAttribute("data-svg-origin",M+" "+S)},tm=function(e,t){var r=e._gsap||new eE.GSCache(e);if("x"in r&&!t&&!r.uncache)return r;var n,i,a,s,o,l,h,u,c,d,p,f,m,g,v,y,x,_,b,w,M,S,T,E,A,L,R,P,C,I,D,O,U=e.style,N=r.scaleX<0,k=getComputedStyle(e),F=e0(e,eY)||"0";return n=i=a=l=h=u=c=d=p=0,s=o=1,r.svg=!!(e.getCTM&&e8(e)),k.translate&&(("none"!==k.translate||"none"!==k.scale||"none"!==k.rotate)&&(U[eX]=("none"!==k.translate?"translate3d("+(k.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+("none"!==k.rotate?"rotate("+k.rotate+") ":"")+("none"!==k.scale?"scale("+k.scale.split(" ").join(",")+") ":"")+("none"!==k[eX]?k[eX]:"")),U.scale=U.rotate=U.translate="none"),g=tp(e,r.svg),r.svg&&(r.uncache?(A=e.getBBox(),F=r.xOrigin-A.x+"px "+(r.yOrigin-A.y)+"px",E=""):E=!t&&e.getAttribute("data-svg-origin"),tf(e,E||F,!!E||r.originIsAbsolute,!1!==r.smooth,g)),f=r.xOrigin||0,m=r.yOrigin||0,g!==th&&(_=g[0],b=g[1],w=g[2],M=g[3],n=S=g[4],i=T=g[5],6===g.length?(s=Math.sqrt(_*_+b*b),o=Math.sqrt(M*M+w*w),l=_||b?eP(b,_)*eL:0,(c=w||M?eP(w,M)*eL+l:0)&&(o*=Math.abs(Math.cos(c*eR))),r.svg&&(n-=f-(f*_+m*w),i-=m-(f*b+m*M))):(O=g[6],I=g[7],R=g[8],P=g[9],C=g[10],D=g[11],n=g[12],i=g[13],a=g[14],h=(v=eP(O,C))*eL,v&&(E=S*(y=Math.cos(-v))+R*(x=Math.sin(-v)),A=T*y+P*x,L=O*y+C*x,R=-(S*x)+R*y,P=-(T*x)+P*y,C=-(O*x)+C*y,D=-(I*x)+D*y,S=E,T=A,O=L),u=(v=eP(-w,C))*eL,v&&(E=_*(y=Math.cos(-v))-R*(x=Math.sin(-v)),A=b*y-P*x,L=w*y-C*x,D=M*x+D*y,_=E,b=A,w=L),l=(v=eP(b,_))*eL,v&&(E=_*(y=Math.cos(v))+b*(x=Math.sin(v)),A=S*y+T*x,b=b*y-_*x,T=T*y-S*x,_=E,S=A),h&&Math.abs(h)+Math.abs(l)>359.9&&(h=l=0,u=180-u),s=(0,eE._round)(Math.sqrt(_*_+b*b+w*w)),o=(0,eE._round)(Math.sqrt(T*T+O*O)),c=Math.abs(v=eP(S,T))>2e-4?v*eL:0,p=D?1/(D<0?-D:D):0),r.svg&&(E=e.getAttribute("transform"),r.forceCSS=e.setAttribute("transform","")||!tc(e0(e,eX)),E&&e.setAttribute("transform",E))),Math.abs(c)>90&&270>Math.abs(c)&&(N?(s*=-1,c+=l<=0?180:-180,l+=l<=0?180:-180):(o*=-1,c+=c<=0?180:-180)),t=t||r.uncache,r.x=n-((r.xPercent=n&&(!t&&r.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-n)?-50:0)))?e.offsetWidth*r.xPercent/100:0)+"px",r.y=i-((r.yPercent=i&&(!t&&r.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-i)?-50:0)))?e.offsetHeight*r.yPercent/100:0)+"px",r.z=a+"px",r.scaleX=(0,eE._round)(s),r.scaleY=(0,eE._round)(o),r.rotation=(0,eE._round)(l)+"deg",r.rotationX=(0,eE._round)(h)+"deg",r.rotationY=(0,eE._round)(u)+"deg",r.skewX=c+"deg",r.skewY=d+"deg",r.transformPerspective=p+"px",(r.zOrigin=parseFloat(F.split(" ")[2])||!t&&r.zOrigin||0)&&(U[eY]=tg(F)),r.xOffset=r.yOffset=0,r.force3D=eE._config.force3D,r.renderTransform=r.svg?tb:eT?t_:ty,r.uncache=0,r},tg=function(e){return(e=e.split(" "))[0]+" "+e[1]},tv=function(e,t,r){var n=(0,eE.getUnit)(t);return(0,eE._round)(parseFloat(t)+parseFloat(tr(e,"x",r+"px",n)))+n},ty=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,t_(e,t)},tx="0deg",t_=function(e,t){var r=t||this,n=r.xPercent,i=r.yPercent,a=r.x,s=r.y,o=r.z,l=r.rotation,h=r.rotationY,u=r.rotationX,c=r.skewX,d=r.skewY,p=r.scaleX,f=r.scaleY,m=r.transformPerspective,g=r.force3D,v=r.target,y=r.zOrigin,x="",_="auto"===g&&e&&1!==e||!0===g;if(y&&(u!==tx||h!==tx)){var b,w=parseFloat(h)*eR,M=Math.sin(w),S=Math.cos(w);a=tv(v,a,-(M*(b=Math.cos(w=parseFloat(u)*eR))*y)),s=tv(v,s,-(-Math.sin(w)*y)),o=tv(v,o,-(S*b*y)+y)}"0px"!==m&&(x+="perspective("+m+") "),(n||i)&&(x+="translate("+n+"%, "+i+"%) "),(_||"0px"!==a||"0px"!==s||"0px"!==o)&&(x+="0px"!==o||_?"translate3d("+a+", "+s+", "+o+") ":"translate("+a+", "+s+") "),l!==tx&&(x+="rotate("+l+") "),h!==tx&&(x+="rotateY("+h+") "),u!==tx&&(x+="rotateX("+u+") "),(c!==tx||d!==tx)&&(x+="skew("+c+", "+d+") "),(1!==p||1!==f)&&(x+="scale("+p+", "+f+") "),v.style[eX]=x||"translate(0, 0)"},tb=function(e,t){var r,n,i,a,s,o=t||this,l=o.xPercent,h=o.yPercent,u=o.x,c=o.y,d=o.rotation,p=o.skewX,f=o.skewY,m=o.scaleX,g=o.scaleY,v=o.target,y=o.xOrigin,x=o.yOrigin,_=o.xOffset,b=o.yOffset,w=o.forceCSS,M=parseFloat(u),S=parseFloat(c);d=parseFloat(d),p=parseFloat(p),(f=parseFloat(f))&&(p+=f=parseFloat(f),d+=f),d||p?(d*=eR,p*=eR,r=Math.cos(d)*m,n=Math.sin(d)*m,i=-(Math.sin(d-p)*g),a=Math.cos(d-p)*g,p&&(f*=eR,i*=s=Math.sqrt(1+(s=Math.tan(p-f))*s),a*=s,f&&(r*=s=Math.sqrt(1+(s=Math.tan(f))*s),n*=s)),r=(0,eE._round)(r),n=(0,eE._round)(n),i=(0,eE._round)(i),a=(0,eE._round)(a)):(r=m,a=g,n=i=0),(M&&!~(u+"").indexOf("px")||S&&!~(c+"").indexOf("px"))&&(M=tr(v,"x",u,"px"),S=tr(v,"y",c,"px")),(y||x||_||b)&&(M=(0,eE._round)(M+y-(y*r+x*i)+_),S=(0,eE._round)(S+x-(y*n+x*a)+b)),(l||h)&&(s=v.getBBox(),M=(0,eE._round)(M+l/100*s.width),S=(0,eE._round)(S+h/100*s.height)),s="matrix("+r+","+n+","+i+","+a+","+M+","+S+")",v.setAttribute("transform",s),w&&(v.style[eX]=s)},tw=function(e,t,r,n,i){var a,s,o=(0,eE._isString)(i),l=parseFloat(i)*(o&&~i.indexOf("rad")?eL:1)-n,h=n+l+"deg";return o&&("short"===(a=i.split("_")[1])&&(l%=360)!=l%180&&(l+=l<0?360:-360),"cw"===a&&l<0?l=(l+36e9)%360-360*~~(l/360):"ccw"===a&&l>0&&(l=(l-36e9)%360-360*~~(l/360))),e._pt=s=new eE.PropTween(e._pt,t,r,n,l,eN),s.e=h,s.u="deg",e._props.push(r),s},tM=function(e,t){for(var r in t)e[r]=t[r];return e},tS=function(e,t,r){var n,i,a,s,o,l,h,u=tM({},r._gsap),c=r.style;for(i in u.svg?(a=r.getAttribute("transform"),r.setAttribute("transform",""),c[eX]=t,n=tm(r,1),e7(r,eX),r.setAttribute("transform",a)):(a=getComputedStyle(r)[eX],c[eX]=t,n=tm(r,1),c[eX]=a),eA)(a=u[i])!==(s=n[i])&&0>"perspective,force3D,transformOrigin,svgOrigin".indexOf(i)&&(o=(0,eE.getUnit)(a)!==(h=(0,eE.getUnit)(s))?tr(r,i,a,h):parseFloat(a),l=parseFloat(s),e._pt=new eE.PropTween(e._pt,n,i,o,l-o,eU),e._pt.u=h||0,e._props.push(i));tM(n,u)};(0,eE._forEachName)("padding,margin,Width,Radius",function(e,t){var r="Right",n="Bottom",i="Left",a=(t<3?["Top",r,n,i]:["Top"+i,"Top"+r,n+r,n+i]).map(function(r){return t<2?e+r:"border"+r+e});tl[t>1?"border"+e:e]=function(e,t,r,n,i){var s,o;if(arguments.length<4)return 5===(o=(s=a.map(function(t){return tn(e,t,r)})).join(" ")).split(s[0]).length?s[0]:o;s=(n+"").split(" "),o={},a.forEach(function(e,t){return o[e]=s[t]=s[t]||s[(t-1)/2|0]}),e.init(t,o,i)}});var tT={name:"css",register:e3,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,r,n,i){var a,s,o,l,h,u,c,d,p,f,m,g,v,y,x,_,b=this._props,w=e.style,M=r.vars.startAt;for(c in eb||e3(),this.styles=this.styles||eQ(e),_=this.styles.props,this.tween=r,t)if("autoRound"!==c&&(s=t[c],!(eE._plugins[c]&&(0,eE._checkPlugin)(c,t,r,n,e,i)))){if(h=typeof s,u=tl[c],"function"===h&&(h=typeof(s=s.call(r,n,e,i))),"string"===h&&~s.indexOf("random(")&&(s=(0,eE._replaceRandom)(s)),u)u(this,e,c,s,r)&&(x=1);else if("--"===c.substr(0,2))a=(getComputedStyle(e).getPropertyValue(c)+"").trim(),s+="",eE._colorExp.lastIndex=0,(0,eE._colorExp).test(a)||(d=(0,eE.getUnit)(a),p=(0,eE.getUnit)(s)),p?d!==p&&(a=tr(e,c,a,p)+p):d&&(s+=d),this.add(w,"setProperty",a,s,n,i,0,0,c),b.push(c),_.push(c,0,w[c]);else if("undefined"!==h){if(M&&c in M?(a="function"==typeof M[c]?M[c].call(r,n,e,i):M[c],(0,eE._isString)(a)&&~a.indexOf("random(")&&(a=(0,eE._replaceRandom)(a)),(0,eE.getUnit)(a+"")||"auto"===a||(a+=eE._config.units[c]||(0,eE.getUnit)(tn(e,c))||""),"="===(a+"").charAt(1)&&(a=tn(e,c))):a=tn(e,c),l=parseFloat(a),(f="string"===h&&"="===s.charAt(1)&&s.substr(0,2))&&(s=s.substr(2)),o=parseFloat(s),c in eO&&("autoAlpha"===c&&(1===l&&"hidden"===tn(e,"visibility")&&o&&(l=0),_.push("visibility",0,w.visibility),e9(this,w,"visibility",l?"inherit":"hidden",o?"inherit":"hidden",!o)),"scale"!==c&&"transform"!==c&&~(c=eO[c]).indexOf(",")&&(c=c.split(",")[0])),m=c in eA){if(this.styles.save(c),g||((v=e._gsap).renderTransform&&!t.parseTransform||tm(e,t.parseTransform),y=!1!==t.smoothOrigin&&v.smooth,(g=this._pt=new eE.PropTween(this._pt,w,eX,0,1,v.renderTransform,v,0,-1)).dep=1),"scale"===c)this._pt=new eE.PropTween(this._pt,v,"scaleY",v.scaleY,(f?(0,eE._parseRelative)(v.scaleY,f+o):o)-v.scaleY||0,eU),this._pt.u=0,b.push("scaleY",c),c+="X";else if("transformOrigin"===c){_.push(eY,0,w[eY]),s=ts(s),v.svg?tf(e,s,0,y,0,this):((p=parseFloat(s.split(" ")[2])||0)!==v.zOrigin&&e9(this,v,"zOrigin",v.zOrigin,p),e9(this,w,c,tg(a),tg(s)));continue}else if("svgOrigin"===c){tf(e,s,1,y,0,this);continue}else if(c in tu){tw(this,v,c,l,f?(0,eE._parseRelative)(l,f+s):s);continue}else if("smoothOrigin"===c){e9(this,v,"smooth",v.smooth,s);continue}else if("force3D"===c){v[c]=s;continue}else if("transform"===c){tS(this,s,e);continue}}else c in w||(c=e2(c)||c);if(m||(o||0===o)&&(l||0===l)&&!eD.test(s)&&c in w)d=(a+"").substr((l+"").length),o||(o=0),p=(0,eE.getUnit)(s)||(c in eE._config.units?eE._config.units[c]:d),d!==p&&(l=tr(e,c,a,p)),this._pt=new eE.PropTween(this._pt,m?v:w,c,l,(f?(0,eE._parseRelative)(l,f+o):o)-l,m||"px"!==p&&"zIndex"!==c||!1===t.autoRound?eU:eF),this._pt.u=p||0,d!==p&&"%"!==p&&(this._pt.b=a,this._pt.r=ek);else if(c in w)ti.call(this,e,c,a,f?f+s:s);else if(c in e)this.add(e,c,a||e[c],f?f+s:s,n,i);else if("parseTransform"!==c){(0,eE._missingPlugin)(c,s);continue}m||(c in w?_.push(c,0,w[c]):_.push(c,1,a||e[c])),b.push(c)}}x&&(0,eE._sortPropTweensByPriority)(this)},render:function(e,t){if(t.tween._time||!eS())for(var r=t._pt;r;)r.r(e,r.d),r=r._next;else t.styles.revert()},get:tn,aliases:eO,getSetter:function(e,t,r){var n=eO[t];return n&&0>n.indexOf(",")&&(t=n),t in eA&&t!==eY&&(e._gsap.x||tn(e,"x"))?r&&eM===r?"scale"===t?eW:eV:(eM=r||{},"scale"===t?ej:eq):e.style&&!(0,eE._isUndefined)(e.style[t])?eH:~t.indexOf("-")?eG:(0,eE._getSetter)(e,t)},core:{_removeProperty:e7,_getMatrix:tp}};eE.gsap.utils.checkPrefix=e2,eE.gsap.core.getStyleSaver=eQ,n="x,y,z,scale,scaleX,scaleY,xPercent,yPercent",i="rotation,rotationX,rotationY,skewX,skewY",a="0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY",s=(0,eE._forEachName)(n+","+i+",transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective",function(e){eA[e]=1}),(0,eE._forEachName)(i,function(e){eE._config.units[e]="deg",tu[e]=1}),eO[s[13]]=n+","+i,(0,eE._forEachName)(a,function(e){var t=e.split(":");eO[t[1]]=s[t[0]]}),(0,eE._forEachName)("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(e){eE._config.units[e]="px"}),(0,eE.gsap).registerPlugin(tT);var tE=(0,eE.gsap).registerPlugin(tT)||eE.gsap;tE.core.Tween;var eE=u("2Tywo"),tA={};tA="#define GLSLIFY 1\nuniform float uTime;\n\nvarying vec2 vUv;\n\nvoid main() {\n    vec4 modelPosition = modelMatrix * vec4(position, 1.0);\n    modelPosition.z += sin(modelPosition.x * 5.0 - uTime) * 0.1;\n\n    vec4 viewPosition = viewMatrix * modelPosition;\n    vec4 projectionPosition = projectionMatrix * viewPosition;\n\n    gl_Position = projectionPosition;\n\n    vUv = uv;\n}";var tL={};tL="#define GLSLIFY 1\nuniform sampler2D uTexture;\nuniform float uTouch;\nuniform float uTime;\n\nvarying vec2 vUv;\n\nvoid main() {\n    vec4 texture = texture2D(uTexture, vUv);\n    vec3 gray = vec3((texture.r + texture.g + texture.b) * 0.3);\n\n    float strength = distance(vUv, vec2(1.2, 0.5));\n    strength -= - sin(uTouch - 0.5) * 3.0;\n\n    vec3 color = mix(texture.rgb, gray.rgb, smoothstep(strength, strength - 0.2, uTouch));\n\n    gl_FragColor = vec4(color, 1.0);\n}";var tR={};tR="#define GLSLIFY 1\nvarying vec2 vUv;\n\nvoid main() {\n    vec4 modelPosition = modelMatrix * vec4(position, 1.0);\n    vec4 viewPosition = viewMatrix * modelPosition;\n    vec4 projectionPosition = projectionMatrix * viewPosition;\n\n    gl_Position = projectionPosition;\n\n    vUv = uv;\n}";var tP={};tP="#define GLSLIFY 1\nuniform float uScrollI;\nuniform float uTime;\n\nvarying vec2 vUv;\n\n// 2D Random\nfloat random (in vec2 st) {\n    return fract(sin(dot(st.xy,\n                         vec2(12.9898,78.233)))\n                 * 43758.5453123);\n}\n\n// 2D Noise based on Morgan McGuire @morgan3d\n// https://www.shadertoy.com/view/4dS3Wd\nfloat noise (in vec2 st) {\n    vec2 i = floor(st);\n    vec2 f = fract(st);\n\n    // Four corners in 2D of a tile\n    float a = random(i);\n    float b = random(i + vec2(1.0, 0.0));\n    float c = random(i + vec2(0.0, 1.0));\n    float d = random(i + vec2(1.0, 1.0));\n\n    // Smooth Interpolation\n\n    // Cubic Hermine Curve.  Same as SmoothStep()\n    vec2 u = f*f*(3.0-2.0*f);\n    // u = smoothstep(0.,1.,f);\n\n    // Mix 4 coorners percentages\n    return mix(a, b, u.x) +\n            (c - a)* u.y * (1.0 - u.x) +\n            (d - b) * u.x * u.y;\n}\n\nvoid main() {\n    vec2 pos = vec2(vec2(vUv) * 2.0);\n    pos += sin(uScrollI * 0.007);\n\n    float strength = noise(pos * 2.0);\n\n    vec3 color1 = vec3(0.229,0.274,0.335);\n    vec3 color2 = vec3(0.261,0.289,0.395);\n\n    vec3 mixedColor = mix(color1, color2, strength);\n\n    gl_FragColor = vec4(mixedColor, 1.0);\n}";var tC={};tC="#define GLSLIFY 1\nuniform float uPixelRatio;\nuniform float uSize;\nuniform float uTime;\n\nattribute float aScale;\n\nvoid main() {\n    vec4 modelPosition = modelMatrix * vec4(position, 1.0);\n    modelPosition.y += sin((uTime * 0.25) + (modelPosition.y * 5.0)) * 2.0;\n\n    vec4 viewPosition = viewMatrix * modelPosition;\n    vec4 projectionPosition = projectionMatrix * viewPosition;\n\n    gl_Position = projectionPosition;\n    gl_PointSize = uSize * aScale * uPixelRatio;\n    gl_PointSize *= (1.0 / - viewPosition.z);\n}";var tI={};tI="#define GLSLIFY 1\nvoid main() {\n    gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);\n}",console.log("index.js is working ");const tD=document.querySelector(".player"),tO=document.querySelector(".player-close"),tU=document.querySelector(".player-source"),tN=document.querySelector(".counterLoading"),tk=document.querySelector("header"),tF=document.querySelector("h1"),tB=document.querySelector("footer"),tz=document.querySelector(".loading"),tH=document.querySelector(".started"),tG=document.querySelector(".started-btn");let tV=1,tW=!1,tj=0,tq=.9*Math.PI,tX=-1,tY=!1,tZ={px:null,py:null,pz:null,rx:null,ry:null,rz:null};[].slice.call(document.querySelectorAll("a")).filter(e=>/^#.+/.test(e.getAttribute("href"))).forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();let t=this.getAttribute("href").substr(1),r=Math.max(document.getElementById(t).offsetTop-40,0);window.scroll({behavior:"smooth",left:0,top:r})})});let tJ=[{url:"https://youtu.be/Yz6Ffc6ShCE?si=iVwHWQeESMZ5N2wR",name:"Transformation Dark Vador\n - Anakin devient Dark Vador"},{url:"https://youtu.be/_YrrE0VnTSA?si=V4Rh4HxtLHpEZ2Ps",name:"Arrivée Dark Vador\n Étoile de la Mort"},{url:"https://youtu.be/sD8jLq42Td4?si=JkcDyvUkNCUJN3jS",name:"Darth Vader's rage"},{url:"https://youtu.be/5_l7ACxmziE?si=5uTDIi1jOk9WJLFS",name:"VADER EPISODE 1: SHARDS\n OF THE PAST"},{url:"https://youtu.be/pfU0QORkRpY?si=2b-ru2Z3Omaq1Mcg",name:"Je suis ton père!"},{url:"https://youtu.be/q4xKvHANqjk?si=3syi7a4l1FPUwUsw",name:"Darth Vader Goes Shopping"},{url:"https://youtu.be/BnEgnrUCXPY?si=wby66iWrkMQFYhue",name:"Votre manque de foi\n me consterne"},{url:"https://youtu.be/hM_8AlSqncI?si=rCiKcFYzltZEvf0P",name:"LA SOUFFRANCE MÈNE\n AU CÔTÉ OBSCUR"},{url:"https://youtu.be/nmpwhNquLq4?si=s_51IlGXAydTfpej",name:"Lord Vader: A Star\n Wars Story"},{url:"https://youtu.be/q11Hp-vFr80",name:"Green Bay"}];const tK={},tQ=document.querySelector(".main-webgl"),t$=new d.Scene;t$.background=new d.Color("#fff");const t0=new d.Scene,t1={width:window.innerWidth,height:window.innerHeight};window.addEventListener("resize",()=>{t1.width=window.innerWidth,t1.height=window.innerHeight,rc.aspect=t1.width/t1.height,rc.updateProjectionMatrix(),rA.setSize(t1.width,t1.height),rA.setPixelRatio(Math.min(window.devicePixelRatio,2))});const t2=new d.Raycaster;let t3=null,t4=new d.Vector2;window.addEventListener("mousemove",e=>{t4.x=e.clientX/t1.width*2-1,t4.y=-(2*(e.clientY/t1.height))+1});const t5=new Audio("/sounds/music-bg.mp3");t5.volume=.1;const t6=new Audio("/sounds/music-bg.mp3");t6.volume=.01;const t8=new d.LoadingManager(()=>{window.setTimeout(()=>{tE.to(tk,.5,{top:10,left:10,transform:"translate(0, 0)",ease:eE.Power1.easeIn}),tE.to(tF,.5,{fontSize:25,top:10,left:10,transform:"translate(0, 0)",width:150,ease:eE.Power1.easeIn}),tE.to(tB,.5,{delay:.4,opacity:1,ease:eE.Power1.easeIn}),tE.to(tB,.5,{delay:.4,opacity:1,ease:eE.Power1.easeIn}),tE.to(tN,.5,{delay:.4,opacity:0,ease:eE.Power1.easeIn}),tE.to(tH,.5,{delay:.9,opacity:1}),tG.addEventListener("click",()=>t7())},50)},(e,t,r)=>{let n=t/r;tN.innerHTML=`${(100*n).toFixed(0)}%`,tk.style.width=`${(550*n).toFixed(0)}px`}),t7=()=>{t5.play(),t6.play(),tE.to(tH,.5,{opacity:0}),tE.to(tz,.5,{opacity:0}),tE.from(rc.position,1.5,{x:4,z:-8.5,y:3}),setTimeout(()=>{tz.style.visibility="hidden",tH.style.visibility="hidden",ry.visible=!0,rx.visible=!0,tY=!0},250)},t9=new d.TextureLoader(t8),re=t9.load("/photo/image-1.jpg"),rt=t9.load("/photo/image-2.jpg"),rr=t9.load("/photo/image-3.jpg"),rn=t9.load("/photo/image-4.jpg"),ri=t9.load("/photo/image-5.jpg"),ra=t9.load("/photo/image-6.jpg"),rs=t9.load("/photo/image-7.jpg"),ro=[re,rt,rr,rn,ri,ra,rs,t9.load("/photo/image-8.jpg"),t9.load("/photo/image-9.jpg"),t9.load("/photo/greenbay.png")],rl=new m(t8);let rh=[];rl.load("/models/Dark_vador/nintendo_switch.glb",e=>{e.scene.scale.set(.32,.32,.32),e.scene.position.y=-1,e.scene.rotation.y=tq,t$.add(e.scene),rh.push(e.scene),t$.traverse(e=>{e instanceof d.Mesh&&e.material instanceof d.MeshStandardMaterial&&(e.material.envMapIntensity=tK.envMapIntensity,e.material.needsUpdate=!0)})},void 0,e=>{console.log(e)});let ru=0;rl.load("/models/Rock/scene.gltf",e=>{e.scene.scale.set(.01,.01,.01),e.scene.position.y=-2.73,e.scene.rotation.y=tq,t$.add(e.scene),rh.push(e.scene),t$.traverse(e=>{e instanceof d.Mesh&&e.material instanceof d.MeshStandardMaterial&&(e.material.envMapIntensity=tK.envMapIntensity,e.material.needsUpdate=!0)}),"ontouchstart"in window?(window.addEventListener("touchstart",e=>{ru=e.touches[0].clientY},!1),window.addEventListener("touchmove",e=>{e.touches[0].clientY<ru?(ru=e.touches[0].clientY,rL(e,!0,ru,"up")):(ru=e.touches[0].clientY,rL(e,!0,ru,"down"))},!1)):window.addEventListener("wheel",e=>rL(e),!1)},void 0,e=>{console.log(e)}),tK.envMapIntensity=5;const rc=new d.PerspectiveCamera(83,t1.width/t1.height,.1,100);rc.position.x=0,rc.position.y=0,rc.position.z=-5,t$.add(rc);const rd=new d.OrthographicCamera(-1,1,1,-1,-1,0),rp=new p(rc,tQ);rp.enabled=!1,rp.enableZoom=!1;const rf=new d.AmbientLight(16711680,1.5);t$.add(rf);const rm=new d.PointLight(16777215,15);rm.position.set(-5.5,5.5,-5),t$.add(rm);const rg=new d.PlaneGeometry(2,2),rv=new d.ShaderMaterial({vertexShader:/*@__PURE__*/r(tR),fragmentShader:/*@__PURE__*/r(tP),uniforms:{uScrollI:{value:tj},uResoltion:{value:new d.Vector2(t1.width,t1.height)},uTime:{value:0}}});t0.add(new d.Mesh(rg,rv));const ry=new d.Group,rx=new d.Group;ry.visible=!1,rx.visible=!1,t$.add(ry,rx);const r_=new d.PlaneGeometry(2,1.25,32,32),rb=[];for(let e=0;e<10;e++){rb.push(new d.ShaderMaterial({side:d.DoubleSide,vertexShader:/*@__PURE__*/r(tA),fragmentShader:/*@__PURE__*/r(tL),uniforms:{uScrollI:{value:tj},uTexture:{value:ro[e]},uTime:{value:0},uTouch:{value:tV}}}));let t=new d.Mesh(r_,rb[e]);t.position.y=e-14.2,t.position.x=-Math.cos(e)*Math.PI,t.position.z=-Math.sin(e)*Math.PI,t.lookAt(0,t.position.y,0),ry.add(t);let n=new em;n.text=tJ[e].name.toString(),n.fontSize=.1,n.position.y=t.position.y,n.position.x=t.position.x,n.position.z=t.position.z,rx.add(n)}const rw=new d.BufferGeometry,rM=new Float32Array(90),rS=new Float32Array(30);for(let e=0;e<30;e++){let t=3*e;rM[t]=(Math.random()-.5)*10,rM[t+1]=1.5*Math.random()-2,rM[t+2]=(Math.random()-.5)*10+2.5,rS[e]=Math.random()}rw.setAttribute("position",new d.BufferAttribute(rM,3)),rw.setAttribute("aScale",new d.BufferAttribute(rS,1));const rT=new d.ShaderMaterial({blending:d.AdditiveBlending,vertexShader:/*@__PURE__*/r(tC),fragmentShader:/*@__PURE__*/r(tI),uniforms:{uTime:{value:0},uSize:{value:10},uPixelRatio:{value:Math.min(window.devicePixelRatio,2)}}}),rE=new d.Points(rw,rT);t$.add(rE);const rA=new d.WebGLRenderer({canvas:tQ});rA.setSize(t1.width,t1.height),rA.setPixelRatio(Math.min(window.devicePixelRatio,2)),rA.autoClear=!1,window.addEventListener("keydown",function(e){"ArrowRight"===e.code||"ArrowDown"===e.code?rL({deltaY:1},!1):("ArrowLeft"===e.code||"ArrowUp"===e.code)&&rL({deltaY:-1},!1)});const rL=(e,t,r,n)=>{let i;let a=window.innerWidth<=768;if(t&&a?i=r:a||(i="wheel"===e.type?e.deltaY>0?3:-3:e.deltaY>0?20:-20),!1===tW&&tY&&void 0!==i){i<0&&tj>0?tj-=Math.abs(i):i>0&&tj<=435&&(tj+=Math.abs(i)),rh.forEach((e,t)=>{e.rotation.y=tq-.01355*tj,0===t?e.position.y=-1-.006*tj:1===t&&(e.position.y=-1-.006*tj),e.position.z=-(.0055000000000000005*tj)});for(let e=0;e<ry.children.length;e++){let t=ry.children[e],r=rx.children[e];t.position.z=-Math.sin(e+1*tj*.1)*Math.PI,t.position.x=-Math.cos(e+1*tj*.1)*Math.PI,t.position.y=e-14.2+.1*tj,t.lookAt(0,t.position.y,0),r.position.z=t.position.z-.5,r.position.x=t.position.x,r.position.y=t.position.y-.3,r.lookAt(2*t.position.x,t.position.y-.3,2*t.position.z)}}};function rR(){let e=document.getElementById("player"),t=`
        <div class="page-event">
            <div class="cover">
                <div class="heading">\u{690D}\u{7686}\u{4EA4}\u{6613}</div>
                 <a id="image-01" class="logo-image">
                    <img src="/pdfs/green-bay-ppt-01.jpg">
                </a>
                <a id="image-02" class="logo-image">
                    <img src="/pdfs/green-bay-ppt-02.jpg">
                </a>
                <a id="image-03" class="logo-image">
                    <img src="/pdfs/green-bay-ppt-03.jpg">
                </a>
                <a id="image-04" class="logo-image">
                    <img src="/pdfs/green-bay-ppt-04.jpg">
                </a>
                <a id="image-05" class="logo-image">
                    <img src="/pdfs/green-bay-ppt-05.jpg">
                </a>
                <a id="image-06" class="logo-image">
                    <img src="/pdfs/green-bay-ppt-06.jpg">
                </a>
                <a id="image-07" class="logo-image">
                    <img src="/pdfs/green-bay-ppt-07.jpg">
                </a>
                <a id="image-08" class="logo-image">
                    <img src="/pdfs/green-bay-ppt-08.jpg">
                </a>
                <a id="image-09" class="logo-image">
                    <img src="/pdfs/green-bay-ppt-09.jpg">
                </a>
                <a id="image-10" class="logo-image">
                    <img src="/pdfs/green-bay-ppt-10.jpg">
                </a>
                <a id="image-11" class="logo-image">
                    <img src="/pdfs/green-bay-ppt-11.jpg">
                </a>
                <a id="image-12" class="logo-image">
                    <img src="/pdfs/green-bay-ppt-12.jpg">
                </a>
                <a id="image-13" class="logo-image">
                    <img src="/pdfs/green-bay-ppt-13.jpg">
                </a>
                <a id="image-14" class="logo-image">
                    <img src="/pdfs/green-bay-ppt-14.jpg">
                </a>
                <a id="image-15" class="logo-image">
                    <img src="/pdfs/green-bay-ppt-15.jpg">
                </a>
                <a id="image-16" class="logo-image">
                    <img src="/pdfs/green-bay-ppt-16.jpg">
                </a>
                <a id="image-17" class="logo-image">
                    <img src="/pdfs/green-bay-ppt-17.jpg">
                </a>
            </div>
            </div>
        <div class="container">
            <div class="header-image"></div>
        </div>
        <div class="event-page">
            <div class="event-page__title"> Green Bay <a class="web-title" href="https://greenbay.tw/", target="blank">(\u{524D}\u{5F80}\u{7DB2}\u{7AD9})</a></div>
            
        </div>
        <ul class="event-page__nav">
        <li><a href="#overview" title="Overview"><i class="fal fa-ellipsis-h-alt"></i></a></li>
        <li><a href="#schedule" title="Schedule"><i class="fal fa-list"></i></a></li>
        <li><a href="#venue" title="Venue"><i class="fal fa-map-marker-alt"></i></a></li>
        <li><a href="#ticket" title="Get Ticket"><i class="fal fa-ticket-alt"></i></a></li>
        </ul>
    `;e.insertAdjacentHTML("beforeend",t),rk=0,(rF=[document.getElementById("image-01"),document.getElementById("image-02"),document.getElementById("image-03"),document.getElementById("image-04"),document.getElementById("image-05"),document.getElementById("image-06"),document.getElementById("image-07"),document.getElementById("image-08"),document.getElementById("image-09"),document.getElementById("image-10"),document.getElementById("image-11"),document.getElementById("image-12"),document.getElementById("image-13"),document.getElementById("image-14"),document.getElementById("image-15"),document.getElementById("image-16"),document.getElementById("image-17")]).forEach((e,t)=>{null===e&&console.error(`Element at index ${t} is null. Please check if the ID is correct.`)});let r=document.createElement("style");r.id="dynamic-style",r.innerHTML=`
        .player {
            overflow-y: scroll !important;
            display: flex !important;
            flex-direction: column !important;
            align-items: center !important;
        }

        .player-source {
            position: relative !important;
            top: 80px !important;
            left: auto !important;
            right: auto !important;
            transform: none !important;
            min-height: 700px !important;
        }
    `,document.head.appendChild(r)}window.addEventListener("click",e=>{rP();let t=e.target,r=document.querySelector(".page-event");t.classList.contains("started-btn")||r||rR()}),window.addEventListener("touchstart",e=>{rP();let t=e.target,r=document.querySelector(".page-event");t.classList.contains("started-btn")||r||rR()});const rP=()=>{if(t3&&!1===tW&&tY){for(let e=0;e<ry.children.length;e++)if(ry.children[e]===t3.object){tX=e,t5.pause(),t6.pause(),tZ={px:ry.children[e].position.x,py:ry.children[e].position.y,pz:ry.children[e].position.z,rx:ry.children[e].rotation.x,ry:ry.children[e].rotation.y,rz:ry.children[e].rotation.z},tE.to(ry.children[e].position,.5,{z:rc.position.z+.5,x:rc.position.x,y:rc.position.y,ease:eE.Power1.easeIn}),tE.to(ry.children[e].rotation,.5,{z:0,x:0,y:0,ease:eE.Power1.easeIn});let t=function(e){let t=e?.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/);return t&&11===t[2].length?t[2]:null}(tJ[e].url);tU.src="https://www.youtube.com/embed/"+t,setTimeout(()=>{tD.style.visibility="visible",tE.to(tD,.5,{opacity:1,ease:eE.Power1.easeIn})},400),tW=!0}}};tO.addEventListener("click",()=>{tU.src="",t5.play(),t6.play(),tE.to(tD,.5,{opacity:0,ease:eE.Power1.easeIn}),tD.style.visibility="hidden",tE.to(ry.children[tX].position,.5,{x:tZ.px,y:tZ.py,z:tZ.pz,ease:eE.Power1.easeIn}),tE.to(ry.children[tX].rotation,.5,{x:tZ.rx,y:tZ.ry,z:tZ.rz,ease:eE.Power1.easeIn}),tX=-1,setTimeout(()=>{tW=!1},500),setTimeout(()=>{(function(){console.log("Executing removeCards");let e=document.getElementById("player").querySelectorAll(".main-cards");console.log(e),e.length>0&&e.forEach(e=>{e.remove()}),style.innerHTML&&(style.innerHTML="")})(),console.log("執行囉")},500)});let rC=0;const rI=e=>{if(e>=0){let t=setInterval(()=>{1===rC?tV+=.01:0===rC&&(tV-=.01),ry.children[e].material.uniforms.uTouch.value=tV,parseFloat(tV.toFixed(1))===rC&&(clearInterval(t),rC=0===rC?1:0)},7)}},rD=new d.Clock;let rO=0,rU=-1;const rN=()=>{let e=rD.getElapsedTime();rb.forEach(t=>{t.uniforms.uTime.value=e,t.uniforms.uScrollI.value=tj}),rv.uniforms.uScrollI.value=tj,rv.uniforms.uTime.value=e,rT.uniforms.uTime.value=e,"ontouchstart"in window||t2.setFromCamera(t4,rc);let t=t2.intersectObjects(ry.children);if(tY){if(1===t.length){if(null===t3)t3=t[0];else for(let e=0;e<ry.children.length;e++)ry.children[e]===t3.object&&0===rO&&(rU=e,rI(e),rO=1,document.body.style.cursor="pointer")}else 1===rO&&rU>=0&&(rI(rU),rO=0,document.body.style.cursor="auto",t3=null,rU=-1)}rA.render(t$,rc),rA.render(t0,rd),window.requestAnimationFrame(rN)};rN();let rk=0,rF=[];window.addEventListener("keydown",e=>{if(e.preventDefault(),"ArrowDown"===e.key||"ArrowRight"===e.key)rk<rF.length&&rF[rk]&&(rF[rk].scrollIntoView({behavior:"smooth",block:"center"}),rk=Math.min(rk+1,rF.length-1));else if("ArrowUp"===e.key||"ArrowLeft"===e.key)rk>0&&rF[rk=Math.max(rk-1,0)]&&rF[rk].scrollIntoView({behavior:"smooth",block:"center"});else if("Backspace"===e.key){let e=document.getElementById("btn-back-to-home");e&&e.click()}});
//# sourceMappingURL=index.694318e9.js.map
